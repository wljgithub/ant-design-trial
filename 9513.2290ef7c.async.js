(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9513],{57141:function(_t,O,_){"use strict";_.d(O,{zj:function(){return nt},oI:function(){return qr},ni:function(){return le},gg:function(){return Lr}});var X=_(6661);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function b(tr,ce,ye,Re){function Qe(Dt){return Dt instanceof ye?Dt:new ye(function(Ct){Ct(Dt)})}return new(ye||(ye=Promise))(function(Dt,Ct){function A(Ce){try{ve(Re.next(Ce))}catch($e){Ct($e)}}function z(Ce){try{ve(Re.throw(Ce))}catch($e){Ct($e)}}function ve(Ce){Ce.done?Dt(Ce.value):Qe(Ce.value).then(A,z)}ve((Re=Re.apply(tr,ce||[])).next())})}function p(tr,ce){var ye={label:0,sent:function(){if(Dt[0]&1)throw Dt[1];return Dt[1]},trys:[],ops:[]},Re,Qe,Dt,Ct;return Ct={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(Ct[Symbol.iterator]=function(){return this}),Ct;function A(ve){return function(Ce){return z([ve,Ce])}}function z(ve){if(Re)throw new TypeError("Generator is already executing.");for(;ye;)try{if(Re=1,Qe&&(Dt=ve[0]&2?Qe.return:ve[0]?Qe.throw||((Dt=Qe.return)&&Dt.call(Qe),0):Qe.next)&&!(Dt=Dt.call(Qe,ve[1])).done)return Dt;switch(Qe=0,Dt&&(ve=[ve[0]&2,Dt.value]),ve[0]){case 0:case 1:Dt=ve;break;case 4:return ye.label++,{value:ve[1],done:!1};case 5:ye.label++,Qe=ve[1],ve=[0];continue;case 7:ve=ye.ops.pop(),ye.trys.pop();continue;default:if(Dt=ye.trys,!(Dt=Dt.length>0&&Dt[Dt.length-1])&&(ve[0]===6||ve[0]===2)){ye=0;continue}if(ve[0]===3&&(!Dt||ve[1]>Dt[0]&&ve[1]<Dt[3])){ye.label=ve[1];break}if(ve[0]===6&&ye.label<Dt[1]){ye.label=Dt[1],Dt=ve;break}if(Dt&&ye.label<Dt[2]){ye.label=Dt[2],ye.ops.push(ve);break}Dt[2]&&ye.ops.pop(),ye.trys.pop();continue}ve=ce.call(tr,ye)}catch(Ce){ve=[6,Ce],Qe=0}finally{Re=Dt=0}if(ve[0]&5)throw ve[1];return{value:ve[0]?ve[1]:void 0,done:!0}}}function H(tr,ce){var ye=typeof Symbol=="function"&&tr[Symbol.iterator];if(!ye)return tr;var Re=ye.call(tr),Qe,Dt=[],Ct;try{for(;(ce===void 0||ce-- >0)&&!(Qe=Re.next()).done;)Dt.push(Qe.value)}catch(A){Ct={error:A}}finally{try{Qe&&!Qe.done&&(ye=Re.return)&&ye.call(Re)}finally{if(Ct)throw Ct.error}}return Dt}function S(){for(var tr=[],ce=0;ce<arguments.length;ce++)tr=tr.concat(H(arguments[ce]));return tr}function F(tr){return tr&&tr.__esModule&&Object.prototype.hasOwnProperty.call(tr,"default")?tr.default:tr}function ie(tr,ce){return ce={exports:{}},tr(ce,ce.exports),ce.exports}var fe=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=ye;function ye(Re){return Re&&typeof Re.length=="number"&&Re.length>=0&&Re.length%1==0}tr.exports=ce.default});F(fe);var Q=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=function(ye){return function(){for(var Re=[],Qe=arguments.length;Qe--;)Re[Qe]=arguments[Qe];var Dt=Re.pop();return ye.call(this,Re,Dt)}},tr.exports=ce.default});F(Q);var we=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.fallback=Qe,ce.wrap=Dt;var ye=ce.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Re=ce.hasNextTick=typeof X=="object"&&typeof X.nextTick=="function";function Qe(A){setTimeout(A,0)}function Dt(A){return function(z){for(var ve=[],Ce=arguments.length-1;Ce-- >0;)ve[Ce]=arguments[Ce+1];return A(function(){return z.apply(void 0,ve)})}}var Ct;ye?Ct=setImmediate:Re?Ct=X.nextTick:Ct=Qe,ce.default=Dt(Ct)});F(we);var Ie=we.fallback,Be=we.wrap,Xe=we.hasSetImmediate,Ut=we.hasNextTick,er=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=Dt;var ye=Qe(Q),Re=Qe(we);function Qe(z){return z&&z.__esModule?z:{default:z}}function Dt(z){return(0,Yt.isAsync)(z)?function(){for(var ve=[],Ce=arguments.length;Ce--;)ve[Ce]=arguments[Ce];var $e=ve.pop(),ot=z.apply(this,ve);return Ct(ot,$e)}:(0,ye.default)(function(ve,Ce){var $e;try{$e=z.apply(this,ve)}catch(ot){return Ce(ot)}if($e&&typeof $e.then=="function")return Ct($e,Ce);Ce(null,$e)})}function Ct(z,ve){return z.then(function(Ce){A(ve,null,Ce)},function(Ce){A(ve,Ce&&Ce.message?Ce:new Error(Ce))})}function A(z,ve,Ce){try{z(ve,Ce)}catch($e){(0,Re.default)(function(ot){throw ot},$e)}}tr.exports=ce.default});F(er);var Yt=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.isAsyncIterable=ce.isAsyncGenerator=ce.isAsync=void 0;var ye=Re(er);function Re(z){return z&&z.__esModule?z:{default:z}}function Qe(z){return z[Symbol.toStringTag]==="AsyncFunction"}function Dt(z){return z[Symbol.toStringTag]==="AsyncGenerator"}function Ct(z){return typeof z[Symbol.asyncIterator]=="function"}function A(z){if(typeof z!="function")throw new Error("expected a function");return Qe(z)?(0,ye.default)(z):z}ce.default=A,ce.isAsync=Qe,ce.isAsyncGenerator=Dt,ce.isAsyncIterable=Ct});F(Yt);var lt=Yt.isAsyncIterable,xt=Yt.isAsyncGenerator,ct=Yt.isAsync,Sr=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=ye;function ye(Re,Qe){if(Qe===void 0&&(Qe=Re.length),!Qe)throw new Error("arity is undefined");function Dt(){for(var Ct=this,A=[],z=arguments.length;z--;)A[z]=arguments[z];return typeof A[Qe-1]=="function"?Re.apply(this,A):new Promise(function(ve,Ce){A[Qe-1]=function($e){for(var ot=[],Ot=arguments.length-1;Ot-- >0;)ot[Ot]=arguments[Ot+1];if($e)return Ce($e);ve(ot.length>1?ot:ot[0])},Re.apply(Ct,A)})}return Object.defineProperty(Dt,"name",{configurable:!0,value:"awaitable("+Re.name+")"}),Dt}tr.exports=ce.default});F(Sr);var Ft=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0});var ye=Dt(fe),Re=Dt(Yt),Qe=Dt(Sr);function Dt(Ct){return Ct&&Ct.__esModule?Ct:{default:Ct}}ce.default=(0,Qe.default)(function(Ct,A,z){var ve=(0,ye.default)(A)?[]:{};Ct(A,function(Ce,$e,ot){(0,Re.default)(Ce)(function(Ot){for(var G,Et=[],Bt=arguments.length-1;Bt-- >0;)Et[Bt]=arguments[Bt+1];Et.length<2&&(G=Et,Et=G[0]),ve[$e]=Et,ot(Ot)})},function(Ce){return z(Ce,ve)})},3),tr.exports=ce.default});F(Ft);var Ht=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=ye;function ye(Re){function Qe(){for(var Dt=[],Ct=arguments.length;Ct--;)Dt[Ct]=arguments[Ct];if(Re!==null){var A=Re;Re=null,A.apply(this,Dt)}}return Object.assign(Qe,Re),Qe}tr.exports=ce.default});F(Ht);var St=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=function(ye){return ye[Symbol.iterator]&&ye[Symbol.iterator]()},tr.exports=ce.default});F(St);var Ge=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=z;var ye=Qe(fe),Re=Qe(St);function Qe(ve){return ve&&ve.__esModule?ve:{default:ve}}function Dt(ve){var Ce=-1,$e=ve.length;return function(){return++Ce<$e?{value:ve[Ce],key:Ce}:null}}function Ct(ve){var Ce=-1;return function(){var ot=ve.next();return ot.done?null:(Ce++,{value:ot.value,key:Ce})}}function A(ve){var Ce=ve?Object.keys(ve):[],$e=-1,ot=Ce.length;return function(){var G=Ce[++$e];return $e<ot?{value:ve[G],key:G}:null}}function z(ve){if((0,ye.default)(ve))return Dt(ve);var Ce=(0,Re.default)(ve);return Ce?Ct(Ce):A(ve)}tr.exports=ce.default});F(Ge);var vt=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=ye;function ye(Re){return function(){for(var Qe=[],Dt=arguments.length;Dt--;)Qe[Dt]=arguments[Dt];if(Re===null)throw new Error("Callback was already called.");var Ct=Re;Re=null,Ct.apply(this,Qe)}}tr.exports=ce.default});F(vt);var Pe=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0});var ye={};ce.default=ye,tr.exports=ce.default});F(Pe);var Te=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=Qe;var ye=Re(Pe);function Re(Dt){return Dt&&Dt.__esModule?Dt:{default:Dt}}function Qe(Dt,Ct,A,z){var ve=!1,Ce=!1,$e=!1,ot=0,Ot=0;function G(){ot>=Ct||$e||ve||($e=!0,Dt.next().then(function(dr){var wr=dr.value,Tr=dr.done;if(!(Ce||ve)){if($e=!1,Tr){ve=!0,ot<=0&&z(null);return}ot++,A(wr,Ot,Et),Ot++,G()}}).catch(Bt))}function Et(dr,wr){if(ot-=1,!Ce){if(dr)return Bt(dr);if(dr===!1){ve=!0,Ce=!0;return}if(wr===ye.default||ve&&ot<=0)return ve=!0,z(null);G()}}function Bt(dr){Ce||($e=!1,ve=!0,z(dr))}G()}tr.exports=ce.default});F(Te);var ze=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0});var ye=A(Ht),Re=A(Ge),Qe=A(vt),Dt=A(Te),Ct=A(Pe);function A(z){return z&&z.__esModule?z:{default:z}}ce.default=function(z){return function(ve,Ce,$e){if($e=(0,ye.default)($e),z<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!ve)return $e(null);if((0,Yt.isAsyncGenerator)(ve))return(0,Dt.default)(ve,z,Ce,$e);if((0,Yt.isAsyncIterable)(ve))return(0,Dt.default)(ve[Symbol.asyncIterator](),z,Ce,$e);var ot=(0,Re.default)(ve),Ot=!1,G=!1,Et=0,Bt=!1;function dr(Tr,Or){if(!G)if(Et-=1,Tr)Ot=!0,$e(Tr);else if(Tr===!1)Ot=!0,G=!0;else{if(Or===Ct.default||Ot&&Et<=0)return Ot=!0,$e(null);Bt||wr()}}function wr(){for(Bt=!0;Et<z&&!Ot;){var Tr=ot();if(Tr===null){Ot=!0,Et<=0&&$e(null);return}Et+=1,Ce(Tr.value,Tr.key,(0,Qe.default)(dr))}Bt=!1}wr()}},tr.exports=ce.default});F(ze);var bt=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0});var ye=Dt(ze),Re=Dt(Yt),Qe=Dt(Sr);function Dt(A){return A&&A.__esModule?A:{default:A}}function Ct(A,z,ve,Ce){return(0,ye.default)(z)(A,(0,Re.default)(ve),Ce)}ce.default=(0,Qe.default)(Ct,4),tr.exports=ce.default});F(bt);var cr=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0});var ye=Qe(bt),Re=Qe(Sr);function Qe(Ct){return Ct&&Ct.__esModule?Ct:{default:Ct}}function Dt(Ct,A,z){return(0,ye.default)(Ct,1,A,z)}ce.default=(0,Re.default)(Dt,3),tr.exports=ce.default});F(cr);var ae=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=Dt;var ye=Qe(Ft),Re=Qe(cr);function Qe(Ct){return Ct&&Ct.__esModule?Ct:{default:Ct}}function Dt(Ct,A){return(0,ye.default)(Re.default,Ct,A)}tr.exports=ce.default}),Ee=F(ae),le=function(){function tr(){for(var ce=arguments,ye=[],Re=0;Re<arguments.length;Re++)ye[Re]=ce[Re];this.args=[],this.tasks=[]}return tr.prototype.call=function(){for(var ce=arguments,ye=[],Re=0;Re<arguments.length;Re++)ye[Re]=ce[Re];return this.args=ye,Ee(this.tasks)},tr.prototype.tap=function(ce,ye){var Re=this;this.tasks.push(function(Qe){ye.apply(void 0,S(Re.args)),Qe(null,ce)})},tr}(),re=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0});var ye=ve(fe),Re=ve(Pe),Qe=ve(bt),Dt=ve(Ht),Ct=ve(vt),A=ve(Yt),z=ve(Sr);function ve(Ot){return Ot&&Ot.__esModule?Ot:{default:Ot}}function Ce(Ot,G,Et){Et=(0,Dt.default)(Et);var Bt=0,dr=0,wr=Ot.length,Tr=!1;wr===0&&Et(null);function Or(qe,yt){qe===!1&&(Tr=!0),Tr!==!0&&(qe?Et(qe):(++dr===wr||yt===Re.default)&&Et(null))}for(;Bt<wr;Bt++)G(Ot[Bt],Bt,(0,Ct.default)(Or))}function $e(Ot,G,Et){return(0,Qe.default)(Ot,Infinity,G,Et)}function ot(Ot,G,Et){var Bt=(0,ye.default)(Ot)?Ce:$e;return Bt(Ot,(0,A.default)(G),Et)}ce.default=(0,z.default)(ot,3),tr.exports=ce.default});F(re);var te=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=Dt;var ye=Qe(re),Re=Qe(Ft);function Qe(Ct){return Ct&&Ct.__esModule?Ct:{default:Ct}}function Dt(Ct,A){return(0,Re.default)(ye.default,Ct,A)}tr.exports=ce.default}),ke=F(te),nt=function(){function tr(){for(var ce=arguments,ye=[],Re=0;Re<arguments.length;Re++)ye[Re]=ce[Re];this.tasks=[]}return tr.prototype.promise=function(){for(var ce=arguments,ye=[],Re=0;Re<arguments.length;Re++)ye[Re]=ce[Re];return ke(this.tasks)},tr.prototype.tapPromise=function(ce,ye){var Re=this;this.tasks.push(function(Qe){return b(Re,void 0,void 0,function(){return p(this,function(Dt){switch(Dt.label){case 0:return[4,ye()];case 1:return Dt.sent(),Qe(null,ce),[2]}})})})},tr}(),Kt=ie(function(tr,ce){Object.defineProperty(ce,"__esModule",{value:!0});var ye=Ct(Ht),Re=Ct(vt),Qe=Ct(Yt),Dt=Ct(Sr);function Ct(z){return z&&z.__esModule?z:{default:z}}function A(z,ve){if(ve=(0,ye.default)(ve),!Array.isArray(z))return ve(new Error("First argument to waterfall must be an array of functions"));if(!z.length)return ve();var Ce=0;function $e(Ot){var G=(0,Qe.default)(z[Ce++]);G.apply(void 0,Ot.concat([(0,Re.default)(ot)]))}function ot(Ot){for(var G=[],Et=arguments.length-1;Et-- >0;)G[Et]=arguments[Et+1];if(Ot!==!1){if(Ot||Ce===z.length)return ve.apply(void 0,[Ot].concat(G));$e(G)}}$e([])}ce.default=(0,Dt.default)(A),tr.exports=ce.default}),Ir=F(Kt),Lr=function(){function tr(){for(var ce=arguments,ye=[],Re=0;Re<arguments.length;Re++)ye[Re]=ce[Re];this.tasks=[]}return tr.prototype.call=function(){for(var ce=arguments,ye=[],Re=0;Re<arguments.length;Re++)ye[Re]=ce[Re];return Ir(this.tasks)},tr.prototype.tap=function(ce,ye){this.tasks.length===0?this.tasks.push(function(Re){var Qe=ye();Re(Qe?null:!1,Qe)}):this.tasks.push(function(Re,Qe){var Dt=ye();Qe(Dt?null:!1,ce)})},tr}(),qr=function(){function tr(){for(var ce=arguments,ye=[],Re=0;Re<arguments.length;Re++)ye[Re]=ce[Re];this.tasks=[]}return tr.prototype.call=function(){for(var ce=arguments,ye=[],Re=0;Re<arguments.length;Re++)ye[Re]=ce[Re];return Ee(this.tasks)},tr.prototype.tap=function(ce,ye){this.tasks.push(function(Re){var Qe=ye();Re(Qe,ce)})},tr}()},11892:function(_t,O,_){"use strict";_.d(O,{nC:function(){return X.ZP},Hp:function(){return X.Hp},e7:function(){return X.e7},yT:function(){return X.yT},vK:function(){return p.v},BlendType:function(){return S.h},AttributeType:function(){return F.GC},ScaleTypes:function(){return F.vY},StyleScaleType:function(){return F.ee},MapServiceEvent:function(){return Q.I},CoordinateSystem:function(){return we.l},CoordinateUniform:function(){return we.k},CameraUniform:function(){return Xe.l},SceneEventList:function(){return Yt.P},PositionType:function(){return St.d},gl:function(){return z.gl}});var X=_(11296),b=_(3670),p=_(82803),H=_(61223),S=_(21968),F=_(15144),ie=_(93934),fe=_.n(ie);_.o(ie,"CameraUniform")&&_.d(O,{CameraUniform:function(){return ie.CameraUniform}}),_.o(ie,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return ie.CityBuildingLayer}}),_.o(ie,"CoordinateSystem")&&_.d(O,{CoordinateSystem:function(){return ie.CoordinateSystem}}),_.o(ie,"CoordinateUniform")&&_.d(O,{CoordinateUniform:function(){return ie.CoordinateUniform}}),_.o(ie,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return ie.HeatmapLayer}}),_.o(ie,"ImageLayer")&&_.d(O,{ImageLayer:function(){return ie.ImageLayer}}),_.o(ie,"LineLayer")&&_.d(O,{LineLayer:function(){return ie.LineLayer}}),_.o(ie,"MapServiceEvent")&&_.d(O,{MapServiceEvent:function(){return ie.MapServiceEvent}}),_.o(ie,"Marker")&&_.d(O,{Marker:function(){return ie.Marker}}),_.o(ie,"PointLayer")&&_.d(O,{PointLayer:function(){return ie.PointLayer}}),_.o(ie,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return ie.PolygonLayer}}),_.o(ie,"Popup")&&_.d(O,{Popup:function(){return ie.Popup}}),_.o(ie,"PositionType")&&_.d(O,{PositionType:function(){return ie.PositionType}}),_.o(ie,"RasterLayer")&&_.d(O,{RasterLayer:function(){return ie.RasterLayer}}),_.o(ie,"Scene")&&_.d(O,{Scene:function(){return ie.Scene}}),_.o(ie,"SceneEventList")&&_.d(O,{SceneEventList:function(){return ie.SceneEventList}}),_.o(ie,"gl")&&_.d(O,{gl:function(){return ie.gl}});var Q=_(61264),we=_(71134),Ie=_(63288),Be=_.n(Ie);_.o(Ie,"CameraUniform")&&_.d(O,{CameraUniform:function(){return Ie.CameraUniform}}),_.o(Ie,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return Ie.CityBuildingLayer}}),_.o(Ie,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return Ie.HeatmapLayer}}),_.o(Ie,"ImageLayer")&&_.d(O,{ImageLayer:function(){return Ie.ImageLayer}}),_.o(Ie,"LineLayer")&&_.d(O,{LineLayer:function(){return Ie.LineLayer}}),_.o(Ie,"Marker")&&_.d(O,{Marker:function(){return Ie.Marker}}),_.o(Ie,"PointLayer")&&_.d(O,{PointLayer:function(){return Ie.PointLayer}}),_.o(Ie,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return Ie.PolygonLayer}}),_.o(Ie,"Popup")&&_.d(O,{Popup:function(){return Ie.Popup}}),_.o(Ie,"PositionType")&&_.d(O,{PositionType:function(){return Ie.PositionType}}),_.o(Ie,"RasterLayer")&&_.d(O,{RasterLayer:function(){return Ie.RasterLayer}}),_.o(Ie,"Scene")&&_.d(O,{Scene:function(){return Ie.Scene}}),_.o(Ie,"SceneEventList")&&_.d(O,{SceneEventList:function(){return Ie.SceneEventList}}),_.o(Ie,"gl")&&_.d(O,{gl:function(){return Ie.gl}});var Xe=_(87300),Ut=_(83968),er=_.n(Ut);_.o(Ut,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return Ut.CityBuildingLayer}}),_.o(Ut,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return Ut.HeatmapLayer}}),_.o(Ut,"ImageLayer")&&_.d(O,{ImageLayer:function(){return Ut.ImageLayer}}),_.o(Ut,"LineLayer")&&_.d(O,{LineLayer:function(){return Ut.LineLayer}}),_.o(Ut,"Marker")&&_.d(O,{Marker:function(){return Ut.Marker}}),_.o(Ut,"PointLayer")&&_.d(O,{PointLayer:function(){return Ut.PointLayer}}),_.o(Ut,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return Ut.PolygonLayer}}),_.o(Ut,"Popup")&&_.d(O,{Popup:function(){return Ut.Popup}}),_.o(Ut,"PositionType")&&_.d(O,{PositionType:function(){return Ut.PositionType}}),_.o(Ut,"RasterLayer")&&_.d(O,{RasterLayer:function(){return Ut.RasterLayer}}),_.o(Ut,"Scene")&&_.d(O,{Scene:function(){return Ut.Scene}}),_.o(Ut,"SceneEventList")&&_.d(O,{SceneEventList:function(){return Ut.SceneEventList}}),_.o(Ut,"gl")&&_.d(O,{gl:function(){return Ut.gl}});var Yt=_(6997),lt=_(13407),xt=_.n(lt);_.o(lt,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return lt.CityBuildingLayer}}),_.o(lt,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return lt.HeatmapLayer}}),_.o(lt,"ImageLayer")&&_.d(O,{ImageLayer:function(){return lt.ImageLayer}}),_.o(lt,"LineLayer")&&_.d(O,{LineLayer:function(){return lt.LineLayer}}),_.o(lt,"Marker")&&_.d(O,{Marker:function(){return lt.Marker}}),_.o(lt,"PointLayer")&&_.d(O,{PointLayer:function(){return lt.PointLayer}}),_.o(lt,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return lt.PolygonLayer}}),_.o(lt,"Popup")&&_.d(O,{Popup:function(){return lt.Popup}}),_.o(lt,"PositionType")&&_.d(O,{PositionType:function(){return lt.PositionType}}),_.o(lt,"RasterLayer")&&_.d(O,{RasterLayer:function(){return lt.RasterLayer}}),_.o(lt,"Scene")&&_.d(O,{Scene:function(){return lt.Scene}}),_.o(lt,"gl")&&_.d(O,{gl:function(){return lt.gl}});var ct=_(75430),Sr=_.n(ct);_.o(ct,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return ct.CityBuildingLayer}}),_.o(ct,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return ct.HeatmapLayer}}),_.o(ct,"ImageLayer")&&_.d(O,{ImageLayer:function(){return ct.ImageLayer}}),_.o(ct,"LineLayer")&&_.d(O,{LineLayer:function(){return ct.LineLayer}}),_.o(ct,"Marker")&&_.d(O,{Marker:function(){return ct.Marker}}),_.o(ct,"PointLayer")&&_.d(O,{PointLayer:function(){return ct.PointLayer}}),_.o(ct,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return ct.PolygonLayer}}),_.o(ct,"Popup")&&_.d(O,{Popup:function(){return ct.Popup}}),_.o(ct,"PositionType")&&_.d(O,{PositionType:function(){return ct.PositionType}}),_.o(ct,"RasterLayer")&&_.d(O,{RasterLayer:function(){return ct.RasterLayer}}),_.o(ct,"Scene")&&_.d(O,{Scene:function(){return ct.Scene}}),_.o(ct,"gl")&&_.d(O,{gl:function(){return ct.gl}});var Ft=_(77221),Ht=_.n(Ft);_.o(Ft,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return Ft.CityBuildingLayer}}),_.o(Ft,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return Ft.HeatmapLayer}}),_.o(Ft,"ImageLayer")&&_.d(O,{ImageLayer:function(){return Ft.ImageLayer}}),_.o(Ft,"LineLayer")&&_.d(O,{LineLayer:function(){return Ft.LineLayer}}),_.o(Ft,"Marker")&&_.d(O,{Marker:function(){return Ft.Marker}}),_.o(Ft,"PointLayer")&&_.d(O,{PointLayer:function(){return Ft.PointLayer}}),_.o(Ft,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return Ft.PolygonLayer}}),_.o(Ft,"Popup")&&_.d(O,{Popup:function(){return Ft.Popup}}),_.o(Ft,"PositionType")&&_.d(O,{PositionType:function(){return Ft.PositionType}}),_.o(Ft,"RasterLayer")&&_.d(O,{RasterLayer:function(){return Ft.RasterLayer}}),_.o(Ft,"Scene")&&_.d(O,{Scene:function(){return Ft.Scene}}),_.o(Ft,"gl")&&_.d(O,{gl:function(){return Ft.gl}});var St=_(81907),Ge=_(58629),vt=_.n(Ge);_.o(Ge,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return Ge.CityBuildingLayer}}),_.o(Ge,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return Ge.HeatmapLayer}}),_.o(Ge,"ImageLayer")&&_.d(O,{ImageLayer:function(){return Ge.ImageLayer}}),_.o(Ge,"LineLayer")&&_.d(O,{LineLayer:function(){return Ge.LineLayer}}),_.o(Ge,"Marker")&&_.d(O,{Marker:function(){return Ge.Marker}}),_.o(Ge,"PointLayer")&&_.d(O,{PointLayer:function(){return Ge.PointLayer}}),_.o(Ge,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return Ge.PolygonLayer}}),_.o(Ge,"Popup")&&_.d(O,{Popup:function(){return Ge.Popup}}),_.o(Ge,"RasterLayer")&&_.d(O,{RasterLayer:function(){return Ge.RasterLayer}}),_.o(Ge,"Scene")&&_.d(O,{Scene:function(){return Ge.Scene}}),_.o(Ge,"gl")&&_.d(O,{gl:function(){return Ge.gl}});var Pe=_(50829),Te=_.n(Pe);_.o(Pe,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return Pe.CityBuildingLayer}}),_.o(Pe,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return Pe.HeatmapLayer}}),_.o(Pe,"ImageLayer")&&_.d(O,{ImageLayer:function(){return Pe.ImageLayer}}),_.o(Pe,"LineLayer")&&_.d(O,{LineLayer:function(){return Pe.LineLayer}}),_.o(Pe,"Marker")&&_.d(O,{Marker:function(){return Pe.Marker}}),_.o(Pe,"PointLayer")&&_.d(O,{PointLayer:function(){return Pe.PointLayer}}),_.o(Pe,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return Pe.PolygonLayer}}),_.o(Pe,"Popup")&&_.d(O,{Popup:function(){return Pe.Popup}}),_.o(Pe,"RasterLayer")&&_.d(O,{RasterLayer:function(){return Pe.RasterLayer}}),_.o(Pe,"Scene")&&_.d(O,{Scene:function(){return Pe.Scene}}),_.o(Pe,"gl")&&_.d(O,{gl:function(){return Pe.gl}});var ze=_(44556),bt=_.n(ze);_.o(ze,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return ze.CityBuildingLayer}}),_.o(ze,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return ze.HeatmapLayer}}),_.o(ze,"ImageLayer")&&_.d(O,{ImageLayer:function(){return ze.ImageLayer}}),_.o(ze,"LineLayer")&&_.d(O,{LineLayer:function(){return ze.LineLayer}}),_.o(ze,"Marker")&&_.d(O,{Marker:function(){return ze.Marker}}),_.o(ze,"PointLayer")&&_.d(O,{PointLayer:function(){return ze.PointLayer}}),_.o(ze,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return ze.PolygonLayer}}),_.o(ze,"Popup")&&_.d(O,{Popup:function(){return ze.Popup}}),_.o(ze,"RasterLayer")&&_.d(O,{RasterLayer:function(){return ze.RasterLayer}}),_.o(ze,"Scene")&&_.d(O,{Scene:function(){return ze.Scene}}),_.o(ze,"gl")&&_.d(O,{gl:function(){return ze.gl}});var cr=_(76967),ae=_(67964),Ee=_.n(ae);_.o(ae,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return ae.CityBuildingLayer}}),_.o(ae,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return ae.HeatmapLayer}}),_.o(ae,"ImageLayer")&&_.d(O,{ImageLayer:function(){return ae.ImageLayer}}),_.o(ae,"LineLayer")&&_.d(O,{LineLayer:function(){return ae.LineLayer}}),_.o(ae,"Marker")&&_.d(O,{Marker:function(){return ae.Marker}}),_.o(ae,"PointLayer")&&_.d(O,{PointLayer:function(){return ae.PointLayer}}),_.o(ae,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return ae.PolygonLayer}}),_.o(ae,"Popup")&&_.d(O,{Popup:function(){return ae.Popup}}),_.o(ae,"RasterLayer")&&_.d(O,{RasterLayer:function(){return ae.RasterLayer}}),_.o(ae,"Scene")&&_.d(O,{Scene:function(){return ae.Scene}}),_.o(ae,"gl")&&_.d(O,{gl:function(){return ae.gl}});var le=_(26661),re=_.n(le);_.o(le,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return le.CityBuildingLayer}}),_.o(le,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return le.HeatmapLayer}}),_.o(le,"ImageLayer")&&_.d(O,{ImageLayer:function(){return le.ImageLayer}}),_.o(le,"LineLayer")&&_.d(O,{LineLayer:function(){return le.LineLayer}}),_.o(le,"Marker")&&_.d(O,{Marker:function(){return le.Marker}}),_.o(le,"PointLayer")&&_.d(O,{PointLayer:function(){return le.PointLayer}}),_.o(le,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return le.PolygonLayer}}),_.o(le,"Popup")&&_.d(O,{Popup:function(){return le.Popup}}),_.o(le,"RasterLayer")&&_.d(O,{RasterLayer:function(){return le.RasterLayer}}),_.o(le,"Scene")&&_.d(O,{Scene:function(){return le.Scene}}),_.o(le,"gl")&&_.d(O,{gl:function(){return le.gl}});var te=_(98865),ke=_.n(te);_.o(te,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return te.CityBuildingLayer}}),_.o(te,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return te.HeatmapLayer}}),_.o(te,"ImageLayer")&&_.d(O,{ImageLayer:function(){return te.ImageLayer}}),_.o(te,"LineLayer")&&_.d(O,{LineLayer:function(){return te.LineLayer}}),_.o(te,"Marker")&&_.d(O,{Marker:function(){return te.Marker}}),_.o(te,"PointLayer")&&_.d(O,{PointLayer:function(){return te.PointLayer}}),_.o(te,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return te.PolygonLayer}}),_.o(te,"Popup")&&_.d(O,{Popup:function(){return te.Popup}}),_.o(te,"RasterLayer")&&_.d(O,{RasterLayer:function(){return te.RasterLayer}}),_.o(te,"Scene")&&_.d(O,{Scene:function(){return te.Scene}}),_.o(te,"gl")&&_.d(O,{gl:function(){return te.gl}});var nt=_(65722),Kt=_.n(nt);_.o(nt,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return nt.CityBuildingLayer}}),_.o(nt,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return nt.HeatmapLayer}}),_.o(nt,"ImageLayer")&&_.d(O,{ImageLayer:function(){return nt.ImageLayer}}),_.o(nt,"LineLayer")&&_.d(O,{LineLayer:function(){return nt.LineLayer}}),_.o(nt,"Marker")&&_.d(O,{Marker:function(){return nt.Marker}}),_.o(nt,"PointLayer")&&_.d(O,{PointLayer:function(){return nt.PointLayer}}),_.o(nt,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return nt.PolygonLayer}}),_.o(nt,"Popup")&&_.d(O,{Popup:function(){return nt.Popup}}),_.o(nt,"RasterLayer")&&_.d(O,{RasterLayer:function(){return nt.RasterLayer}}),_.o(nt,"Scene")&&_.d(O,{Scene:function(){return nt.Scene}}),_.o(nt,"gl")&&_.d(O,{gl:function(){return nt.gl}});var Ir=_(30522),Lr=_.n(Ir);_.o(Ir,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return Ir.CityBuildingLayer}}),_.o(Ir,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return Ir.HeatmapLayer}}),_.o(Ir,"ImageLayer")&&_.d(O,{ImageLayer:function(){return Ir.ImageLayer}}),_.o(Ir,"LineLayer")&&_.d(O,{LineLayer:function(){return Ir.LineLayer}}),_.o(Ir,"Marker")&&_.d(O,{Marker:function(){return Ir.Marker}}),_.o(Ir,"PointLayer")&&_.d(O,{PointLayer:function(){return Ir.PointLayer}}),_.o(Ir,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return Ir.PolygonLayer}}),_.o(Ir,"Popup")&&_.d(O,{Popup:function(){return Ir.Popup}}),_.o(Ir,"RasterLayer")&&_.d(O,{RasterLayer:function(){return Ir.RasterLayer}}),_.o(Ir,"Scene")&&_.d(O,{Scene:function(){return Ir.Scene}}),_.o(Ir,"gl")&&_.d(O,{gl:function(){return Ir.gl}});var qr=_(47026),tr=_.n(qr);_.o(qr,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return qr.CityBuildingLayer}}),_.o(qr,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return qr.HeatmapLayer}}),_.o(qr,"ImageLayer")&&_.d(O,{ImageLayer:function(){return qr.ImageLayer}}),_.o(qr,"LineLayer")&&_.d(O,{LineLayer:function(){return qr.LineLayer}}),_.o(qr,"Marker")&&_.d(O,{Marker:function(){return qr.Marker}}),_.o(qr,"PointLayer")&&_.d(O,{PointLayer:function(){return qr.PointLayer}}),_.o(qr,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return qr.PolygonLayer}}),_.o(qr,"Popup")&&_.d(O,{Popup:function(){return qr.Popup}}),_.o(qr,"RasterLayer")&&_.d(O,{RasterLayer:function(){return qr.RasterLayer}}),_.o(qr,"Scene")&&_.d(O,{Scene:function(){return qr.Scene}}),_.o(qr,"gl")&&_.d(O,{gl:function(){return qr.gl}});var ce=_(3156),ye=_(64500),Re=_.n(ye);_.o(ye,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return ye.CityBuildingLayer}}),_.o(ye,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return ye.HeatmapLayer}}),_.o(ye,"ImageLayer")&&_.d(O,{ImageLayer:function(){return ye.ImageLayer}}),_.o(ye,"LineLayer")&&_.d(O,{LineLayer:function(){return ye.LineLayer}}),_.o(ye,"Marker")&&_.d(O,{Marker:function(){return ye.Marker}}),_.o(ye,"PointLayer")&&_.d(O,{PointLayer:function(){return ye.PointLayer}}),_.o(ye,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return ye.PolygonLayer}}),_.o(ye,"Popup")&&_.d(O,{Popup:function(){return ye.Popup}}),_.o(ye,"RasterLayer")&&_.d(O,{RasterLayer:function(){return ye.RasterLayer}}),_.o(ye,"Scene")&&_.d(O,{Scene:function(){return ye.Scene}}),_.o(ye,"gl")&&_.d(O,{gl:function(){return ye.gl}});var Qe=_(50626),Dt=_.n(Qe);_.o(Qe,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return Qe.CityBuildingLayer}}),_.o(Qe,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return Qe.HeatmapLayer}}),_.o(Qe,"ImageLayer")&&_.d(O,{ImageLayer:function(){return Qe.ImageLayer}}),_.o(Qe,"LineLayer")&&_.d(O,{LineLayer:function(){return Qe.LineLayer}}),_.o(Qe,"Marker")&&_.d(O,{Marker:function(){return Qe.Marker}}),_.o(Qe,"PointLayer")&&_.d(O,{PointLayer:function(){return Qe.PointLayer}}),_.o(Qe,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return Qe.PolygonLayer}}),_.o(Qe,"Popup")&&_.d(O,{Popup:function(){return Qe.Popup}}),_.o(Qe,"RasterLayer")&&_.d(O,{RasterLayer:function(){return Qe.RasterLayer}}),_.o(Qe,"Scene")&&_.d(O,{Scene:function(){return Qe.Scene}}),_.o(Qe,"gl")&&_.d(O,{gl:function(){return Qe.gl}});var Ct=_(88730),A=_.n(Ct);_.o(Ct,"CityBuildingLayer")&&_.d(O,{CityBuildingLayer:function(){return Ct.CityBuildingLayer}}),_.o(Ct,"HeatmapLayer")&&_.d(O,{HeatmapLayer:function(){return Ct.HeatmapLayer}}),_.o(Ct,"ImageLayer")&&_.d(O,{ImageLayer:function(){return Ct.ImageLayer}}),_.o(Ct,"LineLayer")&&_.d(O,{LineLayer:function(){return Ct.LineLayer}}),_.o(Ct,"Marker")&&_.d(O,{Marker:function(){return Ct.Marker}}),_.o(Ct,"PointLayer")&&_.d(O,{PointLayer:function(){return Ct.PointLayer}}),_.o(Ct,"PolygonLayer")&&_.d(O,{PolygonLayer:function(){return Ct.PolygonLayer}}),_.o(Ct,"Popup")&&_.d(O,{Popup:function(){return Ct.Popup}}),_.o(Ct,"RasterLayer")&&_.d(O,{RasterLayer:function(){return Ct.RasterLayer}}),_.o(Ct,"Scene")&&_.d(O,{Scene:function(){return Ct.Scene}}),_.o(Ct,"gl")&&_.d(O,{gl:function(){return Ct.gl}});var z=_(75907)},11296:function(_t,O,_){"use strict";_.d(O,{e7:function(){return zf},Hp:function(){return wf},ZP:function(){return uc},yT:function(){return ih}});var X=_(15845),b=_(60121),p=_.n(b),H=_(38045),S=_(60544),F=_(82803),ie=_(65497),fe=_(66221),Q=_(16710),we=_(26759),Ie=_(36739),Be=_.n(Ie);function Xe(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function Ut(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?Xe(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):Xe(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function er(B,U){var M=typeof Symbol!="undefined"&&B[Symbol.iterator]||B["@@iterator"];if(!M){if(Array.isArray(B)||(M=Yt(B))||U&&B&&typeof B.length=="number"){M&&(B=M);var R=0,ee=function(){};return{s:ee,n:function(){return R>=B.length?{done:!0}:{done:!1,value:B[R++]}},e:function(fr){throw fr},f:ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _e=!0,it=!1,Tt;return{s:function(){M=M.call(B)},n:function(){var fr=M.next();return _e=fr.done,fr},e:function(fr){it=!0,Tt=fr},f:function(){try{!_e&&M.return!=null&&M.return()}finally{if(it)throw Tt}}}}function Yt(B,U){if(!!B){if(typeof B=="string")return lt(B,U);var M=Object.prototype.toString.call(B).slice(8,-1);if(M==="Object"&&B.constructor&&(M=B.constructor.name),M==="Map"||M==="Set")return Array.from(B);if(M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return lt(B,U)}}function lt(B,U){(U==null||U>B.length)&&(U=B.length);for(var M=0,R=new Array(U);M<U;M++)R[M]=B[M];return R}var xt=30;function ct(B){var U=B.characterSet,M=B.getFontWidth,R=B.fontHeight,ee=B.buffer,_e=B.maxCanvasWidth,it=B.mapping,Tt=it===void 0?{}:it,wt=B.xOffset,fr=wt===void 0?0:wt,Hr=B.yOffset,In=Hr===void 0?0:Hr,Wn=0,Cn=fr;Array.from(U).forEach(function(gi,Ji){if(!Tt[gi]){var Mi=M(gi,Ji);Cn+xt>_e&&(Cn=0,Wn++),Tt[gi]={x:Cn,y:In+Wn*xt,width:xt,height:xt,advance:Mi},Cn+=xt}});var fi=R+ee*2;return{mapping:Tt,xOffset:Cn,yOffset:In+Wn*fi,canvasHeight:Ht(In+(Wn+1)*fi)}}function Sr(B,U,M){var R=0,ee=0,_e=0,it=[],Tt={},wt=er(B),fr;try{for(wt.s();!(fr=wt.n()).done;){var Hr=fr.value;if(!Tt[Hr.id]){var In=Hr.size;R+In+U>M&&(Ft(Tt,it,ee),R=0,ee=_e+ee+U,_e=0,it=[]),it.push({icon:Hr,xOffset:R}),R=R+In+U,_e=Math.max(_e,In)}}}catch(Cn){wt.e(Cn)}finally{wt.f()}it.length>0&&Ft(Tt,it,ee);var Wn=Ht(_e+ee+U);return{mapping:Tt,canvasHeight:Wn}}function Ft(B,U,M){var R=er(U),ee;try{for(R.s();!(ee=R.n()).done;){var _e=ee.value,it=_e.icon,Tt=_e.xOffset;B[it.id]=Ut(Ut({},it),{},{x:Tt,y:M,image:it.image,width:it.width,height:it.height})}}catch(wt){R.e(wt)}finally{R.f()}}function Ht(B){return Math.pow(2,Math.ceil(Math.log2(B)))}var St,Ge;function vt(B,U){var M=typeof Symbol!="undefined"&&B[Symbol.iterator]||B["@@iterator"];if(!M){if(Array.isArray(B)||(M=Pe(B))||U&&B&&typeof B.length=="number"){M&&(B=M);var R=0,ee=function(){};return{s:ee,n:function(){return R>=B.length?{done:!0}:{done:!1,value:B[R++]}},e:function(fr){throw fr},f:ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _e=!0,it=!1,Tt;return{s:function(){M=M.call(B)},n:function(){var fr=M.next();return _e=fr.done,fr},e:function(fr){it=!0,Tt=fr},f:function(){try{!_e&&M.return!=null&&M.return()}finally{if(it)throw Tt}}}}function Pe(B,U){if(!!B){if(typeof B=="string")return Te(B,U);var M=Object.prototype.toString.call(B).slice(8,-1);if(M==="Object"&&B.constructor&&(M=B.constructor.name),M==="Map"||M==="Set")return Array.from(B);if(M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return Te(B,U)}}function Te(B,U){(U==null||U>B.length)&&(U=B.length);for(var M=0,R=new Array(U);M<U;M++)R[M]=B[M];return R}function ze(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function bt(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?ze(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):ze(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}var cr=tr(),ae="sans-serif",Ee="normal",le=24,re=3,te=.25,ke=8,nt=1024,Kt=1,Ir=1,Lr=3,qr=null;function tr(){for(var B=[],U=32;U<128;U++)B.push(String.fromCharCode(U));return B}function ce(B,U,M,R){B.font="".concat(R," ").concat(M,"px ").concat(U),B.fillStyle="black",B.textBaseline="middle"}function ye(B,U){for(var M=0;M<B.length;M++)U.data[4*M+3]=B[M]}var Re=(St=(0,H.b2)(),St(Ge=function(){function B(){(0,fe.Z)(this,B),this.fontAtlas=void 0,this.iconFontMap=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new we.z6(Lr)}return(0,Q.Z)(B,[{key:"scale",get:function(){return Ir}},{key:"canvas",get:function(){var M=this.cache.get(this.key);return M&&M.data}},{key:"mapping",get:function(){var M=this.cache.get(this.key);return M&&M.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:ae,fontWeight:Ee,characterSet:cr,fontSize:le,buffer:re,sdf:!0,cutoff:te,radius:ke,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(M){var R=this;M.forEach(function(ee){R.iconFontGlyphs[ee.name]=ee.unicode})}},{key:"addIconFont",value:function(M,R){this.iconFontMap.set(M,R)}},{key:"getIconFontKey",value:function(M){return this.iconFontMap.get(M)||M}},{key:"getGlyph",value:function(M){return this.iconFontGlyphs[M]?String.fromCharCode(parseInt(this.iconFontGlyphs[M],16)):""}},{key:"setFontOptions",value:function(M){this.fontOptions=bt(bt({},this.fontOptions),M),this.key=this.getKey();var R=this.getNewChars(this.key,this.fontOptions.characterSet),ee=this.cache.get(this.key);if(!(ee&&R.length===0)){var _e=this.generateFontAtlas(this.key,R,ee);this.fontAtlas=_e,this.cache.set(this.key,_e)}}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(M,R,ee){var _e=this.fontOptions,it=_e.fontFamily,Tt=_e.fontWeight,wt=_e.fontSize,fr=_e.buffer,Hr=_e.sdf,In=_e.radius,Wn=_e.cutoff,Cn=_e.iconfont,fi=ee&&ee.data;fi||(fi=document.createElement("canvas"),fi.width=nt);var gi=fi.getContext("2d");ce(gi,it,wt,Tt);var Ji=ct(bt({getFontWidth:function(Tf){return gi.measureText(Tf).width},fontHeight:wt*Ir,buffer:fr,characterSet:R,maxCanvasWidth:nt},ee&&{mapping:ee.mapping,xOffset:ee.xOffset,yOffset:ee.yOffset})),Mi=Ji.mapping,Ra=Ji.canvasHeight,wo=Ji.xOffset,yo=Ji.yOffset,uo=gi.getImageData(0,0,fi.width,fi.height);if(fi.height=Ra,gi.putImageData(uo,0,0),ce(gi,it,wt,Tt),Hr){var Za=new(Be())(wt,fr,In,Wn,it,Tt),ra=gi.getImageData(0,0,Za.size,Za.size),Da=vt(R),lo;try{for(Da.s();!(lo=Da.n()).done;){var To=lo.value;if(Cn){var co=String.fromCharCode(parseInt(To.replace("&#x","").replace(";",""),16)),ks=Za.draw(co);ye(ks,ra)}else ye(Za.draw(To),ra);gi.putImageData(ra,Mi[To].x,Mi[To].y)}}catch(Ac){Da.e(Ac)}finally{Da.f()}}else{var uu=vt(R),Hu;try{for(uu.s();!(Hu=uu.n()).done;){var ds=Hu.value;gi.fillText(ds,Mi[ds].x,Mi[ds].y+wt*Kt)}}catch(Ac){uu.e(Ac)}finally{uu.f()}}return{xOffset:wo,yOffset:yo,mapping:Mi,data:fi,width:fi.width,height:fi.height}}},{key:"getKey",value:function(){return"key";var M,R,ee,_e,it,Tt,wt,fr}},{key:"getNewChars",value:function(M,R){var ee=this.cache.get(M);if(!ee)return R;var _e=[],it=ee.mapping,Tt=new Set(Object.keys(it)),wt=new Set(R);return wt.forEach(function(fr){Tt.has(fr)||_e.push(fr)}),_e}}]),B}())||Ge),Qe=_(96114),Dt=_(70243),Ct=_(99219),A,z;function ve(B){var U=Ce();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function Ce(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var $e=3,ot=1024,Ot=64,G=(A=(0,H.b2)(),A(z=function(B){(0,Qe.Z)(M,B);var U=ve(M);function M(){var R;(0,fe.Z)(this,M);for(var ee=arguments.length,_e=new Array(ee),it=0;it<ee;it++)_e[it]=arguments[it];return R=U.call.apply(U,[this].concat(_e)),R.canvasHeight=128,R.texture=void 0,R.canvas=void 0,R.iconData=void 0,R.iconMap=void 0,R.ctx=void 0,R.loadingImageCount=0,R}return(0,Q.Z)(M,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(ee,_e){var it=this,Tt=new Image;if(this.loadingImageCount++,this.hasImage(ee))throw new Error("Image Id already exists");this.iconData.push({id:ee,size:Ot}),this.updateIconMap(),this.loadImage(_e).then(function(wt){Tt=wt;var fr=it.iconData.find(function(Hr){return Hr.id===ee});fr&&(fr.image=Tt,fr.width=Tt.width,fr.height=Tt.height),it.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(ee){return this.iconMap.hasOwnProperty(ee)}},{key:"removeImage",value:function(ee){this.hasImage(ee)&&(this.iconData=this.iconData.filter(function(_e){return _e.id!==ee}),delete this.iconMap[ee],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var ee=this;this.canvas.width=ot,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(_e){var it=ee.iconMap[_e],Tt=it.x,wt=it.y,fr=it.image,Hr=it.width,In=Hr===void 0?64:Hr,Wn=it.height,Cn=Wn===void 0?64:Wn,fi=Math.max(In,Cn),gi=fi/Ot,Ji=Cn/gi,Mi=In/gi;fr&&ee.ctx.drawImage(fr,Tt+(Ot-Mi)/2,wt+(Ot-Ji)/2,Mi,Ji)})}},{key:"updateIconMap",value:function(){var ee=Sr(this.iconData,$e,ot),_e=ee.mapping,it=ee.canvasHeight;this.iconMap=_e,this.canvasHeight=it}},{key:"loadImage",value:function(ee){return new Promise(function(_e,it){if(ee instanceof HTMLImageElement){_e(ee);return}var Tt=new Image;Tt.crossOrigin="anonymous",Tt.onload=function(){_e(Tt)},Tt.onerror=function(){it(new Error("Could not load image at "+ee))},Tt.src=ee instanceof File?URL.createObjectURL(ee):ee})}}]),M}(b.EventEmitter))||z),Et=_(21814),Bt=_(98604),dr,wr,Tr=(dr=(0,H.b2)(),dr(wr=function(){function B(){(0,fe.Z)(this,B),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return(0,Q.Z)(B,[{key:"init",value:function(){}},{key:"update",value:function(M){this.viewport=M,this.viewMatrixInverse=Bt.create(),Bt.invert(this.viewMatrixInverse,M.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var M=this.viewport.getCenter(),R=(0,Et.Z)(M,2),ee=R[0],_e=R[1];return[ee,_e]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(M,R){return this.viewport.projectFlat(M,R)}},{key:"setViewProjectionMatrix",value:function(M){this.overridedViewProjectionMatrix=M}},{key:"jitterProjectionMatrix",value:function(M,R){var ee=Bt.fromTranslation(Bt.create(),[M,R,0]);this.jitteredProjectionMatrix=Bt.multiply(Bt.create(),ee,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Bt.multiply(Bt.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),B}())||wr),Or,qe;function yt(B,U){var M=typeof Symbol!="undefined"&&B[Symbol.iterator]||B["@@iterator"];if(!M){if(Array.isArray(B)||(M=dt(B))||U&&B&&typeof B.length=="number"){M&&(B=M);var R=0,ee=function(){};return{s:ee,n:function(){return R>=B.length?{done:!0}:{done:!1,value:B[R++]}},e:function(fr){throw fr},f:ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _e=!0,it=!1,Tt;return{s:function(){M=M.call(B)},n:function(){var fr=M.next();return _e=fr.done,fr},e:function(fr){it=!0,Tt=fr},f:function(){try{!_e&&M.return!=null&&M.return()}finally{if(it)throw Tt}}}}function dt(B,U){if(!!B){if(typeof B=="string")return lr(B,U);var M=Object.prototype.toString.call(B).slice(8,-1);if(M==="Object"&&B.constructor&&(M=B.constructor.name),M==="Map"||M==="Set")return Array.from(B);if(M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return lr(B,U)}}function lr(B,U){(U==null||U>B.length)&&(U=B.length);for(var M=0,R=new Array(U);M<U;M++)R[M]=B[M];return R}var Kr=(Or=(0,H.b2)(),Or(qe=function(){function B(){(0,fe.Z)(this,B),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return(0,Q.Z)(B,[{key:"init",value:function(M,R){this.container=M.container,this.scene=R,this.mapsService=R.get(F.v.IMapService),this.initControlPos()}},{key:"addControl",value:function(M,R){var ee=R.get(F.v.IMapService);ee.map?(M.addTo(this.scene),this.controls.push(M)):this.unAddControls.push(M)}},{key:"getControlByName",value:function(M){return this.controls.find(function(R){return R.controlOption.name===M})}},{key:"removeControl",value:function(M){var R=this.controls.indexOf(M);return R>-1&&this.controls.splice(R,1),M.remove(),this}},{key:"addControls",value:function(){var M=this;this.unAddControls.forEach(function(R){R.addTo(M.scene),M.controls.push(R)}),this.unAddControls=[]}},{key:"destroy",value:function(){var M=yt(this.controls),R;try{for(M.s();!(R=M.n()).done;){var ee=R.value;ee.remove()}}catch(_e){M.e(_e)}finally{M.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var M=this.controlCorners={},R="l7-",ee=this.controlContainer=we.SO.create("div",R+"control-container",this.container);function _e(it,Tt){var wt=R+it+" "+R+Tt;M[it+Tt]=we.SO.create("div",wt,ee)}_e("top","left"),_e("top","right"),_e("bottom","left"),_e("bottom","right")}},{key:"clearControlPos",value:function(){for(var M in this.controlCorners)this.controlCorners[M]&&we.SO.remove(this.controlCorners[M]);this.controlContainer&&we.SO.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),B}())||qe),gt,Rt,sr=(gt=(0,H.b2)(),gt(Rt=function(){function B(){(0,fe.Z)(this,B),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return(0,Q.Z)(B,[{key:"addMarkerLayer",value:function(M){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(M),M.addTo(this.scene)):this.unAddMarkerLayers.push(M)}},{key:"removeMarkerLayer",value:function(M){M.destroy(),this.markerLayers.indexOf(M);var R=this.markerLayers.indexOf(M);R>-1&&this.markerLayers.splice(R,1)}},{key:"addMarker",value:function(M){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(M),M.addTo(this.scene)):this.unAddMarkers.push(M)}},{key:"addMarkers",value:function(){var M=this;this.unAddMarkers.forEach(function(R){R.addTo(M.scene),M.markers.push(R)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var M=this;this.unAddMarkerLayers.forEach(function(R){M.markerLayers.push(R),R.addTo(M.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(M){M.remove(),this.markers.indexOf(M);var R=this.markers.indexOf(M);R>-1&&this.markers.splice(R,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(M){this.scene=M,this.mapsService=M.get(F.v.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(M){M.remove()}),this.markers=[],this.markerLayers.forEach(function(M){M.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(M){M.destroy()}}]),B}())||Rt),ar,_n,xn=(ar=(0,H.b2)(),ar(_n=function(){function B(){(0,fe.Z)(this,B),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return(0,Q.Z)(B,[{key:"removePopup",value:function(M){M.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(M){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(M.addTo(this.scene),this.popup=M):this.unAddPopup=M}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(M){this.scene=M,this.mapsService=M.get(F.v.IMapService)}}]),B}())||_n),ci=_(82492),_i=_.n(ci),Ui={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Xi=Ui,oi,K;function I(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function j(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?I(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):I(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}var Y={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},ue={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Le=(oi=(0,H.b2)(),oi(K=function(){function B(){(0,fe.Z)(this,B),this.sceneConfigCache={},this.layerConfigCache={}}return(0,Q.Z)(B,[{key:"getSceneConfig",value:function(M){return this.sceneConfigCache[M]}},{key:"getSceneWarninfo",value:function(M){return Xi[M]}},{key:"setSceneConfig",value:function(M,R){this.sceneConfigCache[M]=j(j({},Y),R)}},{key:"getLayerConfig",value:function(M){return this.layerConfigCache[M]}},{key:"setLayerConfig",value:function(M,R,ee){this.layerConfigCache[R]=j({},_i()({},this.sceneConfigCache[M],ue,ee))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),B}())||K),Me=_(93158),se=_(60623),Ne=_(76721),At=Math.PI/180,Dr=512,Ur=4003e4;function Xt(B){var U=B.latitude,M=U===void 0?0:U,R=B.zoom,ee=R===void 0?0:R,_e=B.scale,it=B.highPrecision,Tt=it===void 0?!1:it,wt=B.flipY,fr=wt===void 0?!1:wt;_e=_e!==void 0?_e:Math.pow(2,ee);var Hr={},In=Dr*_e,Wn=Math.cos(M*At),Cn=In/360,fi=Cn/Wn,gi=In/Ur/Wn;if(Hr.pixelsPerMeter=[gi,-gi,gi],Hr.metersPerPixel=[1/gi,-1/gi,1/gi],Hr.pixelsPerDegree=[Cn,-fi,gi],Hr.degreesPerPixel=[1/Cn,-1/fi,1/gi],Tt){var Ji=At*Math.tan(M*At)/Wn,Mi=Cn*Ji/2,Ra=In/Ur*Ji,wo=Ra/fi*gi;Hr.pixelsPerDegree2=[0,-Mi,Ra],Hr.pixelsPerMeter2=[wo,0,wo],fr&&(Hr.pixelsPerDegree2[1]=-Hr.pixelsPerDegree2[1],Hr.pixelsPerMeter2[1]=-Hr.pixelsPerMeter2[1])}return fr&&(Hr.pixelsPerMeter[1]=-Hr.pixelsPerMeter[1],Hr.metersPerPixel[1]=-Hr.metersPerPixel[1],Hr.pixelsPerDegree[1]=-Hr.pixelsPerDegree[1],Hr.degreesPerPixel[1]=-Hr.degreesPerPixel[1]),Hr}var zr=_(71134),On,vn,hr,pn,un,fn=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],hi=(On=(0,H.b2)(),vn=(0,H.f3)(F.v.ICameraService),On(hr=(pn=function(){function B(){(0,fe.Z)(this,B),this.needRefresh=!0,(0,Me.Z)(this,"cameraService",un,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return(0,Q.Z)(B,[{key:"refresh",value:function(){var M=this.cameraService.getZoom(),R=this.cameraService.getZoomScale(),ee=this.cameraService.getCenter(),_e=Xt({latitude:ee[1],zoom:M}),it=_e.pixelsPerMeter,Tt=_e.pixelsPerDegree;this.viewportCenter=ee,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=it,this.pixelsPerDegree=Tt,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===zr.l.LNGLAT||this.coordinateSystem===zr.l.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===zr.l.LNGLAT_OFFSET?this.calculateLnglatOffset(ee,M):this.coordinateSystem===zr.l.P20_OFFSET&&this.calculateLnglatOffset(ee,M,R,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(M){this.coordinateSystem=M}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(M,R,ee,_e){var it=Xt({latitude:M[1],zoom:R,scale:ee,flipY:_e,highPrecision:!0}),Tt=it.pixelsPerMeter,wt=it.pixelsPerDegree,fr=it.pixelsPerDegree2,Hr=this.cameraService.getViewMatrix(),In=this.cameraService.getProjectionMatrix(),Wn=Bt.multiply([],In,Hr),Cn=this.cameraService.projectFlat([Math.fround(M[0]),Math.fround(M[1])],Math.pow(2,R));this.viewportCenterProjection=Ne.fF([],[Cn[0],Cn[1],0,1],Wn),Hr=this.cameraService.getViewMatrixUncentered()||Hr,Wn=Bt.multiply([],In,Hr),Wn=Bt.multiply([],Wn,fn),this.cameraService.setViewProjectionMatrix(Wn),this.pixelsPerMeter=Tt,this.pixelsPerDegree=wt,this.pixelsPerDegree2=fr}}]),B}(),un=(0,se.Z)(pn.prototype,"cameraService",[vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pn))||hr),Jr=_(46697),vi=_(47364),Li=_.n(vi),Qn=_(76967),xi,Ti,bo,ki,si,Rn,Ri;function Zn(B){var U=za();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function za(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var ys={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Fi=(xi=(0,H.b2)(),Ti=(0,H.f3)(F.v.IMapService),bo=(0,H.f3)(F.v.ILogService),xi(ki=(si=function(B){(0,Qe.Z)(M,B);var U=Zn(M);function M(){var R;(0,fe.Z)(this,M);for(var ee=arguments.length,_e=new Array(ee),it=0;it<ee;it++)_e[it]=arguments[it];return R=U.call.apply(U,[this].concat(_e)),(0,Me.Z)(R,"mapService",Rn,(0,Jr.Z)(R)),(0,Me.Z)(R,"logger",Ri,(0,Jr.Z)(R)),R.hammertime=void 0,R.lastClickTime=0,R.lastClickXY=[-1,-1],R.clickTimer=void 0,R.$containter=void 0,R.onDrag=function(Tt){var wt=R.interactionEvent(Tt);wt.type=ys[wt.type],R.emit(Qn.s.Drag,wt)},R.onHammer=function(Tt){Tt.srcEvent.stopPropagation();var wt=R.interactionEvent(Tt);R.emit(Qn.s.Hover,wt)},R.onTouch=function(Tt){var wt=Tt.touches[0];R.onHover({x:wt.pageX,y:wt.pageY,type:"touch"})},R.onHover=function(Tt){var wt=Tt.clientX,fr=Tt.clientY,Hr=wt,In=fr,Wn=Tt.type,Cn=R.mapService.getMapContainer();if(Cn){var fi=Cn.getBoundingClientRect(),gi=fi.top,Ji=fi.left;Hr=Hr-Ji-Cn.clientLeft,In=In-gi-Cn.clientTop}var Mi=R.mapService.containerToLngLat([Hr,In]);if(Wn==="click"){if("ontouchstart"in document.documentElement)return;R.isDoubleTap(Hr,In,Mi);return}if(Wn==="touch"){R.isDoubleTap(Hr,In,Mi);return}Wn!=="click"&&Wn!=="dblclick"&&R.emit(Qn.s.Hover,{x:Hr,y:In,lngLat:Mi,type:Wn,target:Tt})},R}return(0,Q.Z)(M,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Qn.s.Hover)}},{key:"triggerHover",value:function(ee){var _e=ee.x,it=ee.y;this.emit(Qn.s.Hover,{x:_e,y:it})}},{key:"triggerSelect",value:function(ee){this.emit(Qn.s.Select,{featureId:ee})}},{key:"triggerActive",value:function(ee){this.emit(Qn.s.Active,{featureId:ee})}},{key:"addEventListenerOnMap",value:function(){var ee=this.mapService.getMapContainer();if(ee){var _e=new(Li()).Manager(ee);_e.add(new(Li()).Tap({event:"dblclick",taps:2})),_e.add(new(Li()).Tap({event:"click"})),_e.add(new(Li()).Pan({threshold:0,pointers:0})),_e.add(new(Li()).Press({})),_e.on("dblclick click",this.onHammer),_e.on("panstart panmove panend pancancel",this.onDrag),ee.addEventListener("mousemove",this.onHover),ee.addEventListener("mousedown",this.onHover,!0),ee.addEventListener("mouseup",this.onHover),ee.addEventListener("contextmenu",this.onHover),this.hammertime=_e,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var ee=this.mapService.getMapContainer();ee&&(ee.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),ee.removeEventListener("mousedown",this.onHover),ee.removeEventListener("mouseup",this.onHover),ee.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(ee){var _e=ee.type,it=ee.pointerType,Tt,wt;it==="touch"?(wt=Math.floor(ee.pointers[0].clientY),Tt=Math.floor(ee.pointers[0].clientX)):(wt=Math.floor(ee.srcEvent.y),Tt=Math.floor(ee.srcEvent.x));var fr=this.mapService.getMapContainer();if(fr){var Hr=fr.getBoundingClientRect(),In=Hr.top,Wn=Hr.left;Tt-=Wn,wt-=In}var Cn=this.mapService.containerToLngLat([Tt,wt]);return{x:Tt,y:wt,lngLat:Cn,type:_e,target:ee.srcEvent}}},{key:"isDoubleTap",value:function(ee,_e,it){var Tt=this,wt=new Date().getTime(),fr="click";wt-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-ee)<10&&Math.abs(this.lastClickXY[1]-_e)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),fr="dblclick",this.emit(Qn.s.Hover,{x:ee,y:_e,lngLat:it,type:fr})):(this.lastClickTime=wt,this.lastClickXY=[ee,_e],this.clickTimer=setTimeout(function(){fr="click",Tt.emit(Qn.s.Hover,{x:ee,y:_e,lngLat:it,type:fr})},400))}}]),M}(p()),Rn=(0,se.Z)(si.prototype,"mapService",[Ti],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ri=(0,se.Z)(si.prototype,"logger",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),si))||ki),ha=_(75805),Sl=_(87757),Ga=_.n(Sl),mi=_(75907),ro,Na,Ba,Go,ta,Ua,xa,os,$o,El,Jo;function Pa(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function Ha(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?Pa(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):Pa(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}var pa=(ro=(0,H.b2)(),Na=(0,H.f3)(F.v.IRendererService),Ba=(0,H.f3)(F.v.IGlobalConfigService),Go=(0,H.f3)(F.v.IInteractionService),ta=(0,H.f3)(F.v.ILayerService),ro(Ua=(xa=function(){function B(){var U=this;(0,fe.Z)(this,B),(0,Me.Z)(this,"rendererService",os,this),(0,Me.Z)(this,"configService",$o,this),(0,Me.Z)(this,"interactionService",El,this),(0,Me.Z)(this,"layerService",Jo,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(M,R){var ee,_e=R.x,it=R.y,Tt=R.lngLat,wt=R.type,fr=R.target,Hr=!1,In=U.rendererService,Wn=In.getViewportSize,Cn=In.readPixels,fi=In.getContainer,gi=fi().getBoundingClientRect(),Ji=gi.width,Mi=gi.height;Ji*=we.SO.DPR,Mi*=we.SO.DPR;var Ra=M.getLayerConfig(),wo=Ra.enableHighlight,yo=Ra.enableSelect,uo=_e*we.SO.DPR,Za=it*we.SO.DPR;if(uo>Ji-1*we.SO.DPR||uo<0||Za>Mi-1*we.SO.DPR||Za<0)return!1;var ra;if(ra=Cn({x:Math.floor(uo/U.pickBufferScale),y:Math.floor((Mi-(it+1)*we.SO.DPR)/U.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:U.pickingFBO}),ra[0]!==0||ra[1]!==0||ra[2]!==0){var Da=(0,we.W0)(ra),lo=M.getSource().getFeatureById(Da);Da!==M.getCurrentPickId()&&wt==="mousemove"&&(wt="mouseenter");var To={x:_e,y:it,type:wt,lngLat:Tt,featureId:Da,feature:lo,target:fr};lo&&(Hr=!0,M.setCurrentPickId(Da),U.triggerHoverOnLayer(M,To))}else{var co={x:_e,y:it,lngLat:Tt,type:M.getCurrentPickId()!==null&&wt==="mousemove"?"mouseout":"un"+wt,featureId:null,target:fr,feature:null};U.triggerHoverOnLayer(M,Ha(Ha({},co),{},{type:"unpick"})),U.triggerHoverOnLayer(M,co),M.setCurrentPickId(null)}if(wo&&U.highlightPickedFeature(M,ra),yo&&wt==="click"&&((ee=ra)===null||ee===void 0?void 0:ee.toString())!==[0,0,0,0].toString()){var ks=(0,we.W0)(ra);M.getCurrentSelectedId()===null||ks!==M.getCurrentSelectedId()?(U.selectFeature(M,ra),M.setCurrentSelectedId(ks)):(U.selectFeature(M,new Uint8Array([0,0,0,0])),M.setCurrentSelectedId(null))}return Hr}}return(0,Q.Z)(B,[{key:"init",value:function(M){var R=this.rendererService,ee=R.createTexture2D,_e=R.createFramebuffer,it=R.getViewportSize,Tt=R.getContainer,wt=Tt().getBoundingClientRect(),fr=wt.width,Hr=wt.height;fr*=we.SO.DPR,Hr*=we.SO.DPR,this.pickBufferScale=this.configService.getSceneConfig(M).pickBufferScale||1,this.pickingFBO=_e({color:ee({width:Math.round(fr/this.pickBufferScale),height:Math.round(Hr/this.pickBufferScale),wrapS:mi.gl.CLAMP_TO_EDGE,wrapT:mi.gl.CLAMP_TO_EDGE})}),this.interactionService.on(Qn.s.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var U=(0,ha.Z)(Ga().mark(function R(ee,_e,it){var Tt=this,wt,fr,Hr,In;return Ga().wrap(function(Cn){for(;;)switch(Cn.prev=Cn.next){case 0:wt=this.rendererService,fr=wt.useFramebuffer,Hr=wt.clear,In=wt.getContainer,this.resizePickingFBO(),fr(this.pickingFBO,function(){Hr({framebuffer:Tt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),ee.hooks.beforePickingEncode.call(),ee.renderModels(),ee.hooks.afterPickingEncode.call();var fi=Tt.pickBox(ee,_e);it(fi)});case 3:case"end":return Cn.stop()}},R,this)}));function M(R,ee,_e){return U.apply(this,arguments)}return M}()},{key:"pickBox",value:function(M,R){var ee=this,_e=R.map(function(co){var ks=co<0?0:co;return Math.floor(ks*we.SO.DPR/ee.pickBufferScale)}),it=(0,Et.Z)(_e,4),Tt=it[0],wt=it[1],fr=it[2],Hr=it[3],In=this.rendererService,Wn=In.getViewportSize,Cn=In.readPixels,fi=In.getContainer,gi=fi().getBoundingClientRect(),Ji=gi.width,Mi=gi.height;if(Ji*=we.SO.DPR,Mi*=we.SO.DPR,Tt>(Ji-1)*we.SO.DPR/this.pickBufferScale||fr<0||wt>(Mi-1)*we.SO.DPR/this.pickBufferScale||Hr<0)return[];var Ra,wo=Math.min(Ji/this.pickBufferScale,fr)-Tt,yo=Math.min(Mi/this.pickBufferScale,Hr)-wt;Ra=Cn({x:Tt,y:Math.floor(Mi/this.pickBufferScale-(Hr+1)),width:wo,height:yo,data:new Uint8Array(wo*yo*4),framebuffer:this.pickingFBO});for(var uo=[],Za={},ra=0;ra<Ra.length/4;ra=ra+1){var Da=Ra.slice(ra*4,ra*4+4),lo=(0,we.W0)(Da);if(lo!==-1&&!Za[lo]){var To=M.getSource().getFeatureById(lo);uo.push(To),Za[lo]=!0}}return uo}},{key:"pickingAllLayer",value:function(){var U=(0,ha.Z)(Ga().mark(function R(ee){return Ga().wrap(function(it){for(;;)switch(it.prev=it.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){it.next=2;break}return it.abrupt("return");case 2:return this.alreadyInPicking=!0,it.next=5,this.pickingLayers(ee);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return it.stop()}},R,this)}));function M(R){return U.apply(this,arguments)}return M}()},{key:"resizePickingFBO",value:function(){var M=this.rendererService.getContainer,R=M().getBoundingClientRect(),ee=R.width,_e=R.height;ee*=we.SO.DPR,_e*=we.SO.DPR,(this.width!==ee||this.height!==_e)&&(this.pickingFBO.resize({width:Math.round(ee/this.pickBufferScale),height:Math.round(_e/this.pickBufferScale)}),this.width=ee,this.height=_e)}},{key:"pickingLayers",value:function(){var U=(0,ha.Z)(Ga().mark(function R(ee){var _e=this,it,Tt,wt,fr,Hr;return Ga().wrap(function(Wn){for(;;)switch(Wn.prev=Wn.next){case 0:it=this.rendererService,Tt=it.getViewportSize,wt=it.useFramebuffer,fr=it.clear,Hr=it.getContainer,this.resizePickingFBO(),wt(this.pickingFBO,function(){var Cn=_e.layerService.getLayers();Cn.filter(function(fi){return fi.needPick(ee.type)}).reverse().some(function(fi){fr({framebuffer:_e.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),fi.hooks.beforePickingEncode.call(),fi.renderModels(),fi.hooks.afterPickingEncode.call();var gi=_e.pickFromPickingFBO(fi,ee);return gi&&!fi.getLayerConfig().enablePropagation})});case 3:case"end":return Wn.stop()}},R,this)}));function M(R){return U.apply(this,arguments)}return M}()},{key:"triggerHoverOnLayer",value:function(M,R){M.emit(R.type,R)}},{key:"highlightPickedFeature",value:function(M,R){var ee=(0,Et.Z)(R,3),_e=ee[0],it=ee[1],Tt=ee[2];M.hooks.beforeHighlight.call([_e,it,Tt])}},{key:"selectFeature",value:function(M,R){var ee=(0,Et.Z)(R,3),_e=ee[0],it=ee[1],Tt=ee[2];M.hooks.beforeSelect.call([_e,it,Tt])}}]),B}(),os=(0,se.Z)(xa.prototype,"rendererService",[Na],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=(0,se.Z)(xa.prototype,"configService",[Ba],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),El=(0,se.Z)(xa.prototype,"interactionService",[Go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jo=(0,se.Z)(xa.prototype,"layerService",[ta],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xa))||Ua),rt=function(){function B(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,fe.Z)(this,B),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=U}return(0,Q.Z)(B,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var M=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var R=(typeof performance=="undefined"?Date:performance).now();M=(R-this.oldTime)/1e3,this.oldTime=R,this.elapsedTime+=M}return M}}]),B}(),pe,Ye,Qt,Zr,nn,Ai,ya,Ma=(pe=(0,H.b2)(),Ye=(0,H.f3)(F.v.IRendererService),Qt=(0,H.f3)(F.v.IGlobalConfigService),pe(Zr=(nn=function(){function B(){(0,fe.Z)(this,B),this.clock=new rt,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,(0,Me.Z)(this,"renderService",Ai,this),(0,Me.Z)(this,"configService",ya,this)}return(0,Q.Z)(B,[{key:"add",value:function(M){this.sceneInited&&M.init(),this.layers.push(M)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(M){M.inited||M.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(M){return this.layers.find(function(R){return R.id===M})}},{key:"getLayerByName",value:function(M){return this.layers.find(function(R){return R.name===M})}},{key:"remove",value:function(M){var R=this.layers.indexOf(M);R>-1&&this.layers.splice(R,1),M.emit("remove",null),M.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(M){return M.inited}).filter(function(M){return M.isVisible()}).forEach(function(M){M.hooks.beforeRenderData.call(),M.hooks.beforeRender.call(),M.render(),M.hooks.afterRender.call()}),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(M,R){return M.zIndex-R.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(M){return M.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++==0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount==0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),B}(),Ai=(0,se.Z)(nn.prototype,"renderService",[Ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ya=(0,se.Z)(nn.prototype,"configService",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nn))||Zr),va=_(85618),Ia=_(49682),Fu=_(14293),$u=_.n(Fu),wl=function(){function B(U){var M=this;(0,fe.Z)(this,B),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(R){if(R.length===0){var ee;return((ee=M.scale)===null||ee===void 0?void 0:ee.defaultValues)||[]}return R.map(function(_e,it){var Tt,wt=(Tt=M.scale)===null||Tt===void 0?void 0:Tt.scalers[it].func,fr=wt(_e);return fr})},this.setProps(U)}return(0,Q.Z)(B,[{key:"setProps",value:function(M){Object.assign(this,M)}},{key:"mapping",value:function(M){var R;if((R=this.scale)!==null&&R!==void 0&&R.callback){var ee,_e=(ee=this.scale)===null||ee===void 0?void 0:ee.callback.apply(ee,(0,Ia.Z)(M));if(!$u()(_e))return[_e]}return this.defaultCallback(M)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),B}(),Po,ba,$n,js,Ho,Wa;function Xa(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function Wo(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?Xa(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):Xa(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function Ya(B){return new Promise(function(U){return setTimeout(U,B)})}var bu=(Po={},(0,ie.Z)(Po,mi.gl.FLOAT,4),(0,ie.Z)(Po,mi.gl.UNSIGNED_BYTE,1),(0,ie.Z)(Po,mi.gl.UNSIGNED_SHORT,2),Po),Il=(ba=(0,H.b2)(),$n=(0,H.f3)(F.v.IRendererService),ba(js=(Ho=function(){function B(){(0,fe.Z)(this,B),this.attributesAndIndices=void 0,(0,Me.Z)(this,"rendererService",Wa,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return(0,Q.Z)(B,[{key:"registerStyleAttribute",value:function(M){var R=this.getLayerStyleAttribute(M.name||"");return R?R.setProps(M):(R=new wl(M),this.attributes.push(R)),R}},{key:"updateStyleAttribute",value:function(M,R,ee){var _e=this.getLayerStyleAttribute(M);_e||(_e=this.registerStyleAttribute(Wo(Wo({},R),{},{name:M})));var it=R.scale;it&&_e&&(_e.scale=it,_e.needRescale=!0,_e.needRemapping=!0,_e.needRegenerateVertices=!0,ee&&ee.featureRange&&(_e.featureRange=ee.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(M){return this.attributes.find(function(R){return R.name===M})}},{key:"getLayerAttributeScale",value:function(M){var R,ee=this.getLayerStyleAttribute(M),_e=ee==null||(R=ee.scale)===null||R===void 0?void 0:R.scalers;return _e&&_e[0]?_e[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(M,R){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,_e=arguments.length>3?arguments[3]:void 0,it=this.attributes.find(function(yo){return yo.name===M});if(it&&it.descriptor){var Tt=it.descriptor,wt=Tt.update,fr=Tt.buffer,Hr=Tt.size,In=Hr===void 0?0:Hr,Wn=bu[fr.type||mi.gl.FLOAT];if(wt){var Cn=this.featureLayout,fi=Cn.elements,gi=Cn.sizePerElement,Ji=fi.slice(ee,_e);if(!Ji.length)return;var Mi=Ji[0].offset,Ra=Mi*In*Wn,wo=Ji.map(function(yo,uo){for(var Za=yo.featureIdx,ra=yo.vertices,Da=yo.normals,lo=ra.length/gi,To=[],co=0;co<lo;co++){var ks=Da?Da.slice(co*3,co*3+3):[];To.push.apply(To,(0,Ia.Z)(wt(R[Za],Za,ra.slice(co*gi,co*gi+gi),uo,ks)))}return To}).reduce(function(yo,uo){return yo.push.apply(yo,(0,Ia.Z)(uo)),yo},[]);it.vertexAttribute.updateBuffer({data:wo,offset:Ra})}}}},{key:"createAttributesAndIndices",value:function(M,R){var ee=this;this.featureLayout={sizePerElement:0,elements:[]},R&&(this.triangulation=R);var _e=this.attributes.map(function(Mi){return Mi.resetDescriptor(),Mi.descriptor}),it=0,Tt=[],wt=[],fr=[],Hr=3;M.forEach(function(Mi,Ra){var wo=ee.triangulation(Mi),yo=wo.indices,uo=wo.vertices,Za=wo.normals,ra=wo.size;yo.forEach(function(co){wt.push(co+it)}),Hr=ra;var Da=uo.length/ra;ee.featureLayout.sizePerElement=Hr,ee.featureLayout.elements.push({featureIdx:Ra,vertices:uo,normals:Za,offset:it}),it+=Da;for(var lo=function(ks){var uu=(Za==null?void 0:Za.slice(ks*3,ks*3+3))||[],Hu=uo.slice(ks*ra,ks*ra+ra);_e.forEach(function(ds,Ac){if(ds&&ds.update){var Tf;(Tf=ds.buffer.data).push.apply(Tf,(0,Ia.Z)(ds.update(Mi,Ra,Hu,ks,uu)))}})},To=0;To<Da;To++)lo(To)});var In=this.rendererService,Wn=In.createAttribute,Cn=In.createBuffer,fi=In.createElements,gi={};_e.forEach(function(Mi,Ra){if(Mi){var wo=Mi.buffer,yo=Mi.update,uo=Mi.name,Za=(0,va.Z)(Mi,["buffer","update","name"]),ra=Wn(Wo({buffer:Cn(wo)},Za));gi[Mi.name||""]=ra,ee.attributes[Ra].vertexAttribute=ra}});var Ji=fi({data:wt,type:mi.gl.UNSIGNED_INT,count:wt.length});return this.attributesAndIndices={attributes:gi,elements:Ji},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var M;this.attributes.forEach(function(R){R.vertexAttribute&&R.vertexAttribute.destroy()}),(M=this.attributesAndIndices)===null||M===void 0||M.elements.destroy(),this.attributes=[]}}]),B}(),Wa=(0,se.Z)(Ho.prototype,"rendererService",[$n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ho))||js),So=_(33156),Ze=_(6661);function Nt(B){if(typeof window!="undefined"&&(0,So.Z)(window.process)==="object"&&window.process.type==="renderer"||typeof Ze!="undefined"&&(0,So.Z)(Ze.versions)==="object"&&Boolean(Ze.versions.electron))return!0;var U=(typeof navigator=="undefined"?"undefined":(0,So.Z)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,M=B||U;return!!(M&&M.indexOf("Electron")>=0)}var mr=_(6661);function zn(){var B=(typeof mr=="undefined"?"undefined":(0,So.Z)(mr))==="object"&&String(mr)==="[object process]"&&!mr.browser;return!B||Nt()}function oa(){return zn()&&typeof document!="undefined"}var Sa=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",wa=zn();function sa(B){try{var U=window[B],M="__storage_test__";return U.setItem(M,M),U.removeItem(M),U}catch(R){return null}}var Ta=function(){function B(U,M){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";(0,fe.Z)(this,B),this.storage=sa(R),this.id=U,this.config={},Object.assign(this.config,M),this._loadConfiguration()}return(0,Q.Z)(B,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(M){return this.config={},this.updateConfiguration(M)}},{key:"updateConfiguration",value:function(M){if(Object.assign(this.config,M),this.storage){var R=JSON.stringify(this.config);this.storage.setItem(this.id,R)}return this}},{key:"_loadConfiguration",value:function(){var M={};if(this.storage){var R=this.storage.getItem(this.id);M=R?JSON.parse(R):{}}return Object.assign(this.config,M),this}}]),B}();function ss(B){var U;return B<10?U="".concat(B.toFixed(2),"ms"):B<100?U="".concat(B.toFixed(1),"ms"):B<1e3?U="".concat(B.toFixed(0),"ms"):U="".concat((B/1e3).toFixed(2),"s"),U}function As(B){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,M=Math.max(U-B.length,0);return"".concat(" ".repeat(M)).concat(B)}function ja(B){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,M=Math.max(U-B.length,0);return"".concat(B).concat(" ".repeat(M))}function Xl(B){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M=1e-16,R=U.isInteger,ee=R===void 0?!1:R;if(Array.isArray(B)||ArrayBuffer.isView(B))return Su(B,U);if(!Number.isFinite(B))return String(B);if(Math.abs(B)<M)return ee?"0":"0.";if(ee||Math.abs(B)>100&&Math.abs(B)<1e4)return B.toFixed(0);var _e=B.toPrecision(2),it=_e.indexOf(".0");return it===_e.length-2?_e.slice(0,-1):_e}function Su(B,U){for(var M=U.maxElts,R=M===void 0?16:M,ee=U.size,_e=ee===void 0?1:ee,it="[",Tt=0;Tt<B.length&&Tt<R;++Tt)Tt>0&&(it+=",".concat(Tt%_e==0?" ":"")),it+=Xl(B[Tt],U);var wt=B.length>R?"...":"]";return"".concat(it).concat(wt)}function us(B,U,M){var R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,ee=B.src.replace(/\(/g,"%28").replace(/\)/g,"%29");B.width>R&&(M=Math.min(M,R/B.width));var _e=B.width*M,it=B.height*M,Tt=["font-size:1px;","padding:".concat(Math.floor(it/2),"px ").concat(Math.floor(_e/2),"px;"),"line-height:".concat(it,"px;"),"background:url(".concat(ee,");"),"background-size:".concat(_e,"px ").concat(it,"px;"),"color:transparent;"].join("");return["".concat(U," %c+"),Tt]}var Ol={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function _s(B){return typeof B=="string"?Ol[B.toUpperCase()]||Ol.WHITE:B}function Eu(B,U,M){return!wa&&typeof B=="string"&&(U&&(U=_s(U),B="[".concat(U,"m").concat(B,"[39m")),M&&(U=_s(M),B="[".concat(M+10,"m").concat(B,"[49m"))),B}function wu(B){if(typeof Symbol=="undefined"||B[Symbol.iterator]==null){if(Array.isArray(B)||(B=Tl(B))){var U=0,M=function(){};return{s:M,n:function(){return U>=B.length?{done:!0}:{done:!1,value:B[U++]}},e:function(wt){throw wt},f:M}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var R,ee=!0,_e=!1,it;return{s:function(){R=B[Symbol.iterator]()},n:function(){var wt=R.next();return ee=wt.done,wt},e:function(wt){_e=!0,it=wt},f:function(){try{!ee&&R.return!=null&&R.return()}finally{if(_e)throw it}}}}function Tl(B,U){if(!!B){if(typeof B=="string")return Zs(B,U);var M=Object.prototype.toString.call(B).slice(8,-1);if(M==="Object"&&B.constructor&&(M=B.constructor.name),M==="Map"||M==="Set")return Array.from(M);if(M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return Zs(B,U)}}function Zs(B,U){(U==null||U>B.length)&&(U=B.length);for(var M=0,R=new Array(U);M<U;M++)R[M]=B[M];return R}function tf(B){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],M=Object.getPrototypeOf(B),R=Object.getOwnPropertyNames(M),ee=wu(R),_e;try{var it=function(){var wt=_e.value;typeof B[wt]=="function"&&(U.find(function(fr){return wt===fr})||(B[wt]=B[wt].bind(B)))};for(ee.s();!(_e=ee.n()).done;)it()}catch(Tt){ee.e(Tt)}finally{ee.f()}}function Lc(B,U){if(!B)throw new Error(U||"Assertion failed")}var ma=_(6661),zu={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof _.g!="undefined"&&_.g,document:typeof document!="undefined"&&document,process:(typeof ma=="undefined"?"undefined":(0,So.Z)(ma))==="object"&&ma},rf=zu.self||zu.window||zu.global,bf=zu.window||zu.self||zu.global,rh=zu.global||zu.self||zu.window,kf=zu.document||{},no=zu.process||{},Yl=console;function hu(){var B;if(wa&&bf.performance)B=bf.performance.now();else if(no.hrtime){var U=no.hrtime();B=U[0]*1e3+U[1]/1e6}else B=Date.now();return B}var po={debug:wa&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},nf={enabled:!0,level:0};function Cs(){}var Ju={},Qu={once:!0};function Rc(B){for(var U in B)for(var M in B[U])return M||"untitled";return"empty"}var Tu=function(){function B(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},M=U.id;(0,fe.Z)(this,B),this.id=M,this.VERSION=Sa,this._startTs=hu(),this._deltaTs=hu(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Ta("__probe-".concat(this.id,"__"),nf),this.userData={},this.timeStamp("".concat(this.id," started")),tf(this),Object.seal(this)}return(0,Q.Z)(B,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((hu()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((hu()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:M}),this}},{key:"setLevel",value:function(M){return this._storage.updateConfiguration({level:M}),this}},{key:"assert",value:function(M,R){Lc(M,R)}},{key:"warn",value:function(M){return this._getLogFunction(0,M,po.warn,arguments,Qu)}},{key:"error",value:function(M){return this._getLogFunction(0,M,po.error,arguments)}},{key:"deprecated",value:function(M,R){return this.warn("`".concat(M,"` is deprecated and will be removed in a later version. Use `").concat(R,"` instead"))}},{key:"removed",value:function(M,R){return this.error("`".concat(M,"` has been removed. Use `").concat(R,"` instead"))}},{key:"probe",value:function(M,R){return this._getLogFunction(M,R,po.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(M,R){return this._getLogFunction(M,R,po.debug,arguments)}},{key:"info",value:function(M,R){return this._getLogFunction(M,R,console.info,arguments)}},{key:"once",value:function(M,R){return this._getLogFunction(M,R,po.debug||po.info,arguments,Qu)}},{key:"table",value:function(M,R,ee){return R?this._getLogFunction(M,R,console.table||Cs,ee&&[ee],{tag:Rc(R)}):Cs}},{key:"image",value:function(M){var R=M.logLevel,ee=M.priority,_e=M.image,it=M.message,Tt=it===void 0?"":it,wt=M.scale,fr=wt===void 0?1:wt;return this._shouldLog(R||ee)?wa?Ll({image:_e,message:Tt,scale:fr}):la({image:_e,message:Tt,scale:fr}):Cs}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(M){return this._storage.config[M]}},{key:"set",value:function(M,R){this._storage.updateConfiguration((0,ie.Z)({},M,R))}},{key:"time",value:function(M,R){return this._getLogFunction(M,R,console.time?console.time:console.info)}},{key:"timeEnd",value:function(M,R){return this._getLogFunction(M,R,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(M,R){return this._getLogFunction(M,R,console.timeStamp||Cs)}},{key:"group",value:function(M,R){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};ee=af({logLevel:M,message:R,opts:ee});var _e=ee,it=_e.collapsed;return ee.method=(it?console.groupCollapsed:console.group)||console.info,this._getLogFunction(ee)}},{key:"groupCollapsed",value:function(M,R){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(M,R,Object.assign({},ee,{collapsed:!0}))}},{key:"groupEnd",value:function(M){return this._getLogFunction(M,"",console.groupEnd||Cs)}},{key:"withGroup",value:function(M,R,ee){this.group(M,R)();try{ee()}finally{this.groupEnd(M)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(M){return this.isEnabled()&&this.getLevel()>=Vs(M)}},{key:"_getLogFunction",value:function(M,R,ee){var _e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],it=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(M)){var Tt;it=af({logLevel:M,message:R,args:_e,opts:it}),ee=ee||it.method,Lc(ee),it.total=this.getTotal(),it.delta=this.getDelta(),this._deltaTs=hu();var wt=it.tag||it.message;if(it.once)if(!Ju[wt])Ju[wt]=hu();else return Cs;return R=Eo(this.id,it.message,it),(Tt=ee).bind.apply(Tt,[console,R].concat((0,Ia.Z)(it.args)))}return Cs}},{key:"level",set:function(M){this.setLevel(M)},get:function(){return this.getLevel()}},{key:"priority",set:function(M){this.level=M},get:function(){return this.level}}]),B}();Tu.VERSION=Sa;function Vs(B){if(!B)return 0;var U;switch((0,So.Z)(B)){case"number":U=B;break;case"object":U=B.logLevel||B.priority||0;break;default:return 0}return Lc(Number.isFinite(U)&&U>=0),U}function af(B){var U=B.logLevel,M=B.message;B.logLevel=Vs(U);for(var R=B.args?Array.from(B.args):[];R.length&&R.shift()!==M;);switch(B.args=R,(0,So.Z)(U)){case"string":case"function":M!==void 0&&R.unshift(M),B.message=U;break;case"object":Object.assign(B,U);break;default:}typeof B.message=="function"&&(B.message=B.message());var ee=(0,So.Z)(B.message);return Lc(ee==="string"||ee==="object"),Object.assign(B,B.opts)}function Eo(B,U,M){if(typeof U=="string"){var R=M.time?As(ss(M.total)):"";U=M.time?"".concat(B,": ").concat(R,"  ").concat(U):"".concat(B,": ").concat(U),U=Eu(U,M.color,M.background)}return U}function la(B){var U=B.image,M=B.message,R=M===void 0?"":M,ee=B.scale,_e=ee===void 0?1:ee,it=null;try{it=_(75307)}catch(Tt){}return it?function(){return it(U,{fit:"box",width:"".concat(Math.round(80*_e),"%")}).then(function(Tt){return console.log(Tt)})}:Cs}function Ll(B){var U=B.image,M=B.message,R=M===void 0?"":M,ee=B.scale,_e=ee===void 0?1:ee;if(typeof U=="string"){var it=new Image;return it.onload=function(){var Hr,In=us(it,R,_e);(Hr=console).log.apply(Hr,(0,Ia.Z)(In))},it.src=U,Cs}var Tt=U.nodeName||"";if(Tt.toLowerCase()==="img"){var wt;return(wt=console).log.apply(wt,(0,Ia.Z)(us(U,R,_e))),Cs}if(Tt.toLowerCase()==="canvas"){var fr=new Image;return fr.onload=function(){var Hr;return(Hr=console).log.apply(Hr,(0,Ia.Z)(us(fr,R,_e)))},fr.src=U.toDataURL(),Cs}return Cs}var of,pu,qu=new Tu({id:"L7"}).enable(!1);qu.priority=5;var Dc=(of=(0,H.b2)(),of(pu=function(){function B(){(0,fe.Z)(this,B)}return(0,Q.Z)(B,[{key:"error",value:function(M){qu.error(M)()}},{key:"warn",value:function(M){qu.probe(1,M)()}},{key:"info",value:function(M){qu.info(3,M)()}},{key:"debug",value:function(M){qu.probe(4,M)()}}]),B}())||pu),kc=_(57141),Rl=_(33488),Al=_.n(Rl),Au=window.document.documentElement.style,Cu=0;function du(B){var U=B;if(typeof B=="string"&&(U=document.getElementById(B)),U){var M=document.createElement("div");return M.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,M.id="l7-scene-".concat(Cu++),M.classList.add("l7-scene"),U.appendChild(M),M}return null}var el,Kl,eu,tu,Fc,zc,mc,Nu,Cl,$l,tl,Dl,Nc,rl,Bc,sf,Uc,Pl,Mo,gc,jc,nl,Zc,Pu,Aa,Jl,Bu,il,ji,Ea,Gs,Ql,kl,ql,Sf;function Ff(B){var U=ec();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function ec(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var al=(el=(0,H.b2)(),Kl=(0,H.f3)(F.v.SceneID),eu=(0,H.f3)(F.v.IIconService),tu=(0,H.f3)(F.v.IFontService),Fc=(0,H.f3)(F.v.IControlService),zc=(0,H.f3)(F.v.ILogService),mc=(0,H.f3)(F.v.IGlobalConfigService),Nu=(0,H.f3)(F.v.IMapService),Cl=(0,H.f3)(F.v.ICoordinateSystemService),$l=(0,H.f3)(F.v.IRendererService),tl=(0,H.f3)(F.v.ILayerService),Dl=(0,H.f3)(F.v.ICameraService),Nc=(0,H.f3)(F.v.IInteractionService),rl=(0,H.f3)(F.v.IPickingService),Bc=(0,H.f3)(F.v.IShaderModuleService),sf=(0,H.f3)(F.v.IMarkerService),Uc=(0,H.f3)(F.v.IPopupService),el(Pl=(Mo=function(B){(0,Qe.Z)(M,B);var U=Ff(M);function M(){var R;return(0,fe.Z)(this,M),R=U.call(this),R.destroyed=!1,R.loaded=!1,R.loadFont=!1,R.fontFamily="",(0,Me.Z)(R,"id",gc,(0,Jr.Z)(R)),(0,Me.Z)(R,"iconService",jc,(0,Jr.Z)(R)),(0,Me.Z)(R,"fontService",nl,(0,Jr.Z)(R)),(0,Me.Z)(R,"controlService",Zc,(0,Jr.Z)(R)),(0,Me.Z)(R,"logger",Pu,(0,Jr.Z)(R)),(0,Me.Z)(R,"configService",Aa,(0,Jr.Z)(R)),(0,Me.Z)(R,"map",Jl,(0,Jr.Z)(R)),(0,Me.Z)(R,"coordinateSystemService",Bu,(0,Jr.Z)(R)),(0,Me.Z)(R,"rendererService",il,(0,Jr.Z)(R)),(0,Me.Z)(R,"layerService",ji,(0,Jr.Z)(R)),(0,Me.Z)(R,"cameraService",Ea,(0,Jr.Z)(R)),(0,Me.Z)(R,"interactionService",Gs,(0,Jr.Z)(R)),(0,Me.Z)(R,"pickingService",Ql,(0,Jr.Z)(R)),(0,Me.Z)(R,"shaderModuleService",kl,(0,Jr.Z)(R)),(0,Me.Z)(R,"markerService",ql,(0,Jr.Z)(R)),(0,Me.Z)(R,"popupService",Sf,(0,Jr.Z)(R)),R.inited=!1,R.initPromise=void 0,R.rendering=!1,R.$container=void 0,R.canvas=void 0,R.markerContainer=void 0,R.hooks=void 0,R.handleWindowResized=function(){R.emit("resize"),R.$container&&(R.initContainer(),we.SO.triggerResize(),R.coordinateSystemService.needRefresh=!0,R.render())},R.handleMapCameraChanged=function(ee){R.cameraService.update(ee),R.render()},R.hooks={init:new kc.zj},R}return(0,Q.Z)(M,[{key:"init",value:function(ee){var _e=this;this.configService.setSceneConfig(this.id,ee),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ha.Z)(Ga().mark(function it(){return Ga().wrap(function(wt){for(;;)switch(wt.prev=wt.next){case 0:return wt.next=2,new Promise(function(fr){_e.map.onCameraChanged(function(Hr){_e.cameraService.init(),_e.cameraService.update(Hr),_e.map.version!=="GAODE2.x"&&fr()}),_e.map.version!=="GAODE2.x"?_e.map.init():fr()});case 2:if(!(_e.map.version==="GAODE2.x"&&_e.map.initViewPort)){wt.next=6;break}return wt.next=5,_e.map.init();case 5:_e.map.initViewPort();case 6:_e.map.onCameraChanged(_e.handleMapCameraChanged),_e.map.addMarkerContainer(),_e.markerService.addMarkers(),_e.markerService.addMarkerLayers(),_e.popupService.initPopup(),_e.interactionService.init(),_e.interactionService.on(Qn.s.Drag,_e.addSceneEvent.bind(_e)),_e.logger.debug("map ".concat(_e.id," loaded"));case 14:case"end":return wt.stop()}},it)}))),this.hooks.init.tapPromise("initRenderer",(0,ha.Z)(Ga().mark(function it(){var Tt;return Ga().wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(Tt=du(_e.configService.getSceneConfig(_e.id).id||""),_e.$container=Tt,!Tt){fr.next=11;break}return _e.canvas=we.SO.create("canvas","",Tt),_e.setCanvas(),fr.next=7,_e.rendererService.init(_e.canvas,_e.configService.getSceneConfig(_e.id));case 7:Al()(_e.$container,_e.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(_e.handleWindowResized),fr.next=12;break;case 11:_e.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:_e.pickingService.init(_e.id),_e.logger.debug("scene ".concat(_e.id," renderer loaded"));case 14:case"end":return fr.stop()}},it)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(ee){this.logger.debug("add layer ".concat(ee.name," to scene ").concat(this.id)),this.layerService.add(ee),this.render()}},{key:"render",value:function(){var R=(0,ha.Z)(Ga().mark(function _e(){return Ga().wrap(function(Tt){for(;;)switch(Tt.prev=Tt.next){case 0:if(!(this.rendering||this.destroyed)){Tt.next=2;break}return Tt.abrupt("return");case 2:if(this.rendering=!0,this.inited){Tt.next=16;break}return Tt.next=6,this.initPromise;case 6:if(this.destroyed&&this.destroy(),!(this.loadFont&&document.fonts)){Tt.next=10;break}return Tt.next=10,document.fonts.load("24px ".concat(this.fontFamily),"L7text");case 10:this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 16:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 19:case"end":return Tt.stop()}},_e,this)}));function ee(){return R.apply(this,arguments)}return ee}()},{key:"addFontFace",value:function(ee,_e){this.fontFamily=ee;var it=document.createElement("style");it.type="text/css",it.innerText=`
        @font-face{
            font-family: '`.concat(ee,`';
            src: url('`).concat(_e,`') format('woff2'),
            url('`).concat(_e,`') format('woff'),
            url('`).concat(_e,`') format('truetype');
        }`),document.getElementsByTagName("head")[0].appendChild(it),this.loadFont=!0}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(ee){var _e,it=(_e=this.$container)===null||_e===void 0?void 0:_e.getElementsByTagName("canvas")[0];this.render();var Tt=ee==="jpg"?it==null?void 0:it.toDataURL("image/jpeg"):it==null?void 0:it.toDataURL("image/png");return Tt}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var ee=this.$container.parentElement;ee!==null&&(this.markerContainer=we.SO.create("div","l7-marker-container",ee))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,(0,Rl.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var ee,_e,it=we.SO.DPR,Tt=((ee=this.$container)===null||ee===void 0?void 0:ee.clientWidth)||400,wt=((_e=this.$container)===null||_e===void 0?void 0:_e.clientHeight)||300,fr=this.canvas;fr&&(fr.width=Tt*it,fr.height=wt*it,fr.style.width="".concat(Tt,"px"),fr.style.height="".concat(wt,"px")),this.rendererService.viewport({x:0,y:0,width:it*Tt,height:it*wt})}},{key:"setCanvas",value:function(){var ee,_e,it=we.SO.DPR,Tt=((ee=this.$container)===null||ee===void 0?void 0:ee.clientWidth)||400,wt=((_e=this.$container)===null||_e===void 0?void 0:_e.clientHeight)||300,fr=this.canvas;fr.width=Tt*it,fr.height=wt*it,fr.style.width="".concat(Tt,"px"),fr.style.height="".concat(wt,"px")}},{key:"addSceneEvent",value:function(ee){this.emit(ee.type,ee)}}]),M}(b.EventEmitter),gc=(0,se.Z)(Mo.prototype,"id",[Kl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jc=(0,se.Z)(Mo.prototype,"iconService",[eu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nl=(0,se.Z)(Mo.prototype,"fontService",[tu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zc=(0,se.Z)(Mo.prototype,"controlService",[Fc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pu=(0,se.Z)(Mo.prototype,"logger",[zc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aa=(0,se.Z)(Mo.prototype,"configService",[mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jl=(0,se.Z)(Mo.prototype,"map",[Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bu=(0,se.Z)(Mo.prototype,"coordinateSystemService",[Cl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),il=(0,se.Z)(Mo.prototype,"rendererService",[$l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ji=(0,se.Z)(Mo.prototype,"layerService",[tl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ea=(0,se.Z)(Mo.prototype,"cameraService",[Dl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gs=(0,se.Z)(Mo.prototype,"interactionService",[Nc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ql=(0,se.Z)(Mo.prototype,"pickingService",[rl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kl=(0,se.Z)(Mo.prototype,"shaderModuleService",[Bc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ql=(0,se.Z)(Mo.prototype,"markerService",[sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sf=(0,se.Z)(Mo.prototype,"popupService",[Uc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mo))||Pl),ol=_(44908),Ka=_.n(ol);function xs(B){var U=0;switch(B){case"vec2":case"ivec2":U=2;break;case"vec3":case"ivec3":U=3;break;case"vec4":case"ivec4":case"mat2":U=4;break;case"mat3":U=9;break;case"mat4":U=16;break;default:}return U}var Fl=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function io(B){var U={};return B=B.replace(Fl,function(M,R,ee){var _e=ee.split(":"),it=_e[0].trim(),Tt="";switch(_e.length>1&&(Tt=_e[1].trim()),R){case"bool":Tt=Tt==="true";break;case"float":case"int":Tt=Number(Tt);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":Tt?Tt=Tt.replace("[","").replace("]","").split(",").reduce(function(wt,fr){return wt.push(Number(fr.trim())),wt},[]):Tt=new Array(xs(R)).fill(0);break;default:}return U[it]=Tt,"uniform ".concat(R," ").concat(it,`;
`)}),{content:B,uniforms:U}}var En,Ps;function tc(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function Mu(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?tc(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):tc(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}var ru="#define PI 3.14159265359",Hs=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,sl=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Qr=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Ms=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,Iu=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,Is=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,ls=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,bs=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,yc=/precision\s+(high|low|medium)p\s+float/,_c=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Os=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Uu=(En=(0,H.b2)(),En(Ps=function(){function B(){(0,fe.Z)(this,B),this.moduleCache={},this.rawContentCache={}}return(0,Q.Z)(B,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:ru,fs:ru}),this.registerModule("decode",{vs:Hs,fs:""}),this.registerModule("projection",{vs:ls,fs:""}),this.registerModule("project",{vs:Is,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:bs}),this.registerModule("lighting",{vs:Qr,fs:""}),this.registerModule("light",{vs:sl,fs:""}),this.registerModule("picking",{vs:Iu,fs:Ms})}},{key:"registerModule",value:function(M,R){if(!this.rawContentCache[M]){var ee=R.vs,_e=R.fs,it=R.uniforms,Tt=io(ee),wt=Tt.content,fr=Tt.uniforms,Hr=io(_e),In=Hr.content,Wn=Hr.uniforms;this.rawContentCache[M]={fs:In,uniforms:Mu(Mu(Mu({},fr),Wn),it),vs:wt}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(M){var R=this;if(this.moduleCache[M])return this.moduleCache[M];var ee=this.rawContentCache[M].vs,_e=this.rawContentCache[M].fs,it=this.processModule(ee,[],"vs"),Tt=it.content,wt=it.includeList,fr=this.processModule(_e,[],"fs"),Hr=fr.content,In=fr.includeList,Wn=Hr,Cn=Ka()(wt.concat(In).concat(M)).reduce(function(fi,gi){return Mu(Mu({},fi),R.rawContentCache[gi].uniforms)},{});return yc.test(Hr)||(Wn=_c+Hr),this.moduleCache[M]={fs:Wn.trim(),uniforms:Cn,vs:Tt.trim()},this.moduleCache[M]}},{key:"processModule",value:function(M,R,ee){var _e=this,it=M.replace(Os,function(Tt,wt){var fr=wt.split(" "),Hr=fr[0].replace(/"/g,"");if(R.indexOf(Hr)>-1)return"";var In=_e.rawContentCache[Hr][ee];R.push(Hr);var Wn=_e.processModule(In,R,ee),Cn=Wn.content;return Cn});return{content:it,includeList:R}}}]),B}())||Ps),vu=_(86074),nu=_(3156),xc,rc,iu,Ls,Di,Ws=(xc=(0,H.b2)(),rc=(0,H.f3)(F.v.IShaderModuleService),xc(iu=(Ls=function(){function B(){(0,fe.Z)(this,B),(0,Me.Z)(this,"shaderModuleService",Di,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return(0,Q.Z)(B,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return nu.G.Normal}},{key:"init",value:function(M,R){this.config=R,this.rendererService=M.getContainer().get(F.v.IRendererService),this.cameraService=M.getContainer().get(F.v.ICameraService),this.mapService=M.getContainer().get(F.v.IMapService),this.interactionService=M.getContainer().get(F.v.IInteractionService),this.layerService=M.getContainer().get(F.v.ILayerService)}},{key:"render",value:function(M){}}]),B}(),Di=(0,se.Z)(Ls.prototype,"shaderModuleService",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ls))||iu),Uo,vo;function ju(B){var U=ul();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function ul(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var mu=(Uo=(0,H.b2)(),Uo(vo=function(B){(0,Qe.Z)(M,B);var U=ju(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(ee,_e){(0,vu.Z)((0,Ct.Z)(M.prototype),"init",this).call(this,ee,_e)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),M}(Ws))||vo),cs,zl,Gn,Mn,ll;function fs(B,U){var M=typeof Symbol!="undefined"&&B[Symbol.iterator]||B["@@iterator"];if(!M){if(Array.isArray(B)||(M=Io(B))||U&&B&&typeof B.length=="number"){M&&(B=M);var R=0,ee=function(){};return{s:ee,n:function(){return R>=B.length?{done:!0}:{done:!1,value:B[R++]}},e:function(fr){throw fr},f:ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _e=!0,it=!1,Tt;return{s:function(){M=M.call(B)},n:function(){var fr=M.next();return _e=fr.done,fr},e:function(fr){it=!0,Tt=fr},f:function(){try{!_e&&M.return!=null&&M.return()}finally{if(it)throw Tt}}}}function Io(B,U){if(!!B){if(typeof B=="string")return jo(B,U);var M=Object.prototype.toString.call(B).slice(8,-1);if(M==="Object"&&B.constructor&&(M=B.constructor.name),M==="Map"||M==="Set")return Array.from(B);if(M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return jo(B,U)}}function jo(B,U){(U==null||U>B.length)&&(U=B.length);for(var M=0,R=new Array(U);M<U;M++)R[M]=B[M];return R}var Zu=(cs=(0,H.b2)(),zl=(0,H.f3)(F.v.IPostProcessor),cs(Gn=(Mn=function(){function B(){(0,fe.Z)(this,B),this.passes=[],(0,Me.Z)(this,"postProcessor",ll,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return(0,Q.Z)(B,[{key:"setLayer",value:function(M){this.layer=M}},{key:"setRenderFlag",value:function(M){this.renderFlag=M}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var U=(0,ha.Z)(Ga().mark(function R(){var ee,_e,it;return Ga().wrap(function(wt){for(;;)switch(wt.prev=wt.next){case 0:ee=fs(this.passes),wt.prev=1,ee.s();case 3:if((_e=ee.n()).done){wt.next=9;break}return it=_e.value,wt.next=7,it.render(this.layer);case 7:wt.next=3;break;case 9:wt.next=14;break;case 11:wt.prev=11,wt.t0=wt.catch(1),ee.e(wt.t0);case 14:return wt.prev=14,ee.f(),wt.finish(14);case 17:this.layer.renderModels();case 18:case"end":return wt.stop()}},R,this,[[1,11,14,17]])}));function M(){return U.apply(this,arguments)}return M}()},{key:"resize",value:function(M,R){(this.width!==M||this.height!==R)&&(this.width=M,this.height=R)}},{key:"add",value:function(M,R){M.getType()===nu.G.PostProcessing?this.postProcessor.add(M,this.layer,R):(M.init(this.layer,R),this.passes.push(M))}},{key:"insert",value:function(M,R,ee){M.init(this.layer,R),this.passes.splice(ee,0,M)}},{key:"destroy",value:function(){this.passes.length=0}}]),B}(),ll=(0,se.Z)(Mn.prototype,"postProcessor",[zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn))||Gn),gu,Nl,Yi,ao,Vc;function cl(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function bc(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?cl(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):cl(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function Vu(B){var U=Rs();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function Rs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var nc=(gu=(0,H.b2)(),Nl=(0,H.f3)(F.v.ILogService),gu(Yi=(ao=function(B){(0,Qe.Z)(M,B);var U=Vu(M);function M(){var R;(0,fe.Z)(this,M);for(var ee=arguments.length,_e=new Array(ee),it=0;it<ee;it++)_e[it]=arguments[it];return R=U.call.apply(U,[this].concat(_e)),(0,Me.Z)(R,"logger",Vc,(0,Jr.Z)(R)),R.pickingFBO=void 0,R.layer=void 0,R.width=0,R.height=0,R.alreadyInRendering=!1,R.pickFromPickingFBO=function(Tt){var wt=Tt.x,fr=Tt.y,Hr=Tt.lngLat,In=Tt.type;if(!(!R.layer.isVisible()||!R.layer.needPick(In))){var Wn=R.rendererService,Cn=Wn.getViewportSize,fi=Wn.readPixels,gi=Wn.useFramebuffer,Ji=Cn(),Mi=Ji.width,Ra=Ji.height,wo=R.layer.getLayerConfig(),yo=wo.enableHighlight,uo=wo.enableSelect,Za=wt*we.SO.DPR,ra=fr*we.SO.DPR;if(!(Za>Mi||Za<0||ra>Ra||ra<0)){var Da;gi(R.pickingFBO,function(){var lo;if(Da=fi({x:Math.round(Za),y:Math.round(Ra-(fr+1)*we.SO.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:R.pickingFBO}),Da[0]!==0||Da[1]!==0||Da[2]!==0){R.logger.debug("picked");var To=(0,we.W0)(Da),co=R.layer.getSource().getFeatureById(To),ks={x:wt,y:fr,type:In,lngLat:Hr,featureId:To,feature:co};co&&(R.layer.setCurrentPickId(To),R.triggerHoverOnLayer(ks))}else{var uu={x:wt,y:fr,lngLat:Hr,type:R.layer.getCurrentPickId()===null?"un"+In:"mouseout",featureId:null,feature:null};R.triggerHoverOnLayer(bc(bc({},uu),{},{type:"unpick"})),R.triggerHoverOnLayer(uu),R.layer.setCurrentPickId(null)}yo&&R.highlightPickedFeature(Da),uo&&In==="click"&&((lo=Da)===null||lo===void 0?void 0:lo.toString())!==[0,0,0,0].toString()&&R.selectFeature(Da)})}}},R}return(0,Q.Z)(M,[{key:"getType",value:function(){return nu.G.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(ee,_e){(0,vu.Z)((0,Ct.Z)(M.prototype),"init",this).call(this,ee,_e),this.layer=ee;var it=this.rendererService,Tt=it.createTexture2D,wt=it.createFramebuffer,fr=it.getViewportSize,Hr=fr(),In=Hr.width,Wn=Hr.height;this.pickingFBO=wt({color:Tt({width:In,height:Wn,wrapS:mi.gl.CLAMP_TO_EDGE,wrapT:mi.gl.CLAMP_TO_EDGE})}),this.interactionService.on(Qn.s.Hover,this.pickFromPickingFBO),this.interactionService.on(Qn.s.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Qn.s.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(ee){var _e=this;if(!this.alreadyInRendering){var it=this.rendererService,Tt=it.getViewportSize,wt=it.useFramebuffer,fr=it.clear,Hr=Tt(),In=Hr.width,Wn=Hr.height;this.alreadyInRendering=!0,(this.width!==In||this.height!==Wn)&&(this.pickingFBO.resize({width:In,height:Wn}),this.width=In,this.height=Wn),wt(this.pickingFBO,function(){fr({framebuffer:_e.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var Cn=_e.layer.multiPassRenderer.getRenderFlag();_e.layer.multiPassRenderer.setRenderFlag(!1),ee.hooks.beforePickingEncode.call(),ee.render(),ee.hooks.afterPickingEncode.call(),_e.layer.multiPassRenderer.setRenderFlag(Cn),_e.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(ee){this.layer.emit(ee.type,ee)}},{key:"highlightPickedFeature",value:function(ee){var _e=(0,Et.Z)(ee,3),it=_e[0],Tt=_e[1],wt=_e[2];this.layer.hooks.beforeHighlight.call([it,Tt,wt]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(ee){var _e=(0,Et.Z)(ee,3),it=_e[0],Tt=_e[1],wt=_e[2];this.layer.hooks.beforeSelect.call([it,Tt,wt]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(ee){var _e=ee.featureId,it=(0,we.Z6)(_e);this.selectFeature(new Uint8Array(it))}},{key:"highlightFeatureHandle",value:function(ee){var _e=ee.featureId,it=(0,we.Z6)(_e);this.highlightPickedFeature(new Uint8Array(it))}}]),M}(Ws),Vc=(0,se.Z)(ao.prototype,"logger",[Nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ao))||Yi),hs=_(3670),Sc,Bl;function ic(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function Oa(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?ic(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):ic(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function ac(B){var U=fl();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function fl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var Ec=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,hl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,pl=(Sc=(0,H.b2)(),Sc(Bl=function(B){(0,Qe.Z)(M,B);var U=ac(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:hl,fs:Ec});var ee=this.shaderModuleService.getModule("blur-pass"),_e=ee.vs,it=ee.fs,Tt=ee.uniforms,wt=this.rendererService.getViewportSize(),fr=wt.width,Hr=wt.height;return{vs:_e,fs:it,uniforms:Oa(Oa({},Tt),{},{u_ViewportSize:[fr,Hr]})}}},{key:"convertOptionsToUniforms",value:function(ee){var _e={};return $u()(ee.blurRadius)||(_e.u_BlurDir=[ee.blurRadius,0]),_e}}]),M}(hs.Z))||Bl),Ul,yu;function au(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function Gc(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?au(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):au(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function wc(B){var U=uf();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function uf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var Hc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,c=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,o=(Ul=(0,H.b2)(),Ul(yu=function(B){(0,Qe.Z)(M,B);var U=wc(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:c,fs:Hc});var ee=this.shaderModuleService.getModule("blur-pass"),_e=ee.vs,it=ee.fs,Tt=ee.uniforms,wt=this.rendererService.getViewportSize(),fr=wt.width,Hr=wt.height;return{vs:_e,fs:it,uniforms:Gc(Gc({},Tt),{},{u_ViewportSize:[fr,Hr]})}}},{key:"convertOptionsToUniforms",value:function(ee){var _e={};return $u()(ee.blurRadius)||(_e.u_BlurDir=[0,ee.blurRadius]),_e}}]),M}(hs.Z))||yu),i,h;function g(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function E(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?g(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):g(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function C(B){var U=L();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function L(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var Z=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,q=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,de=(i=(0,H.b2)(),i(h=function(B){(0,Qe.Z)(M,B);var U=C(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:q,fs:Z});var ee=this.shaderModuleService.getModule("colorhalftone-pass"),_e=ee.vs,it=ee.fs,Tt=ee.uniforms,wt=this.rendererService.getViewportSize(),fr=wt.width,Hr=wt.height;return{vs:_e,fs:it,uniforms:E(E({},Tt),{},{u_ViewportSize:[fr,Hr]})}}}]),M}(hs.Z))||h),ge,be;function Ke(B){var U=He();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function He(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var ut=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,We=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,et=(ge=(0,H.b2)(),ge(be=function(B){(0,Qe.Z)(M,B);var U=Ke(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:We,fs:ut}),this.shaderModuleService.getModule("copy-pass")}}]),M}(hs.Z))||be),Pt,Mt;function _r(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function nr(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?_r(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):_r(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function gr(B){var U=Er();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function Er(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var tn=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Vr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,mn=(Pt=(0,H.b2)(),Pt(Mt=function(B){(0,Qe.Z)(M,B);var U=gr(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Vr,fs:tn});var ee=this.shaderModuleService.getModule("hexagonalpixelate-pass"),_e=ee.vs,it=ee.fs,Tt=ee.uniforms,wt=this.rendererService.getViewportSize(),fr=wt.width,Hr=wt.height;return{vs:_e,fs:it,uniforms:nr(nr({},Tt),{},{u_ViewportSize:[fr,Hr]})}}}]),M}(hs.Z))||Mt),Sn,Hn;function ei(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function Ei(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?ei(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):ei(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function Ki(B){var U=bn();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function bn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var pi=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,bi=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Nn=(Sn=(0,H.b2)(),Sn(Hn=function(B){(0,Qe.Z)(M,B);var U=Ki(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:bi,fs:pi});var ee=this.shaderModuleService.getModule("ink-pass"),_e=ee.vs,it=ee.fs,Tt=ee.uniforms,wt=this.rendererService.getViewportSize(),fr=wt.width,Hr=wt.height;return{vs:_e,fs:it,uniforms:Ei(Ei({},Tt),{},{u_ViewportSize:[fr,Hr]})}}}]),M}(hs.Z))||Hn),yi,Kn;function Ci(B){var U=Wi();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function Wi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var mo=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,oo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Oo=(yi=(0,H.b2)(),yi(Kn=function(B){(0,Qe.Z)(M,B);var U=Ci(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:oo,fs:mo}),this.shaderModuleService.getModule("noise-pass")}}]),M}(hs.Z))||Kn),La,$a;function Ss(B){var U=Qo();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function Qo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var dl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ou=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,qo=(La=(0,H.b2)(),La($a=function(B){(0,Qe.Z)(M,B);var U=Ss(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:dl,fs:Ou}),this.shaderModuleService.getModule("sepia-pass")}}]),M}(hs.Z))||$a),Ds,vl,oc,Lu,ou,ml,Ru=(Ds=(0,H.b2)(),vl=(0,H.f3)(F.v.IRendererService),oc=(0,H.zY)(),Ds(Lu=(ou=function(){function B(){(0,fe.Z)(this,B),(0,Me.Z)(this,"rendererService",ml,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return(0,Q.Z)(B,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var U=(0,ha.Z)(Ga().mark(function R(ee){var _e,it;return Ga().wrap(function(wt){for(;;)switch(wt.prev=wt.next){case 0:_e=0;case 1:if(!(_e<this.passes.length)){wt.next=10;break}return it=this.passes[_e],it.setRenderToScreen(this.isLastEnabledPass(_e)),wt.next=6,it.render(ee);case 6:_e!==this.passes.length-1&&this.swap();case 7:_e++,wt.next=1;break;case 10:case"end":return wt.stop()}},R,this)}));function M(R){return U.apply(this,arguments)}return M}()},{key:"resize",value:function(M,R){this.readFBO.resize({width:M,height:R}),this.writeFBO.resize({width:M,height:R})}},{key:"add",value:function(M,R,ee){M.init(R,ee),this.passes.push(M)}},{key:"insert",value:function(M,R,ee,_e){M.init(ee,_e),this.passes.splice(R,0,M)}},{key:"getPostProcessingPassByName",value:function(M){return this.passes.find(function(R){return R.getName()===M})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(M){for(var R=M+1;R<this.passes.length;R++)if(this.passes[R].isEnabled())return!1;return!0}},{key:"swap",value:function(){var M=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=M}}]),B}(),ml=(0,se.Z)(ou.prototype,"rendererService",[vl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,se.Z)(ou.prototype,"init",[oc],Object.getOwnPropertyDescriptor(ou.prototype,"init"),ou.prototype),ou))||Lu),jl,su;function so(B){var U=Du();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function Du(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var Zl=(jl=(0,H.b2)(),jl(su=function(B){(0,Qe.Z)(M,B);var U=so(M);function M(){return(0,fe.Z)(this,M),U.apply(this,arguments)}return(0,Q.Z)(M,[{key:"getType",value:function(){return nu.G.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(ee,_e){(0,vu.Z)((0,Ct.Z)(M.prototype),"init",this).call(this,ee,_e)}},{key:"render",value:function(ee){var _e=this.rendererService,it=_e.useFramebuffer,Tt=_e.clear;it(null,function(){Tt({color:[0,0,0,0],depth:1,stencil:0}),ee.multiPassRenderer.setRenderFlag(!1),ee.render(),ee.multiPassRenderer.setRenderFlag(!0)})}}]),M}(Ws))||su),ps,go,Lo,Ro,Do,ko,Xs;function Ml(B,U){var M=Object.keys(B);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(B);U&&(R=R.filter(function(ee){return Object.getOwnPropertyDescriptor(B,ee).enumerable})),M.push.apply(M,R)}return M}function Vl(B){for(var U=1;U<arguments.length;U++){var M=arguments[U]!=null?arguments[U]:{};U%2?Ml(Object(M),!0).forEach(function(R){(0,ie.Z)(B,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(B,Object.getOwnPropertyDescriptors(M)):Ml(Object(M)).forEach(function(R){Object.defineProperty(B,R,Object.getOwnPropertyDescriptor(M,R))})}return B}function Tc(B){var U=Gu();return function(){var R=(0,Ct.Z)(B),ee;if(U){var _e=(0,Ct.Z)(this).constructor;ee=Reflect.construct(R,arguments,_e)}else ee=R.apply(this,arguments);return(0,Dt.Z)(this,ee)}}function Gu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(B){return!1}}var Wc=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,gl=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Ys=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function Fo(B,U){for(var M=0,R=1/U,ee=B;ee>0;)M=M+R*(ee%U),ee=Math.floor(ee/U),R=R/U;return M}var lf=1,nh=(ps=(0,H.b2)(),go=(0,H.f3)(F.v.IShaderModuleService),Lo=(0,H.f3)(F.v.ILogService),ps(Ro=(Do=function(B){(0,Qe.Z)(M,B);var U=Tc(M);function M(){var R;(0,fe.Z)(this,M);for(var ee=arguments.length,_e=new Array(ee),it=0;it<ee;it++)_e[it]=arguments[it];return R=U.call.apply(U,[this].concat(_e)),(0,Me.Z)(R,"shaderModuleService",ko,(0,Jr.Z)(R)),(0,Me.Z)(R,"logger",Xs,(0,Jr.Z)(R)),R.haltonSequence=[],R.accumulatingId=0,R.frame=0,R.timer=void 0,R.sampleRenderTarget=void 0,R.prevRenderTarget=void 0,R.outputRenderTarget=void 0,R.copyRenderTarget=void 0,R.blendModel=void 0,R.outputModel=void 0,R.copyModel=void 0,R}return(0,Q.Z)(M,[{key:"getType",value:function(){return nu.G.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(ee,_e){(0,vu.Z)((0,Ct.Z)(M.prototype),"init",this).call(this,ee,_e);var it=this.rendererService,Tt=it.createFramebuffer,wt=it.createTexture2D;this.sampleRenderTarget=Tt({color:wt({width:1,height:1,wrapS:mi.gl.CLAMP_TO_EDGE,wrapT:mi.gl.CLAMP_TO_EDGE})}),this.prevRenderTarget=Tt({color:wt({width:1,height:1,wrapS:mi.gl.CLAMP_TO_EDGE,wrapT:mi.gl.CLAMP_TO_EDGE})}),this.outputRenderTarget=Tt({color:wt({width:1,height:1,wrapS:mi.gl.CLAMP_TO_EDGE,wrapT:mi.gl.CLAMP_TO_EDGE})}),this.copyRenderTarget=Tt({color:wt({width:1,height:1,wrapS:mi.gl.CLAMP_TO_EDGE,wrapT:mi.gl.CLAMP_TO_EDGE})});for(var fr=0;fr<30;fr++)this.haltonSequence.push([Fo(fr,2),Fo(fr,3)]);this.blendModel=this.createTriangleModel("blend-pass",Wc),this.outputModel=this.createTriangleModel("copy-pass",gl,{blend:{enable:!0,func:{srcRGB:mi.gl.ONE,dstRGB:mi.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:mi.gl.ONE,dstAlpha:mi.gl.ONE_MINUS_SRC_ALPHA},equation:{rgb:mi.gl.FUNC_ADD,alpha:mi.gl.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",gl)}},{key:"render",value:function(ee){var _e=this,it=this.rendererService,Tt=it.clear,wt=it.getViewportSize,fr=it.useFramebuffer,Hr=wt(),In=Hr.width,Wn=Hr.height;this.sampleRenderTarget.resize({width:In,height:Wn}),this.prevRenderTarget.resize({width:In,height:Wn}),this.outputRenderTarget.resize({width:In,height:Wn}),this.copyRenderTarget.resize({width:In,height:Wn}),this.resetFrame(),this.stopAccumulating();var Cn=ee.multiPassRenderer.getPostProcessor().getReadFBO();fr(Cn,function(){Tt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:Cn}),ee.multiPassRenderer.setRenderFlag(!1),ee.render(),ee.multiPassRenderer.setRenderFlag(!0)});var fi=function gi(Ji){!_e.accumulatingId||Ji!==_e.accumulatingId||_e.isFinished()||(_e.doRender(ee),requestAnimationFrame(function(){gi(Ji)}))};this.accumulatingId=lf++,this.timer=window.setTimeout(function(){fi(_e.accumulatingId)},50)}},{key:"doRender",value:function(ee){var _e=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var it=this.rendererService,Tt=it.clear,wt=it.getViewportSize,fr=it.useFramebuffer,Hr=wt(),In=Hr.width,Wn=Hr.height,Cn=ee.getLayerConfig(),fi=Cn.jitterScale,gi=fi===void 0?1:fi,Ji=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Ji[0]*2-1)/In*gi,(Ji[1]*2-1)/Wn*gi),ee.multiPassRenderer.setRenderFlag(!1),ee.hooks.beforeRender.call(),fr(this.sampleRenderTarget,function(){Tt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:_e.sampleRenderTarget}),ee.render()}),ee.hooks.afterRender.call(),ee.multiPassRenderer.setRenderFlag(!0);var Mi=ee.getLayerConfig();fr(this.outputRenderTarget,function(){_e.blendModel.draw({uniforms:{u_opacity:Mi.opacity||1,u_MixRatio:_e.frame===0?1:.9,u_Diffuse1:_e.sampleRenderTarget,u_Diffuse2:_e.frame===0?ee.multiPassRenderer.getPostProcessor().getReadFBO():_e.prevRenderTarget}})}),this.frame===0&&Tt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(fr(this.copyRenderTarget,function(){_e.outputModel.draw({uniforms:{u_Texture:_e.outputRenderTarget}})}),fr(ee.multiPassRenderer.getPostProcessor().getReadFBO(),function(){_e.copyModel.draw({uniforms:{u_Texture:_e.copyRenderTarget}})}),ee.multiPassRenderer.getPostProcessor().render(ee));var Ra=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Ra,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(ee,_e,it){this.shaderModuleService.registerModule(ee,{vs:Ys,fs:_e});var Tt=this.shaderModuleService.getModule(ee),wt=Tt.vs,fr=Tt.fs,Hr=Tt.uniforms,In=this.rendererService,Wn=In.createAttribute,Cn=In.createBuffer,fi=In.createModel;return fi(Vl({vs:wt,fs:fr,attributes:{a_Position:Wn({buffer:Cn({data:[-4,-4,4,-4,0,4],type:mi.gl.FLOAT}),size:2})},uniforms:Vl({},Hr),depth:{enable:!1},count:3},it))}}]),M}(Ws),ko=(0,se.Z)(Do.prototype,"shaderModuleService",[go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xs=(0,se.Z)(Do.prototype,"logger",[Lo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Do))||Ro),sc=new H.W2;sc.bind(F.v.IGlobalConfigService).to(Le).inSingletonScope(),sc.bind(F.v.IShaderModuleService).to(Uu).inSingletonScope(),sc.bind(F.v.ILogService).to(Dc).inSingletonScope(),(0,H.GW)((0,H.b2)(),b.EventEmitter),sc.bind(F.v.IEventEmitter).to(b.EventEmitter);var Ef=(0,S.Z)(sc,!1),ih=function(U){var M=Ef.lazyInject(U);return function(R,ee,_e){M.call(this,R,ee),_e&&(_e.initializer=function(){return R[ee]})}},Kh=function(U){var M=Ef.lazyMultiInject(U);return function(R,ee,_e){M.call(this,R,ee),_e&&(_e.initializer=function(){return R[ee]})}},uc=sc,ah=0;function wf(){var B=new H.W2;return B.parent=sc,B.bind(F.v.SceneID).toConstantValue("".concat(ah++)),B.bind(F.v.ILayerService).to(Ma).inSingletonScope(),B.bind(F.v.ISceneService).to(al).inSingletonScope(),B.bind(F.v.ICameraService).to(Tr).inSingletonScope(),B.bind(F.v.ICoordinateSystemService).to(hi).inSingletonScope(),B.bind(F.v.IInteractionService).to(Fi).inSingletonScope(),B.bind(F.v.IPickingService).to(pa).inSingletonScope(),B.bind(F.v.IControlService).to(Kr).inSingletonScope(),B.bind(F.v.IMarkerService).to(sr).inSingletonScope(),B.bind(F.v.IIconService).to(G).inSingletonScope(),B.bind(F.v.IFontService).to(Re).inSingletonScope(),B.bind(F.v.IPopupService).to(xn).inSingletonScope(),B.bind(F.v.INormalPass).to(mu).whenTargetNamed("clear"),B.bind(F.v.INormalPass).to(nc).whenTargetNamed("pixelPicking"),B.bind(F.v.INormalPass).to(Zl).whenTargetNamed("render"),B.bind(F.v.INormalPass).to(nh).whenTargetNamed("taa"),B.bind(F.v.IFactoryNormalPass).toFactory(function(U){return function(M){return U.container.getNamed(F.v.INormalPass,M)}}),B.bind(F.v.IPostProcessingPass).to(et).whenTargetNamed("copy"),B.bind(F.v.IPostProcessingPass).to(pl).whenTargetNamed("blurH"),B.bind(F.v.IPostProcessingPass).to(o).whenTargetNamed("blurV"),B.bind(F.v.IPostProcessingPass).to(Oo).whenTargetNamed("noise"),B.bind(F.v.IPostProcessingPass).to(qo).whenTargetNamed("sepia"),B.bind(F.v.IPostProcessingPass).to(de).whenTargetNamed("colorHalftone"),B.bind(F.v.IPostProcessingPass).to(mn).whenTargetNamed("hexagonalPixelate"),B.bind(F.v.IPostProcessingPass).to(Nn).whenTargetNamed("ink"),B.bind(F.v.IFactoryPostProcessingPass).toFactory(function(U){return function(M){var R=U.container.getNamed(F.v.IPostProcessingPass,M);return R.setName(M),R}}),B}function zf(B){var U=new H.W2;return U.parent=B,U.bind(F.v.IStyleAttributeService).to(Il).inSingletonScope(),U.bind(F.v.IMultiPassRenderer).to(Zu).inSingletonScope(),U.bind(F.v.IPostProcessor).to(Ru).inSingletonScope(),U}},77221:function(){},75430:function(){},87300:function(_t,O,_){"use strict";_.d(O,{l:function(){return X}});var X={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},81907:function(_t,O,_){"use strict";_.d(O,{d:function(){return X}});var X;(function(b){b.TOPRIGHT="topright",b.TOPLEFT="topleft",b.BOTTOMRIGHT="bottomright",b.BOTTOMLEFT="bottomleft"})(X||(X={}))},58629:function(){},50829:function(){},83968:function(){},71134:function(_t,O,_){"use strict";_.d(O,{l:function(){return X},k:function(){return b}});var X;(function(p){p[p.LNGLAT=1]="LNGLAT",p[p.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",p[p.VECTOR_TILE=3]="VECTOR_TILE",p[p.IDENTITY=4]="IDENTITY",p[p.P20=5]="P20",p[p.P20_OFFSET=6]="P20_OFFSET",p[p.METER_OFFSET=7]="METER_OFFSET",p[p.P20_2=8]="P20_2"})(X||(X={}));var b={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"}},76967:function(_t,O,_){"use strict";_.d(O,{s:function(){return X}});var X;(function(b){b.Hover="hover",b.Click="click",b.Select="select",b.Active="active",b.Drag="drag"})(X||(X={}))},67964:function(){},21968:function(_t,O,_){"use strict";_.d(O,{h:function(){return X}});var X;(function(b){b.normal="normal",b.additive="additive",b.subtractive="subtractive",b.min="min",b.max="max",b.none="none"})(X||(X={}))},15144:function(_t,O,_){"use strict";_.d(O,{vY:function(){return X},ee:function(){return b},GC:function(){return p}});var X;(function(H){H.LINEAR="linear",H.POWER="power",H.LOG="log",H.IDENTITY="identity",H.TIME="time",H.QUANTILE="quantile",H.QUANTIZE="quantize",H.THRESHOLD="threshold",H.CAT="cat"})(X||(X={}));var b;(function(H){H.CONSTANT="constant",H.VARIABLE="variable"})(b||(b={}));var p;(function(H){H[H.Attribute=0]="Attribute",H[H.InstancedAttribute=1]="InstancedAttribute",H[H.Uniform=2]="Uniform"})(p||(p={}))},44556:function(){},61264:function(_t,O,_){"use strict";_.d(O,{I:function(){return X}});var X=["mapload"]},26661:function(){},98865:function(){},65722:function(){},30522:function(){},47026:function(){},3156:function(_t,O,_){"use strict";_.d(O,{G:function(){return X}});var X;(function(b){b.Normal="normal",b.PostProcessing="post-processing"})(X||(X={}))},64500:function(){},63288:function(){},50626:function(){},88730:function(){},75907:function(_t,O,_){"use strict";_.d(O,{gl:function(){return X}});var X;(function(b){b[b.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",b[b.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",b[b.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",b[b.POINTS=0]="POINTS",b[b.LINES=1]="LINES",b[b.LINE_LOOP=2]="LINE_LOOP",b[b.LINE_STRIP=3]="LINE_STRIP",b[b.TRIANGLES=4]="TRIANGLES",b[b.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",b[b.TRIANGLE_FAN=6]="TRIANGLE_FAN",b[b.ZERO=0]="ZERO",b[b.ONE=1]="ONE",b[b.SRC_COLOR=768]="SRC_COLOR",b[b.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",b[b.SRC_ALPHA=770]="SRC_ALPHA",b[b.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",b[b.DST_ALPHA=772]="DST_ALPHA",b[b.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",b[b.DST_COLOR=774]="DST_COLOR",b[b.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",b[b.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",b[b.FUNC_ADD=32774]="FUNC_ADD",b[b.BLEND_EQUATION=32777]="BLEND_EQUATION",b[b.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",b[b.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",b[b.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",b[b.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",b[b.MAX_EXT=32776]="MAX_EXT",b[b.MIN_EXT=32775]="MIN_EXT",b[b.BLEND_DST_RGB=32968]="BLEND_DST_RGB",b[b.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",b[b.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",b[b.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",b[b.CONSTANT_COLOR=32769]="CONSTANT_COLOR",b[b.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",b[b.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",b[b.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",b[b.BLEND_COLOR=32773]="BLEND_COLOR",b[b.ARRAY_BUFFER=34962]="ARRAY_BUFFER",b[b.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",b[b.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",b[b.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",b[b.STREAM_DRAW=35040]="STREAM_DRAW",b[b.STATIC_DRAW=35044]="STATIC_DRAW",b[b.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",b[b.BUFFER_SIZE=34660]="BUFFER_SIZE",b[b.BUFFER_USAGE=34661]="BUFFER_USAGE",b[b.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",b[b.FRONT=1028]="FRONT",b[b.BACK=1029]="BACK",b[b.FRONT_AND_BACK=1032]="FRONT_AND_BACK",b[b.CULL_FACE=2884]="CULL_FACE",b[b.BLEND=3042]="BLEND",b[b.DITHER=3024]="DITHER",b[b.STENCIL_TEST=2960]="STENCIL_TEST",b[b.DEPTH_TEST=2929]="DEPTH_TEST",b[b.SCISSOR_TEST=3089]="SCISSOR_TEST",b[b.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",b[b.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",b[b.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",b[b.NO_ERROR=0]="NO_ERROR",b[b.INVALID_ENUM=1280]="INVALID_ENUM",b[b.INVALID_VALUE=1281]="INVALID_VALUE",b[b.INVALID_OPERATION=1282]="INVALID_OPERATION",b[b.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",b[b.CW=2304]="CW",b[b.CCW=2305]="CCW",b[b.LINE_WIDTH=2849]="LINE_WIDTH",b[b.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",b[b.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",b[b.CULL_FACE_MODE=2885]="CULL_FACE_MODE",b[b.FRONT_FACE=2886]="FRONT_FACE",b[b.DEPTH_RANGE=2928]="DEPTH_RANGE",b[b.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",b[b.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",b[b.DEPTH_FUNC=2932]="DEPTH_FUNC",b[b.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",b[b.STENCIL_FUNC=2962]="STENCIL_FUNC",b[b.STENCIL_FAIL=2964]="STENCIL_FAIL",b[b.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",b[b.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",b[b.STENCIL_REF=2967]="STENCIL_REF",b[b.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",b[b.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",b[b.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",b[b.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",b[b.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",b[b.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",b[b.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",b[b.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",b[b.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",b[b.VIEWPORT=2978]="VIEWPORT",b[b.SCISSOR_BOX=3088]="SCISSOR_BOX",b[b.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",b[b.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",b[b.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",b[b.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",b[b.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",b[b.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",b[b.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",b[b.RED_BITS=3410]="RED_BITS",b[b.GREEN_BITS=3411]="GREEN_BITS",b[b.BLUE_BITS=3412]="BLUE_BITS",b[b.ALPHA_BITS=3413]="ALPHA_BITS",b[b.DEPTH_BITS=3414]="DEPTH_BITS",b[b.STENCIL_BITS=3415]="STENCIL_BITS",b[b.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",b[b.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",b[b.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",b[b.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",b[b.SAMPLES=32937]="SAMPLES",b[b.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",b[b.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",b[b.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",b[b.DONT_CARE=4352]="DONT_CARE",b[b.FASTEST=4353]="FASTEST",b[b.NICEST=4354]="NICEST",b[b.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",b[b.BYTE=5120]="BYTE",b[b.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",b[b.SHORT=5122]="SHORT",b[b.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",b[b.INT=5124]="INT",b[b.UNSIGNED_INT=5125]="UNSIGNED_INT",b[b.FLOAT=5126]="FLOAT",b[b.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",b[b.ALPHA=6406]="ALPHA",b[b.RGB=6407]="RGB",b[b.RGBA=6408]="RGBA",b[b.LUMINANCE=6409]="LUMINANCE",b[b.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",b[b.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",b[b.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",b[b.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",b[b.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",b[b.VERTEX_SHADER=35633]="VERTEX_SHADER",b[b.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",b[b.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",b[b.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",b[b.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",b[b.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",b[b.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",b[b.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",b[b.SHADER_TYPE=35663]="SHADER_TYPE",b[b.DELETE_STATUS=35712]="DELETE_STATUS",b[b.LINK_STATUS=35714]="LINK_STATUS",b[b.VALIDATE_STATUS=35715]="VALIDATE_STATUS",b[b.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",b[b.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",b[b.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",b[b.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",b[b.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",b[b.NEVER=512]="NEVER",b[b.LESS=513]="LESS",b[b.EQUAL=514]="EQUAL",b[b.LEQUAL=515]="LEQUAL",b[b.GREATER=516]="GREATER",b[b.NOTEQUAL=517]="NOTEQUAL",b[b.GEQUAL=518]="GEQUAL",b[b.ALWAYS=519]="ALWAYS",b[b.KEEP=7680]="KEEP",b[b.REPLACE=7681]="REPLACE",b[b.INCR=7682]="INCR",b[b.DECR=7683]="DECR",b[b.INVERT=5386]="INVERT",b[b.INCR_WRAP=34055]="INCR_WRAP",b[b.DECR_WRAP=34056]="DECR_WRAP",b[b.VENDOR=7936]="VENDOR",b[b.RENDERER=7937]="RENDERER",b[b.VERSION=7938]="VERSION",b[b.NEAREST=9728]="NEAREST",b[b.LINEAR=9729]="LINEAR",b[b.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",b[b.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",b[b.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",b[b.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",b[b.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",b[b.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",b[b.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",b[b.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",b[b.TEXTURE_2D=3553]="TEXTURE_2D",b[b.TEXTURE=5890]="TEXTURE",b[b.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",b[b.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",b[b.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",b[b.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",b[b.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",b[b.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",b[b.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",b[b.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",b[b.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",b[b.TEXTURE0=33984]="TEXTURE0",b[b.TEXTURE1=33985]="TEXTURE1",b[b.TEXTURE2=33986]="TEXTURE2",b[b.TEXTURE3=33987]="TEXTURE3",b[b.TEXTURE4=33988]="TEXTURE4",b[b.TEXTURE5=33989]="TEXTURE5",b[b.TEXTURE6=33990]="TEXTURE6",b[b.TEXTURE7=33991]="TEXTURE7",b[b.TEXTURE8=33992]="TEXTURE8",b[b.TEXTURE9=33993]="TEXTURE9",b[b.TEXTURE10=33994]="TEXTURE10",b[b.TEXTURE11=33995]="TEXTURE11",b[b.TEXTURE12=33996]="TEXTURE12",b[b.TEXTURE13=33997]="TEXTURE13",b[b.TEXTURE14=33998]="TEXTURE14",b[b.TEXTURE15=33999]="TEXTURE15",b[b.TEXTURE16=34e3]="TEXTURE16",b[b.TEXTURE17=34001]="TEXTURE17",b[b.TEXTURE18=34002]="TEXTURE18",b[b.TEXTURE19=34003]="TEXTURE19",b[b.TEXTURE20=34004]="TEXTURE20",b[b.TEXTURE21=34005]="TEXTURE21",b[b.TEXTURE22=34006]="TEXTURE22",b[b.TEXTURE23=34007]="TEXTURE23",b[b.TEXTURE24=34008]="TEXTURE24",b[b.TEXTURE25=34009]="TEXTURE25",b[b.TEXTURE26=34010]="TEXTURE26",b[b.TEXTURE27=34011]="TEXTURE27",b[b.TEXTURE28=34012]="TEXTURE28",b[b.TEXTURE29=34013]="TEXTURE29",b[b.TEXTURE30=34014]="TEXTURE30",b[b.TEXTURE31=34015]="TEXTURE31",b[b.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",b[b.REPEAT=10497]="REPEAT",b[b.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",b[b.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",b[b.FLOAT_VEC2=35664]="FLOAT_VEC2",b[b.FLOAT_VEC3=35665]="FLOAT_VEC3",b[b.FLOAT_VEC4=35666]="FLOAT_VEC4",b[b.INT_VEC2=35667]="INT_VEC2",b[b.INT_VEC3=35668]="INT_VEC3",b[b.INT_VEC4=35669]="INT_VEC4",b[b.BOOL=35670]="BOOL",b[b.BOOL_VEC2=35671]="BOOL_VEC2",b[b.BOOL_VEC3=35672]="BOOL_VEC3",b[b.BOOL_VEC4=35673]="BOOL_VEC4",b[b.FLOAT_MAT2=35674]="FLOAT_MAT2",b[b.FLOAT_MAT3=35675]="FLOAT_MAT3",b[b.FLOAT_MAT4=35676]="FLOAT_MAT4",b[b.SAMPLER_2D=35678]="SAMPLER_2D",b[b.SAMPLER_CUBE=35680]="SAMPLER_CUBE",b[b.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",b[b.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",b[b.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",b[b.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",b[b.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",b[b.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",b[b.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",b[b.COMPILE_STATUS=35713]="COMPILE_STATUS",b[b.LOW_FLOAT=36336]="LOW_FLOAT",b[b.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",b[b.HIGH_FLOAT=36338]="HIGH_FLOAT",b[b.LOW_INT=36339]="LOW_INT",b[b.MEDIUM_INT=36340]="MEDIUM_INT",b[b.HIGH_INT=36341]="HIGH_INT",b[b.FRAMEBUFFER=36160]="FRAMEBUFFER",b[b.RENDERBUFFER=36161]="RENDERBUFFER",b[b.RGBA4=32854]="RGBA4",b[b.RGB5_A1=32855]="RGB5_A1",b[b.RGB565=36194]="RGB565",b[b.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",b[b.STENCIL_INDEX=6401]="STENCIL_INDEX",b[b.STENCIL_INDEX8=36168]="STENCIL_INDEX8",b[b.DEPTH_STENCIL=34041]="DEPTH_STENCIL",b[b.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",b[b.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",b[b.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",b[b.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",b[b.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",b[b.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",b[b.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",b[b.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",b[b.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",b[b.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",b[b.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",b[b.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",b[b.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",b[b.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",b[b.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",b[b.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",b[b.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",b[b.NONE=0]="NONE",b[b.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",b[b.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",b[b.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",b[b.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",b[b.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",b[b.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",b[b.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",b[b.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",b[b.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",b[b.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",b[b.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",b[b.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",b[b.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",b[b.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(X||(X={}))},3670:function(_t,O,_){"use strict";_.d(O,{Z:function(){return Ge}});var X=_(65497),b=_(93158),p=_(66221),H=_(16710),S=_(60623),F=_(11700),ie=_.n(F),fe=_(14293),Q=_.n(fe),we=_(68929),Ie=_.n(we),Be=_(38045),Xe=_(11892),Ut=_(82803),er=_(3156),Yt,lt,xt,ct,Sr;function Ft(vt,Pe){var Te=Object.keys(vt);if(Object.getOwnPropertySymbols){var ze=Object.getOwnPropertySymbols(vt);Pe&&(ze=ze.filter(function(bt){return Object.getOwnPropertyDescriptor(vt,bt).enumerable})),Te.push.apply(Te,ze)}return Te}function Ht(vt){for(var Pe=1;Pe<arguments.length;Pe++){var Te=arguments[Pe]!=null?arguments[Pe]:{};Pe%2?Ft(Object(Te),!0).forEach(function(ze){(0,X.Z)(vt,ze,Te[ze])}):Object.getOwnPropertyDescriptors?Object.defineProperties(vt,Object.getOwnPropertyDescriptors(Te)):Ft(Object(Te)).forEach(function(ze){Object.defineProperty(vt,ze,Object.getOwnPropertyDescriptor(Te,ze))})}return vt}var St=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ge=(Yt=(0,Be.b2)(),lt=(0,Be.f3)(Ut.v.IShaderModuleService),Yt(xt=(ct=function(){function vt(){(0,p.Z)(this,vt),(0,b.Z)(this,"shaderModuleService",Sr,this),this.rendererService=void 0,this.config=void 0,this.quad=St,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return(0,H.Z)(vt,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Te){this.name=Te}},{key:"getType",value:function(){return er.G.PostProcessing}},{key:"init",value:function(Te,ze){this.config=ze,this.rendererService=Te.getContainer().get(Ut.v.IRendererService);var bt=this.rendererService,cr=bt.createAttribute,ae=bt.createBuffer,Ee=bt.createModel,le=this.setupShaders(),re=le.vs,te=le.fs,ke=le.uniforms;this.model=Ee({vs:re,fs:te,attributes:{a_Position:cr({buffer:ae({data:[-4,-4,4,-4,0,4],type:Xe.gl.FLOAT}),size:2})},uniforms:Ht(Ht({u_Texture:null},ke),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Te){var ze=this,bt=Te.multiPassRenderer.getPostProcessor(),cr=this.rendererService,ae=cr.useFramebuffer,Ee=cr.getViewportSize,le=cr.clear,re=Ee(),te=re.width,ke=re.height;ae(this.renderToScreen?null:bt.getWriteFBO(),function(){le({framebuffer:bt.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),ze.model.draw({uniforms:Ht({u_Texture:bt.getReadFBO(),u_ViewportSize:[te,ke]},ze.convertOptionsToUniforms(ze.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Te){this.enabled=Te}},{key:"setRenderToScreen",value:function(Te){this.renderToScreen=Te}},{key:"updateOptions",value:function(Te){this.optionsToUpdate=Ht(Ht({},this.optionsToUpdate),Te)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Te){var ze={};return Object.keys(Te).forEach(function(bt){Q()(Te[bt])||(ze["u_".concat(ie()(Ie()(bt)))]=Te[bt])}),ze}}]),vt}(),Sr=(0,S.Z)(ct.prototype,"shaderModuleService",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct))||xt)},6997:function(_t,O,_){"use strict";_.d(O,{P:function(){return X}});var X=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},13407:function(){},93934:function(){},82803:function(_t,O,_){"use strict";_.d(O,{v:function(){return X}});var X={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},61223:function(_t,O,_){"use strict";var X=_(74691),b=null;function p(Pe){return b.indexOf(Pe)}var H=2,S=4,F=64,ie=128,fe=256,Q=512,we=8192,Ie=16384,Be=32768,Xe=null,Ut=131072,er=262144,Yt=524288,lt=1048576,xt=2097152,ct=4194304,Sr=8388608,Ft=16777216,Ht=null;function St(Pe,Te){return Pe=_clamp(Math.floor(Pe),0,255),Te=_clamp(Math.floor(Te),0,255),256*Pe+Te}function Ge(Pe){var Te=Pe.color,ze=Pe.radius,bt=Pe.tileX,cr=Pe.tileY,ae=Pe.shape,Ee=Pe.opacity,le=Pe.stroke,re=Pe.strokeWidth,te=Pe.strokeOpacity,ke=[],nt=[],Kt=[],Ir=[St(Te[0],Te[1]),St(Te[2],Te[3])],Lr=[St(le[0],le[1]),St(le[2],le[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(qr){var tr=_slicedToArray(qr,2),ce=tr[0],ye=tr[1];ke.push([].concat(Ir,[(ce+1)*Sr+(ye+1)*xt+getShapeIndex(ae)*Ut+ze,(bt+512)*Yt+(cr+512)*F])),nt.push([].concat(Lr,[re,te])),Kt.push([Ee,0,0,0])}),{packedBuffer:ke,packedBuffer2:nt,packedBuffer3:Kt}}function vt(Pe,Te){if(Pe===0&&!Te)return 0;if(Pe===1&&Te)return 4294967295;var ze=Te?1:0,bt=Math.floor(Pe*127);return bt*Ht+ze*Ft+bt*Ut+ze*Xe+bt*Q+ze*fe+bt*H+ze}},55589:function(_t,O,_){"use strict";_.d(O,{zP:function(){return c1},JE:function(){return y0},ns:function(){return l1}});var X={};_.r(X),_.d(X,{add:function(){return zc},angle:function(){return Sf},bezier:function(){return Bu},ceil:function(){return $l},clone:function(){return el},copy:function(){return tu},create:function(){return du},cross:function(){return Pu},dist:function(){return io},distance:function(){return Uc},div:function(){return Fl},divide:function(){return Cl},dot:function(){return Zc},equals:function(){return ol},exactEquals:function(){return al},floor:function(){return tl},forEach:function(){return Mu},fromValues:function(){return eu},hermite:function(){return Jl},inverse:function(){return jc},len:function(){return Ps},length:function(){return Kl},lerp:function(){return Aa},max:function(){return Nc},min:function(){return Dl},mul:function(){return xs},multiply:function(){return Nu},negate:function(){return gc},normalize:function(){return nl},random:function(){return il},rotateX:function(){return Ql},rotateY:function(){return kl},rotateZ:function(){return ql},round:function(){return rl},scale:function(){return Bc},scaleAndAdd:function(){return sf},set:function(){return Fc},sqrDist:function(){return En},sqrLen:function(){return tc},squaredDistance:function(){return Pl},squaredLength:function(){return Mo},str:function(){return ec},sub:function(){return Ka},subtract:function(){return mc},transformMat3:function(){return Ea},transformMat4:function(){return ji},transformQuat:function(){return Gs},zero:function(){return Ff}});var b=_(67294),p=(0,b.createContext)({});function H(){return(0,b.useContext)(p)}var S=_(11892),F=_(65497),ie=_(21814),fe=_(66221),Q=_(16710),we=_(96114),Ie=_(70243),Be=_(99219),Xe=_(26759),Ut=_(60121);function er(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Yt(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?er(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):er(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function lt(n){var s=xt();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function xt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ct;(function(n){n.TOPRIGHT="topright",n.TOPLEFT="topleft",n.BOTTOMRIGHT="bottomright",n.BOTTOMLEFT="bottomleft"})(ct||(ct={}));var Sr=0,Ft=function(n){(0,we.Z)(a,n);var s=lt(a);function a(u){var l;return(0,fe.Z)(this,a),l=s.call(this),l.controlOption=void 0,l.container=void 0,l.sceneContainer=void 0,l.mapsService=void 0,l.renderService=void 0,l.layerService=void 0,l.controlService=void 0,l.isShow=void 0,l.controlOption=Yt(Yt({},l.getDefault()),u||{}),l}return(0,Q.Z)(a,[{key:"getDefault",value:function(){return{position:ct.TOPRIGHT,name:"".concat(Sr++)}}},{key:"setPosition",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"bottomright",d=this.controlService;return d&&d.removeControl(this),this.controlOption.position=l,d&&d.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(l){this.mapsService=l.get(S.vK.IMapService),this.renderService=l.get(S.vK.IRendererService),this.layerService=l.get(S.vK.ILayerService),this.controlService=l.get(S.vK.IControlService),this.sceneContainer=l,this.isShow=!0,this.container=this.onAdd();var d=this.container,y=this.controlOption.position,w=this.controlService.controlCorners[y];return Xe.SO.addClass(d,"l7-control"),y.indexOf("bottom")!==-1?w.insertBefore(d,w.firstChild):w.appendChild(d),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var l=this.container;Xe.SO.addClass(l,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var l=this.container;Xe.SO.removeClass(l,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;Xe.SO.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(l){if(this.mapsService&&l&&l.screenX>0&&l.screenY>0){var d=this.mapsService.getContainer();d!==null&&d.focus()}}}]),a}(Ut.EventEmitter),Ht=_(46697);function St(n){var s=Ge();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Ge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var vt=function(n){(0,we.Z)(a,n);var s=St(a);function a(u){var l;return(0,fe.Z)(this,a),l=s.call(this,u),l.layerControlInputs=void 0,l.layers=void 0,l.lastZIndex=void 0,l.handlingClick=void 0,l.layersLink=void 0,l.baseLayersList=void 0,l.separator=void 0,l.overlaysList=void 0,l.form=void 0,l.layerControlInputs=[],l.layers=[],l.lastZIndex=0,l.handlingClick=!1,l.initLayers(),(0,Xe.Ev)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],(0,Ht.Z)(l)),l}return(0,Q.Z)(a,[{key:"getDefault",value:function(){return{collapsed:!0,position:S.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var l=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(d){d.layer.on("remove",l.onLayerChange),d.layer.on("add",l.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(l,d){return this.addLayer(l,d,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var l=this.renderService.getViewportSize(),d=l.height;Xe.SO.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var y=d-(this.container.offsetTop+50);return y<this.form.clientHeight?(Xe.SO.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=y+"px"):Xe.SO.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return Xe.SO.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var l=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(d){d.layer.off("remove",l.onLayerChange),d.layer.off("add",l.onLayerChange)}))}},{key:"initLayout",value:function(){var l="l7-control-layers",d=this.container=Xe.SO.create("div",l),y=this.controlOption.collapsed;d.setAttribute("aria-haspopup","true");var w=this.form=Xe.SO.create("form",l+"-list");y&&(this.mapsService.on("click",this.collapse),d.addEventListener("mouseenter",this.expand),d.addEventListener("mouseleave",this.collapse)),this.layersLink=Xe.SO.create("a",l+"-toggle",d);var P=this.layersLink;P.title="Layers",y||this.expand(),this.baseLayersList=Xe.SO.create("div",l+"-base",w),this.separator=Xe.SO.create("div",l+"-separator",w),this.overlaysList=Xe.SO.create("div",l+"-overlays",w),d.appendChild(w)}},{key:"initLayers",value:function(){var l=this,d=this.controlOption,y=d.baseLayers,w=y===void 0?{}:y,P=d.overlayers,k=P===void 0?{}:P;Object.keys(w).forEach(function($,W){l.addLayer(w[$],$,!1)}),Object.keys(k).forEach(function($,W){l.addLayer(k[$],$,!0)})}},{key:"update",value:function(){if(!this.container)return this;Xe.SO.empty(this.baseLayersList),Xe.SO.empty(this.overlaysList),this.layerControlInputs=[];var l,d,y,w,P=0;for(y=0;y<this.layers.length;y++)w=this.layers[y],this.addItem(w),d=d||w.overlay,l=l||!w.overlay,P+=w.overlay?0:1;return this.controlOption.hideSingleBase&&(l=l&&P>1,this.baseLayersList.style.display=l?"":"none"),this.separator.style.display=d&&l?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var l=this.layerControlInputs,d,y,w=this.mapsService.getZoom(),P=l.length-1;P>=0;P--)if(d=l[P],y=this.layerService.getLayer(d.layerId),y&&y.inited){var k=y.getMinZoom(),$=y.getMaxZoom();d.disabled=w<k||w>$}}},{key:"addLayer",value:function(l,d,y){this.mapsService&&(l.on("add",this.onLayerChange),l.on("remove",this.onLayerChange)),this.layers.push({layer:l,name:d,overlay:y});var w=this.controlOption,P=w.sortLayers,k=w.sortFunction,$=w.autoZIndex;P&&this.layers.sort(function(W,me){return k(W.layer,me.layer,W.name,me.name)}),$&&l.setZIndex&&(this.lastZIndex++,l.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(l){this.handlingClick||this.update();var d=this.layerService.getLayer(l.target.layerId),y=d!=null&&d.overlay?l.type==="add"?"overlayadd":"overlayremove":l.type==="add"?"baselayerchange":null;y&&this.emit(y,d)}},{key:"createRadioElement",value:function(l,d){var y='<input type="radio" class="l7-control-layers-selector" name="'+l+'"'+(d?' checked="checked"':"")+"/>",w=document.createElement("div");return w.innerHTML=y,w.firstChild}},{key:"addItem",value:function(l){var d=document.createElement("label"),y=this.layerService.getLayer(l.layer.id),w=y&&y.inited&&l.layer.isVisible(),P;l.overlay?(P=document.createElement("input"),P.type="checkbox",P.className="l7-control-layers-selector",P.defaultChecked=w):P=this.createRadioElement("l7-base-layers",w),this.layerControlInputs.push(P),P.layerId=l.layer.id,P.addEventListener("click",this.onInputClick);var k=document.createElement("span");k.innerHTML=" "+l.name;var $=document.createElement("div");d.appendChild($),$.appendChild(P),$.appendChild(k);var W=l.overlay?this.overlaysList:this.baseLayersList;return W.appendChild(d),this.checkDisabledLayers(),d}},{key:"onInputClick",value:function(){var l=this.layerControlInputs,d,y,w=[],P=[];this.handlingClick=!0;for(var k=l.length-1;k>=0;k--)d=l[k],y=this.layerService.getLayer(d.layerId),d.checked?w.push(y):d.checked||P.push(y);P.forEach(function($){$.hide()}),w.forEach(function($){$.show()}),this.handlingClick=!1}}]),a}(Ft);function Pe(n){var s=Te();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Te(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ze=function(n){(0,we.Z)(a,n);var s=Pe(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getDefault",value:function(){return{position:ct.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var l="l7-control-logo",d=Xe.SO.create("div",l),y=Xe.SO.create("a","l7-ctrl-logo");return y.target="_blank",y.rel="noopener nofollow",y.href="https://antv.alipay.com/l7",y.setAttribute("aria-label","AntV logo"),y.setAttribute("rel","noopener nofollow"),d.appendChild(y),d}},{key:"onRemove",value:function(){return null}}]),a}(Ft);function bt(n){var s=cr();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function cr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ae=function(n){(0,we.Z)(a,n);var s=bt(a);function a(u){var l;return(0,fe.Z)(this,a),l=s.call(this,u),l.mScale=void 0,l.iScale=void 0,(0,Xe.Ev)(["update"],(0,Ht.Z)(l)),l}return(0,Q.Z)(a,[{key:"getDefault",value:function(){return{position:ct.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var l="l7-control-scale",d=Xe.SO.create("div",l);this.addScales(l+"-line",d);var y=this.controlOption.updateWhenIdle;return this.mapsService.on(y?"moveend":"mapmove",this.update),this.mapsService.on(y?"zoomend":"zoomchange",this.update),this.update(),d}},{key:"onRemove",value:function(){var l=this.controlOption.updateWhenIdle;this.mapsService.off(l?"zoomend":"zoomchange",this.update),this.mapsService.off(l?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var l=this.mapsService,d=this.controlOption.maxWidth,y=l.getSize()[1]/2,w=l.containerToLngLat([0,y]),P=l.containerToLngLat([d,y]),k=(0,Xe.yM)([w.lng,w.lat],[P.lng,P.lat]);this.updateScales(k)}},{key:"updateScales",value:function(l){var d=this.controlOption,y=d.metric,w=d.imperial;y&&l&&this.updateMetric(l),w&&l&&this.updateImperial(l)}},{key:"updateMetric",value:function(l){var d=this.getRoundNum(l),y=d<1e3?d+" m":d/1e3+" km";this.updateScale(this.mScale,y,d/l)}},{key:"updateImperial",value:function(l){var d=l*3.2808399,y,w,P;d>5280?(y=d/5280,w=this.getRoundNum(y),this.updateScale(this.iScale,w+" mi",w/y)):(P=this.getRoundNum(d),this.updateScale(this.iScale,P+" ft",P/d))}},{key:"updateScale",value:function(l,d,y){var w=this.controlOption.maxWidth;l.style.width=Math.round(w*y)+"px",l.innerHTML=d}},{key:"getRoundNum",value:function(l){var d=Math.pow(10,(Math.floor(l)+"").length-1),y=l/d;return y=y>=10?10:y>=5?5:y>=3?3:y>=2?2:1,d*y}},{key:"addScales",value:function(l,d){var y=this.controlOption,w=y.metric,P=y.imperial;w&&(this.mScale=Xe.SO.create("div",l,d)),P&&(this.iScale=Xe.SO.create("div",l,d))}}]),a}(Ft);function Ee(n){var s=le();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function le(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var re=function(n){(0,we.Z)(a,n);var s=Ee(a);function a(u){var l;return(0,fe.Z)(this,a),l=s.call(this,u),l.disabled=void 0,l.zoomInButton=void 0,l.zoomOutButton=void 0,(0,Xe.Ev)(["updateDisabled","zoomIn","zoomOut"],(0,Ht.Z)(l)),l}return(0,Q.Z)(a,[{key:"getDefault",value:function(){return{position:ct.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var l="l7-control-zoom",d=Xe.SO.create("div",l+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,l+"-in",d,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,l+"-out",d,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),d}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(l,d,y,w,P){var k=Xe.SO.create("a",y,w);return k.innerHTML=l,k.title=d,k.href="javascript:void(0)",k.addEventListener("click",P),k}},{key:"updateDisabled",value:function(){var l=this.mapsService,d="l7-disabled";Xe.SO.removeClass(this.zoomInButton,d),Xe.SO.removeClass(this.zoomOutButton,d),(this.disabled||l.getZoom()<=l.getMinZoom())&&Xe.SO.addClass(this.zoomOutButton,d),(this.disabled||l.getZoom()>=l.getMaxZoom())&&Xe.SO.addClass(this.zoomInButton,d)}}]),a}(Ft);function te(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function ke(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?te(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):te(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function nt(n){var s=Kt();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Kt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ir=function(n){(0,we.Z)(a,n);var s=nt(a);function a(u){var l;return(0,fe.Z)(this,a),l=s.call(this),l.markerOption=void 0,l.defaultMarker=void 0,l.popup=void 0,l.mapsService=void 0,l.sceneSerive=void 0,l.lngLat=void 0,l.scene=void 0,l.added=!1,l.eventHandle=function(d){l.emit(d.type,{target:d,data:l.markerOption.extData,lngLat:l.lngLat})},l.markerOption=ke(ke({},l.getDefault()),u),(0,Xe.Ev)(["update","onMove","onUp","addDragHandler","onMapClick"],(0,Ht.Z)(l)),l.init(),l}return(0,Q.Z)(a,[{key:"getDefault",value:function(){return{element:void 0,anchor:Xe.bV.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(l){this.scene=l,this.mapsService=l.get(S.vK.IMapService),this.sceneSerive=l.get(S.vK.ISceneService);var d=this.markerOption,y=d.element,w=d.draggable;return this.mapsService.getMarkerContainer().appendChild(y),this.registerMarkerEvent(y),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var l=this.markerOption.element;return l&&Xe.SO.remove(l),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(l){return this.lngLat=l,Array.isArray(l)&&(this.lngLat={lng:l[0],lat:l[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(l){var d=this;if(!this.added)return this.once("added",function(){d.setElement(l)}),this;var y=this.markerOption.element;return y&&Xe.SO.remove(y),this.markerOption.element=l,this.init(),this.mapsService.getMarkerContainer().appendChild(l),this.registerMarkerEvent(l),this.update(),this}},{key:"openPopup",value:function(){var l=this;if(!this.added)return this.once("added",function(){l.openPopup()}),this;var d=this.popup;return d?(d.isOpen()||d.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var l=this;this.added||this.once("added",function(){l.closePopup()});var d=this.popup;return d&&d.remove(),this}},{key:"setPopup",value:function(l){return this.popup=l,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var l=this.popup;if(l)l.isOpen()?l.remove():l.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(l){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(l){this.markerOption.extData=l}},{key:"update",value:function(){if(!!this.mapsService){var l=this.markerOption,d=l.element,y=l.anchor;this.updatePosition(),Xe.SO.setTransform(d,"".concat(Xe.rQ[y]))}}},{key:"onMapClick",value:function(l){var d=this.markerOption.element;this.popup&&d&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!!this.mapsService){var l=this.markerOption,d=l.element,y=l.offsets,w=this.lngLat,P=w.lng,k=w.lat,$=this.mapsService.getBounds(),W=this.mapsService.lngLatToContainer([P,k]);if(d){d.style.display="block";var me=this.mapsService.getContainer(),Je=0,pt=0;if(me&&(Je=me.scrollWidth,pt=me.scrollHeight),Math.abs($[0][0])>180||Math.abs($[1][0])>180){if(W.x>Je){var Zt=this.mapsService.lngLatToContainer([P-360,k]);W.x=Zt.x}if(W.x<0){var Pr=this.mapsService.lngLatToContainer([P+360,k]);W.x=Pr.x}}(W.x>Je||W.x<0||W.y>pt||W.y<0)&&(d.style.display="none"),d.style.left=W.x+y[0]+"px",d.style.top=W.y-y[1]+"px"}}}},{key:"init",value:function(){var l=this,d=this.markerOption.element,y=this.markerOption,w=y.color,P=y.anchor;if(!d){this.defaultMarker=!0,d=Xe.SO.create("div"),this.markerOption.element=d;var k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.setAttributeNS(null,"display","block"),k.setAttributeNS(null,"height","48px"),k.setAttributeNS(null,"width","48px"),k.setAttributeNS(null,"viewBox","0 0 1024 1024");var $=document.createElementNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),$.setAttributeNS(null,"fill",w),k.appendChild($),d.appendChild(k)}Xe.SO.addClass(d,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(W){var me,Je,pt=((me=l.markerOption)===null||me===void 0?void 0:me.style)&&((Je=l.markerOption)===null||Je===void 0?void 0:Je.style[W]);d&&(d.style[W]=pt)}),d.addEventListener("click",function(W){l.onMapClick(W)}),d.addEventListener("click",this.eventHandle),(0,Xe.zi)(d,P,"marker")}},{key:"registerMarkerEvent",value:function(l){l.addEventListener("mousemove",this.eventHandle),l.addEventListener("click",this.eventHandle),l.addEventListener("mousedown",this.eventHandle),l.addEventListener("mouseup",this.eventHandle),l.addEventListener("dblclick",this.eventHandle),l.addEventListener("contextmenu",this.eventHandle),l.addEventListener("mouseover",this.eventHandle),l.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var l=this.getElement();l.removeEventListener("mousemove",this.eventHandle),l.removeEventListener("click",this.eventHandle),l.removeEventListener("mousedown",this.eventHandle),l.removeEventListener("mouseup",this.eventHandle),l.removeEventListener("dblclick",this.eventHandle),l.removeEventListener("contextmenu",this.eventHandle),l.removeEventListener("mouseover",this.eventHandle),l.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(l){throw new Error("Method not implemented.")}},{key:"onUp",value:function(l){throw new Error("Method not implemented.")}}]),a}(Ut.EventEmitter),Lr=_(82492),qr=_.n(Lr),tr=_(12476),ce=_.n(tr);function ye(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Re(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ye(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):ye(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function Qe(n){var s=Dt();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Dt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ct=function(n){(0,we.Z)(a,n);var s=Qe(a);function a(u){var l,d;return(0,fe.Z)(this,a),d=s.call(this),d.markers=[],d.markerLayerOption=void 0,d.clusterIndex=void 0,d.points=[],d.clusterMarkers=[],d.mapsService=void 0,d.scene=void 0,d.zoom=void 0,d.bbox=void 0,d.markerLayerOption=qr()(d.getDefault(),u),(0,Xe.Ev)(["update"],(0,Ht.Z)(d)),d.zoom=((l=d.markerLayerOption.clusterOption)===null||l===void 0?void 0:l.zoom)||-99,d}return(0,Q.Z)(a,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(l){return this.scene=l,this.mapsService=l.get(S.vK.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(l){var d=this.markerLayerOption.cluster;d&&this.addPoint(l,this.markers.length),this.markers.push(l)}},{key:"removeMarker",value:function(l){this.markers.indexOf(l);var d=this.markers.indexOf(l);d>-1&&this.markers.splice(d,1)}},{key:"getMarkers",value:function(){var l=this.markerLayerOption.cluster;return l?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var l=this;this.getMarkers().forEach(function(d){d.addTo(l.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(l){l.remove()}),this.clusterMarkers.forEach(function(l){l.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(l,d){var y=l.getLnglat(),w=y.lng,P=y.lat,k={geometry:{type:"Point",coordinates:[w,P]},properties:Re(Re({},l.getExtData()),{},{marker_id:d})};this.points.push(k)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var l=this.markerLayerOption.clusterOption,d=l.radius,y=l.minZoom,w=y===void 0?0:y,P=l.maxZoom;this.clusterIndex=new(ce())({radius:d,minZoom:w,maxZoom:P}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(l,d){var y=this,w=l[0].concat(l[1]),P=this.clusterIndex.getClusters(w,d);this.clusterMarkers.forEach(function(k){k.remove()}),this.clusterMarkers=[],P.forEach(function(k){var $,W=y.markerLayerOption.clusterOption,me=W.field,Je=W.method;if(k.properties&&($=k.properties)!==null&&$!==void 0&&$.cluster_id){var pt,Zt=y.getLeaves((pt=k.properties)===null||pt===void 0?void 0:pt.cluster_id);if(k.properties.clusterData=Zt,me&&Je){var Pr=Zt==null?void 0:Zt.map(function(Xn){var Zi=(0,F.Z)({},me,Xn.properties[me]);return Zi}),Mr=Xe.a5.getColumn(Pr,me),hn=Xe.a5.getSatByColumn(Je,Mr),dn="point_"+Je;k.properties[dn]=hn.toFixed(2)}}var Fn=y.clusterMarker(k);y.clusterMarkers.push(Fn),Fn.addTo(y.scene)})}},{key:"getLeaves",value:function(l){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return l?this.clusterIndex.getLeaves(l,d,y):null}},{key:"clusterMarker",value:function(l){var d=this.markerLayerOption.clusterOption,y=d,w=y.element,P=w===void 0?this.generateElement.bind(this):w,k=new Ir({element:P(l)}).setLnglat({lng:l.geometry.coordinates[0],lat:l.geometry.coordinates[1]});return k}},{key:"normalMarker",value:function(l){var d=l.properties.marker_id;return this.markers[d]}},{key:"update",value:function(){var l=this.mapsService.getZoom(),d=this.mapsService.getBounds();(!this.bbox||Math.abs(l-this.zoom)>=1||!(0,Xe.oO)(this.bbox,d))&&(this.bbox=(0,Xe.yA)(d,.5),this.zoom=Math.floor(l),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(l){var d=Xe.SO.create("div","l7-marker-cluster"),y=Xe.SO.create("div","",d),w=Xe.SO.create("span","",y),P=this.markerLayerOption.clusterOption,k=P.field,$=P.method;l.properties.point_count=l.properties.point_count||1;var W=k&&$?l.properties["point_"+$]||l.properties[k]:l.properties.point_count;return w.textContent=W,d}}]),a}(Ut.EventEmitter);function A(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function z(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?A(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function ve(n){var s=Ce();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Ce(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $e=function(n){(0,we.Z)(a,n);var s=ve(a);function a(u){var l;return(0,fe.Z)(this,a),l=s.call(this),l.popupOption=void 0,l.mapsService=void 0,l.sceneSerive=void 0,l.lngLat=void 0,l.content=void 0,l.closeButton=void 0,l.timeoutInstance=void 0,l.container=void 0,l.tip=void 0,l.scene=void 0,l.popupOption=z(z({},l.getdefault()),u),(0,Xe.Ev)(["update","onClickClose","remove"],(0,Ht.Z)(l)),l}return(0,Q.Z)(a,[{key:"addTo",value:function(l){var d=this;return this.mapsService=l.get(S.vK.IMapService),this.sceneSerive=l.get(S.vK.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=l,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){d.mapsService.on("click",d.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(l){var d=window.document.createDocumentFragment(),y=window.document.createElement("body"),w;for(y.innerHTML=l;w=y.firstChild,!!w;)d.appendChild(w);return this.setDOMContent(d)}},{key:"setLnglat",value:function(l){return this.lngLat=l,Array.isArray(l)&&(this.lngLat={lng:l[0],lat:l[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(l){return this.setDOMContent(window.document.createTextNode(l))}},{key:"setMaxWidth",value:function(l){return this.popupOption.maxWidth=l,this.update(),this}},{key:"setDOMContent",value:function(l){return this.createContent(),this.content.appendChild(l),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&Xe.SO.remove(this.content),this.content=Xe.SO.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=Xe.SO.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(l,d,y){var w=window.document.createElement(l);return d!==void 0&&(w.className=d),y&&y.appendChild(w),w}},{key:"removeDom",value:function(l){l.parentNode&&l.parentNode.removeChild(l)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:Xe.bV.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(l){l.stopPropagation&&l.stopPropagation(),this.remove()}},{key:"update",value:function(){var l=this,d=this.lngLat,y=this.popupOption,w=y.className,P=y.maxWidth,k=y.anchor;if(!(!this.mapsService||!d||!this.content)){var $=this.mapsService.getMarkerContainer();if(!this.container&&$){this.container=this.creatDom("div","l7-popup",$),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),w&&w.split(" ").forEach(function(me){return l.container.classList.add(me)});var W=this.popupOption.stopPropagation;W&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(me){l.container.addEventListener(me,function(Je){Je.stopPropagation()})})}P&&this.container.style.maxWidth!==P&&(this.container.style.maxWidth=P),this.updatePosition(),Xe.SO.setTransform(this.container,"".concat(Xe.rQ[k])),(0,Xe.zi)(this.container,k,"popup")}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var l=this.lngLat,d=l.lng,y=l.lat,w=this.popupOption.offsets,P=this.mapsService.lngLatToContainer([d,y]);this.container.style.left=P.x+w[0]+"px",this.container.style.top=P.y-w[1]+"px"}}}]),a}(Ut.EventEmitter);_(83772)(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }
`);var ot=_(75805),Ot=_(87757),G=_.n(Ot),Et=_(38045),Bt=_(20607),dr=_.n(Bt),wr=function(){function n(s,a){(0,fe.Z)(this,n),this.attribute=void 0,this.buffer=void 0;var u=a.buffer,l=a.offset,d=a.stride,y=a.normalized,w=a.size,P=a.divisor;this.buffer=u,this.attribute={buffer:u.get(),offset:l||0,stride:d||0,normalized:y||!1,divisor:P||0},w&&(this.attribute.size=w)}return(0,Q.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(a){this.buffer.subData(a)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),Tr,Or,qe,yt,dt,lr,Kr,gt,Rt,sr,ar,_n,xn,ci,_i=(Tr={},(0,F.Z)(Tr,S.gl.POINTS,"points"),(0,F.Z)(Tr,S.gl.LINES,"lines"),(0,F.Z)(Tr,S.gl.LINE_LOOP,"line loop"),(0,F.Z)(Tr,S.gl.LINE_STRIP,"line strip"),(0,F.Z)(Tr,S.gl.TRIANGLES,"triangles"),(0,F.Z)(Tr,S.gl.TRIANGLE_FAN,"triangle fan"),(0,F.Z)(Tr,S.gl.TRIANGLE_STRIP,"triangle strip"),Tr),Ui=(Or={},(0,F.Z)(Or,S.gl.STATIC_DRAW,"static"),(0,F.Z)(Or,S.gl.DYNAMIC_DRAW,"dynamic"),(0,F.Z)(Or,S.gl.STREAM_DRAW,"stream"),Or),Xi=(qe={},(0,F.Z)(qe,S.gl.BYTE,"int8"),(0,F.Z)(qe,S.gl.UNSIGNED_INT,"int16"),(0,F.Z)(qe,S.gl.INT,"int32"),(0,F.Z)(qe,S.gl.UNSIGNED_BYTE,"uint8"),(0,F.Z)(qe,S.gl.UNSIGNED_SHORT,"uint16"),(0,F.Z)(qe,S.gl.UNSIGNED_INT,"uint32"),(0,F.Z)(qe,S.gl.FLOAT,"float"),qe),oi=(yt={},(0,F.Z)(yt,S.gl.ALPHA,"alpha"),(0,F.Z)(yt,S.gl.LUMINANCE,"luminance"),(0,F.Z)(yt,S.gl.LUMINANCE_ALPHA,"luminance alpha"),(0,F.Z)(yt,S.gl.RGB,"rgb"),(0,F.Z)(yt,S.gl.RGBA,"rgba"),(0,F.Z)(yt,S.gl.RGBA4,"rgba4"),(0,F.Z)(yt,S.gl.RGB5_A1,"rgb5 a1"),(0,F.Z)(yt,S.gl.RGB565,"rgb565"),(0,F.Z)(yt,S.gl.DEPTH_COMPONENT,"depth"),(0,F.Z)(yt,S.gl.DEPTH_STENCIL,"depth stencil"),yt),K=(dt={},(0,F.Z)(dt,S.gl.DONT_CARE,"dont care"),(0,F.Z)(dt,S.gl.NICEST,"nice"),(0,F.Z)(dt,S.gl.FASTEST,"fast"),dt),I=(lr={},(0,F.Z)(lr,S.gl.NEAREST,"nearest"),(0,F.Z)(lr,S.gl.LINEAR,"linear"),(0,F.Z)(lr,S.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,F.Z)(lr,S.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,F.Z)(lr,S.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,F.Z)(lr,S.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),lr),j=(Kr={},(0,F.Z)(Kr,S.gl.REPEAT,"repeat"),(0,F.Z)(Kr,S.gl.CLAMP_TO_EDGE,"clamp"),(0,F.Z)(Kr,S.gl.MIRRORED_REPEAT,"mirror"),Kr),Y=(gt={},(0,F.Z)(gt,S.gl.NONE,"none"),(0,F.Z)(gt,S.gl.BROWSER_DEFAULT_WEBGL,"browser"),gt),ue=(Rt={},(0,F.Z)(Rt,S.gl.NEVER,"never"),(0,F.Z)(Rt,S.gl.ALWAYS,"always"),(0,F.Z)(Rt,S.gl.LESS,"less"),(0,F.Z)(Rt,S.gl.LEQUAL,"lequal"),(0,F.Z)(Rt,S.gl.GREATER,"greater"),(0,F.Z)(Rt,S.gl.GEQUAL,"gequal"),(0,F.Z)(Rt,S.gl.EQUAL,"equal"),(0,F.Z)(Rt,S.gl.NOTEQUAL,"notequal"),Rt),Le=(sr={},(0,F.Z)(sr,S.gl.FUNC_ADD,"add"),(0,F.Z)(sr,S.gl.MIN_EXT,"min"),(0,F.Z)(sr,S.gl.MAX_EXT,"max"),(0,F.Z)(sr,S.gl.FUNC_SUBTRACT,"subtract"),(0,F.Z)(sr,S.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),sr),Me=(ar={},(0,F.Z)(ar,S.gl.ZERO,"zero"),(0,F.Z)(ar,S.gl.ONE,"one"),(0,F.Z)(ar,S.gl.SRC_COLOR,"src color"),(0,F.Z)(ar,S.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,F.Z)(ar,S.gl.SRC_ALPHA,"src alpha"),(0,F.Z)(ar,S.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,F.Z)(ar,S.gl.DST_COLOR,"dst color"),(0,F.Z)(ar,S.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,F.Z)(ar,S.gl.DST_ALPHA,"dst alpha"),(0,F.Z)(ar,S.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,F.Z)(ar,S.gl.CONSTANT_COLOR,"constant color"),(0,F.Z)(ar,S.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,F.Z)(ar,S.gl.CONSTANT_ALPHA,"constant alpha"),(0,F.Z)(ar,S.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,F.Z)(ar,S.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),ar),se=(_n={},(0,F.Z)(_n,S.gl.NEVER,"never"),(0,F.Z)(_n,S.gl.ALWAYS,"always"),(0,F.Z)(_n,S.gl.LESS,"less"),(0,F.Z)(_n,S.gl.LEQUAL,"lequal"),(0,F.Z)(_n,S.gl.GREATER,"greater"),(0,F.Z)(_n,S.gl.GEQUAL,"gequal"),(0,F.Z)(_n,S.gl.EQUAL,"equal"),(0,F.Z)(_n,S.gl.NOTEQUAL,"notequal"),_n),Ne=(xn={},(0,F.Z)(xn,S.gl.ZERO,"zero"),(0,F.Z)(xn,S.gl.KEEP,"keep"),(0,F.Z)(xn,S.gl.REPLACE,"replace"),(0,F.Z)(xn,S.gl.INVERT,"invert"),(0,F.Z)(xn,S.gl.INCR,"increment"),(0,F.Z)(xn,S.gl.DECR,"decrement"),(0,F.Z)(xn,S.gl.INCR_WRAP,"increment wrap"),(0,F.Z)(xn,S.gl.DECR_WRAP,"decrement wrap"),xn),At=(ci={},(0,F.Z)(ci,S.gl.FRONT,"front"),(0,F.Z)(ci,S.gl.BACK,"back"),ci),Dr=function(){function n(s,a){(0,fe.Z)(this,n),this.buffer=void 0;var u=a.data,l=a.usage,d=a.type;this.buffer=s.buffer({data:u,usage:Ui[l||S.gl.STATIC_DRAW],type:Xi[d||S.gl.UNSIGNED_BYTE]})}return(0,Q.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(a){var u=a.data,l=a.offset;this.buffer.subdata(u,l)}}]),n}(),Ur=function(){function n(s,a){(0,fe.Z)(this,n),this.elements=void 0;var u=a.data,l=a.usage,d=a.type,y=a.count;this.elements=s.elements({data:u,usage:Ui[l||S.gl.STATIC_DRAW],type:Xi[d||S.gl.UNSIGNED_BYTE],count:y})}return(0,Q.Z)(n,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(a){var u=a.data;this.elements.subdata(u)}},{key:"destroy",value:function(){}}]),n}(),Xt=function(){function n(s,a){(0,fe.Z)(this,n),this.framebuffer=void 0;var u=a.width,l=a.height,d=a.color,y=a.colors,w=a.depth,P=a.stencil,k={width:u,height:l};Array.isArray(y)&&(k.colors=y.map(function($){return $.get()})),d&&typeof d!="boolean"&&(k.color=d.get()),this.framebuffer=s.framebuffer(k)}return(0,Q.Z)(n,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(a){var u=a.width,l=a.height;this.framebuffer.resize(u,l)}}]),n}(),zr=_(33156),On=_(36719),vn=_.n(On),hr=_(68630),pn=_.n(hr);function un(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function fn(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?un(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):un(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}var hi=function(){function n(s,a){(0,fe.Z)(this,n),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=s;var u=a.vs,l=a.fs,d=a.attributes,y=a.uniforms,w=a.primitive,P=a.count,k=a.elements,$=a.depth,W=a.blend,me=a.stencil,Je=a.cull,pt=a.instances,Zt={};this.options=a,y&&(this.uniforms=this.extractUniforms(y),Object.keys(y).forEach(function(hn){Zt[hn]=s.prop(hn)}));var Pr={};Object.keys(d).forEach(function(hn){Pr[hn]=d[hn].get()});var Mr={attributes:Pr,frag:l,uniforms:Zt,vert:u,primitive:_i[w===void 0?S.gl.TRIANGLES:w]};pt&&(Mr.instances=pt),P&&(Mr.count=P),k&&(Mr.elements=k.get()),this.initDepthDrawParams({depth:$},Mr),this.initBlendDrawParams({blend:W},Mr),this.initStencilDrawParams({stencil:me},Mr),this.initCullDrawParams({cull:Je},Mr),this.drawCommand=s(Mr),this.drawParams=Mr}return(0,Q.Z)(n,[{key:"addUniforms",value:function(a){this.uniforms=fn(fn({},this.uniforms),this.extractUniforms(a))}},{key:"draw",value:function(a){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var u=fn(fn({},this.uniforms),this.extractUniforms(a.uniforms||{})),l={};Object.keys(u).forEach(function(d){var y=(0,zr.Z)(u[d]);y==="boolean"||y==="number"||Array.isArray(u[d])||u[d].BYTES_PER_ELEMENT?l[d]=u[d]:l[d]=u[d].get()}),this.drawCommand(l)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(a){a.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(a,u){var l=a.depth;l&&(u.depth={enable:l.enable===void 0?!0:!!l.enable,mask:l.mask===void 0?!0:!!l.mask,func:ue[l.func||S.gl.LESS],range:l.range||[0,1]})}},{key:"initBlendDrawParams",value:function(a,u){var l=a.blend;if(l){var d=l.enable,y=l.func,w=l.equation,P=l.color,k=P===void 0?[0,0,0,0]:P;u.blend={enable:!!d,func:{srcRGB:Me[y&&y.srcRGB||S.gl.SRC_ALPHA],srcAlpha:Me[y&&y.srcAlpha||S.gl.SRC_ALPHA],dstRGB:Me[y&&y.dstRGB||S.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Me[y&&y.dstAlpha||S.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Le[w&&w.rgb||S.gl.FUNC_ADD],alpha:Le[w&&w.alpha||S.gl.FUNC_ADD]},color:k}}}},{key:"initStencilDrawParams",value:function(a,u){var l=a.stencil;if(l){var d=l.enable,y=l.mask,w=y===void 0?-1:y,P=l.func,k=P===void 0?{cmp:S.gl.ALWAYS,ref:0,mask:-1}:P,$=l.opFront,W=$===void 0?{fail:S.gl.KEEP,zfail:S.gl.KEEP,zpass:S.gl.KEEP}:$,me=l.opBack,Je=me===void 0?{fail:S.gl.KEEP,zfail:S.gl.KEEP,zpass:S.gl.KEEP}:me;u.stencil={enable:!!d,mask:w,func:fn(fn({},k),{},{cmp:se[k.cmp]}),opFront:{fail:Ne[W.fail],zfail:Ne[W.zfail],zpass:Ne[W.zpass]},opBack:{fail:Ne[Je.fail],zfail:Ne[Je.zfail],zpass:Ne[Je.zpass]}}}}},{key:"initCullDrawParams",value:function(a,u){var l=a.cull;if(l){var d=l.enable,y=l.face,w=y===void 0?S.gl.BACK:y;u.cull={enable:!!d,face:At[w]}}}},{key:"extractUniforms",value:function(a){var u=this,l={};return Object.keys(a).forEach(function(d){u.extractUniformsRecursively(d,a[d],l,"")}),l}},{key:"extractUniformsRecursively",value:function(a,u,l,d){var y=this;if(u===null||typeof u=="number"||typeof u=="boolean"||Array.isArray(u)&&typeof u[0]=="number"||vn()(u)||u===""||"resize"in u){l["".concat(d&&d+".").concat(a)]=u;return}pn()(u)&&Object.keys(u).forEach(function(w){y.extractUniformsRecursively(w,u[w],l,"".concat(d&&d+".").concat(a))}),Array.isArray(u)&&u.forEach(function(w,P){Object.keys(w).forEach(function(k){y.extractUniformsRecursively(k,w[k],l,"".concat(d&&d+".").concat(a,"[").concat(P,"]"))})})}}]),n}(),Jr=function(){function n(s,a){(0,fe.Z)(this,n),this.texture=void 0,this.width=void 0,this.height=void 0;var u=a.data,l=a.type,d=l===void 0?S.gl.UNSIGNED_BYTE:l,y=a.width,w=a.height,P=a.flipY,k=P===void 0?!1:P,$=a.format,W=$===void 0?S.gl.RGBA:$,me=a.mipmap,Je=me===void 0?!1:me,pt=a.wrapS,Zt=pt===void 0?S.gl.CLAMP_TO_EDGE:pt,Pr=a.wrapT,Mr=Pr===void 0?S.gl.CLAMP_TO_EDGE:Pr,hn=a.aniso,dn=hn===void 0?0:hn,Fn=a.alignment,Xn=Fn===void 0?1:Fn,Zi=a.premultiplyAlpha,ti=Zi===void 0?!1:Zi,$i=a.mag,Ca=$i===void 0?S.gl.NEAREST:$i,ka=a.min,di=ka===void 0?S.gl.NEAREST:ka,_a=a.colorSpace,to=_a===void 0?S.gl.BROWSER_DEFAULT_WEBGL:_a;this.width=y,this.height=w;var Ku={width:y,height:w,type:Xi[d],format:oi[W],wrapS:j[Zt],wrapT:j[Mr],mag:I[Ca],min:I[di],alignment:Xn,flipY:k,colorSpace:Y[to],premultiplyAlpha:ti,aniso:dn};u&&(Ku.data=u),typeof Je=="number"?Ku.mipmap=K[Je]:typeof Je=="boolean"&&(Ku.mipmap=Je),this.texture=s.texture(Ku)}return(0,Q.Z)(n,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(a)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(a){var u=a.width,l=a.height;this.texture.resize(u,l),this.width=u,this.height=l}},{key:"destroy",value:function(){this.texture.destroy()}}]),n}(),vi,Li,Qn=(vi=(0,Et.b2)(),vi(Li=function(){function n(){var s=this;(0,fe.Z)(this,n),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(a){return new hi(s.gl,a)},this.createAttribute=function(a){return new wr(s.gl,a)},this.createBuffer=function(a){return new Dr(s.gl,a)},this.createElements=function(a){return new Ur(s.gl,a)},this.createTexture2D=function(a){return new Jr(s.gl,a)},this.createFramebuffer=function(a){return new Xt(s.gl,a)},this.useFramebuffer=function(a,u){s.gl({framebuffer:a?a.get():null})(u)},this.clear=function(a){var u=a.color,l=a.depth,d=a.stencil,y=a.framebuffer,w=y===void 0?null:y,P={color:u,depth:l,stencil:d};P.framebuffer=w===null?w:w.get(),s.gl.clear(P)},this.viewport=function(a){var u=a.x,l=a.y,d=a.width,y=a.height;s.gl._gl.viewport(u,l,d,y),s.width=d,s.height=y,s.gl._refresh()},this.readPixels=function(a){var u=a.framebuffer,l=a.x,d=a.y,y=a.width,w=a.height,P={x:l,y:d,width:y,height:w};return u&&(P.framebuffer=u.get()),s.gl.read(P)},this.getViewportSize=function(){return{width:s.gl._gl.drawingBufferWidth,height:s.gl._gl.drawingBufferHeight}},this.getContainer=function(){var a;return(a=s.canvas)===null||a===void 0?void 0:a.parentElement},this.getCanvas=function(){return s.canvas},this.getGLContext=function(){return s.gl._gl},this.destroy=function(){s.gl.destroy()}}return(0,Q.Z)(n,[{key:"init",value:function(){var s=(0,ot.Z)(G().mark(function u(l,d){var y=this;return G().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return this.canvas=l,P.next=3,new Promise(function(k,$){dr()({canvas:y.canvas,attributes:{alpha:!0,antialias:d.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:d.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(me,Je){(me||!Je)&&$(me),k(Je)}})});case 3:this.gl=P.sent;case 4:case"end":return P.stop()}},u,this)}));function a(u,l){return s.apply(this,arguments)}return a}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var a=this.getGLContext();a.disable(a.CULL_FACE)}},{key:"setDirty",value:function(a){this.isDirty=a}},{key:"getDirty",value:function(){return this.isDirty}}]),n}())||Li);function xi(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Ti(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?xi(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):xi(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}var bo=function(){function n(s){(0,fe.Z)(this,n),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var a=s.id,u=s.map,l=(0,S.Hp)();this.container=l,u.setContainer(l,a),l.bind(S.vK.IRendererService).to(Qn).inSingletonScope(),this.sceneService=l.get(S.vK.ISceneService),this.mapService=l.get(S.vK.IMapService),this.iconService=l.get(S.vK.IIconService),this.fontService=l.get(S.vK.IFontService),this.controlService=l.get(S.vK.IControlService),this.layerService=l.get(S.vK.ILayerService),this.markerService=l.get(S.vK.IMarkerService),this.interactionService=l.get(S.vK.IInteractionService),this.popupService=l.get(S.vK.IPopupService),this.initComponent(a),this.sceneService.init(s),this.initControl()}return(0,Q.Z)(n,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(a){return this.sceneService.exportPng(a)}},{key:"exportMap",value:function(a){return this.sceneService.exportPng(a)}},{key:"registerRenderService",value:function(a){var u=this;if(this.sceneService.loaded){var l=new a(this);l.init()}else this.on("loaded",function(){var d=new a(u);d.init()})}},{key:"map",get:function(){return this.mapService.map}},{key:"addLayer",value:function(a){var u=(0,S.e7)(this.container);a.setContainer(u),this.sceneService.addLayer(a)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(a){return this.layerService.getLayer(a)}},{key:"getLayerByName",value:function(a){return this.layerService.getLayerByName(a)}},{key:"removeLayer",value:function(a){this.layerService.remove(a)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addIconFont",value:function(a,u){this.fontService.addIconFont(a,u)}},{key:"addIconFonts",value:function(a){var u=this;a.forEach(function(l){var d=(0,ie.Z)(l,2),y=d[0],w=d[1];u.fontService.addIconFont(y,w)})}},{key:"addFontFace",value:function(a,u){this.sceneService.addFontFace(a,u)}},{key:"addImage",value:function(a,u){this.iconService.addImage(a,u)}},{key:"hasImage",value:function(a){return this.iconService.hasImage(a)}},{key:"removeImage",value:function(a){this.iconService.removeImage(a)}},{key:"addIconFontGlyphs",value:function(a,u){this.fontService.addIconGlyphs(u)}},{key:"addControl",value:function(a){this.controlService.addControl(a,this.container)}},{key:"removeControl",value:function(a){this.controlService.removeControl(a)}},{key:"getControlByName",value:function(a){return this.controlService.getControlByName(a)}},{key:"addMarker",value:function(a){this.markerService.addMarker(a)}},{key:"addMarkerLayer",value:function(a){this.markerService.addMarkerLayer(a)}},{key:"removeMarkerLayer",value:function(a){this.markerService.removeMarkerLayer(a)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(a){this.popupService.addPopup(a)}},{key:"on",value:function(a,u){S.SceneEventList.indexOf(a)===-1?this.mapService.on(a,u):this.sceneService.on(a,u)}},{key:"off",value:function(a,u){S.SceneEventList.indexOf(a)===-1?this.mapService.off(a,u):this.sceneService.off(a,u)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(a){return this.mapService.getCenter(a)}},{key:"setCenter",value:function(a,u){return this.mapService.setCenter(a,u)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(a){return this.mapService.setPitch(a)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(a){this.mapService.setRotation(a)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(a){this.mapService.panTo(a)}},{key:"panBy",value:function(a){this.mapService.panBy(a)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(a){this.mapService.setZoom(a)}},{key:"fitBounds",value:function(a,u){var l=this.sceneService.getSceneConfig(),d=l.fitBoundsOptions,y=l.animate;this.mapService.fitBounds(a,u||Ti(Ti({},d),{},{animate:y}))}},{key:"setZoomAndCenter",value:function(a,u){this.mapService.setZoomAndCenter(a,u)}},{key:"setMapStyle",value:function(a){this.mapService.setMapStyle(a)}},{key:"setMapStatus",value:function(a){this.mapService.setMapStatus(a)}},{key:"pixelToLngLat",value:function(a){return this.mapService.pixelToLngLat(a)}},{key:"lngLatToPixel",value:function(a){return this.mapService.lngLatToPixel(a)}},{key:"containerToLngLat",value:function(a){return this.mapService.containerToLngLat(a)}},{key:"lngLatToContainer",value:function(a){return this.mapService.lngLatToContainer(a)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(a,u){this.container.bind(S.vK.IPostProcessingPass).to(a).whenTargetNamed(u)}},{key:"initComponent",value:function(a){this.controlService.init({container:Xe.SO.getContainer(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var a=this.sceneService.getSceneConfig(),u=a.logoVisible,l=a.logoPosition;u&&this.addControl(new ze({position:l}))}}]),n}(),ki=_(85618),si=_(93158),Rn=_(60623),Ri=_(13218),Zn=_.n(Ri),za=_(23560),ys=_.n(za),Fi=_(57141),ha=_(27820),Sl=_.n(ha),Ga,mi,ro,Na,Ba;function Go(n){return n.map(function(s){return typeof s=="string"&&(s=[s,{}]),s})}var ta=(Ga=(0,Et.b2)(),mi=(0,Et.f3)(S.vK.IGlobalConfigService),Ga(ro=(Na=function(){function n(){(0,fe.Z)(this,n),(0,si.Z)(this,"configService",Ba,this),this.enabled=void 0}return(0,Q.Z)(n,[{key:"apply",value:function(a,u){var l=this,d=u.rendererService,y=u.postProcessingPassFactory,w=u.normalPassFactory;a.hooks.init.tap("MultiPassRendererPlugin",function(){var P=a.getLayerConfig(),k=P.enableMultiPassRenderer,$=P.passes,W=$===void 0?[]:$;l.enabled=!!k&&a.getLayerConfig().enableMultiPassRenderer!==!1,l.enabled&&(a.multiPassRenderer=l.createMultiPassRenderer(a,W,y,w),a.multiPassRenderer.setRenderFlag(!0))}),a.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(a,u,l,d){var y=a.multiPassRenderer,w=a.getLayerConfig(),P=w.enablePicking,k=w.enableTAA;return P&&y.add(d("pixelPicking")),y}}]),n}(),Ba=(0,Rn.Z)(Na.prototype,"configService",[mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Na))||ro),Ua,xa=(Ua={},(0,F.Z)(Ua,S.BlendType.additive,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE,srcAlpha:1,dstAlpha:1}}),(0,F.Z)(Ua,S.BlendType.none,{enable:!1}),(0,F.Z)(Ua,S.BlendType.normal,{enable:!0,func:{srcRGB:S.gl.SRC_ALPHA,dstRGB:S.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,F.Z)(Ua,S.BlendType.subtractive,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE,srcAlpha:S.gl.ZERO,dstAlpha:S.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:S.gl.FUNC_SUBTRACT,alpha:S.gl.FUNC_SUBTRACT}}),(0,F.Z)(Ua,S.BlendType.max,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE},equation:{rgb:S.gl.MAX_EXT}}),(0,F.Z)(Ua,S.BlendType.min,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE},equation:{rgb:S.gl.MIN_EXT}}),Ua),os={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},$o,El,Jo,Pa,Ha,pa,rt;function pe(n,s){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Ye(n))||s&&n&&typeof n.length=="number"){a&&(n=a);var u=0,l=function(){};return{s:l,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(k){throw k},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,y=!1,w;return{s:function(){a=a.call(n)},n:function(){var k=a.next();return d=k.done,k},e:function(k){y=!0,w=k},f:function(){try{!d&&a.return!=null&&a.return()}finally{if(y)throw w}}}}function Ye(n,s){if(!!n){if(typeof n=="string")return Qt(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Qt(n,s)}}function Qt(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function Zr(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function nn(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Zr(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Zr(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function Ai(n){var s=ya();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function ya(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ma=0,va=($o=(0,S.yT)(S.vK.ILogService),El=(0,S.yT)(S.vK.IGlobalConfigService),Jo=(0,S.yT)(S.vK.IShaderModuleService),Pa=function(n){(0,we.Z)(a,n);var s=Ai(a);function a(){var u,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,fe.Z)(this,a),u=s.call(this),u.id="".concat(Ma++),u.name="".concat(Ma),u.type=void 0,u.visible=!0,u.zIndex=0,u.minZoom=void 0,u.maxZoom=void 0,u.inited=!1,u.layerModelNeedUpdate=!1,u.pickedFeatureID=null,u.selectedFeatureID=null,u.styleNeedUpdate=!1,u.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},u.hooks={init:new Fi.oI,afterInit:new Fi.oI,beforeRender:new Fi.oI,beforeRenderData:new Fi.gg,afterRender:new Fi.ni,beforePickingEncode:new Fi.ni,afterPickingEncode:new Fi.ni,beforeHighlight:new Fi.ni(["pickedColor"]),afterHighlight:new Fi.ni,beforeSelect:new Fi.ni(["pickedColor"]),afterSelect:new Fi.ni,beforeDestroy:new Fi.ni,afterDestroy:new Fi.ni},u.models=[],u.multiPassRenderer=void 0,u.plugins=void 0,u.sourceOption=void 0,u.layerModel=void 0,(0,si.Z)(u,"logger",Ha,(0,Ht.Z)(u)),(0,si.Z)(u,"configService",pa,(0,Ht.Z)(u)),(0,si.Z)(u,"shaderModuleService",rt,(0,Ht.Z)(u)),u.cameraService=void 0,u.coordinateService=void 0,u.iconService=void 0,u.fontService=void 0,u.pickingService=void 0,u.rendererService=void 0,u.layerService=void 0,u.interactionService=void 0,u.mapService=void 0,u.styleAttributeService=void 0,u.layerSource=void 0,u.postProcessingPassFactory=void 0,u.normalPassFactory=void 0,u.animateOptions={enable:!1},u.container=void 0,u.encodedData=void 0,u.configSchema=void 0,u.currentPickId=null,u.rawConfig=void 0,u.needUpdateConfig=void 0,u.pendingStyleAttributes=[],u.scaleOptions={},u.animateStartTime=void 0,u.aniamateStatus=!1,u.sourceEvent=function(){u.dataState.dataSourceNeedUpdate=!0;var d=u.getLayerConfig(),y=d.autoFit,w=d.fitBoundsOptions;y&&u.fitBounds(w),u.emit("dataUpdate"),u.reRender()},u.name=l.name||u.id,u.zIndex=l.zIndex||0,u.rawConfig=l,u}return(0,Q.Z)(a,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(l){if(!this.inited)this.needUpdateConfig=nn(nn({},this.needUpdateConfig),l);else{var d=this.container.get(S.vK.SceneID);this.configService.setLayerConfig(d,this.id,nn(nn(nn({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),l)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(l){this.container=l}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(l){return this.plugins.push(l),this}},{key:"init",value:function(){var l=this,d=this.container.get(S.vK.SceneID),y=this.rawConfig.enableMultiPassRenderer,w=y===void 0?!1:y;this.configService.setLayerConfig(d,this.id,{enableMultiPassRenderer:w}),this.iconService=this.container.get(S.vK.IIconService),this.fontService=this.container.get(S.vK.IFontService),this.rendererService=this.container.get(S.vK.IRendererService),this.layerService=this.container.get(S.vK.ILayerService),this.interactionService=this.container.get(S.vK.IInteractionService),this.pickingService=this.container.get(S.vK.IPickingService),this.mapService=this.container.get(S.vK.IMapService),this.cameraService=this.container.get(S.vK.ICameraService),this.coordinateService=this.container.get(S.vK.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(S.vK.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(S.vK.IFactoryNormalPass),this.styleAttributeService=this.container.get(S.vK.IStyleAttributeService),this.multiPassRenderer=this.container.get(S.vK.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(W){var me=W.attributeName,Je=W.attributeField,pt=W.attributeValues,Zt=W.updateOptions;l.styleAttributeService.updateStyleAttribute(me,{scale:nn({field:Je},l.splitValuesAndCallbackInAttribute(pt,l.getLayerConfig()[me]))},Zt)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(S.vK.ILayerPlugin);var P=pe(this.plugins),k;try{for(P.s();!(k=P.n()).done;){var $=k.value;$.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(W){P.e(W)}finally{P.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(nn(nn({},this.getDefaultConfig()),this.rawConfig));var l=this.getLayerConfig(),d=l.animateOption;d!=null&&d.enable&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(l,d,y){return this.updateStyleAttribute("color",l,d,y),this}},{key:"texture",value:function(l,d,y){return this.updateStyleAttribute("texture",l,d,y),this}},{key:"rotate",value:function(l,d,y){return this.updateStyleAttribute("rotate",l,d,y),this}},{key:"size",value:function(l,d,y){return this.updateStyleAttribute("size",l,d,y),this}},{key:"filter",value:function(l,d,y){return this.updateStyleAttribute("filter",l,d,y),this}},{key:"shape",value:function(l,d,y){return this.updateStyleAttribute("shape",l,d,y),this}},{key:"label",value:function(l,d,y){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:l,attributeValues:d,updateOptions:y}),this}},{key:"animate",value:function(l){var d={};return Zn()(l)?(d.enable=!0,d=nn(nn({},d),l)):d.enable=l,this.updateLayerConfig({animateOption:d}),this}},{key:"source",value:function(l,d){return this.sourceOption={data:l,options:d},this}},{key:"setData",value:function(l,d){var y=this;return this.inited?this.layerSource.setData(l,d):this.on("inited",function(){y.layerSource.setData(l,d)}),this}},{key:"style",value:function(l){var d=this,y=l.passes,w=(0,ki.Z)(l,["passes"]);return y&&Go(y).forEach(function(P){var k=d.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(P[0]);k&&k.updateOptions(P[1])}),this.rawConfig=nn(nn({},this.rawConfig),w),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(l,d){return Zn()(l)?this.scaleOptions=nn(nn({},this.scaleOptions),l):this.scaleOptions[l]=d,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(l){var d={};return d.enableHighlight=Zn()(l)?!0:l,Zn()(l)?(d.enableHighlight=!0,l.color&&(d.highlightColor=l.color)):d.enableHighlight=!!l,this.updateLayerConfig(d),this}},{key:"setActive",value:function(l,d){var y=this;if(Zn()(l)){var w=l.x,P=w===void 0?0:w,k=l.y,$=k===void 0?0:k;this.updateLayerConfig({highlightColor:Zn()(d)?d.color:this.getLayerConfig().highlightColor}),this.pick({x:P,y:$})}else this.updateLayerConfig({pickedFeatureID:l,highlightColor:Zn()(d)?d.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call((0,Xe.Z6)(l)).then(function(){setTimeout(function(){y.reRender()},1)})}},{key:"select",value:function(l){var d={};return d.enableSelect=Zn()(l)?!0:l,Zn()(l)?(d.enableSelect=!0,l.color&&(d.selectColor=l.color)):d.enableSelect=!!l,this.updateLayerConfig(d),this}},{key:"setSelect",value:function(l,d){var y=this;if(Zn()(l)){var w=l.x,P=w===void 0?0:w,k=l.y,$=k===void 0?0:k;this.updateLayerConfig({selectColor:Zn()(d)?d.color:this.getLayerConfig().selectColor}),this.pick({x:P,y:$})}else this.updateLayerConfig({pickedFeatureID:l,selectColor:Zn()(d)?d.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call((0,Xe.Z6)(l)).then(function(){setTimeout(function(){y.reRender()},1)})}},{key:"setBlend",value:function(l){this.updateLayerConfig({blend:l}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(l){return this.zIndex=l,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(l){this.currentPickId=l}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(l){this.selectedFeatureID=l}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var l=this.mapService.getZoom(),d=this.getLayerConfig(),y=d.visible,w=d.minZoom,P=w===void 0?-Infinity:w,k=d.maxZoom,$=k===void 0?Infinity:k;return!!y&&l>=P&&l<=$}},{key:"setMinZoom",value:function(l){return this.updateLayerConfig({minZoom:l}),this}},{key:"getMinZoom",value:function(){var l=this.getLayerConfig(),d=l.minZoom;return d}},{key:"getMaxZoom",value:function(){var l=this.getLayerConfig(),d=l.maxZoom;return d}},{key:"get",value:function(l){var d=this.getLayerConfig();return d[l]}},{key:"setMaxZoom",value:function(l){return this.updateLayerConfig({maxZoom:l}),this}},{key:"fitBounds",value:function(l){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var d=this.getSource(),y=d.extent,w=y.some(function(P){return Math.abs(P)===Infinity});return w?this:(this.mapService.fitBounds([[y[0],y[1]],[y[2],y[3]]],l),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(l){return l.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(l){return l.needRescale||l.needRemapping||l.needRegenerateVertices}).length}},{key:"setSource",value:function(l){this.layerSource=l;var d=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(d),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(l){this.encodedData=l}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=Sl()([os,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(l){var d=this.styleAttributeService.getLayerAttributeScale(l);if(d){if(d.ticks){var y=d.ticks().map(function(P){return(0,F.Z)({value:P},l,d(P))});return y}else if(d.invertExtent){var w=d.range().map(function(P){return(0,F.Z)({value:d.invertExtent(P)},l,P)});return w}}else return[]}},{key:"pick",value:function(l){var d=l.x,y=l.y;this.interactionService.triggerHover({x:d,y})}},{key:"boxSelect",value:function(l,d){this.pickingService.boxPickLayer(this,l,d)}},{key:"buildLayerModel",value:function(l){var d=l.moduleName,y=l.vertexShader,w=l.fragmentShader,P=l.triangulation,k=(0,ki.Z)(l,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(d,{vs:y,fs:w});var $=this.shaderModuleService.getModule(d),W=$.vs,me=$.fs,Je=$.uniforms,pt=this.rendererService.createModel,Zt=this.styleAttributeService.createAttributesAndIndices(this.encodedData,P),Pr=Zt.attributes,Mr=Zt.elements;return pt(nn({attributes:Pr,uniforms:Je,fs:me,vs:W,elements:Mr,blend:xa[S.BlendType.normal]},k))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(l){var d=this.getLayerConfig(),y=d.enableHighlight,w=y===void 0?!0:y,P=d.enableSelect,k=P===void 0?!0:P,$=this.eventNames().indexOf(l)!==-1||this.eventNames().indexOf("un"+l)!==-1;return(l==="click"||l==="dblclick")&&k&&($=!0),l==="mousemove"&&(w||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&($=!0),this.isVisible()&&$}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var l=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(d){d.draw({uniforms:l.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(l,d){return{values:ys()(l)?void 0:l||d,callback:ys()(l)?l:void 0}}},{key:"updateStyleAttribute",value:function(l,d,y,w){this.inited?this.styleAttributeService.updateStyleAttribute(l,{scale:nn({field:d},this.splitValuesAndCallbackInAttribute(y,this.getLayerConfig()[d]))},w):this.pendingStyleAttributes.push({attributeName:l,attributeField:d,attributeValues:y,updateOptions:w})}}]),a}(Ut.EventEmitter),Ha=(0,Rn.Z)(Pa.prototype,"logger",[$o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pa=(0,Rn.Z)(Pa.prototype,"configService",[El],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rt=(0,Rn.Z)(Pa.prototype,"shaderModuleService",[Jo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pa),Ia,Fu,$u,wl,Po,ba=(Ia=(0,S.yT)(S.vK.IGlobalConfigService),Fu=(0,S.yT)(S.vK.IShaderModuleService),$u=function(){function n(s){(0,fe.Z)(this,n),this.triangulation=void 0,this.layer=void 0,(0,si.Z)(this,"configService",wl,this),(0,si.Z)(this,"shaderModuleService",Po,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=s,this.rendererService=s.getContainer().get(S.vK.IRendererService),this.styleAttributeService=s.getContainer().get(S.vK.IStyleAttributeService),this.mapService=s.getContainer().get(S.vK.IMapService),this.iconService=s.getContainer().get(S.vK.IIconService),this.fontService=s.getContainer().get(S.vK.IFontService),this.cameraService=s.getContainer().get(S.vK.ICameraService),this.layerService=s.getContainer().get(S.vK.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return(0,Q.Z)(n,[{key:"getBlend",value:function(){var a=this.layer.getLayerConfig(),u=a.blend,l=u===void 0?"normal":u;return xa[S.BlendType[l]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.duration||4,a.interval||.2,a.trailLength||.1]}},{key:"startModelAnimate",value:function(){var a=this.layer.getLayerConfig(),u=a.animateOption;u.enable&&this.layer.setAnimateStartTime()}}]),n}(),wl=(0,Rn.Z)($u.prototype,"configService",[Ia],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Po=(0,Rn.Z)($u.prototype,"shaderModuleService",[Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$u),$n=_(49682),js=_(61829),Ho=_.n(js),Wa=_(90208);function Xa(){var n=new Wa.WT(2);return Wa.WT!=Float32Array&&(n[0]=0,n[1]=0),n}function Wo(n){var s=new glMatrix.ARRAY_TYPE(2);return s[0]=n[0],s[1]=n[1],s}function Ya(n,s){var a=new Wa.WT(2);return a[0]=n,a[1]=s,a}function bu(n,s){return n[0]=s[0],n[1]=s[1],n}function Il(n,s,a){return n[0]=s,n[1]=a,n}function So(n,s,a){return n[0]=s[0]+a[0],n[1]=s[1]+a[1],n}function Ze(n,s,a){return n[0]=s[0]-a[0],n[1]=s[1]-a[1],n}function Nt(n,s,a){return n[0]=s[0]*a[0],n[1]=s[1]*a[1],n}function mr(n,s,a){return n[0]=s[0]/a[0],n[1]=s[1]/a[1],n}function zn(n,s){return n[0]=Math.ceil(s[0]),n[1]=Math.ceil(s[1]),n}function oa(n,s){return n[0]=Math.floor(s[0]),n[1]=Math.floor(s[1]),n}function Sa(n,s,a){return n[0]=Math.min(s[0],a[0]),n[1]=Math.min(s[1],a[1]),n}function wa(n,s,a){return n[0]=Math.max(s[0],a[0]),n[1]=Math.max(s[1],a[1]),n}function sa(n,s){return n[0]=Math.round(s[0]),n[1]=Math.round(s[1]),n}function Ta(n,s,a){return n[0]=s[0]*a,n[1]=s[1]*a,n}function ss(n,s,a,u){return n[0]=s[0]+a[0]*u,n[1]=s[1]+a[1]*u,n}function As(n,s){var a=s[0]-n[0],u=s[1]-n[1];return Math.hypot(a,u)}function ja(n,s){var a=s[0]-n[0],u=s[1]-n[1];return a*a+u*u}function Xl(n){var s=n[0],a=n[1];return Math.hypot(s,a)}function Su(n){var s=n[0],a=n[1];return s*s+a*a}function us(n,s){return n[0]=-s[0],n[1]=-s[1],n}function Ol(n,s){return n[0]=1/s[0],n[1]=1/s[1],n}function _s(n,s){var a=s[0],u=s[1],l=a*a+u*u;return l>0&&(l=1/Math.sqrt(l)),n[0]=s[0]*l,n[1]=s[1]*l,n}function Eu(n,s){return n[0]*s[0]+n[1]*s[1]}function wu(n,s,a){var u=s[0]*a[1]-s[1]*a[0];return n[0]=n[1]=0,n[2]=u,n}function Tl(n,s,a,u){var l=s[0],d=s[1];return n[0]=l+u*(a[0]-l),n[1]=d+u*(a[1]-d),n}function Zs(n,s){s=s||1;var a=glMatrix.RANDOM()*2*Math.PI;return n[0]=Math.cos(a)*s,n[1]=Math.sin(a)*s,n}function tf(n,s,a){var u=s[0],l=s[1];return n[0]=a[0]*u+a[2]*l,n[1]=a[1]*u+a[3]*l,n}function Lc(n,s,a){var u=s[0],l=s[1];return n[0]=a[0]*u+a[2]*l+a[4],n[1]=a[1]*u+a[3]*l+a[5],n}function ma(n,s,a){var u=s[0],l=s[1];return n[0]=a[0]*u+a[3]*l+a[6],n[1]=a[1]*u+a[4]*l+a[7],n}function zu(n,s,a){var u=s[0],l=s[1];return n[0]=a[0]*u+a[4]*l+a[12],n[1]=a[1]*u+a[5]*l+a[13],n}function rf(n,s,a,u){var l=s[0]-a[0],d=s[1]-a[1],y=Math.sin(u),w=Math.cos(u);return n[0]=l*w-d*y+a[0],n[1]=l*y+d*w+a[1],n}function bf(n,s){var a=n[0],u=n[1],l=s[0],d=s[1],y=Math.sqrt(a*a+u*u)*Math.sqrt(l*l+d*d),w=y&&(a*l+u*d)/y;return Math.acos(Math.min(Math.max(w,-1),1))}function rh(n){return n[0]=0,n[1]=0,n}function kf(n){return"vec2("+n[0]+", "+n[1]+")"}function no(n,s){return n[0]===s[0]&&n[1]===s[1]}function Yl(n,s){var a=n[0],u=n[1],l=s[0],d=s[1];return Math.abs(a-l)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(u-d)<=glMatrix.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))}var hu=null,po=Ze,nf=null,Cs=null,Ju=null,Qu=null,Rc=null,Tu=function(){var n=Xa();return function(s,a,u,l,d,y){var w,P;for(a||(a=2),u||(u=0),l?P=Math.min(l*a+u,s.length):P=s.length,w=u;w<P;w+=a)n[0]=s[w],n[1]=s[w+1],d(n,n,y),s[w]=n[0],s[w+1]=n[1];return s}}(),Vs=Xa(),af=Xa(),Eo=Xa(),la=Xa(),Ll=Xa();function of(n,s,a,u,l){So(n,a,u),_s(n,n),s=Ya(-n[1],n[0]);var d=Ya(-a[1],a[0]);return[l/Eu(s,d),s]}function pu(n,s){return Il(n,-s[1],s[0])}function qu(n,s,a){return po(n,s,a),_s(n,n),n}function Dc(n,s){return n[0]===s[0]&&n[1]===s[1]}function kc(n){for(var s=new Map,a=0;a<n.length;a++){var u=n[0].toString()+"-"+n[1].toString();s.get(u)?(n.splice(a,1),a++):s.set(u,u)}return n}var Rl=function(){function n(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,fe.Z)(this,n),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=Ya(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=s.join||"miter",this.cap=s.cap||"butt",this.miterLimit=s.miterLimit||10,this.thickness=s.thickness||1,this.dash=s.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return(0,Q.Z)(n,[{key:"extrude_gaode2",value:function(a,u){var l=this.complex;if(a.length<=1)return l;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var d=a.length,y=l.startIndex,w=1;w<d;w++){var P=a[w-1],k=u[w-1],$=a[w],W=u[w],me=w<a.length-1?a[w+1]:null,Je=w<u.length-1?u[w+1]:null,pt=this.segment_gaode2(l,y,P,$,me,k,W,Je);y+=pt}if(this.dash)for(var Zt=0;Zt<l.positions.length/6;Zt++)l.positions[Zt*6+5]=this.totalDistance;return l.startIndex=l.positions.length/6,l}},{key:"extrude",value:function(a){var u=this.complex;if(a.length<=1)return u;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var l=a.length,d=u.startIndex,y=1;y<l;y++){var w=a[y-1],P=a[y],k=y<a.length-1?a[y+1]:null,$=this.segment(u,d,w,P,k);d+=$}if(this.dash)for(var W=0;W<u.positions.length/6;W++)u.positions[W*6+5]=this.totalDistance;return u.startIndex=u.positions.length/6,u}},{key:"segment_gaode2",value:function(a,u,l,d,y,w,P,k){var $=0,W=a.indices,me=a.positions,Je=a.normals,pt=this.cap==="square",Zt=this.join==="bevel",Pr=(0,Xe.Z)([P[0],P[1]]),Mr=(0,Xe.Z)([w[0],w[1]]);qu(Eo,d,l);var hn=0;if(this.dash&&(hn=this.lineSegmentDistance(Pr,Mr),this.totalDistance+=hn),this.normal||(this.normal=Xa(),pu(this.normal,Eo)),!this.started)if(this.started=!0,pt){var dn=Xa(),Fn=Xa();So(dn,this.normal,Eo),So(Fn,this.normal,Eo),Je.push(Fn[0],Fn[1],0),Je.push(dn[0],dn[1],0),me.push(l[0],l[1],0,this.totalDistance-hn,-this.thickness,0),me.push(l[0],l[1],0,this.totalDistance-hn,this.thickness,0)}else this.extrusions(me,Je,l,this.normal,this.thickness,this.totalDistance-hn);if(W.push(u+0,u+1,u+2),y){Dc(d,y)&&So(y,d,_s(y,Ze(y,d,l))),qu(la,y,d);var ti=of(Ll,Xa(),Eo,la,this.thickness),$i=(0,ie.Z)(ti,2),Ca=$i[0],ka=$i[1],di=Eu(Ll,this.normal)<0?-1:1,_a=Zt;if(!_a&&this.join==="miter"){var to=Ca;to>this.miterLimit&&(_a=!0)}_a?(Je.push(this.normal[0],this.normal[1],0),Je.push(ka[0],ka[1],0),me.push(d[0],d[1],0,this.totalDistance,-this.thickness*di,0),me.push(d[0],d[1],0,this.totalDistance,this.thickness*di,0),W.push.apply(W,(0,$n.Z)(this.lastFlip!==-di?[u,u+2,u+3]:[u+2,u+1,u+3])),W.push(u+2,u+3,u+4),pu(Vs,la),bu(this.normal,Vs),Je.push(this.normal[0],this.normal[1],0),me.push(d[0],d[1],0,this.totalDistance,-this.thickness*di,0),$+=3):(this.extrusions(me,Je,d,ka,Ca,this.totalDistance),W.push.apply(W,(0,$n.Z)(this.lastFlip===1?[u,u+2,u+3]:[u+2,u+1,u+3])),di=-1,bu(this.normal,ka),$+=2),this.lastFlip=di}else{if(pu(this.normal,Eo),pt){var Xn=Xa(),Zi=Xa();po(Zi,Eo,this.normal),So(Xn,Eo,this.normal),Je.push(Zi[0],Zi[1],0),Je.push(Xn[0],Xn[1],0),me.push(d[0],d[1],0,this.totalDistance,this.thickness,0),me.push(d[0],d[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(me,Je,d,this.normal,this.thickness,this.totalDistance);W.push.apply(W,(0,$n.Z)(this.lastFlip===1?[u,u+2,u+3]:[u+2,u+1,u+3])),$+=2}return $}},{key:"segment",value:function(a,u,l,d,y){var w=0,P=a.indices,k=a.positions,$=a.normals,W=this.cap==="square",me=this.join==="bevel",Je=(0,Xe.Z)([d[0],d[1]]),pt=(0,Xe.Z)([l[0],l[1]]);qu(Eo,Je,pt);var Zt=0;if(this.dash&&(Zt=this.lineSegmentDistance(Je,pt),this.totalDistance+=Zt),this.normal||(this.normal=Xa(),pu(this.normal,Eo)),!this.started)if(this.started=!0,W){var Pr=Xa(),Mr=Xa();So(Pr,this.normal,Eo),So(Mr,this.normal,Eo),$.push(Mr[0],Mr[1],0),$.push(Pr[0],Pr[1],0),k.push(l[0],l[1],0,this.totalDistance-Zt,-this.thickness,0),k.push(l[0],l[1],0,this.totalDistance-Zt,this.thickness,0)}else this.extrusions(k,$,l,this.normal,this.thickness,this.totalDistance-Zt);if(P.push(u+0,u+1,u+2),y){var Fn=(0,Xe.Z)([y[0],y[1]]);Dc(Je,Fn)&&So(Fn,Je,_s(Fn,Ze(Fn,Je,pt))),qu(la,Fn,Je);var Xn=of(Ll,Xa(),Eo,la,this.thickness),Zi=(0,ie.Z)(Xn,2),ti=Zi[0],$i=Zi[1],Ca=Eu(Ll,this.normal)<0?-1:1,ka=me;if(!ka&&this.join==="miter"){var di=ti;di>this.miterLimit&&(ka=!0)}ka?($.push(this.normal[0],this.normal[1],0),$.push($i[0],$i[1],0),k.push(d[0],d[1],0,this.totalDistance,-this.thickness*Ca,0),k.push(d[0],d[1],0,this.totalDistance,this.thickness*Ca,0),P.push.apply(P,(0,$n.Z)(this.lastFlip!==-Ca?[u,u+2,u+3]:[u+2,u+1,u+3])),P.push(u+2,u+3,u+4),pu(Vs,la),bu(this.normal,Vs),$.push(this.normal[0],this.normal[1],0),k.push(d[0],d[1],0,this.totalDistance,-this.thickness*Ca,0),w+=3):(this.extrusions(k,$,d,$i,ti,this.totalDistance),P.push.apply(P,(0,$n.Z)(this.lastFlip===1?[u,u+2,u+3]:[u+2,u+1,u+3])),Ca=-1,bu(this.normal,$i),w+=2),this.lastFlip=Ca}else{if(pu(this.normal,Eo),W){var hn=Xa(),dn=Xa();po(dn,Eo,this.normal),So(hn,Eo,this.normal),$.push(dn[0],dn[1],0),$.push(hn[0],hn[1],0),k.push(d[0],d[1],0,this.totalDistance,this.thickness,0),k.push(d[0],d[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(k,$,d,this.normal,this.thickness,this.totalDistance);P.push.apply(P,(0,$n.Z)(this.lastFlip===1?[u,u+2,u+3]:[u+2,u+1,u+3])),w+=2}return w}},{key:"extrusions",value:function(a,u,l,d,y,w){u.push(d[0],d[1],0),u.push(d[0],d[1],0),a.push(l[0],l[1],0,w,-y,0),a.push(l[0],l[1],0,w,y,0)}},{key:"lineSegmentDistance",value:function(a,u){var l=u[0]-a[0],d=u[1]-a[1];return Math.sqrt(l*l+d*d)}}]),n}(),Al=_(81763),Au=_.n(Al);function Cu(n){if(Au()(n[0]))return n;if(Au()(n[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Au()(n[0][0][0])){var s=n,a=0,u=0,l=0;return s.forEach(function(d){d.forEach(function(y){a+=y[0],u+=y[1],l++})}),[a/l,u/l,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function du(){var n=new Wa.WT(3);return Wa.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function el(n){var s=new Wa.WT(3);return s[0]=n[0],s[1]=n[1],s[2]=n[2],s}function Kl(n){var s=n[0],a=n[1],u=n[2];return Math.hypot(s,a,u)}function eu(n,s,a){var u=new Wa.WT(3);return u[0]=n,u[1]=s,u[2]=a,u}function tu(n,s){return n[0]=s[0],n[1]=s[1],n[2]=s[2],n}function Fc(n,s,a,u){return n[0]=s,n[1]=a,n[2]=u,n}function zc(n,s,a){return n[0]=s[0]+a[0],n[1]=s[1]+a[1],n[2]=s[2]+a[2],n}function mc(n,s,a){return n[0]=s[0]-a[0],n[1]=s[1]-a[1],n[2]=s[2]-a[2],n}function Nu(n,s,a){return n[0]=s[0]*a[0],n[1]=s[1]*a[1],n[2]=s[2]*a[2],n}function Cl(n,s,a){return n[0]=s[0]/a[0],n[1]=s[1]/a[1],n[2]=s[2]/a[2],n}function $l(n,s){return n[0]=Math.ceil(s[0]),n[1]=Math.ceil(s[1]),n[2]=Math.ceil(s[2]),n}function tl(n,s){return n[0]=Math.floor(s[0]),n[1]=Math.floor(s[1]),n[2]=Math.floor(s[2]),n}function Dl(n,s,a){return n[0]=Math.min(s[0],a[0]),n[1]=Math.min(s[1],a[1]),n[2]=Math.min(s[2],a[2]),n}function Nc(n,s,a){return n[0]=Math.max(s[0],a[0]),n[1]=Math.max(s[1],a[1]),n[2]=Math.max(s[2],a[2]),n}function rl(n,s){return n[0]=Math.round(s[0]),n[1]=Math.round(s[1]),n[2]=Math.round(s[2]),n}function Bc(n,s,a){return n[0]=s[0]*a,n[1]=s[1]*a,n[2]=s[2]*a,n}function sf(n,s,a,u){return n[0]=s[0]+a[0]*u,n[1]=s[1]+a[1]*u,n[2]=s[2]+a[2]*u,n}function Uc(n,s){var a=s[0]-n[0],u=s[1]-n[1],l=s[2]-n[2];return Math.hypot(a,u,l)}function Pl(n,s){var a=s[0]-n[0],u=s[1]-n[1],l=s[2]-n[2];return a*a+u*u+l*l}function Mo(n){var s=n[0],a=n[1],u=n[2];return s*s+a*a+u*u}function gc(n,s){return n[0]=-s[0],n[1]=-s[1],n[2]=-s[2],n}function jc(n,s){return n[0]=1/s[0],n[1]=1/s[1],n[2]=1/s[2],n}function nl(n,s){var a=s[0],u=s[1],l=s[2],d=a*a+u*u+l*l;return d>0&&(d=1/Math.sqrt(d)),n[0]=s[0]*d,n[1]=s[1]*d,n[2]=s[2]*d,n}function Zc(n,s){return n[0]*s[0]+n[1]*s[1]+n[2]*s[2]}function Pu(n,s,a){var u=s[0],l=s[1],d=s[2],y=a[0],w=a[1],P=a[2];return n[0]=l*P-d*w,n[1]=d*y-u*P,n[2]=u*w-l*y,n}function Aa(n,s,a,u){var l=s[0],d=s[1],y=s[2];return n[0]=l+u*(a[0]-l),n[1]=d+u*(a[1]-d),n[2]=y+u*(a[2]-y),n}function Jl(n,s,a,u,l,d){var y=d*d,w=y*(2*d-3)+1,P=y*(d-2)+d,k=y*(d-1),$=y*(3-2*d);return n[0]=s[0]*w+a[0]*P+u[0]*k+l[0]*$,n[1]=s[1]*w+a[1]*P+u[1]*k+l[1]*$,n[2]=s[2]*w+a[2]*P+u[2]*k+l[2]*$,n}function Bu(n,s,a,u,l,d){var y=1-d,w=y*y,P=d*d,k=w*y,$=3*d*w,W=3*P*y,me=P*d;return n[0]=s[0]*k+a[0]*$+u[0]*W+l[0]*me,n[1]=s[1]*k+a[1]*$+u[1]*W+l[1]*me,n[2]=s[2]*k+a[2]*$+u[2]*W+l[2]*me,n}function il(n,s){s=s||1;var a=Wa.FD()*2*Math.PI,u=Wa.FD()*2-1,l=Math.sqrt(1-u*u)*s;return n[0]=Math.cos(a)*l,n[1]=Math.sin(a)*l,n[2]=u*s,n}function ji(n,s,a){var u=s[0],l=s[1],d=s[2],y=a[3]*u+a[7]*l+a[11]*d+a[15];return y=y||1,n[0]=(a[0]*u+a[4]*l+a[8]*d+a[12])/y,n[1]=(a[1]*u+a[5]*l+a[9]*d+a[13])/y,n[2]=(a[2]*u+a[6]*l+a[10]*d+a[14])/y,n}function Ea(n,s,a){var u=s[0],l=s[1],d=s[2];return n[0]=u*a[0]+l*a[3]+d*a[6],n[1]=u*a[1]+l*a[4]+d*a[7],n[2]=u*a[2]+l*a[5]+d*a[8],n}function Gs(n,s,a){var u=a[0],l=a[1],d=a[2],y=a[3],w=s[0],P=s[1],k=s[2],$=l*k-d*P,W=d*w-u*k,me=u*P-l*w,Je=l*me-d*W,pt=d*$-u*me,Zt=u*W-l*$,Pr=y*2;return $*=Pr,W*=Pr,me*=Pr,Je*=2,pt*=2,Zt*=2,n[0]=w+$+Je,n[1]=P+W+pt,n[2]=k+me+Zt,n}function Ql(n,s,a,u){var l=[],d=[];return l[0]=s[0]-a[0],l[1]=s[1]-a[1],l[2]=s[2]-a[2],d[0]=l[0],d[1]=l[1]*Math.cos(u)-l[2]*Math.sin(u),d[2]=l[1]*Math.sin(u)+l[2]*Math.cos(u),n[0]=d[0]+a[0],n[1]=d[1]+a[1],n[2]=d[2]+a[2],n}function kl(n,s,a,u){var l=[],d=[];return l[0]=s[0]-a[0],l[1]=s[1]-a[1],l[2]=s[2]-a[2],d[0]=l[2]*Math.sin(u)+l[0]*Math.cos(u),d[1]=l[1],d[2]=l[2]*Math.cos(u)-l[0]*Math.sin(u),n[0]=d[0]+a[0],n[1]=d[1]+a[1],n[2]=d[2]+a[2],n}function ql(n,s,a,u){var l=[],d=[];return l[0]=s[0]-a[0],l[1]=s[1]-a[1],l[2]=s[2]-a[2],d[0]=l[0]*Math.cos(u)-l[1]*Math.sin(u),d[1]=l[0]*Math.sin(u)+l[1]*Math.cos(u),d[2]=l[2],n[0]=d[0]+a[0],n[1]=d[1]+a[1],n[2]=d[2]+a[2],n}function Sf(n,s){var a=n[0],u=n[1],l=n[2],d=s[0],y=s[1],w=s[2],P=Math.sqrt(a*a+u*u+l*l),k=Math.sqrt(d*d+y*y+w*w),$=P*k,W=$&&Zc(n,s)/$;return Math.acos(Math.min(Math.max(W,-1),1))}function Ff(n){return n[0]=0,n[1]=0,n[2]=0,n}function ec(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function al(n,s){return n[0]===s[0]&&n[1]===s[1]&&n[2]===s[2]}function ol(n,s){var a=n[0],u=n[1],l=n[2],d=s[0],y=s[1],w=s[2];return Math.abs(a-d)<=Wa.Ib*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-y)<=Wa.Ib*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-w)<=Wa.Ib*Math.max(1,Math.abs(l),Math.abs(w))}var Ka=mc,xs=Nu,Fl=Cl,io=Uc,En=Pl,Ps=Kl,tc=Mo,Mu=function(){var n=du();return function(s,a,u,l,d,y){var w,P;for(a||(a=3),u||(u=0),l?P=Math.min(l*a+u,s.length):P=s.length,w=u;w<P;w+=a)n[0]=s[w],n[1]=s[w+1],n[2]=s[w+2],d(n,n,y),s[w]=n[0],s[w+1]=n[1],s[w+2]=n[2];return s}}();function ru(n){var s=n[0][0],a=n[0][n[0].length-1];s[0]===a[0]&&s[1]===a[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var u=n[0].length,l=Ho().flatten(n),d=l.vertices,y=l.dimensions,w=[],P=[],k=0;k<d.length/y;k++)y===2?w.push(d[k*2],d[k*2+1],1):w.push(d[k*3],d[k*3+1],1);var $=Ho()(l.vertices,l.holes,l.dimensions);P.push.apply(P,(0,$n.Z)($));for(var W=function(pt){var Zt=l.vertices.slice(pt*y,(pt+1)*y),Pr=l.vertices.slice((pt+1)*y,(pt+2)*y);Pr.length===0&&(Pr=l.vertices.slice(0,y));var Mr=w.length/3;w.push(Zt[0],Zt[1],1,Pr[0],Pr[1],1,Zt[0],Zt[1],0,Pr[0],Pr[1],0),P.push.apply(P,(0,$n.Z)([0,2,1,2,3,1].map(function(hn){return hn+Mr})))},me=0;me<u;me++)W(me);return{positions:w,index:P}}function Hs(n){var s=Ho().flatten(n),a=Ho()(s.vertices,s.holes,s.dimensions);return{positions:s.vertices,index:a}}function sl(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=n[0][0],u=n[0][n[0].length-1];a[0]===u[0]&&a[1]===u[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var l=n[0].length,d=Ho().flatten(n),y=d.vertices,w=d.dimensions,P=[],k=[],$=[],W=0;W<y.length/w;W++)w===2?P.push(y[W*2],y[W*2+1],1,-1,-1):P.push(y[W*3],y[W*3+1],1,-1,-1),$.push(0,0,1);var me=Ho()(d.vertices,d.holes,d.dimensions);k.push.apply(k,(0,$n.Z)(me));for(var Je=function(Pr){var Mr=d.vertices.slice(Pr*w,(Pr+1)*w),hn=d.vertices.slice((Pr+1)*w,(Pr+2)*w);hn.length===0&&(hn=d.vertices.slice(0,w));var dn=P.length/5;P.push(Mr[0],Mr[1],1,0,0,hn[0],hn[1],1,.1,0,Mr[0],Mr[1],0,0,.8,hn[0],hn[1],0,.1,.8);var Fn=Qr([hn[0],hn[1],1],[Mr[0],Mr[1],0],[Mr[0],Mr[1],1],s);$.push.apply($,(0,$n.Z)(Fn).concat((0,$n.Z)(Fn),(0,$n.Z)(Fn),(0,$n.Z)(Fn))),k.push.apply(k,(0,$n.Z)([1,2,0,3,2,1].map(function(Xn){return Xn+dn})))},pt=0;pt<l;pt++)Je(pt);return{positions:P,index:k,normals:$}}function Qr(n,s,a){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=du(),d=du(),y=du();u&&(n=(0,Xe.vP)(n),s=(0,Xe.vP)(s),a=(0,Xe.vP)(a));var w=eu.apply(X,(0,$n.Z)(n)),P=eu.apply(X,(0,$n.Z)(s)),k=eu.apply(X,(0,$n.Z)(a));Ka(l,k,P),Ka(d,w,P),Pu(y,l,d);var $=du();return nl($,y),$}var Ms,Iu;(function(n){n.CYLINDER="cylinder",n.SQUARECOLUMN="squareColumn",n.TRIANGLECOLUMN="triangleColumn",n.HEXAGONCOLUMN="hexagonColumn",n.PENTAGONCOLUMN="pentagonColumn"})(Iu||(Iu={}));var Is;(function(n){n.CIRCLE="circle",n.SQUARE="square",n.TRIANGLE="triangle",n.HEXAGON="hexagon",n.PENTAGON="pentagon"})(Is||(Is={}));function ls(n){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Math.PI*2/n,u=[],l=0;l<n;l++)u.push(a*l+s*Math.PI/12);var d=u.map(function(y){var w=Math.sin(y+Math.PI/4),P=Math.cos(y+Math.PI/4);return[w,P,0]});return d}function bs(){return ls(30)}function yc(){return ls(4)}function _c(){return ls(3)}function Os(){return ls(6,1)}function Uu(){return ls(5)}var vu=(Ms={},(0,F.Z)(Ms,Is.CIRCLE,bs),(0,F.Z)(Ms,Is.HEXAGON,Os),(0,F.Z)(Ms,Is.TRIANGLE,_c),(0,F.Z)(Ms,Is.SQUARE,yc),(0,F.Z)(Ms,Is.PENTAGON,Uu),(0,F.Z)(Ms,Iu.CYLINDER,bs),(0,F.Z)(Ms,Iu.HEXAGONCOLUMN,Os),(0,F.Z)(Ms,Iu.TRIANGLECOLUMN,_c),(0,F.Z)(Ms,Iu.SQUARECOLUMN,yc),(0,F.Z)(Ms,Iu.PENTAGONCOLUMN,Uu),Ms),nu={};function xc(n){var s=Cu(n.coordinates);return{vertices:[].concat((0,$n.Z)(s),(0,$n.Z)(s),(0,$n.Z)(s),(0,$n.Z)(s)),indices:[0,1,2,2,3,0],size:s.length}}function rc(n){var s=n.shape,a=mu(s,!1),u=a.positions,l=a.index,d=a.normals;return{vertices:u,indices:l,normals:d,size:5}}function iu(n){var s=Cu(n.coordinates);return{vertices:(0,$n.Z)(s),indices:[0],size:s.length}}function Ls(n){var s=n.coordinates,a=n.originCoordinates,u=n.version,l=new Rl({dash:!0,join:"bevel"});if(u==="GAODE2.x"){var d=s;Array.isArray(d[0][0])||(d=[s]);var y=a;Array.isArray(y[0][0])||(y=[a]);for(var w=0;w<d.length;w++){var P=d[w],k=y[w];l.extrude_gaode2(P,k)}}else{var $=s;Array.isArray($[0][0])||($=[s]),$.forEach(function(me){l.extrude(me)})}var W=l.complex;return{vertices:W.positions,indices:W.indices,normals:W.normals,size:6}}function Di(n){var s=n.coordinates,a=Ho().flatten(s),u=a.vertices,l=a.dimensions,d=a.holes;return{indices:Ho()(u,d,l),vertices:u,size:l}}function Ws(n){var s=n.coordinates,a=sl(s,!0),u=a.positions,l=a.index,d=a.normals;return{vertices:u,indices:l,normals:d,size:5}}function Uo(n){var s=n.shape,a=Mn(s),u=a.positions,l=a.index;return{vertices:u,indices:l,size:3}}function vo(n){var s=n.coordinates,a=[].concat((0,$n.Z)(s[0]),[0,0,1,s[1][0],s[0][1],0,1,1],(0,$n.Z)(s[1]),[0,1,0],(0,$n.Z)(s[0]),[0,0,1],(0,$n.Z)(s[1]),[0,1,0,s[0][0],s[1][1],0,0,0]),u=[0,1,2,3,4,5];return{vertices:a,indices:u,size:5}}function ju(n){for(var s=30,a=n.coordinates,u=[],l=[],d=function(P){u.push(P,1,P,a[0][0],a[0][1],a[1][0],a[1][1],P,-1,P,a[0][0],a[0][1],a[1][0],a[1][1]),P!==s-1&&l.push.apply(l,(0,$n.Z)([0,1,2,1,3,2].map(function(k){return P*2+k})))},y=0;y<s;y++)d(y);return{vertices:u,indices:l,size:7}}function ul(n){var s=n.coordinates;s.length===2&&s.push(0);var a=n.size,u=ll(-1,1),l=ll(1,1),d=ll(-1,-1),y=ll(1,-1),w=[].concat((0,$n.Z)(s),(0,$n.Z)(u),(0,$n.Z)(s),(0,$n.Z)(d),(0,$n.Z)(s),(0,$n.Z)(y),(0,$n.Z)(s),(0,$n.Z)(l)),P=[0,1,2,3,0,2];return{vertices:w,indices:P,size:5}}function mu(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(nu&&nu[n])return nu[n];var a=vu[n]?vu[n]():vu.cylinder(),u=sl([a],s);return nu[n]=u,u}function cs(n,s){for(var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=new Float32Array(n.length/a*3),d,y,w,P=vec3.create(),k=vec3.create(),$=vec3.create(),W=0,me=s.length;W<me;W+=3){d=s[W+0]*3,y=s[W+1]*3,w=s[W+2]*3;var Je=[n[d],n[d+1]],pt=[n[y],n[y+1]],Zt=[n[w],n[w+1]];u&&(Je=lngLatToMeters(Je),pt=lngLatToMeters(pt),Zt=lngLatToMeters(Zt));var Pr=Je,Mr=_slicedToArray(Pr,2),hn=Mr[0],dn=Mr[1],Fn=vec3.fromValues(hn,dn,n[d+2]),Xn=pt,Zi=_slicedToArray(Xn,2),ti=Zi[0],$i=Zi[1],Ca=vec3.fromValues(ti,$i,n[y+2]),ka=Zt,di=_slicedToArray(ka,2),_a=di[0],to=di[1],Ku=vec3.fromValues(_a,to,n[w+2]);vec3.sub(P,Ku,Ca),vec3.sub(k,Fn,Ca),vec3.cross($,P,k),l[d]+=P[0],l[d+1]+=P[1],l[d+2]+=P[2],l[y]+=P[0],l[y+1]+=P[1],l[y+2]+=P[2],l[w]+=P[0],l[w+1]+=P[1],l[w+2]+=P[2]}return zl(l),l}function zl(n){for(var s=0,a=n.length;s<a;s+=3){var u=vec3.fromValues(n[s],n[s+1],n[s+2]),l=vec3.create();vec3.normalize(l,u),n.set(l,s)}}function Gn(n){var s=n[0][0],a=n[0][n[0].length-1];return s[0]===a[0]&&s[1]===a[1]}function Mn(n){var s=["cylinder","triangleColumn","hexagonColumn","squareColumn"],a=vu[n]?vu[n]():vu.circle(),u=s.indexOf(n)===-1?Hs([a]):ru([a]);return u}function ll(n,s){var a=(n+1)/2,u=(s+1)/2;return[a,u]}function fs(n){var s=Io();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Io(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var jo=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Zu=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;
uniform mat4 u_Mvp;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,gu=function(n){(0,we.Z)(a,n);var s=fs(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=d===void 0?1:d,w=l.baseColor,P=w===void 0?"rgb(16,16,16)":w,k=l.brightColor,$=k===void 0?"rgb(255,176,38)":k,W=l.windowColor,me=W===void 0?"rgb(30,60,89)":W,Je=l.time,pt=Je===void 0?0:Je;return{u_opacity:y,u_baseColor:(0,Xe.CI)(P),u_brightColor:(0,Xe.CI)($),u_windowColor:(0,Xe.CI)(me),u_time:this.layer.getLayerAnimateTime()||pt}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Zu,fragmentShader:jo,triangulation:Ws})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y,w,P,k){return k}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.size,$=k===void 0?10:k;return Array.isArray($)?[$[0]]:[$]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(d,y,w,P){var k=d.size;return[w[3],w[4]]}}})}}]),a}(ba);function Nl(n){var s=Yi();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Yi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ao=function(n){(0,we.Z)(a,n);var s=Nl(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.type="PolygonLayer",u}return(0,Q.Z)(a,[{key:"buildModels",value:function(){this.layerModel=new gu(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(l){this.updateLayerConfig({time:l})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),a}(va);function Vc(n){var s=cl();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function cl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var bc=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
uniform mat4 u_Mvp;\r
varying vec4 v_color;\r
\r
uniform vec2 u_SceneCenterMKT;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  // gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\r
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807\r
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));\r
    gl_Position = u_Mvp * (project_pos);\r
  } else {\r
     vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
    gl_Position = project_common_position_to_clipspace(project_pos);\r
  }\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,Vu=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Rs=function(n){(0,we.Z)(a,n);var s=Vc(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.coverage,w=l.angle;return{u_opacity:d||1,u_coverage:y||.9,u_angle:w||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:bc,fragmentShader:Vu,triangulation:Uo,depth:{enable:!1},primitive:S.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y){var w=d.version==="GAODE2.x"?d.originCoordinates:d.coordinates;return[w[0],w[1],0]}}})}}]),a}(ba);function nc(n){var s=hs();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function hs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Sc=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"


void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
  // vec2 lnglat = (a_Pos.xy + offset); 
  // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  // gl_Position = project_common_position_to_clipspace(project_pos);
  // float lightWeight = calc_lighting(project_pos);
  // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 lnglat = (a_Pos.xy + offset); 
    // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));

    // float lightWeight = calc_lighting(project_pos);
    // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    // gl_Position = u_Mvp * vec4(lnglat , a_Position.z * a_Size, 1.0);
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u7ECF\u7EAC\u5EA6
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807
    vec4 project_pos = project_position(vec4(customLnglat, a_Position.z * a_Size, 1.0));

    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    gl_Position = u_Mvp * vec4(customLnglat , a_Position.z * a_Size, 1.0);
  } else {
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
    vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
    
    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
    
    gl_Position = project_common_position_to_clipspace(project_pos);
  }



  setPickingColor(a_PickingColor);
}
`,Bl=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ic=function(n){(0,we.Z)(a,n);var s=nc(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.coverage,w=l.angle;return{u_opacity:d||1,u_coverage:y||1,u_angle:w||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Sc,fragmentShader:Bl,triangulation:rc,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.size;return Array.isArray(k)?[k[0]]:[k]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y,w,P,k){return k}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y){var w=d.version==="GAODE2.x"?d.originCoordinates:d.coordinates;return[w[0],w[1],0]}}})}}]),a}(ba),Oa=_(98604);function ac(n,s){for(var a=[],u=[],l=[],d=n+1,y=s+1,w=n/2,P=s/2,k=0;k<y;k++)for(var $=k-P,W=0;W<d;W++){var me=W-w;u.push(me/w,-$/P,0),l.push(W/n),l.push(1-k/s)}for(var Je=0;Je<s;Je++)for(var pt=0;pt<n;pt++){var Zt=pt+d*Je,Pr=pt+d*(Je+1),Mr=pt+1+d*(Je+1),hn=pt+1+d*Je;a.push(Zt,Pr,hn),a.push(Pr,Mr,hn)}return{vertices:u,indices:a,uvs:l}}var fl,Ec;function hl(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function pl(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?hl(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):hl(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function Ul(n){var s=yu();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function yu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var au=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,Gc=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;


vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // \u5C06\u539F\u672C 0 -> 1 \u7684 uv \u8F6C\u6362\u4E3A -1 -> 1 \u7684\u6807\u51C6\u5750\u6807\u7A7A\u95F4\uFF08NDC\uFF09

  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y \u5E73\u9762\u4E0A\u7684\u70B9\uFF08z == 0\uFF09\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E09\u7EF4\u4E0A\u7684\u70B9\u88AB\u6295\u5F71\u5230\u5E73\u9762\u540E\u7684\u70B9
	vec4 p2 = vec4(pos, 1.0, 1.0); // \u5E73\u884C\u4E8Ex/y\u5E73\u9762\u3001z==1 \u7684\u5E73\u9762\u4E0A\u7684\u70B9

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // \u6839\u636E\u89C6\u56FE\u6295\u5F71\u77E9\u9635\u7684\u9006\u77E9\u9635\u5E73\u9762\u4E0A\u7684\u53CD\u7B97\u51FA\u4E09\u7EF4\u7A7A\u95F4\u4E2D\u7684\u70B9\uFF08p1\u5E73\u9762\u4E0A\u7684\u70B9\uFF09
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w; // \u5F52\u4E00\u5316\u64CD\u4F5C\uFF08\u5F52\u4E00\u5316\u540E\u4E3A\u4E16\u754C\u5750\u6807\uFF09
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0.0, 1.0, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);
 
}
`,wc=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,uf=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,Hc=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
        gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
        gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
}
`,c=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,o=(fl=(0,Et.b2)(),fl(Ec=function(n){(0,we.Z)(a,n);var s=Ul(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.texture=void 0,u.colorTexture=void 0,u.heatmapFramerBuffer=void 0,u.intensityModel=void 0,u.colorModel=void 0,u.shapeType=void 0,u}return(0,Q.Z)(a,[{key:"render",value:function(){var l=this,d=this.rendererService,y=d.clear,w=d.useFramebuffer;w(this.heatmapFramerBuffer,function(){y({color:[0,0,0,0],depth:1,stencil:0,framebuffer:l.heatmapFramerBuffer}),l.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var l,d=this.rendererService,y=d.createFramebuffer,w=d.clear,P=d.getViewportSize,k=d.createTexture2D,$=d.useFramebuffer,W=this.styleAttributeService.getLayerStyleAttribute("shape"),me=(W==null||(l=W.scale)===null||l===void 0?void 0:l.field)||"heatmap";this.shapeType=me,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=me==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Je=this.layer.getLayerConfig(),pt=Je.rampColors,Zt=(0,Xe.Cl)(pt),Pr=P(),Mr=Pr.width,hn=Pr.height;return this.heatmapFramerBuffer=y({color:k({width:Math.floor(Mr/4),height:Math.floor(hn/4),wrapS:S.gl.CLAMP_TO_EDGE,wrapT:S.gl.CLAMP_TO_EDGE,min:S.gl.LINEAR,mag:S.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:S.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(d,y,w,P){return[w[3],w[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.size,$=k===void 0?1:k;return[$]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:Hc,fragmentShader:uf,triangulation:ul,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:S.gl.ONE,srcAlpha:1,dstRGB:S.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:c,fs:wc});var l=this.shaderModuleService.getModule("heatmapColor"),d=l.vs,y=l.fs,w=l.uniforms,P=this.rendererService,k=P.createAttribute,$=P.createElements,W=P.createBuffer,me=P.createModel;return me({vs:d,fs:y,attributes:{a_Position:k({buffer:W({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:S.gl.FLOAT}),size:3}),a_Uv:k({buffer:W({data:[0,1,1,1,0,0,1,0],type:S.gl.FLOAT}),size:2})},uniforms:pl({},w),depth:{enable:!1},blend:this.getBlend(),count:6,elements:$({data:[0,2,1,2,3,1],type:S.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.intensity,w=y===void 0?10:y,P=l.radius,k=P===void 0?5:P;this.intensityModel.draw({uniforms:{u_opacity:d||1,u_radius:k,u_intensity:w}})}},{key:"drawColorMode",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity;this.colorModel.draw({uniforms:{u_opacity:d||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=Oa.create();Oa.invert(y,this.cameraService.getViewProjectionMatrixUncentered()),this.colorModel.draw({uniforms:{u_opacity:d||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:(0,$n.Z)(y)}})}},{key:"build3dHeatMap",value:function(){var l=this.rendererService.getViewportSize,d=l(),y=d.width,w=d.height,P=ac(y/4,w/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Gc,fs:au});var k=this.shaderModuleService.getModule("heatmap3dColor"),$=k.vs,W=k.fs,me=k.uniforms,Je=this.rendererService,pt=Je.createAttribute,Zt=Je.createElements,Pr=Je.createBuffer,Mr=Je.createModel;return Mr({vs:$,fs:W,attributes:{a_Position:pt({buffer:Pr({data:P.vertices,type:S.gl.FLOAT}),size:3}),a_Uv:pt({buffer:Pr({data:P.uvs,type:S.gl.FLOAT}),size:2})},primitive:S.gl.TRIANGLES,uniforms:pl({},me),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:S.gl.SRC_ALPHA,srcAlpha:1,dstRGB:S.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:Zt({data:P.indices,type:S.gl.UNSIGNED_INT,count:P.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var l=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var d=this.layer.getLayerConfig(),y=d.rampColors,w=(0,Xe.Cl)(y);this.colorTexture=l({data:new Uint8Array(w.data),width:w.width,height:w.height,wrapS:S.gl.CLAMP_TO_EDGE,wrapT:S.gl.CLAMP_TO_EDGE,min:S.gl.NEAREST,mag:S.gl.NEAREST,flipY:!1})}}]),a}(ba))||Ec);function i(n){var s=h();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function h(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var g=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,E=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
 
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xy, 0., 1.0));
    // gl_Position = u_Mvp * (vec4(a_Pos.xy + offset, 0., 1.0));
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT;
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));
    gl_Position = u_Mvp * vec4(project_pos.xy, 0.0, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,C=function(n){(0,we.Z)(a,n);var s=i(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.coverage,w=l.angle;return{u_opacity:d||1,u_coverage:y||.9,u_angle:w||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:E,fragmentShader:g,triangulation:Uo,depth:{enable:!1},primitive:S.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y){var w=d.version==="GAODE2.x"?d.originCoordinates:d.coordinates;return[w[0],w[1],0]}}})}}]),a}(ba),L={heatmap:o,heatmap3d:o,grid:Rs,grid3d:ic,hexagon:C},Z=L;function q(n){var s=de();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function de(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ge=function(n){(0,we.Z)(a,n);var s=q(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.type="HeatMapLayer",u}return(0,Q.Z)(a,[{key:"buildModels",value:function(){var l=this.getModelType();this.layerModel=new Z[l](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var l=this,d=this.getModelType();return d==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(y){return y.draw({uniforms:l.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var l,d=this.styleAttributeService.getLayerStyleAttribute("shape"),y=this.getLayerConfig(),w=y.shape3d,P=this.getSource(),k=P.data.type,$=(d==null||(l=d.scale)===null||l===void 0?void 0:l.field)||"heatmap";return $==="heatmap"||$==="heatmap3d"?"heatmap":k==="hexagon"?(w==null?void 0:w.indexOf($))===-1?"hexagon":"grid3d":k==="grid"?(w==null?void 0:w.indexOf($))===-1?"grid":"grid3d":"heatmap"}}]),a}(va);function be(n){var s=Ke();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Ke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var He=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,ut=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,We=function(n){(0,we.Z)(a,n);var s=be(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.texture=void 0,u}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity;return{u_opacity:d||1,u_texture:this.texture}}},{key:"initModels",value:function(){var l=this,d=this.layer.getSource(),y=this.rendererService.createTexture2D;return this.texture=y({height:0,width:0}),d.data.images.then(function(w){l.texture=y({data:w[0],width:w[0].width,height:w[0].height}),l.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:ut,fragmentShader:He,triangulation:vo,primitive:S.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(d,y,w,P){return[w[3],w[4]]}}})}}]),a}(ba),et={image:We},Pt=et;function Mt(n){var s=_r();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function _r(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var nr=function(n){(0,we.Z)(a,n);var s=Mt(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.type="ImageLayer",u}return(0,Q.Z)(a,[{key:"buildModels",value:function(){var l=this.getModelType();this.layerModel=new Pt[l](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var l=this.getModelType(),d={image:{}};return d[l]}},{key:"getModelType",value:function(){return"image"}}]),a}(va);function gr(n){var s=Er();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Er(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tn=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying float v_segmentIndex;
varying float v_arcDistrance;
varying float v_pixelLen;
varying float v_a;
varying vec2 v_offset;
varying vec2 v_iconMapUV;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6

  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / (segmentNumber - 1.0)));
    float count = floor(v_arcDistrance/v_pixelLen);

    float u = 1.0 - fract(arcRadio * count + animateSpeed);
    float alpha = 1.0;
    if(u_aimate.x == Animate) {
      u = gl_FragColor.a;
      alpha = gl_FragColor.a;
    }
    float v = length(v_offset)/(v_a); // \u6A2A\u5411
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
    gl_FragColor.a *= alpha;
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
  // gl_FragColor = filterColor(gl_FragColor);

}`,Vr=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;
varying float v_arcDistrance;
varying float v_pixelLen;
varying float v_a;
varying vec2 v_offset;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  

  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        v_distance_ratio = 1.0 - v_distance_ratio;
      }
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    v_segmentIndex = a_Position.x + 1.0;
    v_arcDistrance = length(source - target);
    v_iconMapUV = a_iconMapUV;
    v_pixelLen = project_pixel(u_icon_step);
    v_a = project_pixel(a_Size);
    v_offset = offset + offset * sign(a_Position.y);
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,mn={solid:0,dash:1},Sn=function(n){(0,we.Z)(a,n);var s=gr(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.texture=void 0,u.updateTexture=function(){var w=u.rendererService.createTexture2D;if(u.texture){u.texture.update({data:u.iconService.getCanvas()}),u.layer.render();return}u.texture=w({data:u.iconService.getCanvas(),mag:S.gl.NEAREST,min:S.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})},u}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.lineType,w=y===void 0?"solid":y,P=l.dashArray,k=P===void 0?[10,5]:P,$=l.forward,W=$===void 0?!0:$,me=l.lineTexture,Je=me===void 0?!1:me,pt=l.iconStep,Zt=pt===void 0?100:pt;return k.length===2&&k.push(0,0),this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:d||1,segmentNumber:30,u_line_type:mn[w||"solid"],u_dash_array:k,u_blur:.9,u_lineDir:W?1:-1,u_texture:this.texture,u_line_texture:Je?1:0,u_icon_step:Zt,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"getAnimateUniforms",value:function(){var l=this.layer.getLayerConfig(),d=l.animateOption;return{u_aimate:this.animateOption2Array(d),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Vr,fragmentShader:tn,triangulation:ju,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var l=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(y,w,P,k){var $=y.size,W=$===void 0?1:$;return Array.isArray(W)?[W[0]]:[W]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(y,w,P,k){return[P[3],P[4],P[5],P[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(y,w,P,k){var $=l.iconService.getIconMap(),W=y.texture,me=$[W]||{x:0,y:0},Je=me.x,pt=me.y;return[Je,pt]}}})}}]),a}(ba);function Hn(n){var s=ei();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function ei(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ei=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // if(u_line_texture == LineTexture) { // while load texture
  //    //v_u; // \u6C34\u5E73
  //   float v = length(v_offset)/(v_a); // \u6A2A\u5411
  //   vec2 uv= v_iconMapUV / u_textSize + vec2(v_u, v) / u_textSize * 64.;
  //   // gl_FragColor = vec4(v_u, v, 0.0, 1.0);
  //   // gl_FragColor = vec4(1.0, 0.0, 0.0, v_u);
  //   gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
  // } else {
  //    gl_FragColor = filterColor(gl_FragColor);
  // }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ki=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,bn={solid:0,dash:1},pi=function(n){(0,we.Z)(a,n);var s=Hn(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.lineType,w=y===void 0?"solid":y,P=l.dashArray,k=P===void 0?[10,5]:P;return k.length===2&&k.push(0,0),{u_opacity:d||1,segmentNumber:30,u_line_type:bn[w]||0,u_dash_array:k}}},{key:"getAnimateUniforms",value:function(){var l=this.layer.getLayerConfig(),d=l.animateOption;return{u_aimate:this.animateOption2Array(d),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:Ki,fragmentShader:Ei,triangulation:ju,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.size,$=k===void 0?1:k;return Array.isArray($)?[$[0]]:[$]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(d,y,w,P){return[w[3],w[4],w[5],w[6]]}}})}}]),a}(ba);function bi(n){var s=Nn();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Nn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var yi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying float v_segmentIndex;
varying float v_arcDistrance;
varying float v_pixelLen;
varying float v_a;
varying vec2 v_offset;
varying vec2 v_iconMapUV;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6

  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / (segmentNumber - 1.0)));
    float count = floor(v_arcDistrance/v_pixelLen);

    float u = 1.0 - fract(arcRadio * count + animateSpeed);
    float alpha = 1.0;
    if(u_aimate.x == Animate) {
      u = gl_FragColor.a;
      alpha = gl_FragColor.a;
    }
    float v = length(v_offset)/(v_a); // \u6A2A\u5411
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
    gl_FragColor.a *= alpha;
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
  // gl_FragColor = filterColor(gl_FragColor);

}`,Kn=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,Ci={solid:0,dash:1},Wi=function(n){(0,we.Z)(a,n);var s=bi(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.lineType,w=y===void 0?"solid":y,P=l.dashArray,k=P===void 0?[10,5]:P;return k.length===2&&k.push(0,0),{u_opacity:d||1,segmentNumber:30,u_line_type:Ci[w]||0,u_dash_array:k}}},{key:"getAnimateUniforms",value:function(){var l=this.layer.getLayerConfig(),d=l.animateOption;return{u_aimate:this.animateOption2Array(d),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Kn,fragmentShader:yi,triangulation:ju,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.size,$=k===void 0?1:k;return Array.isArray($)?[$[0]]:[$]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(d,y,w,P){return[w[3],w[4],w[5],w[6]]}}})}}]),a}(ba);function mo(n){var s=oo();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Oo=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;

varying float v_distance;
varying vec2 v_offset;
varying float v_a;
varying float v_pixelLen;
varying vec2 v_iconMapUV;
varying float v_strokeWidth;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8
// [animate, duration, interval, trailLength],
void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  if(u_line_texture == LineTexture) { // while load texture
    float u = fract(mod(v_distance, v_pixelLen)/v_pixelLen - animateSpeed);
    float v = length(v_offset)/(v_a*2.0);
    v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
  // gl_FragColor = filterColor(vec4(1.0, 0.0, 0.0, 1.0));
 
  // float r = max(smoothstep( 0.95, 1.0, v_strokeWidth/(v_a*2.0)), v_strokeWidth/(v_a*2.0));
  // if(rV < r || rV > 1.0 - r) {
  //   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
  // } 
  // float v = length(v_offset)/(v_a*2.0);
  // if(v > 0.9) {
  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);
  // } else if(v < 0.1) {
  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);
  // }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,La=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;

varying float v_distance;
varying vec2 v_offset;
varying float v_size;
varying float v_a;
varying float v_pixelLen;
varying vec2 v_iconMapUV;
// varying float v_strokeWidth;

void main() {
  
  v_iconMapUV = a_iconMapUV;
  v_distance = a_Distance;
  v_pixelLen = project_pixel(u_icon_step);

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    // v_distance_ratio = 0.01;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));


  v_color = a_Color;
  v_a = project_pixel(a_Size.x);

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);

  vec2 offset = project_pixel(size.xy);
  // v_strokeWidth = project_pixel(2.0);

  v_offset = offset + offset * sign(a_Miter);

  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y, 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y / 10.0, 1.0)); // \u989D\u5916\u9664 10.0 \u662F\u4E3A\u4E86\u548Cgaode1.x\u7684\u9AD8\u5EA6\u517C\u5BB9
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,$a={solid:0,dash:1},Ss=function(n){(0,we.Z)(a,n);var s=mo(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.texture=void 0,u.updateTexture=function(){var w=u.rendererService.createTexture2D;if(u.texture){u.texture.update({data:u.iconService.getCanvas()}),u.layer.render();return}u.texture=w({data:u.iconService.getCanvas(),mag:S.gl.NEAREST,min:S.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})},u}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.lineType,w=y===void 0?"solid":y,P=l.dashArray,k=P===void 0?[10,5,0,0]:P,$=l.lineTexture,W=$===void 0?!1:$,me=l.iconStep,Je=me===void 0?100:me;return k.length===2&&k.push(0,0),this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:d||1,u_line_type:$a[w],u_dash_array:k,u_texture:this.texture,u_line_texture:W?1:0,u_icon_step:Je,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"getAnimateUniforms",value:function(){var l=this.layer.getLayerConfig(),d=l.animateOption;return{u_aimate:this.animateOption2Array(d),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:La,fragmentShader:Oo,triangulation:Ls,primitive:S.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var l=this,d=this.layer.getLayerConfig(),y=d.lineType,w=y===void 0?"solid":y;this.styleAttributeService.registerStyleAttribute({name:"distance",type:S.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(k,$,W,me){return[W[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:S.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(k,$,W,me){return[W[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(k,$,W,me){var Je=k.size,pt=Je===void 0?1:Je;return Array.isArray(pt)?[pt[0],pt[1]]:[pt,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(k,$,W,me,Je){return Je}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:S.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(k,$,W,me){return[W[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(k,$,W,me){var Je=l.iconService.getIconMap(),pt=k.texture,Zt=Je[pt]||{x:0,y:0},Pr=Zt.x,Mr=Zt.y;return[Pr,Mr]}}})}},{key:"loadImage",value:function(l){return new Promise(function(d,y){if(l instanceof HTMLImageElement){d(l);return}var w=new Image;w.crossOrigin="anonymous",w.onload=function(){d(w)},w.onerror=function(){y(new Error("Could not load image at "+l))},w.src=l instanceof File?URL.createObjectURL(l):l})}}]),a}(ba),Qo={arc:Sn,arc3d:pi,greatcircle:Wi,line:Ss},dl=Qo;function Ou(n){var s=qo();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function qo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ds=function(n){(0,we.Z)(a,n);var s=Ou(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.type="LineLayer",u}return(0,Q.Z)(a,[{key:"buildModels",value:function(){var l=this.getModelType();this.layerModel=new dl[l](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var l=this.getModelType(),d={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return d[l]}},{key:"getModelType",value:function(){var l,d=this.styleAttributeService.getLayerStyleAttribute("shape"),y=d==null||(l=d.scale)===null||l===void 0?void 0:l.field;return y||"line"}}]),a}(va);function vl(n){var s=oc();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function oc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Lu=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ou=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }
  setPickingColor(a_PickingColor);
}
`,ml=function(n){(0,we.Z)(a,n);var s=vl(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.offsets;return{u_opacity:d||1,u_offsets:y||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:ou,fragmentShader:Lu,triangulation:rc,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y,w,P){var k=d.size;if(k){var $=[];return Array.isArray(k)&&($=k.length===2?[k[0],k[0],k[1]]:k),Array.isArray(k)||($=[k]),$}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y,w,P,k){return k}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y){var w=Cu(d.coordinates);return[w[0],w[1],0]}}})}}]),a}(ba);function Ru(n){var s=jl();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function jl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var su=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,so=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,Du=function(n){(0,we.Z)(a,n);var s=Ru(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=d===void 0?1:d,w=l.stroke,P=w===void 0?"rgb(0,0,0,0)":w,k=l.strokeWidth,$=k===void 0?1:k,W=l.strokeOpacity,me=W===void 0?1:W,Je=l.offsets,pt=Je===void 0?[0,0]:Je;return{u_opacity:y,u_stroke_width:$,u_stroke_color:(0,Xe.CI)(P),u_stroke_opacity:me,u_offsets:[-pt[0],pt[1]]}}},{key:"getAnimateUniforms",value:function(){var l=this.layer.getLayerConfig(),d=l.animateOption;return{u_aimate:this.animateOption2Array(d),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),xc)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:so,fragmentShader:su,triangulation:xc,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(l){return[l.enable?0:1,l.speed||1,l.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var l=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:S.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(y,w,P,k){var $=[1,1,-1,1,-1,-1,1,-1],W=k%4*2;return[$[W],$[W+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(y,w,P,k){var $=y.size,W=$===void 0?5:$;return Array.isArray(W)?[W[0]]:[W]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:S.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(y,w,P,k){var $=y.shape,W=$===void 0?2:$,me=l.layer.getLayerConfig().shape2d,Je=me.indexOf(W);return[Je]}}})}}]),a}(ba);function Zl(n){var s=ps();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function ps(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var go=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor=texture2D(u_texture,pos);
      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }
      gl_FragColor.a =gl_FragColor.a * u_opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,Lo=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);

  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
    }
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Ro=function(n){(0,we.Z)(a,n);var s=Zl(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.texture=void 0,u}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity;return{u_opacity:d||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var l=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){l.updateTexture(),l.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Lo,fragmentShader:go,triangulation:iu,primitive:S.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var l=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(y,w,P,k){var $=y.size;return Array.isArray($)?[$[0]]:[$]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(y,w,P,k){var $=l.fontService.mapping,W=y.shape,me=l.fontService.getGlyph(W),Je=$[me],pt=Je.x,Zt=Je.y;return[pt,Zt]}}})}},{key:"updateTexture",value:function(){var l=this.rendererService.createTexture2D,d=this.fontService.canvas;this.texture=l({data:d,mag:S.gl.LINEAR,min:S.gl.LINEAR,width:d.width,height:d.height})}},{key:"initIconFontGlyphs",value:function(){var l=this,d=this.layer.getLayerConfig(),y=d.fontWeight,w=y===void 0?"normal":y,P=d.fontFamily,k=P===void 0?"sans-serif":P,$=this.layer.getEncodedData(),W=[];$.forEach(function(me){var Je=me.shape,pt=Je===void 0?"":Je;pt=pt.toString();var Zt=l.fontService.getGlyph(pt);W.indexOf(Zt)===-1&&W.push(Zt)}),this.fontService.setFontOptions({characterSet:W,fontWeight:w,fontFamily:k,fontSize:48})}}]),a}(ba);function Do(n){var s=ko();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function ko(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Xs=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor=texture2D(u_texture,pos);
      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }
      gl_FragColor.a =gl_FragColor.a * u_opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,Ml=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);

  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
    }
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Vl=function(n){(0,we.Z)(a,n);var s=Do(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.texture=void 0,u.updateTexture=function(){var w=u.rendererService.createTexture2D;if(u.texture){u.texture.update({data:u.iconService.getCanvas()}),u.layer.render();return}u.texture=w({data:u.iconService.getCanvas(),mag:S.gl.NEAREST,min:S.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})},u}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=l.offsets,w=y===void 0?[0,0]:y;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:d||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-w[0],w[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Ml,fragmentShader:Xs,triangulation:iu,primitive:S.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var l=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(y,w,P,k){var $=y.size,W=$===void 0?5:$;return Array.isArray(W)?[W[0]]:[W]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(y,w,P,k){var $=l.iconService.getIconMap(),W=y.shape,me=$[W]||{x:0,y:0},Je=me.x,pt=me.y;return[Je,pt]}}})}}]),a}(ba);function Tc(n){var s=Gu();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Gu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wc=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,gl=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  // vec2 offset = project_pixel(u_offsets);
  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\
  // 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position, 1.0);
  } else { // else
    vec2 offset = project_pixel(u_offsets);
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Ys(n){var s=n.coordinates;return{vertices:(0,$n.Z)(s),indices:[0],size:s.length}}var Fo=function(n){(0,we.Z)(a,n);var s=Tc(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=d===void 0?1:d,w=l.stroke,P=w===void 0?"rgb(0,0,0,0)":w,k=l.strokeWidth,$=k===void 0?1:k,W=l.offsets,me=W===void 0?[0,0]:W;return{u_opacity:y,u_stroke_width:$,u_stroke_color:(0,Xe.CI)(P),u_offsets:[-me[0],me[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:gl,fragmentShader:Wc,triangulation:Ys,depth:{enable:!1},primitive:S.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.size,$=k===void 0?1:k;return Array.isArray($)?[$[0]]:[$]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:S.BlendType.additive}}}]),a}(ba),lf=_(76721);function nh(n,s){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=sc(n))||s&&n&&typeof n.length=="number"){a&&(n=a);var u=0,l=function(){};return{s:l,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(k){throw k},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,y=!1,w;return{s:function(){a=a.call(n)},n:function(){var k=a.next();return d=k.done,k},e:function(k){y=!0,w=k},f:function(){try{!d&&a.return!=null&&a.return()}finally{if(y)throw w}}}}function sc(n,s){if(!!n){if(typeof n=="string")return Ef(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ef(n,s)}}function Ef(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}var ih=function(){function n(s,a,u){(0,fe.Z)(this,n),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var l=this.boxCells;this.xCellCount=Math.ceil(s/u),this.yCellCount=Math.ceil(a/u);for(var d=0;d<this.xCellCount*this.yCellCount;d++)l.push([]);this.boxKeys=[],this.bboxes=[],this.width=s,this.height=a,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/a,this.boxUid=0}return(0,Q.Z)(n,[{key:"insert",value:function(a,u,l,d,y){this.forEachCell(u,l,d,y,this.insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(u),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(y)}},{key:"query",value:function(a,u,l,d,y){return this.queryHitTest(a,u,l,d,!1,y)}},{key:"hitTest",value:function(a,u,l,d,y){return this.queryHitTest(a,u,l,d,!0,y)}},{key:"insertBoxCell",value:function(a,u,l,d,y,w){this.boxCells[y].push(w)}},{key:"queryHitTest",value:function(a,u,l,d,y,w){if(l<0||a>this.width||d<0||u>this.height)return y?!1:[];var P=[];if(a<=0&&u<=0&&this.width<=l&&this.height<=d){if(y)return!0;for(var k=0;k<this.boxKeys.length;k++)P.push({key:this.boxKeys[k],x1:this.bboxes[k*4],y1:this.bboxes[k*4+1],x2:this.bboxes[k*4+2],y2:this.bboxes[k*4+3]});return w?P.filter(w):P}var $={hitTest:y,seenUids:{box:{},circle:{}}};return this.forEachCell(a,u,l,d,this.queryCell,P,$,w),y?P.length>0:P}},{key:"queryCell",value:function(a,u,l,d,y,w,P,k){var $=P.seenUids,W=this.boxCells[y];if(W!==null){var me=this.bboxes,Je=nh(W),pt;try{for(Je.s();!(pt=Je.n()).done;){var Zt=pt.value;if(!$.box[Zt]){$.box[Zt]=!0;var Pr=Zt*4;if(a<=me[Pr+2]&&u<=me[Pr+3]&&l>=me[Pr+0]&&d>=me[Pr+1]&&(!k||k(this.boxKeys[Zt]))){if(P.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[Zt],x1:me[Pr],y1:me[Pr+1],x2:me[Pr+2],y2:me[Pr+3]})}}}}catch(Mr){Je.e(Mr)}finally{Je.f()}}return!1}},{key:"forEachCell",value:function(a,u,l,d,y,w,P,k){for(var $=this.convertToXCellCoord(a),W=this.convertToYCellCoord(u),me=this.convertToXCellCoord(l),Je=this.convertToYCellCoord(d),pt=$;pt<=me;pt++)for(var Zt=W;Zt<=Je;Zt++){var Pr=this.xCellCount*Zt+pt;if(y.call(this,a,u,l,d,Pr,w,P,k))return}}},{key:"convertToXCellCoord",value:function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}},{key:"convertToYCellCoord",value:function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}}]),n}(),Kh=ih,uc=function(){function n(s,a){(0,fe.Z)(this,n),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=s,this.height=a,this.viewportPadding=Math.max(s,a),this.grid=new Kh(s+this.viewportPadding,a+this.viewportPadding,25),this.screenRightBoundary=s+this.viewportPadding,this.screenBottomBoundary=a+this.viewportPadding,this.gridRightBoundary=s+2*this.viewportPadding,this.gridBottomBoundary=a+2*this.viewportPadding}return(0,Q.Z)(n,[{key:"placeCollisionBox",value:function(a){var u=a.x1+a.anchorPointX+this.viewportPadding,l=a.y1+a.anchorPointY+this.viewportPadding,d=a.x2+a.anchorPointX+this.viewportPadding,y=a.y2+a.anchorPointY+this.viewportPadding;return!this.isInsideGrid(u,l,d,y)||this.grid.hitTest(u,l,d,y)?{box:[]}:{box:[u,l,d,y]}}},{key:"insertCollisionBox",value:function(a,u){var l={featureIndex:u};this.grid.insert(l,a[0],a[1],a[2],a[3])}},{key:"project",value:function(a,u,l){var d=lf.al(u,l,0,1),y=lf.Ue(),w=Oa.fromValues.apply(Oa,(0,$n.Z)(a));return lf.fF(y,d,w),{x:(y[0]/y[3]+1)/2*this.width+this.viewportPadding,y:(-y[1]/y[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(a,u,l,d){return l>=0&&a<this.gridRightBoundary&&d>=0&&u<this.gridBottomBoundary}}]),n}();function ah(n,s){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=wf(n))||s&&n&&typeof n.length=="number"){a&&(n=a);var u=0,l=function(){};return{s:l,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(k){throw k},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,y=!1,w;return{s:function(){a=a.call(n)},n:function(){var k=a.next();return d=k.done,k},e:function(k){y=!0,w=k},f:function(){try{!d&&a.return!=null&&a.return()}finally{if(y)throw w}}}}function wf(n,s){if(!!n){if(typeof n=="string")return zf(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zf(n,s)}}function zf(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function B(n){var s=.5,a=.5;switch(n){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0;break;default:s=.5}switch(n){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0;break;default:a=.5}return{horizontalAlign:s,verticalAlign:a}}function U(n,s,a,u,l){if(!!l){var d=n[u],y=d.glyph;if(y)for(var w=s[y].advance*d.scale,P=(n[u].x+w)*l,k=a;k<=u;k++)n[k].x-=P}}function M(n,s,a,u,l,d,y){var w=(s-a)*l,P=(-u*y+.5)*d,k=ah(n),$;try{for(k.s();!($=k.n()).done;){var W=$.value;W.x+=w,W.y+=P}}catch(me){k.e(me)}finally{k.f()}}function R(n,s,a,u,l,d,y){var w=-8,P=0,k=w,$=0,W=n.positionedGlyphs,me=d==="right"?1:d==="left"?0:.5,Je=W.length;a.forEach(function(hn){if(hn.split("").forEach(function(Fn){var Xn=s[Fn],Zi=0;Xn&&(W.push({glyph:Fn,x:P,y:k+Zi,vertical:!1,scale:1,metrics:Xn}),P+=Xn.advance+y)}),W.length!==Je){var dn=P-y;$=Math.max(dn,$),U(W,s,Je,W.length-1,me)}P=0,k+=u});var pt=B(l),Zt=pt.horizontalAlign,Pr=pt.verticalAlign;M(W,me,Zt,Pr,$,u,a.length);var Mr=k-w;n.top+=-Pr*Mr,n.bottom=n.top+Mr,n.left+=-Zt*$,n.right=n.left+$}function ee(n,s,a,u,l,d,y){var w=-8,P=0,k=w,$=0,W=n.positionedGlyphs,me=d==="right"?1:d==="left"?0:.5,Je=W.length;a.forEach(function(hn){var dn=s[hn],Fn=0;if(dn&&(W.push({glyph:hn,x:P,y:k+Fn,vertical:!1,scale:1,metrics:dn}),P+=dn.advance+y),W.length!==Je){var Xn=P-y;$=Math.max(Xn,$),U(W,s,Je,W.length-1,me)}P=0,k+=u});var pt=B(l),Zt=pt.horizontalAlign,Pr=pt.verticalAlign;M(W,me,Zt,Pr,$,u,a.length);var Mr=k-w;n.top+=-Pr*Mr,n.bottom=n.top+Mr,n.left+=-Zt*$,n.right=n.left+$}function _e(n,s,a,u,l,d){var y=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],w=arguments.length>7?arguments[7]:void 0,P=n.split(`
`),k=[],$={positionedGlyphs:k,top:y[1],bottom:y[1],left:y[0],right:y[0],lineCount:P.length,text:n};return w?ee($,s,P,a,u,l,d):R($,s,P,a,u,l,d),k.length?$:!1}function it(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],a=arguments.length>2?arguments[2]:void 0,u=n.positionedGlyphs,l=u===void 0?[]:u,d=[],y=ah(l),w;try{for(y.s();!(w=y.n()).done;){var P=w.value,k=P.metrics,$=4,W=k.advance*P.scale/2,me=a?[P.x+W,P.y]:[0,0],Je=a?[0,0]:[P.x+W+s[0],P.y+s[1]],pt=(0-$)*P.scale-W+Je[0],Zt=(0-$)*P.scale+Je[1],Pr=pt+k.width*P.scale,Mr=Zt+k.height*P.scale,hn={x:pt,y:Zt},dn={x:Pr,y:Zt},Fn={x:pt,y:Mr},Xn={x:Pr,y:Mr};d.push({tl:hn,tr:dn,bl:Fn,br:Xn,tex:k,glyphOffset:me})}}catch(Zi){y.e(Zi)}finally{y.f()}return d}function Tt(n,s){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=wt(n))||s&&n&&typeof n.length=="number"){a&&(n=a);var u=0,l=function(){};return{s:l,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(k){throw k},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,y=!1,w;return{s:function(){a=a.call(n)},n:function(){var k=a.next();return d=k.done,k},e:function(k){y=!0,w=k},f:function(){try{!d&&a.return!=null&&a.return()}finally{if(y)throw w}}}}function wt(n,s){if(!!n){if(typeof n=="string")return fr(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return fr(n,s)}}function fr(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function Hr(n){var s=In();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function In(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wn=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Cn=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function fi(n){var s=this,a=n.id,u=[],l=[];if(!s.glyphInfoMap||!s.glyphInfoMap[a])return{vertices:[],indices:[],size:7};var d=s.glyphInfoMap[a].centroid,y=d.length===2?[d[0],d[1],0]:d;return s.glyphInfoMap[a].glyphQuads.forEach(function(w,P){u.push.apply(u,(0,$n.Z)(y).concat([w.tex.x,w.tex.y+w.tex.height,w.tl.x,w.tl.y],(0,$n.Z)(y),[w.tex.x+w.tex.width,w.tex.y+w.tex.height,w.tr.x,w.tr.y],(0,$n.Z)(y),[w.tex.x+w.tex.width,w.tex.y,w.br.x,w.br.y],(0,$n.Z)(y),[w.tex.x,w.tex.y,w.bl.x,w.bl.y])),l.push(0+P*4,1+P*4,2+P*4,2+P*4,3+P*4,0+P*4)}),{vertices:u,indices:l,size:7}}var gi=function(n){(0,we.Z)(a,n);var s=Hr(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.glyphInfo=void 0,u.glyphInfoMap={},u.texture=void 0,u.currentZoom=-1,u.extent=void 0,u.textureHeight=0,u.textCount=0,u.preTextStyle={},u.buildModels=function(){return u.initGlyph(),u.updateTexture(),u.filterGlyphs(),[u.layer.buildLayerModel({moduleName:"pointText",vertexShader:Cn,fragmentShader:Wn,triangulation:fi.bind((0,Ht.Z)(u)),depth:{enable:!1},blend:u.getBlend()})]},u}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=d===void 0?1:d,w=l.stroke,P=w===void 0?"#fff":w,k=l.strokeWidth,$=k===void 0?0:k,W=l.strokeOpacity,me=W===void 0?1:W,Je=l.textAnchor,pt=Je===void 0?"center":Je,Zt=l.textAllowOverlap,Pr=Zt===void 0?!1:Zt,Mr=l.halo,hn=Mr===void 0?.5:Mr,dn=l.gamma,Fn=dn===void 0?2:dn,Xn=this.fontService,Zi=Xn.canvas,ti=Xn.mapping;return Object.keys(ti).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(ti).length),this.preTextStyle={textAnchor:pt,textAllowOverlap:Pr},{u_opacity:y,u_stroke_opacity:me,u_sdf_map:this.texture,u_stroke:(0,Xe.CI)(P),u_halo_blur:hn,u_gamma_scale:Fn,u_sdf_map_size:[Zi.width,Zi.height],u_strokeWidth:$}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var l=this.layer.getLayerConfig(),d=l.textAnchor,y=d===void 0?"center":d,w=l.textAllowOverlap,P=w===void 0?!0:w;return this.preTextStyle={textAnchor:y,textAllowOverlap:P},this.buildModels()}},{key:"needUpdate",value:function(){var l=this.layer.getLayerConfig(),d=l.textAllowOverlap,y=d===void 0?!1:d,w=this.mapService.getZoom(),P=this.mapService.getBounds(),k=(0,Xe.oO)(this.extent,P);return!y&&(Math.abs(this.currentZoom-w)>1||!k)||y!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:S.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.rotate,$=k===void 0?0:k;return Array.isArray($)?[$[0]]:[$]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:S.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(d,y,w,P){return[w[5],w[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.size,$=k===void 0?12:k;return Array.isArray($)?[$[0]]:[$]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:S.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(d,y,w,P){return[w[3],w[4]]}}})}},{key:"textExtent",value:function(){var l=this.mapService.getBounds();return(0,Xe.yA)(l,.5)}},{key:"initTextFont",value:function(){var l=this.layer.getLayerConfig(),d=l.fontWeight,y=d===void 0?"400":d,w=l.fontFamily,P=w===void 0?"sans-serif":w,k=this.layer.getEncodedData(),$=[];k.forEach(function(W){var me=W.shape,Je=me===void 0?"":me;Je=Je.toString();var pt=Tt(Je),Zt;try{for(pt.s();!(Zt=pt.n()).done;){var Pr=Zt.value;$.indexOf(Pr)===-1&&$.push(Pr)}}catch(Mr){pt.e(Mr)}finally{pt.f()}}),this.fontService.setFontOptions({characterSet:$,fontWeight:y,fontFamily:P,iconfont:!1})}},{key:"initIconFontTex",value:function(){var l=this.layer.getLayerConfig(),d=l.fontWeight,y=d===void 0?"400":d,w=l.fontFamily,P=w===void 0?"sans-serif":w,k=this.layer.getEncodedData(),$=[];k.forEach(function(W){var me=W.shape,Je=me===void 0?"":me;Je=Je.toString(),$.indexOf(Je)===-1&&$.push(Je)}),this.fontService.setFontOptions({characterSet:$,fontWeight:y,fontFamily:P,iconfont:!0})}},{key:"generateGlyphLayout",value:function(l){var d=this,y=this.fontService.mapping,w=this.layer.getLayerConfig(),P=w.spacing,k=P===void 0?2:P,$=w.textAnchor,W=$===void 0?"center":$,me=w.textOffset,Je=this.layer.getEncodedData();this.glyphInfo=Je.map(function(pt){var Zt=pt.shape,Pr=Zt===void 0?"":Zt,Mr=pt.id,hn=pt.size,dn=hn===void 0?1:hn,Fn=_e(Pr.toString(),y,dn,W,"center",k,me,l),Xn=it(Fn,me,!1);return pt.shaping=Fn,pt.glyphQuads=Xn,pt.centroid=Cu(pt.coordinates),pt.originCentroid=pt.version==="GAODE2.x"?Cu(pt.originCoordinates):pt.originCentroid=pt.centroid,d.glyphInfoMap[Mr]={shaping:Fn,glyphQuads:Xn,centroid:Cu(pt.coordinates)},pt})}},{key:"filterGlyphs",value:function(){var l=this,d=this.layer.getLayerConfig(),y=d.padding,w=y===void 0?[4,4]:y,P=d.textAllowOverlap,k=P===void 0?!1:P;if(!k){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var $=this.rendererService.getViewportSize(),W=$.width,me=$.height,Je=new uc(W,me),pt=this.glyphInfo.filter(function(Zt){var Pr=Zt.shaping,Mr=Zt.id,hn=Mr===void 0?0:Mr,dn=Zt.version==="GAODE2.x"?Zt.originCentroid:Zt.centroid,Fn=Zt.size,Xn=Fn/24,Zi=l.mapService.lngLatToContainer(dn),ti=Je.placeCollisionBox({x1:Pr.left*Xn-w[0],x2:Pr.right*Xn+w[0],y1:Pr.top*Xn-w[1],y2:Pr.bottom*Xn+w[1],anchorPointX:Zi.x,anchorPointY:Zi.y}),$i=ti.box;return $i&&$i.length?(Je.insertCollisionBox($i,hn),!0):!1});pt.forEach(function(Zt){l.glyphInfoMap[Zt.id]=Zt})}}},{key:"initGlyph",value:function(){var l=this.layer.getLayerConfig(),d=l.iconfont,y=d===void 0?!1:d;y?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(y)}},{key:"updateTexture",value:function(){var l=this.rendererService.createTexture2D,d=this.fontService.canvas;this.textureHeight=d.height,this.texture&&this.texture.destroy(),this.texture=l({data:d,mag:S.gl.LINEAR,min:S.gl.LINEAR,width:d.width,height:d.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Cn,fragmentShader:Wn,triangulation:fi.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),a}(ba),Ji={fill:Du,image:Vl,normal:Fo,extrude:ml,text:gi,icon:Ro},Mi=Ji;function Ra(n){var s=wo();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function wo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var yo=function(n){(0,we.Z)(a,n);var s=Ra(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.type="PointLayer",u}return(0,Q.Z)(a,[{key:"buildModels",value:function(){var l=this.getModelType();this.layerModel=new Mi[l](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var l=this.getModelType(),d={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return d[l]}},{key:"getModelType",value:function(){var l=this.getEncodedData(),d=this.getLayerConfig(),y=d.shape2d,w=d.shape3d,P=this.iconService.getIconMap(),k=l.find(function(W){return W.hasOwnProperty("shape")});if(k){var $=k.shape;return $==="dot"?"normal":(y==null?void 0:y.indexOf($))!==-1?"fill":(w==null?void 0:w.indexOf($))!==-1?"extrude":P.hasOwnProperty($)?"image":this.fontService.getGlyph($)!==""?"icon":"text"}else return"normal"}}]),a}(va);function uo(n){var s=Za();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Za(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ra=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Da=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,lo=function(n){(0,we.Z)(a,n);var s=uo(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=d===void 0?1:d;return{u_opacity:y}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:Da,fragmentShader:ra,triangulation:Ws})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(d,y,w,P,k){return k}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(d,y,w,P){var k=d.size,$=k===void 0?10:k;return Array.isArray($)?[$[0]]:[$]}}})}}]),a}(ba);function To(n){var s=co();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function co(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ks=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,uu=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,Hu=function(n){(0,we.Z)(a,n);var s=To(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=d===void 0?1:d;return{u_opacity:y}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:uu,fragmentShader:ks,triangulation:Di,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),a}(ba),ds={fill:Hu,line:Ss,extrude:lo,text:gi,point_fill:Du,point_image:Vl,point_normal:Fo,point_extrude:ml},Ac=ds;function Tf(n){var s=Ap();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function Ap(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $h=function(n){(0,we.Z)(a,n);var s=Tf(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.type="PolygonLayer",u}return(0,Q.Z)(a,[{key:"buildModels",value:function(){var l=this.getModelType();this.layerModel=new Ac[l](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var l,d=this.styleAttributeService.getLayerStyleAttribute("shape"),y=d==null||(l=d.scale)===null||l===void 0?void 0:l.field;return y==="fill"?"fill":y==="extrude"?"extrude":y==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var l=this.getEncodedData(),d=this.getLayerConfig(),y=d.shape2d,w=d.shape3d,P=this.iconService.getIconMap(),k=l.find(function(W){return W.hasOwnProperty("shape")});if(k){var $=k.shape;return $==="dot"?"point_normal":(y==null?void 0:y.indexOf($))!==-1?"point_fill":(w==null?void 0:w.indexOf($))!==-1?"point_extrude":P.hasOwnProperty($)?"point_image":"text"}else return"fill"}}]),a}(va);function Cc(n){var s=cf();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function cf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Jh=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,Qh=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Th=function(n){(0,we.Z)(a,n);var s=Cc(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.texture=void 0,u.colorTexture=void 0,u}return(0,Q.Z)(a,[{key:"getUninforms",value:function(){var l=this.layer.getLayerConfig(),d=l.opacity,y=d===void 0?1:d,w=l.clampLow,P=w===void 0?!0:w,k=l.clampHigh,$=k===void 0?!0:k,W=l.noDataValue,me=W===void 0?-9999999:W,Je=l.domain,pt=Je===void 0?[0,1]:Je;return this.updateColorTexure(),{u_opacity:y||1,u_texture:this.texture,u_domain:pt,u_clampLow:P,u_clampHigh:typeof $!="undefined"?$:P,u_noDataValue:me,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var l=this.layer.getSource(),d=this.rendererService.createTexture2D,y=l.data.dataArray[0];this.texture=d({data:y.data,width:y.width,height:y.height,format:S.gl.LUMINANCE,type:S.gl.FLOAT});var w=this.layer.getLayerConfig(),P=w.rampColors,k=(0,Xe.Cl)(P);return this.colorTexture=d({data:k.data,width:k.width,height:k.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:Qh,fragmentShader:Jh,triangulation:vo,primitive:S.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(d,y,w,P){return[w[3],w[4]]}}})}},{key:"updateColorTexure",value:function(){var l=this.rendererService.createTexture2D,d=this.layer.getLayerConfig(),y=d.rampColors,w=(0,Xe.Cl)(y);this.colorTexture=l({data:w.data,width:w.width,height:w.height,flipY:!1})}}]),a}(ba),Ah={raster:Th,raster3d:Th},Cp=Ah;function lc(n){var s=ff();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function ff(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Af=function(n){(0,we.Z)(a,n);var s=lc(a);function a(){var u;(0,fe.Z)(this,a);for(var l=arguments.length,d=new Array(l),y=0;y<l;y++)d[y]=arguments[y];return u=s.call.apply(s,[this].concat(d)),u.type="RasterLayer",u}return(0,Q.Z)(a,[{key:"buildModels",value:function(){var l=this.getModelType();this.layerModel=new Cp[l](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var l=this.getModelType(),d={raster:{},raster3d:{}};return d[l]}},{key:"getModelType",value:function(){return"raster"}}]),a}(va),cc=_(50361),Xc=_.n(cc),Wu,Nf,Ch,_u,yl,Zo,Fs,Ph,qh,ep,Mh;function Ks(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function tp(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Ks(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Ks(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}var rp=(Wu=(0,Et.b2)(),Nf=(0,Et.f3)(S.vK.IGlobalConfigService),Ch=(0,Et.f3)(S.vK.ILogService),_u=(0,Et.f3)(S.vK.IMapService),yl=(0,Et.f3)(S.vK.IFontService),Wu(Zo=(Fs=function(){function n(){(0,fe.Z)(this,n),(0,si.Z)(this,"configService",Ph,this),(0,si.Z)(this,"logger",qh,this),(0,si.Z)(this,"mapService",ep,this),(0,si.Z)(this,"fontService",Mh,this)}return(0,Q.Z)(n,[{key:"apply",value:function(a,u){var l=this,d=u.styleAttributeService;a.hooks.init.tap("DataMappingPlugin",function(){l.generateMaping(a,{styleAttributeService:d})}),a.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return a.dataState.dataMappingNeedUpdate=!1,l.generateMaping(a,{styleAttributeService:d}),!0}),a.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!a.layerModelNeedUpdate){var y=d.getLayerStyleAttributes()||[],w=d.getLayerStyleAttribute("filter"),P=a.getSource().data.dataArray,k=y.filter(function(W){return W.needRemapping}),$=P;w!=null&&w.needRemapping&&w!==null&&w!==void 0&&w.scale&&($=P.filter(function(W){return l.applyAttributeMapping(w,W)[0]})),k.length&&(w!=null&&w.needRemapping?(a.setEncodedData(l.mapping(y,$)),w.needRemapping=!1):a.setEncodedData(l.mapping(k,$,a.getEncodedData())),l.logger.debug("remapping finished"),a.emit("remapping",null))}})}},{key:"generateMaping",value:function(a,u){var l=this,d=u.styleAttributeService,y=d.getLayerStyleAttributes()||[],w=d.getLayerStyleAttribute("filter"),P=a.getSource().data.dataArray,k=P;w!=null&&w.scale&&(k=P.filter(function($){return l.applyAttributeMapping(w,$)[0]})),a.setEncodedData(this.mapping(y,k))}},{key:"mapping",value:function(a,u,l){var d=this,y=u.map(function(w,P){var k=l?l[P]:{},$=tp({id:w._id,coordinates:w.coordinates},k);return a.filter(function(W){return W.scale!==void 0}).forEach(function(W){var me=d.applyAttributeMapping(W,w);W.needRemapping=!1,W.name==="color"&&(me=me.map(function(Je){return(0,Xe.CI)(Je)})),$[W.name]=Array.isArray(me)&&me.length===1?me[0]:me,W.name==="shape"&&($.shape=d.fontService.getIconFontKey($[W.name]))}),$});return y.length>0&&this.mapService.version==="GAODE2.x"&&(typeof y[0].coordinates[0]=="number"?y.map(function(w){w.version="GAODE2.x",w.originCoordinates=Xc()(w.coordinates),w.coordinates=d.mapService.lngLatToCoord(w.coordinates)}):y.map(function(w){w.version="GAODE2.x",w.originCoordinates=Xc()(w.coordinates),w.coordinates=d.mapService.lngLatToCoords(w.coordinates)})),y}},{key:"applyAttributeMapping",value:function(a,u){var l;if(!a.scale)return[];var d=(a==null||(l=a.scale)===null||l===void 0?void 0:l.scalers)||[],y=[];return d.forEach(function(w){var P,k=w.field;(u.hasOwnProperty(k)||((P=a.scale)===null||P===void 0?void 0:P.type)==="variable")&&y.push(u[k])}),a.mapping?a.mapping(y):[]}}]),n}(),Ph=(0,Rn.Z)(Fs.prototype,"configService",[Nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qh=(0,Rn.Z)(Fs.prototype,"logger",[Ch],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ep=(0,Rn.Z)(Fs.prototype,"mapService",[_u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mh=(0,Rn.Z)(Fs.prototype,"fontService",[yl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fs))||Zo),Ih={},np={},Oh=function(s){return np[s]},Bf=function(s,a){np[s]=a},ip=function(s){return Ih[s]},hf=function(s,a){Ih[s]=a},oh={},Lh={},Rh=34,fc=10,sh=13;function J(n){return new Function("d","return {"+n.map(function(s,a){return JSON.stringify(s)+": d["+a+'] || ""'}).join(",")+"}")}function he(n,s){var a=J(n);return function(u,l){return s(a(u),l,n)}}function Ue(n){var s=Object.create(null),a=[];return n.forEach(function(u){for(var l in u)l in s||a.push(s[l]=l)}),a}function Vt(n,s){var a=n+"",u=a.length;return u<s?new Array(s-u+1).join(0)+a:a}function yr(n){return n<0?"-"+Vt(-n,6):n>9999?"+"+Vt(n,6):Vt(n,4)}function pr(n){var s=n.getUTCHours(),a=n.getUTCMinutes(),u=n.getUTCSeconds(),l=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":yr(n.getUTCFullYear(),4)+"-"+Vt(n.getUTCMonth()+1,2)+"-"+Vt(n.getUTCDate(),2)+(l?"T"+Vt(s,2)+":"+Vt(a,2)+":"+Vt(u,2)+"."+Vt(l,3)+"Z":u?"T"+Vt(s,2)+":"+Vt(a,2)+":"+Vt(u,2)+"Z":a||s?"T"+Vt(s,2)+":"+Vt(a,2)+"Z":"")}function rr(n){var s=new RegExp('["'+n+`
\r]`),a=n.charCodeAt(0);function u(W,me){var Je,pt,Zt=l(W,function(Pr,Mr){if(Je)return Je(Pr,Mr-1);pt=Pr,Je=me?he(Pr,me):J(Pr)});return Zt.columns=pt||[],Zt}function l(W,me){var Je=[],pt=W.length,Zt=0,Pr=0,Mr,hn=pt<=0,dn=!1;W.charCodeAt(pt-1)===fc&&--pt,W.charCodeAt(pt-1)===sh&&--pt;function Fn(){if(hn)return Lh;if(dn)return dn=!1,oh;var Zi,ti=Zt,$i;if(W.charCodeAt(ti)===Rh){for(;Zt++<pt&&W.charCodeAt(Zt)!==Rh||W.charCodeAt(++Zt)===Rh;);return(Zi=Zt)>=pt?hn=!0:($i=W.charCodeAt(Zt++))===fc?dn=!0:$i===sh&&(dn=!0,W.charCodeAt(Zt)===fc&&++Zt),W.slice(ti+1,Zi-1).replace(/""/g,'"')}for(;Zt<pt;){if(($i=W.charCodeAt(Zi=Zt++))===fc)dn=!0;else if($i===sh)dn=!0,W.charCodeAt(Zt)===fc&&++Zt;else if($i!==a)continue;return W.slice(ti,Zi)}return hn=!0,W.slice(ti,pt)}for(;(Mr=Fn())!==Lh;){for(var Xn=[];Mr!==oh&&Mr!==Lh;)Xn.push(Mr),Mr=Fn();me&&(Xn=me(Xn,Pr++))==null||Je.push(Xn)}return Je}function d(W,me){return W.map(function(Je){return me.map(function(pt){return $(Je[pt])}).join(n)})}function y(W,me){return me==null&&(me=Ue(W)),[me.map($).join(n)].concat(d(W,me)).join(`
`)}function w(W,me){return me==null&&(me=Ue(W)),d(W,me).join(`
`)}function P(W){return W.map(k).join(`
`)}function k(W){return W.map($).join(n)}function $(W){return W==null?"":W instanceof Date?pr(W):s.test(W+="")?'"'+W.replace(/"/g,'""')+'"':W}return{parse:u,parseRows:l,format:y,formatBody:w,formatRows:P,formatRow:k,formatValue:$}}var kr=rr(","),rn=kr.parse,Wr=kr.parseRows,$r=kr.format,on=kr.formatBody,gn=kr.formatRows,cn=kr.formatRow,en=kr.formatValue,ir=_(33010),Jt=_.n(ir);function jr(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function yn(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?jr(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):jr(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function br(n,s){var a=s.x,u=s.y,l=s.x1,d=s.y1,y=s.coordinates,w=[];return n.forEach(function(P,k){var $=[];if(a&&u&&($=[parseFloat(P[a]),parseFloat(P[u])]),a&&u&&l&&d){var W=[parseFloat(P[a]),parseFloat(P[u])],me=[parseFloat(P[l]),parseFloat(P[d])];$=[W,me]}if(y){var Je="Polygon";Array.isArray(y[0])||(Je="Point"),Array.isArray(y[0])&&!Array.isArray(y[0][0])&&(Je="LineString");var pt={type:Je,coordinates:(0,$n.Z)(P[y])};Jt()(pt,!0),$=pt.coordinates}var Zt=yn(yn({},P),{},{_id:k,coordinates:$});w.push(Zt)}),{dataArray:w}}function Yn(n,s){var a=rn(n);return br(a,s)}var Gr=_(7126);function Br(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Fr(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Xr(n){if(n.length>1&&isNumber(n[0])&&isNumber(n[1]))return!0;if(Array.isArray(n[0])&&n[0].length)return Xr(n[0]);throw new Error("coordinates must only contain numbers")}function jn(n,s,a){if(!s||!a)throw new Error("type and name required");if(!n||n.type!==s)throw new Error("Invalid input to "+a+": must be a "+s+", given "+n.type)}function qn(n,s,a){if(!n)throw new Error("No feature passed");if(!a)throw new Error(".featureOf() requires a name");if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!n.geometry||n.geometry.type!==s)throw new Error("Invalid input to "+a+": must be a "+s+", given "+n.geometry.type)}function ln(n,s,a){if(!n)throw new Error("No featureCollection passed");if(!a)throw new Error(".collectionOf() requires a name");if(!n||n.type!=="FeatureCollection")throw new Error("Invalid input to "+a+", FeatureCollection required");for(var u=0,l=n.features;u<l.length;u++){var d=l[u];if(!d||d.type!=="Feature"||!d.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!d.geometry||d.geometry.type!==s)throw new Error("Invalid input to "+a+": must be a "+s+", given "+d.geometry.type)}}function Nr(n){return n.type==="Feature"?n.geometry:n}function Rr(n,s){return n.type==="FeatureCollection"?"FeatureCollection":n.type==="GeometryCollection"?"GeometryCollection":n.type==="Feature"&&n.geometry!==null?n.geometry.type:n.type}function ri(n,s,a){if(n!==null)for(var u,l,d,y,w,P,k,$=0,W=0,me,Je=n.type,pt=Je==="FeatureCollection",Zt=Je==="Feature",Pr=pt?n.features.length:1,Mr=0;Mr<Pr;Mr++){k=pt?n.features[Mr].geometry:Zt?n.geometry:n,me=k?k.type==="GeometryCollection":!1,w=me?k.geometries.length:1;for(var hn=0;hn<w;hn++){var dn=0,Fn=0;if(y=me?k.geometries[hn]:k,y!==null){P=y.coordinates;var Xn=y.type;switch($=a&&(Xn==="Polygon"||Xn==="MultiPolygon")?1:0,Xn){case null:break;case"Point":if(s(P,W,Mr,dn,Fn)===!1)return!1;W++,dn++;break;case"LineString":case"MultiPoint":for(u=0;u<P.length;u++){if(s(P[u],W,Mr,dn,Fn)===!1)return!1;W++,Xn==="MultiPoint"&&dn++}Xn==="LineString"&&dn++;break;case"Polygon":case"MultiLineString":for(u=0;u<P.length;u++){for(l=0;l<P[u].length-$;l++){if(s(P[u][l],W,Mr,dn,Fn)===!1)return!1;W++}Xn==="MultiLineString"&&dn++,Xn==="Polygon"&&Fn++}Xn==="Polygon"&&dn++;break;case"MultiPolygon":for(u=0;u<P.length;u++){for(Fn=0,l=0;l<P[u].length;l++){for(d=0;d<P[u][l].length-$;d++){if(s(P[u][l][d],W,Mr,dn,Fn)===!1)return!1;W++}Fn++}dn++}break;case"GeometryCollection":for(u=0;u<y.geometries.length;u++)if(ri(y.geometries[u],s,a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ni(n,s,a,u){var l=a;return ri(n,function(d,y,w,P,k){y===0&&a===void 0?l=d:l=s(l,d,y,w,P,k)},u),l}function Ln(n,s){var a;switch(n.type){case"FeatureCollection":for(a=0;a<n.features.length&&s(n.features[a].properties,a)!==!1;a++);break;case"Feature":s(n.properties,0);break}}function Vi(n,s,a){var u=a;return Ln(n,function(l,d){d===0&&a===void 0?u=l:u=s(u,l,d)}),u}function wi(n,s){if(n.type==="Feature")s(n,0);else if(n.type==="FeatureCollection")for(var a=0;a<n.features.length&&s(n.features[a],a)!==!1;a++);}function Gi(n,s,a){var u=a;return wi(n,function(l,d){d===0&&a===void 0?u=l:u=s(u,l,d)}),u}function ca(n){var s=[];return ri(n,function(a){s.push(a)}),s}function zo(n,s){var a,u,l,d,y,w,P,k,$,W,me=0,Je=n.type==="FeatureCollection",pt=n.type==="Feature",Zt=Je?n.features.length:1;for(a=0;a<Zt;a++){for(w=Je?n.features[a].geometry:pt?n.geometry:n,k=Je?n.features[a].properties:pt?n.properties:{},$=Je?n.features[a].bbox:pt?n.bbox:void 0,W=Je?n.features[a].id:pt?n.id:void 0,P=w?w.type==="GeometryCollection":!1,y=P?w.geometries.length:1,l=0;l<y;l++){if(d=P?w.geometries[l]:w,d===null){if(s(null,me,k,$,W)===!1)return!1;continue}switch(d.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(s(d,me,k,$,W)===!1)return!1;break}case"GeometryCollection":{for(u=0;u<d.geometries.length;u++)if(s(d.geometries[u],me,k,$,W)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}me++}}function zs(n,s,a){var u=a;return zo(n,function(l,d,y,w,P){d===0&&a===void 0?u=l:u=s(u,l,d,y,w,P)}),u}function Hi(n,s){zo(n,function(a,u,l,d,y){var w=a===null?null:a.type;switch(w){case null:case"Point":case"LineString":case"Polygon":return s((0,Gr.zL)(a,l,{bbox:d,id:y}),u,0)===!1?!1:void 0}var P;switch(w){case"MultiPoint":P="Point";break;case"MultiLineString":P="LineString";break;case"MultiPolygon":P="Polygon";break}for(var k=0;k<a.coordinates.length;k++){var $=a.coordinates[k],W={type:P,coordinates:$};if(s((0,Gr.zL)(W,l),u,k)===!1)return!1}})}function No(n,s,a){var u=a;return Hi(n,function(l,d,y){d===0&&y===0&&a===void 0?u=l:u=s(u,l,d,y)}),u}function Ja(n,s){Hi(n,function(a,u,l){var d=0;if(!!a.geometry){var y=a.geometry.type;if(!(y==="Point"||y==="MultiPoint")){var w,P=0,k=0,$=0;if(ri(a,function(W,me,Je,pt,Zt){if(w===void 0||u>P||pt>k||Zt>$){w=W,P=u,k=pt,$=Zt,d=0;return}var Pr=lineString([w,W],a.properties);if(s(Pr,u,l,Zt,d)===!1)return!1;d++,w=W})===!1)return!1}}})}function es(n,s,a){var u=a,l=!1;return Ja(n,function(d,y,w,P,k){l===!1&&a===void 0?u=d:u=s(u,d,y,w,P,k),l=!0}),u}function ts(n,s){if(!n)throw new Error("geojson is required");Hi(n,function(a,u,l){if(a.geometry!==null){var d=a.geometry.type,y=a.geometry.coordinates;switch(d){case"LineString":if(s(a,u,l,0,0)===!1)return!1;break;case"Polygon":for(var w=0;w<y.length;w++)if(s(lineString(y[w],a.properties),u,l,w)===!1)return!1;break}}})}function Es(n,s,a){var u=a;return ts(n,function(l,d,y,w){d===0&&a===void 0?u=l:u=s(u,l,d,y,w)}),u}function Ns(n,s){if(s=s||{},!isObject(s))throw new Error("options is invalid");var a=s.featureIndex||0,u=s.multiFeatureIndex||0,l=s.geometryIndex||0,d=s.segmentIndex||0,y=s.properties,w;switch(n.type){case"FeatureCollection":a<0&&(a=n.features.length+a),y=y||n.features[a].properties,w=n.features[a].geometry;break;case"Feature":y=y||n.properties,w=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":w=n;break;default:throw new Error("geojson is invalid")}if(w===null)return null;var P=w.coordinates;switch(w.type){case"Point":case"MultiPoint":return null;case"LineString":return d<0&&(d=P.length+d-1),lineString([P[d],P[d+1]],y,s);case"Polygon":return l<0&&(l=P.length+l),d<0&&(d=P[l].length+d-1),lineString([P[l][d],P[l][d+1]],y,s);case"MultiLineString":return u<0&&(u=P.length+u),d<0&&(d=P[u].length+d-1),lineString([P[u][d],P[u][d+1]],y,s);case"MultiPolygon":return u<0&&(u=P.length+u),l<0&&(l=P[u].length+l),d<0&&(d=P[u][l].length-d-1),lineString([P[u][l][d],P[u][l][d+1]],y,s)}throw new Error("geojson is invalid")}function $s(n,s){if(s=s||{},!isObject(s))throw new Error("options is invalid");var a=s.featureIndex||0,u=s.multiFeatureIndex||0,l=s.geometryIndex||0,d=s.coordIndex||0,y=s.properties,w;switch(n.type){case"FeatureCollection":a<0&&(a=n.features.length+a),y=y||n.features[a].properties,w=n.features[a].geometry;break;case"Feature":y=y||n.properties,w=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":w=n;break;default:throw new Error("geojson is invalid")}if(w===null)return null;var P=w.coordinates;switch(w.type){case"Point":return point(P,y,s);case"MultiPoint":return u<0&&(u=P.length+u),point(P[u],y,s);case"LineString":return d<0&&(d=P.length+d),point(P[d],y,s);case"Polygon":return l<0&&(l=P.length+l),d<0&&(d=P[l].length+d),point(P[l][d],y,s);case"MultiLineString":return u<0&&(u=P.length+u),d<0&&(d=P[u].length+d),point(P[u][d],y,s);case"MultiPolygon":return u<0&&(u=P.length+u),l<0&&(l=P[u].length+l),d<0&&(d=P[u][l].length-d),point(P[u][l][d],y,s)}throw new Error("geojson is invalid")}function Bo(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Ii(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Bo(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Bo(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function Js(n,s){var a=[],u={};if(n.features=n.features.filter(function(d){var y=d.geometry;return d!=null&&y&&y.type&&y.coordinates&&y.coordinates.length>0}),Jt()(n,!0),n.features.length===0)return{dataArray:[],featureKeys:u};var l=0;return Hi(n,function(d,y){var w=Fr(d),P=y,k=Ii(Ii({},d.properties),{},{coordinates:w,_id:P});a.push(k)}),{dataArray:a,featureKeys:u}}function da(n,s){var a=s.extent,u=new Promise(function(d){ii(n,function(y){d(y)})}),l={images:u,_id:1,dataArray:[{_id:0,coordinates:[[a[0],a[1]],[a[2],a[3]]]}]};return l}function ii(n,s){var a=n,u=[];if(typeof a=="string")(0,Xe.gJ)({url:a},function(y,w){u.push(w),s(u)});else{var l=a.length,d=0;a.forEach(function(y){(0,Xe.gJ)({url:y},function(w,P){d++,u.push(P),d===l&&s(u)})})}return da}function Oi(n,s){var a=s.extent,u=s.width,l=s.height,d=s.min,y=s.max,w={_id:1,dataArray:[{_id:1,data:Array.from(n),width:u,height:l,min:d,max:y,coordinates:[[a[0],a[1]],[a[2],a[3]]]}]};return w}var qi=_(30236),ws=_.n(qi),Qs=_(47037),Gl=_.n(Qs);function Ve(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function ur(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Ve(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Ve(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function $t(n,s){var a=s.radius,u=a===void 0?40:a,l=s.maxZoom,d=l===void 0?18:l,y=s.minZoom,w=y===void 0?0:y,P=s.zoom,k=P===void 0?2:P;if(n.pointIndex){var $=n.pointIndex.getClusters(n.extent,Math.floor(k));return n.dataArray=wn($),n}var W=new(ce())({radius:u,minZoom:w,maxZoom:d}),me={type:"FeatureCollection",features:[]};return me.features=n.dataArray.map(function(Je){return{type:"Feature",geometry:{type:"Point",coordinates:Je.coordinates},properties:ur({},Je)}}),W.load(me.features),W}function wn(n){return n.map(function(s,a){return ur({coordinates:s.geometry.coordinates,_id:a+1},s.properties)})}function zi(n){if(n.length===0)throw new Error("max requires at least one data point");for(var s=n[0],a=1;a<n.length;a++)n[a]>s&&(s=n[a]);return s}function Oe(n){if(n.length===0)throw new Error("min requires at least one data point");for(var s=n[0],a=1;a<n.length;a++)n[a]<s&&(s=n[a]);return s}function xe(n){if(n.length===0)return 0;for(var s=n[0],a=0,u,l=1;l<n.length;l++)u=s+n[l]*1,Math.abs(s)>=Math.abs(n[l])?a+=s-u+n[l]:a+=n[l]-u+s,s=u;return s+a*1}function ft(n){if(n.length===0)throw new Error("mean requires at least one data point");return xe(n)/n.length}var zt={min:Oe,max:zi,mean:ft,sum:xe};function jt(n,s){return n.map(function(a){return a[s]*1})}function mt(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function ht(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?mt(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):mt(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function It(n){var s=De();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function De(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function st(n,s){if(Array.isArray(s))return s}var Ae=function(n){(0,we.Z)(a,n);var s=It(a);function a(u,l){var d;return(0,fe.Z)(this,a),d=s.call(this),d.data=void 0,d.extent=void 0,d.hooks={init:new Fi.ni},d.parser={type:"geojson"},d.transforms=[],d.cluster=!1,d.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},d.mapService=void 0,d.invalidExtent=!1,d.originData=void 0,d.rawData=void 0,d.cfg={},d.clusterIndex=void 0,d.originData=u,d.initCfg(l),d.hooks.init.tap("parser",function(){d.excuteParser()}),d.hooks.init.tap("cluster",function(){d.initCluster()}),d.hooks.init.tap("transform",function(){d.executeTrans()}),d.init(),d}return(0,Q.Z)(a,[{key:"setData",value:function(l,d){this.rawData=l,this.originData=l,this.initCfg(d),this.init(),this.emit("update")}},{key:"getClusters",value:function(l){return this.clusterIndex.getClusters(this.caculClusterExtent(2),l)}},{key:"getClustersLeaves",value:function(l){return this.clusterIndex.getLeaves(l,Infinity)}},{key:"updateClusterData",value:function(l){var d=this,y=this.clusterOptions,w=y.method,P=w===void 0?"sum":w,k=y.field,$=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(l));this.clusterOptions.zoom=l,$.forEach(function(W){W.id||(W.properties.point_count=1)}),(k||ys()(P))&&($=$.map(function(W){var me=W.id;if(me){var Je=d.clusterIndex.getLeaves(me,Infinity),pt=Je.map(function(Mr){return Mr.properties}),Zt;if(Gl()(P)&&k){var Pr=jt(pt,k);Zt=zt[P](Pr)}ys()(P)&&(Zt=P(pt)),W.properties.stat=Zt}else W.properties.point_count=1;return W})),this.data=Oh("geojson")({type:"FeatureCollection",features:$}),this.executeTrans()}},{key:"getFeatureById",value:function(l){var d=this.parser.type,y=d===void 0?"geojson":d;if(y==="geojson"&&!this.cluster){var w=l<this.originData.features.length?this.originData.features[l]:"null",P=Xc()(w);if(this.transforms.length!==0){var k=this.data.dataArray.find(function($){return $._id===l});P.properties=k}return P}else return l<this.data.dataArray.length?this.data.dataArray[l]:"null"}},{key:"getFeatureId",value:function(l,d){var y=this.data.dataArray.find(function(w){return w[l]===name});return y==null?void 0:y._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"caculClusterExtent",value:function(l){var d=[[-Infinity,-Infinity],[Infinity,Infinity]];return this.invalidExtent||(d=(0,Xe.yA)((0,Xe.ds)(this.extent),l)),d[0].concat(d[1])}},{key:"initCfg",value:function(l){this.cfg=ws()(this.cfg,l,st);var d=this.cfg;d&&(d.parser&&(this.parser=d.parser),d.transforms&&(this.transforms=d.transforms),this.cluster=d.cluster||!1,d.clusterOptions&&(this.cluster=!0,this.clusterOptions=ht(ht({},this.clusterOptions),d.clusterOptions)))}},{key:"excuteParser",value:function(){var l=this.parser,d=l.type||"geojson",y=Oh(d);this.data=y(this.originData,l),this.extent=(0,Xe.We)(this.data.dataArray),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3]}},{key:"executeTrans",value:function(){var l=this,d=this.transforms;d.forEach(function(y){var w=y.type,P=ip(w)(l.data,y);Object.assign(l.data,P)})}},{key:"initCluster",value:function(){if(!!this.cluster){var l=this.clusterOptions||{};this.clusterIndex=$t(this.data,l)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),a}(Ut.EventEmitter);function kt(n,s){var a=s.callback;return a&&(n.dataArray=n.dataArray.filter(a)),n}function Gt(n,s){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Ar(n))||s&&n&&typeof n.length=="number"){a&&(n=a);var u=0,l=function(){};return{s:l,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(k){throw k},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=!0,y=!1,w;return{s:function(){a=a.call(n)},n:function(){var k=a.next();return d=k.done,k},e:function(k){y=!0,w=k},f:function(){try{!d&&a.return!=null&&a.return()}finally{if(y)throw w}}}}function Ar(n,s){if(!!n){if(typeof n=="string")return or(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return or(n,s)}}function or(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}var xr=6378e3;function Yr(n,s){var a=n.dataArray,u=s.size,l=u===void 0?10:u,d=l/(2*Math.PI*xr)*(256<<20)/2,y=Bn(a,l),w=y.gridHash,P=y.gridOffset,k=Pi(w,P,s);return{yOffset:d,xOffset:d,radius:d,type:"grid",dataArray:k}}function Bn(n,s){var a=Infinity,u=-Infinity,l,d=Gt(n),y;try{for(d.s();!(y=d.n()).done;){var w=y.value;l=w.coordinates[1],Number.isFinite(l)&&(a=l<a?l:a,u=l>u?l:u)}}catch(dn){d.e(dn)}finally{d.f()}var P=(a+u)/2,k=Ni(s,P);if(k.xOffset<=0||k.yOffset<=0)return{gridHash:{},gridOffset:k};var $={},W=Gt(n),me;try{for(W.s();!(me=W.n()).done;){var Je=me.value,pt=Je.coordinates[1],Zt=Je.coordinates[0];if(Number.isFinite(pt)&&Number.isFinite(Zt)){var Pr=Math.floor((pt+90)/k.yOffset),Mr=Math.floor((Zt+180)/k.xOffset),hn="".concat(Pr,"-").concat(Mr);$[hn]=$[hn]||{count:0,points:[]},$[hn].count+=1,$[hn].points.push(Je)}}}catch(dn){W.e(dn)}finally{W.f()}return{gridHash:$,gridOffset:k}}function Ni(n,s){var a=Dn(n),u=ai(s,n);return{yOffset:a,xOffset:u}}function Dn(n){return n/xr*(180/Math.PI)}function ai(n,s){return s/xr*(180/Math.PI)/Math.cos(n*Math.PI/180)}function Pi(n,s,a){return Object.keys(n).reduce(function(u,l,d){var y=l.split("-"),w=parseInt(y[0],10),P=parseInt(y[1],10),k={};if(a.field&&a.method){var $=Xe.a5.getColumn(n[l].points,a.field);k[a.method]=Xe.a5.statMap[a.method]($)}return Object.assign(k,{_id:d,coordinates:(0,Xe.Z)([-180+s.xOffset*(P+.5),-90+s.yOffset*(w+.5)]),rawData:n[l].points,count:n[l].count}),u.push(k),u},[])}var ea=Math.PI/3,Vo=[0,ea,2*ea,3*ea,4*ea,5*ea];function ku(n){return n[0]}function uh(n){return n[1]}function _l(){var n=0,s=0,a=1,u=1,l=ku,d=uh,y,w,P;function k(W){var me={},Je=[],pt,Zt=W.length;for(pt=0;pt<Zt;++pt)if(!(isNaN(Mr=+l.call(null,Pr=W[pt],pt,W))||isNaN(hn=+d.call(null,Pr,pt,W)))){var Pr,Mr,hn,dn=Math.round(hn=hn/P),Fn=Math.round(Mr=Mr/w-(dn&1)/2),Xn=hn-dn;if(Math.abs(Xn)*3>1){var Zi=Mr-Fn,ti=Fn+(Mr<Fn?-1:1)/2,$i=dn+(hn<dn?-1:1),Ca=Mr-ti,ka=hn-$i;Zi*Zi+Xn*Xn>Ca*Ca+ka*ka&&(Fn=ti+(dn&1?1:-1)/2,dn=$i)}var di=Fn+"-"+dn,_a=me[di];_a?_a.push(Pr):(Je.push(_a=me[di]=[Pr]),_a.x=(Fn+(dn&1)/2)*w,_a.y=dn*P)}return Je}function $(W){var me=0,Je=0;return Vo.map(function(pt){var Zt=Math.sin(pt)*W,Pr=-Math.cos(pt)*W,Mr=Zt-me,hn=Pr-Je;return me=Zt,Je=Pr,[Mr,hn]})}return k.hexagon=function(W){return"m"+$(W==null?y:+W).join("l")+"z"},k.centers=function(){for(var W=[],me=Math.round(s/P),Je=Math.round(n/w),pt=me*P;pt<u+y;pt+=P,++me)for(var Zt=Je*w+(me&1)*w/2;Zt<a+w/2;Zt+=w)W.push([Zt,pt]);return W},k.mesh=function(){var W=$(y).slice(0,4).join("l");return k.centers().map(function(me){return"M"+me+"m"+W}).join("")},k.x=function(W){return arguments.length?(l=W,k):l},k.y=function(W){return arguments.length?(d=W,k):d},k.radius=function(W){return arguments.length?(y=+W,w=y*2*Math.sin(ea),P=y*1.5,k):y},k.size=function(W){return arguments.length?(n=s=0,a=+W[0],u=+W[1],k):[a-n,u-s]},k.extent=function(W){return arguments.length?(n=+W[0][0],s=+W[0][1],a=+W[1][0],u=+W[1][1],k):[[n,s],[a,u]]},k.radius(1)}function lh(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function xl(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?lh(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):lh(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}var Uf=6378e3;function jf(n,s){var a=n.dataArray,u=s.size,l=u===void 0?10:u,d=s.method,y=d===void 0?"sum":d,w=l/(2*Math.PI*Uf)*(256<<20)/2,P=a.map(function(me){var Je=(0,Xe.Z)(me.coordinates),pt=(0,ie.Z)(Je,2),Zt=pt[0],Pr=pt[1];return xl(xl({},me),{},{coordinates:[Zt,Pr]})}),k=_l().radius(w).x(function(me){return me.coordinates[0]}).y(function(me){return me.coordinates[1]}),$=k(P),W={dataArray:$.map(function(me,Je){var pt;if(s.field&&y){var Zt=Xe.a5.getColumn(me,s.field);me[y]=Xe.a5.statMap[y](Zt)}return pt={},(0,F.Z)(pt,s.method,me[y]),(0,F.Z)(pt,"count",me.length),(0,F.Z)(pt,"rawData",me),(0,F.Z)(pt,"coordinates",[me.x,me.y]),(0,F.Z)(pt,"_id",Je),pt}),radius:w,xOffset:w,yOffset:w,type:"hexagon"};return W}function ap(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Zf(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ap(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):ap(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function td(n,s){var a=s.sourceField,u=s.targetField,l=s.data,d={};return l.forEach(function(y){d[y[a]]=y}),n.dataArray=n.dataArray.map(function(y){var w=y[u];return Zf(Zf({},y),d[w])}),n}function vs(n,s){var a=s.callback;return a&&(n.dataArray=n.dataArray.map(a)),n}var Ao=_(2121),rd=Ae;Bf("geojson",Js),Bf("image",da),Bf("csv",Yn),Bf("json",br),Bf("raster",Oi),hf("cluster",$t),hf("filter",kt),hf("join",td),hf("map",vs),hf("grid",Yr),hf("hexagon",jf);var Pp,Mp,nd=(Pp=(0,Et.b2)(),Pp(Mp=function(){function n(){(0,fe.Z)(this,n),this.mapService=void 0}return(0,Q.Z)(n,[{key:"apply",value:function(a){var u=this;this.mapService=a.getContainer().get(S.vK.IMapService),a.hooks.init.tap("DataSourcePlugin",function(){var l=a.sourceOption,d=l.data,y=l.options;a.setSource(new rd(d,y)),u.updateClusterData(a)}),a.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var l=u.updateClusterData(a),d=a.dataState.dataSourceNeedUpdate;return a.dataState.dataSourceNeedUpdate=!1,l||d})}},{key:"updateClusterData",value:function(a){var u=a.getSource(),l=u.cluster,d=u.clusterOptions,y=d.zoom,w=y===void 0?0:y,P=d.maxZoom,k=P===void 0?16:P,$=this.mapService.getZoom()-1,W=a.dataState.dataSourceNeedUpdate;return l&&(W||Math.abs(w-$)>1)&&k>w?(u.updateClusterData(Math.floor($)),!0):!1}}]),n}())||Mp),id=_(44908),Ip=_.n(id),Vf=_(14293),Cf=_.n(Vf);function op(n,s){return n<s?-1:n>s?1:n>=s?0:NaN}function rs(n){return n.length===1&&(n=Dh(n)),{left:function(a,u,l,d){for(l==null&&(l=0),d==null&&(d=a.length);l<d;){var y=l+d>>>1;n(a[y],u)<0?l=y+1:d=y}return l},right:function(a,u,l,d){for(l==null&&(l=0),d==null&&(d=a.length);l<d;){var y=l+d>>>1;n(a[y],u)>0?d=y:l=y+1}return l}}}function Dh(n){return function(s,a){return op(n(s),a)}}var Yc=rs(op),sp=Yc.right,Op=Yc.left,ch=sp;function fh(n,s){var a=n.length,u=-1,l,d,y;if(s==null){for(;++u<a;)if((l=n[u])!=null&&l>=l)for(d=y=l;++u<a;)(l=n[u])!=null&&(d>l&&(d=l),y<l&&(y=l))}else for(;++u<a;)if((l=s(n[u],u,n))!=null&&l>=l)for(d=y=l;++u<a;)(l=s(n[u],u,n))!=null&&(d>l&&(d=l),y<l&&(y=l));return[d,y]}var Kc=Array.prototype,kd=Kc.slice,Fd=Kc.map,Lp=Math.sqrt(50),ms=Math.sqrt(10),$c=Math.sqrt(2);function Rp(n,s,a){var u,l=-1,d,y,w;if(s=+s,n=+n,a=+a,n===s&&a>0)return[n];if((u=s<n)&&(d=n,n=s,s=d),(w=e(n,s,a))===0||!isFinite(w))return[];if(w>0)for(n=Math.ceil(n/w),s=Math.floor(s/w),y=new Array(d=Math.ceil(s-n+1));++l<d;)y[l]=(n+l)*w;else for(n=Math.floor(n*w),s=Math.ceil(s*w),y=new Array(d=Math.ceil(n-s+1));++l<d;)y[l]=(n-l)/w;return u&&y.reverse(),y}function e(n,s,a){var u=(s-n)/Math.max(0,a),l=Math.floor(Math.log(u)/Math.LN10),d=u/Math.pow(10,l);return l>=0?(d>=Lp?10:d>=ms?5:d>=$c?2:1)*Math.pow(10,l):-Math.pow(10,-l)/(d>=Lp?10:d>=ms?5:d>=$c?2:1)}function t(n,s,a){var u=Math.abs(s-n)/Math.max(0,a),l=Math.pow(10,Math.floor(Math.log(u)/Math.LN10)),d=u/l;return d>=Lp?l*=10:d>=ms?l*=5:d>=$c&&(l*=2),s<n?-l:l}function r(){var n=identity,s=extent,a=sturges;function u(l){var d,y=l.length,w,P=new Array(y);for(d=0;d<y;++d)P[d]=n(l[d],d,l);var k=s(P),$=k[0],W=k[1],me=a(P,$,W);Array.isArray(me)||(me=tickStep($,W,me),me=range(Math.ceil($/me)*me,W,me));for(var Je=me.length;me[0]<=$;)me.shift(),--Je;for(;me[Je-1]>W;)me.pop(),--Je;var pt=new Array(Je+1),Zt;for(d=0;d<=Je;++d)Zt=pt[d]=[],Zt.x0=d>0?me[d-1]:$,Zt.x1=d<Je?me[d]:W;for(d=0;d<y;++d)w=P[d],$<=w&&w<=W&&pt[bisect(me,w,0,Je)].push(l[d]);return pt}return u.value=function(l){return arguments.length?(n=typeof l=="function"?l:constant(l),u):n},u.domain=function(l){return arguments.length?(s=typeof l=="function"?l:constant([l[0],l[1]]),u):s},u.thresholds=function(l){return arguments.length?(a=typeof l=="function"?l:Array.isArray(l)?constant(slice.call(l)):constant(l),u):a},u}function f(n,s,a){return n=map.call(n,number).sort(ascending),Math.ceil((a-s)/(2*(quantile(n,.75)-quantile(n,.25))*Math.pow(n.length,-1/3)))}function v(n){return n===null?NaN:+n}function m(n,s,a){if(a==null&&(a=v),!!(u=n.length)){if((s=+s)<=0||u<2)return+a(n[0],0,n);if(s>=1)return+a(n[u-1],u-1,n);var u,l=(u-1)*s,d=Math.floor(l),y=+a(n[d],d,n),w=+a(n[d+1],d+1,n);return y+(w-y)*(l-d)}}var x="$";function T(){}T.prototype=D.prototype={constructor:T,has:function(s){return x+s in this},get:function(s){return this[x+s]},set:function(s,a){return this[x+s]=a,this},remove:function(s){var a=x+s;return a in this&&delete this[a]},clear:function(){for(var s in this)s[0]===x&&delete this[s]},keys:function(){var s=[];for(var a in this)a[0]===x&&s.push(a.slice(1));return s},values:function(){var s=[];for(var a in this)a[0]===x&&s.push(this[a]);return s},entries:function(){var s=[];for(var a in this)a[0]===x&&s.push({key:a.slice(1),value:this[a]});return s},size:function(){var s=0;for(var a in this)a[0]===x&&++s;return s},empty:function(){for(var s in this)if(s[0]===x)return!1;return!0},each:function(s){for(var a in this)a[0]===x&&s(this[a],a.slice(1),this)}};function D(n,s){var a=new T;if(n instanceof T)n.each(function(w,P){a.set(P,w)});else if(Array.isArray(n)){var u=-1,l=n.length,d;if(s==null)for(;++u<l;)a.set(u,n[u]);else for(;++u<l;)a.set(s(d=n[u],u,n),d)}else if(n)for(var y in n)a.set(y,n[y]);return a}var N=D;function V(){var n=[],s=[],a,u,l;function d(w,P,k,$){if(P>=n.length)return a!=null&&w.sort(a),u!=null?u(w):w;for(var W=-1,me=w.length,Je=n[P++],pt,Zt,Pr=map(),Mr,hn=k();++W<me;)(Mr=Pr.get(pt=Je(Zt=w[W])+""))?Mr.push(Zt):Pr.set(pt,[Zt]);return Pr.each(function(dn,Fn){$(hn,Fn,d(dn,P,k,$))}),hn}function y(w,P){if(++P>n.length)return w;var k,$=s[P-1];return u!=null&&P>=n.length?k=w.entries():(k=[],w.each(function(W,me){k.push({key:me,values:y(W,P)})})),$!=null?k.sort(function(W,me){return $(W.key,me.key)}):k}return l={object:function(P){return d(P,0,ne,oe)},map:function(P){return d(P,0,Se,je)},entries:function(P){return y(d(P,0,Se,je),0)},key:function(P){return n.push(P),l},sortKeys:function(P){return s[n.length-1]=P,l},sortValues:function(P){return a=P,l},rollup:function(P){return u=P,l}}}function ne(){return{}}function oe(n,s,a){n[s]=a}function Se(){return map()}function je(n,s,a){n.set(s,a)}function Fe(){}var tt=N.prototype;Fe.prototype=at.prototype={constructor:Fe,has:tt.has,add:function(s){return s+="",this[x+s]=s,this},remove:tt.remove,clear:tt.clear,values:tt.keys,size:tt.size,empty:tt.empty,each:tt.each};function at(n,s){var a=new Fe;if(n instanceof Fe)n.each(function(d){a.add(d)});else if(n){var u=-1,l=n.length;if(s==null)for(;++u<l;)a.add(n[u]);else for(;++u<l;)a.add(s(n[u],u,n))}return a}var Lt=null,Wt=Array.prototype,qt=Wt.map,Cr=Wt.slice;function vr(n,s){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(s).domain(n);break}return this}function an(n,s){switch(arguments.length){case 0:break;case 1:this.interpolator(n);break;default:this.interpolator(s).domain(n);break}return this}var sn={name:"implicit"};function Tn(){var n=N(),s=[],a=[],u=sn;function l(d){var y=d+"",w=n.get(y);if(!w){if(u!==sn)return u;n.set(y,w=s.push(d))}return a[(w-1)%a.length]}return l.domain=function(d){if(!arguments.length)return s.slice();s=[],n=N();for(var y=-1,w=d.length,P,k;++y<w;)n.has(k=(P=d[y])+"")||n.set(k,s.push(P));return l},l.range=function(d){return arguments.length?(a=Cr.call(d),l):a.slice()},l.unknown=function(d){return arguments.length?(u=d,l):u},l.copy=function(){return Tn(s,a).unknown(u)},vr.apply(l,arguments),l}function Un(){var n=ordinal().unknown(void 0),s=n.domain,a=n.range,u=[0,1],l,d,y=!1,w=0,P=0,k=.5;delete n.unknown;function $(){var W=s().length,me=u[1]<u[0],Je=u[me-0],pt=u[1-me];l=(pt-Je)/Math.max(1,W-w+P*2),y&&(l=Math.floor(l)),Je+=(pt-Je-l*(W-w))*k,d=l*(1-w),y&&(Je=Math.round(Je),d=Math.round(d));var Zt=sequence(W).map(function(Pr){return Je+l*Pr});return a(me?Zt.reverse():Zt)}return n.domain=function(W){return arguments.length?(s(W),$()):s()},n.range=function(W){return arguments.length?(u=[+W[0],+W[1]],$()):u.slice()},n.rangeRound=function(W){return u=[+W[0],+W[1]],y=!0,$()},n.bandwidth=function(){return d},n.step=function(){return l},n.round=function(W){return arguments.length?(y=!!W,$()):y},n.padding=function(W){return arguments.length?(w=Math.min(1,P=+W),$()):w},n.paddingInner=function(W){return arguments.length?(w=Math.min(1,W),$()):w},n.paddingOuter=function(W){return arguments.length?(P=+W,$()):P},n.align=function(W){return arguments.length?(k=Math.max(0,Math.min(1,W)),$()):k},n.copy=function(){return Un(s(),u).round(y).paddingInner(w).paddingOuter(P).align(k)},initRange.apply($(),arguments)}function kn(n){var s=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return kn(s())},n}function Pn(){return kn(Un.apply(null,arguments).paddingInner(1))}var ui=_(82983);function Jn(n,s,a,u,l){var d=n*n,y=d*n;return((1-3*n+3*d-y)*s+(4-6*d+3*y)*a+(1+3*n+3*d-3*y)*u+y*l)/6}function Vn(n){var s=n.length-1;return function(a){var u=a<=0?a=0:a>=1?(a=1,s-1):Math.floor(a*s),l=n[u],d=n[u+1],y=u>0?n[u-1]:2*l-d,w=u<s-1?n[u+2]:2*d-l;return Jn((a-u/s)*s,y,l,d,w)}}function Qi(n){var s=n.length;return function(a){var u=Math.floor(((a%=1)<0?++a:a)*s),l=n[(u+s-1)%s],d=n[u%s],y=n[(u+1)%s],w=n[(u+2)%s];return Jn((a-u/s)*s,l,d,y,w)}}function Si(n){return function(){return n}}function ga(n,s){return function(a){return n+a*s}}function li(n,s,a){return n=Math.pow(n,a),s=Math.pow(s,a)-n,a=1/a,function(u){return Math.pow(n+u*s,a)}}function aa(n,s){var a=s-n;return a?ga(n,a>180||a<-180?a-360*Math.round(a/360):a):constant(isNaN(n)?s:n)}function fo(n){return(n=+n)==1?Qa:function(s,a){return a-s?li(s,a,n):Si(isNaN(s)?a:s)}}function Qa(n,s){var a=s-n;return a?ga(n,a):Si(isNaN(n)?s:n)}var _o=function n(s){var a=fo(s);function u(l,d){var y=a((l=(0,ui.B8)(l)).r,(d=(0,ui.B8)(d)).r),w=a(l.g,d.g),P=a(l.b,d.b),k=Qa(l.opacity,d.opacity);return function($){return l.r=y($),l.g=w($),l.b=P($),l.opacity=k($),l+""}}return u.gamma=n,u}(1);function xo(n){return function(s){var a=s.length,u=new Array(a),l=new Array(a),d=new Array(a),y,w;for(y=0;y<a;++y)w=(0,ui.B8)(s[y]),u[y]=w.r||0,l[y]=w.g||0,d[y]=w.b||0;return u=n(u),l=n(l),d=n(d),w.opacity=1,function(P){return w.r=u(P),w.g=l(P),w.b=d(P),w+""}}}var Xo=xo(Vn),lu=xo(Qi);function gs(n,s){return(isNumberArray(s)?numberArray:cu)(n,s)}function cu(n,s){var a=s?s.length:0,u=n?Math.min(a,n.length):0,l=new Array(u),d=new Array(a),y;for(y=0;y<u;++y)l[y]=qa(n[y],s[y]);for(;y<a;++y)d[y]=s[y];return function(w){for(y=0;y<u;++y)d[y]=l[y](w);return d}}function Bs(n,s){var a=new Date;return n=+n,s=+s,function(u){return a.setTime(n*(1-u)+s*u),a}}function Us(n,s){return n=+n,s=+s,function(a){return n*(1-a)+s*a}}function Ts(n,s){var a={},u={},l;(n===null||typeof n!="object")&&(n={}),(s===null||typeof s!="object")&&(s={});for(l in s)l in n?a[l]=qa(n[l],s[l]):u[l]=s[l];return function(d){for(l in a)u[l]=a[l](d);return u}}var Yo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ns=new RegExp(Yo.source,"g");function fa(n){return function(){return n}}function na(n){return function(s){return n(s)+""}}function Va(n,s){var a=Yo.lastIndex=ns.lastIndex=0,u,l,d,y=-1,w=[],P=[];for(n=n+"",s=s+"";(u=Yo.exec(n))&&(l=ns.exec(s));)(d=l.index)>a&&(d=s.slice(a,d),w[y]?w[y]+=d:w[++y]=d),(u=u[0])===(l=l[0])?w[y]?w[y]+=l:w[++y]=l:(w[++y]=null,P.push({i:y,x:Us(u,l)})),a=ns.lastIndex;return a<s.length&&(d=s.slice(a),w[y]?w[y]+=d:w[++y]=d),w.length<2?P[0]?na(P[0].x):fa(s):(s=P.length,function(k){for(var $=0,W;$<s;++$)w[(W=P[$]).i]=W.x(k);return w.join("")})}function eo(n,s){s||(s=[]);var a=n?Math.min(s.length,n.length):0,u=s.slice(),l;return function(d){for(l=0;l<a;++l)u[l]=n[l]*(1-d)+s[l]*d;return u}}function xu(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function qa(n,s){var a=typeof s,u;return s==null||a==="boolean"?Si(s):(a==="number"?Us:a==="string"?(u=(0,ui.ZP)(s))?(s=u,_o):Va:s instanceof ui.ZP?_o:s instanceof Date?Bs:xu(s)?eo:Array.isArray(s)?cu:typeof s.valueOf!="function"&&typeof s.toString!="function"||isNaN(s)?Ts:Us)(n,s)}function Co(n,s){return n=+n,s=+s,function(a){return Math.round(n*(1-a)+s*a)}}function fu(n){return function(){return n}}function ia(n){return+n}var Jc=[0,1];function is(n){return n}function Hl(n,s){return(s-=n=+n)?function(a){return(a-n)/s}:fu(isNaN(s)?NaN:.5)}function bl(n){var s=n[0],a=n[n.length-1],u;return s>a&&(u=s,s=a,a=u),function(l){return Math.max(s,Math.min(a,l))}}function qs(n,s,a){var u=n[0],l=n[1],d=s[0],y=s[1];return l<u?(u=Hl(l,u),d=a(y,d)):(u=Hl(u,l),d=a(d,y)),function(w){return d(u(w))}}function pf(n,s,a){var u=Math.min(n.length,s.length)-1,l=new Array(u),d=new Array(u),y=-1;for(n[u]<n[0]&&(n=n.slice().reverse(),s=s.slice().reverse());++y<u;)l[y]=Hl(n[y],n[y+1]),d[y]=a(s[y],s[y+1]);return function(w){var P=ch(n,w,1,u)-1;return d[P](l[P](w))}}function hc(n,s){return s.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function Pc(){var n=Jc,s=Jc,a=qa,u,l,d,y=is,w,P,k;function $(){return w=Math.min(n.length,s.length)>2?pf:qs,P=k=null,W}function W(me){return isNaN(me=+me)?d:(P||(P=w(n.map(u),s,a)))(u(y(me)))}return W.invert=function(me){return y(l((k||(k=w(s,n.map(u),Us)))(me)))},W.domain=function(me){return arguments.length?(n=qt.call(me,ia),y===is||(y=bl(n)),$()):n.slice()},W.range=function(me){return arguments.length?(s=Cr.call(me),$()):s.slice()},W.rangeRound=function(me){return s=Cr.call(me),a=Co,$()},W.clamp=function(me){return arguments.length?(y=me?bl(n):is,W):y!==is},W.interpolate=function(me){return arguments.length?(a=me,$()):a},W.unknown=function(me){return arguments.length?(d=me,W):d},function(me,Je){return u=me,l=Je,$()}}function hh(n,s){return Pc()(n,s)}var Qc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Pf(n){if(!(s=Qc.exec(n)))throw new Error("invalid format: "+n);var s;return new Gf({fill:s[1],align:s[2],sign:s[3],symbol:s[4],zero:s[5],width:s[6],comma:s[7],precision:s[8]&&s[8].slice(1),trim:s[9],type:s[10]})}Pf.prototype=Gf.prototype;function Gf(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Gf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ph(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Hf(n,s){if((a=(n=s?n.toExponential(s-1):n.toExponential()).indexOf("e"))<0)return null;var a,u=n.slice(0,a);return[u.length>1?u[0]+u.slice(2):u,+n.slice(a+1)]}function qc(n){return n=Hf(Math.abs(n)),n?n[1]:NaN}function up(n,s){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qc(s)/3)))*3-qc(Math.abs(n)))}function Mf(n,s){return function(a,u){for(var l=a.length,d=[],y=0,w=n[0],P=0;l>0&&w>0&&(P+w+1>u&&(w=Math.max(1,u-P)),d.push(a.substring(l-=w,l+w)),!((P+=w+1)>u));)w=n[y=(y+1)%n.length];return d.reverse().join(s)}}function dh(n){return function(s){return s.replace(/[0-9]/g,function(a){return n[+a]})}}function lp(n){e:for(var s=n.length,a=1,u=-1,l;a<s;++a)switch(n[a]){case".":u=l=a;break;case"0":u===0&&(u=a),l=a;break;default:if(!+n[a])break e;u>0&&(u=0);break}return u>0?n.slice(0,u)+n.slice(l+1):n}var Wf;function If(n,s){var a=Hf(n,s);if(!a)return n+"";var u=a[0],l=a[1],d=l-(Wf=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,y=u.length;return d===y?u:d>y?u+new Array(d-y+1).join("0"):d>0?u.slice(0,d)+"."+u.slice(d):"0."+new Array(1-d).join("0")+Hf(n,Math.max(0,s+d-1))[0]}function vh(n,s){var a=Hf(n,s);if(!a)return n+"";var u=a[0],l=a[1];return l<0?"0."+new Array(-l).join("0")+u:u.length>l+1?u.slice(0,l+1)+"."+u.slice(l+1):u+new Array(l-u.length+2).join("0")}var kh={"%":function(s,a){return(s*100).toFixed(a)},b:function(s){return Math.round(s).toString(2)},c:function(s){return s+""},d:ph,e:function(s,a){return s.toExponential(a)},f:function(s,a){return s.toFixed(a)},g:function(s,a){return s.toPrecision(a)},o:function(s){return Math.round(s).toString(8)},p:function(s,a){return vh(s*100,a)},r:vh,s:If,X:function(s){return Math.round(s).toString(16).toUpperCase()},x:function(s){return Math.round(s).toString(16)}};function Fh(n){return n}var Xf=Array.prototype.map,zh=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function cp(n){var s=n.grouping===void 0||n.thousands===void 0?Fh:Mf(Xf.call(n.grouping,Number),n.thousands+""),a=n.currency===void 0?"":n.currency[0]+"",u=n.currency===void 0?"":n.currency[1]+"",l=n.decimal===void 0?".":n.decimal+"",d=n.numerals===void 0?Fh:dh(Xf.call(n.numerals,String)),y=n.percent===void 0?"%":n.percent+"",w=n.minus===void 0?"-":n.minus+"",P=n.nan===void 0?"NaN":n.nan+"";function k(W){W=Pf(W);var me=W.fill,Je=W.align,pt=W.sign,Zt=W.symbol,Pr=W.zero,Mr=W.width,hn=W.comma,dn=W.precision,Fn=W.trim,Xn=W.type;Xn==="n"?(hn=!0,Xn="g"):kh[Xn]||(dn===void 0&&(dn=12),Fn=!0,Xn="g"),(Pr||me==="0"&&Je==="=")&&(Pr=!0,me="0",Je="=");var Zi=Zt==="$"?a:Zt==="#"&&/[boxX]/.test(Xn)?"0"+Xn.toLowerCase():"",ti=Zt==="$"?u:/[%p]/.test(Xn)?y:"",$i=kh[Xn],Ca=/[defgprs%]/.test(Xn);dn=dn===void 0?6:/[gprs]/.test(Xn)?Math.max(1,Math.min(21,dn)):Math.max(0,Math.min(20,dn));function ka(di){var _a=Zi,to=ti,Ku,Sp,Ep;if(Xn==="c")to=$i(di)+to,di="";else{di=+di;var wp=di<0||1/di<0;if(di=isNaN(di)?P:$i(Math.abs(di),dn),Fn&&(di=lp(di)),wp&&+di==0&&pt!=="+"&&(wp=!1),_a=(wp?pt==="("?pt:w:pt==="-"||pt==="("?"":pt)+_a,to=(Xn==="s"?zh[8+Wf/3]:"")+to+(wp&&pt==="("?")":""),Ca){for(Ku=-1,Sp=di.length;++Ku<Sp;)if(Ep=di.charCodeAt(Ku),48>Ep||Ep>57){to=(Ep===46?l+di.slice(Ku+1):di.slice(Ku))+to,di=di.slice(0,Ku);break}}}hn&&!Pr&&(di=s(di,Infinity));var Tp=_a.length+di.length+to.length,xf=Tp<Mr?new Array(Mr-Tp+1).join(me):"";switch(hn&&Pr&&(di=s(xf+di,xf.length?Mr-to.length:Infinity),xf=""),Je){case"<":di=_a+di+to+xf;break;case"=":di=_a+xf+di+to;break;case"^":di=xf.slice(0,Tp=xf.length>>1)+_a+di+to+xf.slice(Tp);break;default:di=xf+_a+di+to;break}return d(di)}return ka.toString=function(){return W+""},ka}function $(W,me){var Je=k((W=Pf(W),W.type="f",W)),pt=Math.max(-8,Math.min(8,Math.floor(qc(me)/3)))*3,Zt=Math.pow(10,-pt),Pr=zh[8+pt/3];return function(Mr){return Je(Zt*Mr)+Pr}}return{format:k,formatPrefix:$}}var df,mh,gh;Nh({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Nh(n){return df=cp(n),mh=df.format,gh=df.formatPrefix,df}function Bh(n,s){return n=Math.abs(n),s=Math.abs(s)-n,Math.max(0,qc(s)-qc(n))+1}function yh(n){return Math.max(0,-qc(Math.abs(n)))}function Uh(n,s,a,u){var l=t(n,s,a),d;switch(u=Pf(u==null?",f":u),u.type){case"s":{var y=Math.max(Math.abs(n),Math.abs(s));return u.precision==null&&!isNaN(d=up(l,y))&&(u.precision=d),gh(u,y)}case"":case"e":case"g":case"p":case"r":{u.precision==null&&!isNaN(d=Bh(l,Math.max(Math.abs(n),Math.abs(s))))&&(u.precision=d-(u.type==="e"));break}case"f":case"%":{u.precision==null&&!isNaN(d=yh(l))&&(u.precision=d-(u.type==="%")*2);break}}return mh(u)}function vf(n){var s=n.domain;return n.ticks=function(a){var u=s();return Rp(u[0],u[u.length-1],a==null?10:a)},n.tickFormat=function(a,u){var l=s();return Uh(l[0],l[l.length-1],a==null?10:a,u)},n.nice=function(a){a==null&&(a=10);var u=s(),l=0,d=u.length-1,y=u[l],w=u[d],P;return w<y&&(P=y,y=w,w=P,P=l,l=d,d=P),P=e(y,w,a),P>0?(y=Math.floor(y/P)*P,w=Math.ceil(w/P)*P,P=e(y,w,a)):P<0&&(y=Math.ceil(y*P)/P,w=Math.floor(w*P)/P,P=e(y,w,a)),P>0?(u[l]=Math.floor(y/P)*P,u[d]=Math.ceil(w/P)*P,s(u)):P<0&&(u[l]=Math.ceil(y*P)/P,u[d]=Math.floor(w*P)/P,s(u)),n},n}function Yf(){var n=hh(is,is);return n.copy=function(){return hc(n,Yf())},vr.apply(n,arguments),vf(n)}function _h(n){var s;function a(u){return isNaN(u=+u)?s:u}return a.invert=a,a.domain=a.range=function(u){return arguments.length?(n=qt.call(u,ia),a):n.slice()},a.unknown=function(u){return arguments.length?(s=u,a):s},a.copy=function(){return _h(n).unknown(s)},n=arguments.length?qt.call(n,ia):[0,1],vf(a)}function fp(n,s){n=n.slice();var a=0,u=n.length-1,l=n[a],d=n[u],y;return d<l&&(y=a,a=u,u=y,y=l,l=d,d=y),n[a]=s.floor(l),n[u]=s.ceil(d),n}function hp(n){return Math.log(n)}function Dp(n){return Math.exp(n)}function kp(n){return-Math.log(-n)}function ad(n){return-Math.exp(-n)}function Fp(n){return isFinite(n)?+("1e"+n):n<0?0:n}function rv(n){return n===10?Fp:n===Math.E?Math.exp:function(s){return Math.pow(n,s)}}function zd(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),function(s){return Math.log(s)/n})}function xh(n){return function(s){return-n(-s)}}function Ko(n){var s=n(hp,Dp),a=s.domain,u=10,l,d;function y(){return l=zd(u),d=rv(u),a()[0]<0?(l=xh(l),d=xh(d),n(kp,ad)):n(hp,Dp),s}return s.base=function(w){return arguments.length?(u=+w,y()):u},s.domain=function(w){return arguments.length?(a(w),y()):a()},s.ticks=function(w){var P=a(),k=P[0],$=P[P.length-1],W;(W=$<k)&&(me=k,k=$,$=me);var me=l(k),Je=l($),pt,Zt,Pr,Mr=w==null?10:+w,hn=[];if(!(u%1)&&Je-me<Mr){if(me=Math.round(me)-1,Je=Math.round(Je)+1,k>0){for(;me<Je;++me)for(Zt=1,pt=d(me);Zt<u;++Zt)if(Pr=pt*Zt,!(Pr<k)){if(Pr>$)break;hn.push(Pr)}}else for(;me<Je;++me)for(Zt=u-1,pt=d(me);Zt>=1;--Zt)if(Pr=pt*Zt,!(Pr<k)){if(Pr>$)break;hn.push(Pr)}}else hn=Rp(me,Je,Math.min(Je-me,Mr)).map(d);return W?hn.reverse():hn},s.tickFormat=function(w,P){if(P==null&&(P=u===10?".0e":","),typeof P!="function"&&(P=mh(P)),w===Infinity)return P;w==null&&(w=10);var k=Math.max(1,u*w/s.ticks().length);return function($){var W=$/d(Math.round(l($)));return W*u<u-.5&&(W*=u),W<=k?P($):""}},s.nice=function(){return a(fp(a(),{floor:function(P){return d(Math.floor(l(P)))},ceil:function(P){return d(Math.ceil(l(P)))}}))},s}function pc(){var n=Ko(Pc()).domain([1,10]);return n.copy=function(){return hc(n,pc()).base(n.base())},vr.apply(n,arguments),n}function od(n){return function(s){return Math.sign(s)*Math.log1p(Math.abs(s/n))}}function mf(n){return function(s){return Math.sign(s)*Math.expm1(Math.abs(s))*n}}function zp(n){var s=1,a=n(od(s),mf(s));return a.constant=function(u){return arguments.length?n(od(s=+u),mf(s)):s},linearish(a)}function sd(){var n=zp(transformer());return n.copy=function(){return copy(n,sd()).constant(n.constant())},initRange.apply(n,arguments)}function jh(n){return function(s){return s<0?-Math.pow(-s,n):Math.pow(s,n)}}function ef(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function pp(n){return n<0?-n*n:n*n}function Zh(n){var s=n(is,is),a=1;function u(){return a===1?n(is,is):a===.5?n(ef,pp):n(jh(a),jh(1/a))}return s.exponent=function(l){return arguments.length?(a=+l,u()):a},vf(s)}function bh(){var n=Zh(Pc());return n.copy=function(){return hc(n,bh()).exponent(n.exponent())},vr.apply(n,arguments),n}function Np(){return bh.apply(null,arguments).exponent(.5)}function dp(){var n=[],s=[],a=[],u;function l(){var y=0,w=Math.max(1,s.length);for(a=new Array(w-1);++y<w;)a[y-1]=m(n,y/w);return d}function d(y){return isNaN(y=+y)?u:s[ch(a,y)]}return d.invertExtent=function(y){var w=s.indexOf(y);return w<0?[NaN,NaN]:[w>0?a[w-1]:n[0],w<a.length?a[w]:n[n.length-1]]},d.domain=function(y){if(!arguments.length)return n.slice();n=[];for(var w=0,P=y.length,k;w<P;++w)k=y[w],k!=null&&!isNaN(k=+k)&&n.push(k);return n.sort(op),l()},d.range=function(y){return arguments.length?(s=Cr.call(y),l()):s.slice()},d.unknown=function(y){return arguments.length?(u=y,d):u},d.quantiles=function(){return a.slice()},d.copy=function(){return dp().domain(n).range(s).unknown(u)},vr.apply(d,arguments)}function Bp(){var n=0,s=1,a=1,u=[.5],l=[0,1],d;function y(P){return P<=P?l[ch(u,P,0,a)]:d}function w(){var P=-1;for(u=new Array(a);++P<a;)u[P]=((P+1)*s-(P-a)*n)/(a+1);return y}return y.domain=function(P){return arguments.length?(n=+P[0],s=+P[1],w()):[n,s]},y.range=function(P){return arguments.length?(a=(l=Cr.call(P)).length-1,w()):l.slice()},y.invertExtent=function(P){var k=l.indexOf(P);return k<0?[NaN,NaN]:k<1?[n,u[0]]:k>=a?[u[a-1],s]:[u[k-1],u[k]]},y.unknown=function(P){return arguments.length&&(d=P),y},y.thresholds=function(){return u.slice()},y.copy=function(){return Bp().domain([n,s]).range(l).unknown(d)},vr.apply(vf(y),arguments)}function Sh(){var n=[.5],s=[0,1],a,u=1;function l(d){return d<=d?s[ch(n,d,0,u)]:a}return l.domain=function(d){return arguments.length?(n=Cr.call(d),u=Math.min(n.length,s.length-1),l):n.slice()},l.range=function(d){return arguments.length?(s=Cr.call(d),u=Math.min(n.length,s.length-1),l):s.slice()},l.invertExtent=function(d){var y=s.indexOf(d);return[n[y-1],n[y]]},l.unknown=function(d){return arguments.length?(a=d,l):a},l.copy=function(){return Sh().domain(n).range(s).unknown(a)},vr.apply(l,arguments)}var vp=new Date,mp=new Date;function Xu(n,s,a,u){function l(d){return n(d=arguments.length===0?new Date:new Date(+d)),d}return l.floor=function(d){return n(d=new Date(+d)),d},l.ceil=function(d){return n(d=new Date(d-1)),s(d,1),n(d),d},l.round=function(d){var y=l(d),w=l.ceil(d);return d-y<w-d?y:w},l.offset=function(d,y){return s(d=new Date(+d),y==null?1:Math.floor(y)),d},l.range=function(d,y,w){var P=[],k;if(d=l.ceil(d),w=w==null?1:Math.floor(w),!(d<y)||!(w>0))return P;do P.push(k=new Date(+d)),s(d,w),n(d);while(k<d&&d<y);return P},l.filter=function(d){return Xu(function(y){if(y>=y)for(;n(y),!d(y);)y.setTime(y-1)},function(y,w){if(y>=y)if(w<0)for(;++w<=0;)for(;s(y,-1),!d(y););else for(;--w>=0;)for(;s(y,1),!d(y););})},a&&(l.count=function(d,y){return vp.setTime(+d),mp.setTime(+y),n(vp),n(mp),Math.floor(a(vp,mp))},l.every=function(d){return d=Math.floor(d),!isFinite(d)||!(d>0)?null:d>1?l.filter(u?function(y){return u(y)%d==0}:function(y){return l.count(0,y)%d==0}):l}),l}var gp=Xu(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,s){n.setFullYear(n.getFullYear()+s)},function(n,s){return s.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});gp.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:Xu(function(s){s.setFullYear(Math.floor(s.getFullYear()/n)*n),s.setMonth(0,1),s.setHours(0,0,0,0)},function(s,a){s.setFullYear(s.getFullYear()+a*n)})};var Kf=gp,Wl=gp.range,Vh=Xu(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,s){n.setMonth(n.getMonth()+s)},function(n,s){return s.getMonth()-n.getMonth()+(s.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()}),ud=Vh,gf=Vh.range,yp=1e3,Eh=6e4,Of=36e5,$f=864e5,Jf=6048e5;function dc(n){return Xu(function(s){s.setDate(s.getDate()-(s.getDay()+7-n)%7),s.setHours(0,0,0,0)},function(s,a){s.setDate(s.getDate()+a*7)},function(s,a){return(a-s-(a.getTimezoneOffset()-s.getTimezoneOffset())*Eh)/Jf})}var Lf=dc(0),Gh=dc(1),ld=dc(2),cd=dc(3),Qf=dc(4),Up=dc(5),jp=dc(6),Rf=Lf.range,Nd=Gh.range,fd=ld.range,hd=cd.range,Bd=Qf.range,pd=Up.range,Ud=jp.range,Zp=Xu(function(n){n.setHours(0,0,0,0)},function(n,s){n.setDate(n.getDate()+s)},function(n,s){return(s-n-(s.getTimezoneOffset()-n.getTimezoneOffset())*Eh)/$f},function(n){return n.getDate()-1}),Hh=Zp,jd=Zp.range,wh=Xu(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*yp-n.getMinutes()*Eh)},function(n,s){n.setTime(+n+s*Of)},function(n,s){return(s-n)/Of},function(n){return n.getHours()}),dd=wh,Vp=wh.range,vd=Xu(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*yp)},function(n,s){n.setTime(+n+s*Eh)},function(n,s){return(s-n)/Eh},function(n){return n.getMinutes()}),md=vd,nv=vd.range,gd=Xu(function(n){n.setTime(n-n.getMilliseconds())},function(n,s){n.setTime(+n+s*yp)},function(n,s){return(s-n)/yp},function(n){return n.getUTCSeconds()}),Zd=gd,iv=gd.range,_p=Xu(function(){},function(n,s){n.setTime(+n+s)},function(n,s){return s-n});_p.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?Xu(function(s){s.setTime(Math.floor(s/n)*n)},function(s,a){s.setTime(+s+a*n)},function(s,a){return(a-s)/n}):_p};var Vd=_p,av=_p.range;function qf(n){return Xu(function(s){s.setUTCDate(s.getUTCDate()-(s.getUTCDay()+7-n)%7),s.setUTCHours(0,0,0,0)},function(s,a){s.setUTCDate(s.getUTCDate()+a*7)},function(s,a){return(a-s)/Jf})}var Mc=qf(0),eh=qf(1),yd=qf(2),_d=qf(3),Df=qf(4),xd=qf(5),ug=qf(6),k1=Mc.range,F1=eh.range,z1=yd.range,N1=_d.range,B1=Df.range,U1=xd.range,j1=ug.range,ov=Xu(function(n){n.setUTCHours(0,0,0,0)},function(n,s){n.setUTCDate(n.getUTCDate()+s)},function(n,s){return(s-n)/$f},function(n){return n.getUTCDate()-1}),sv=ov,Z1=ov.range,Gd=Xu(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,s){n.setUTCFullYear(n.getUTCFullYear()+s)},function(n,s){return s.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});Gd.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:Xu(function(s){s.setUTCFullYear(Math.floor(s.getUTCFullYear()/n)*n),s.setUTCMonth(0,1),s.setUTCHours(0,0,0,0)},function(s,a){s.setUTCFullYear(s.getUTCFullYear()+a*n)})};var Gp=Gd,V1=Gd.range;function Hd(n){if(0<=n.y&&n.y<100){var s=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return s.setFullYear(n.y),s}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function Wd(n){if(0<=n.y&&n.y<100){var s=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function Hp(n,s,a){return{y:n,m:s,d:a,H:0,M:0,S:0,L:0}}function lg(n){var s=n.dateTime,a=n.date,u=n.time,l=n.periods,d=n.days,y=n.shortDays,w=n.months,P=n.shortMonths,k=Wp(l),$=Xp(l),W=Wp(d),me=Xp(d),Je=Wp(y),pt=Xp(y),Zt=Wp(w),Pr=Xp(w),Mr=Wp(P),hn=Xp(P),dn={a:wp,A:Tp,b:xf,B:A1,c:null,d:pv,e:pv,f:Lg,g:Zg,G:Gg,H:Mg,I:Ig,j:Og,L:dv,m:Rg,M:Dg,p:C1,q:P1,Q:xv,s:bv,S:kg,u:Fg,U:zg,V:Ng,w:Bg,W:Ug,x:null,X:null,y:jg,Y:Vg,Z:Hg,"%":_v},Fn={a:M1,A:I1,b:O1,B:L1,c:null,d:mv,e:mv,f:Kg,g:ay,G:sy,H:Wg,I:Xg,j:Yg,L:gv,m:$g,M:Jg,p:R1,q:D1,Q:xv,s:bv,S:Qg,u:qg,U:ey,V:ty,w:ry,W:ny,x:null,X:null,y:iy,Y:oy,Z:uy,"%":_v},Xn={a:ka,A:di,b:_a,B:to,c:Ku,d:fv,e:fv,f:Tg,g:cv,G:lv,H:hv,I:hv,j:bg,L:wg,m:xg,M:Sg,p:Ca,q:_g,Q:Cg,s:Pg,S:Eg,u:dg,U:vg,V:mg,w:pg,W:gg,x:Sp,X:Ep,y:cv,Y:lv,Z:yg,"%":Ag};dn.x=Zi(a,dn),dn.X=Zi(u,dn),dn.c=Zi(s,dn),Fn.x=Zi(a,Fn),Fn.X=Zi(u,Fn),Fn.c=Zi(s,Fn);function Zi(Bi,Fa){return function(ua){var An=[],vc=-1,as=0,Ic=Bi.length,Oc,Yh,sg;for(ua instanceof Date||(ua=new Date(+ua));++vc<Ic;)Bi.charCodeAt(vc)===37&&(An.push(Bi.slice(as,vc)),(Yh=uv[Oc=Bi.charAt(++vc)])!=null?Oc=Bi.charAt(++vc):Yh=Oc==="e"?" ":"0",(sg=Fa[Oc])&&(Oc=sg(ua,Yh)),An.push(Oc),as=vc+1);return An.push(Bi.slice(as,vc)),An.join("")}}function ti(Bi,Fa){return function(ua){var An=Hp(1900,void 0,1),vc=$i(An,Bi,ua+="",0),as,Ic;if(vc!=ua.length)return null;if("Q"in An)return new Date(An.Q);if("s"in An)return new Date(An.s*1e3+("L"in An?An.L:0));if(Fa&&!("Z"in An)&&(An.Z=0),"p"in An&&(An.H=An.H%12+An.p*12),An.m===void 0&&(An.m="q"in An?An.q:0),"V"in An){if(An.V<1||An.V>53)return null;"w"in An||(An.w=1),"Z"in An?(as=Wd(Hp(An.y,0,1)),Ic=as.getUTCDay(),as=Ic>4||Ic===0?eh.ceil(as):eh(as),as=sv.offset(as,(An.V-1)*7),An.y=as.getUTCFullYear(),An.m=as.getUTCMonth(),An.d=as.getUTCDate()+(An.w+6)%7):(as=Hd(Hp(An.y,0,1)),Ic=as.getDay(),as=Ic>4||Ic===0?Gh.ceil(as):Gh(as),as=Hh.offset(as,(An.V-1)*7),An.y=as.getFullYear(),An.m=as.getMonth(),An.d=as.getDate()+(An.w+6)%7)}else("W"in An||"U"in An)&&("w"in An||(An.w="u"in An?An.u%7:"W"in An?1:0),Ic="Z"in An?Wd(Hp(An.y,0,1)).getUTCDay():Hd(Hp(An.y,0,1)).getDay(),An.m=0,An.d="W"in An?(An.w+6)%7+An.W*7-(Ic+5)%7:An.w+An.U*7-(Ic+6)%7);return"Z"in An?(An.H+=An.Z/100|0,An.M+=An.Z%100,Wd(An)):Hd(An)}}function $i(Bi,Fa,ua,An){for(var vc=0,as=Fa.length,Ic=ua.length,Oc,Yh;vc<as;){if(An>=Ic)return-1;if(Oc=Fa.charCodeAt(vc++),Oc===37){if(Oc=Fa.charAt(vc++),Yh=Xn[Oc in uv?Fa.charAt(vc++):Oc],!Yh||(An=Yh(Bi,ua,An))<0)return-1}else if(Oc!=ua.charCodeAt(An++))return-1}return An}function Ca(Bi,Fa,ua){var An=k.exec(Fa.slice(ua));return An?(Bi.p=$[An[0].toLowerCase()],ua+An[0].length):-1}function ka(Bi,Fa,ua){var An=Je.exec(Fa.slice(ua));return An?(Bi.w=pt[An[0].toLowerCase()],ua+An[0].length):-1}function di(Bi,Fa,ua){var An=W.exec(Fa.slice(ua));return An?(Bi.w=me[An[0].toLowerCase()],ua+An[0].length):-1}function _a(Bi,Fa,ua){var An=Mr.exec(Fa.slice(ua));return An?(Bi.m=hn[An[0].toLowerCase()],ua+An[0].length):-1}function to(Bi,Fa,ua){var An=Zt.exec(Fa.slice(ua));return An?(Bi.m=Pr[An[0].toLowerCase()],ua+An[0].length):-1}function Ku(Bi,Fa,ua){return $i(Bi,s,Fa,ua)}function Sp(Bi,Fa,ua){return $i(Bi,a,Fa,ua)}function Ep(Bi,Fa,ua){return $i(Bi,u,Fa,ua)}function wp(Bi){return y[Bi.getDay()]}function Tp(Bi){return d[Bi.getDay()]}function xf(Bi){return P[Bi.getMonth()]}function A1(Bi){return w[Bi.getMonth()]}function C1(Bi){return l[+(Bi.getHours()>=12)]}function P1(Bi){return 1+~~(Bi.getMonth()/3)}function M1(Bi){return y[Bi.getUTCDay()]}function I1(Bi){return d[Bi.getUTCDay()]}function O1(Bi){return P[Bi.getUTCMonth()]}function L1(Bi){return w[Bi.getUTCMonth()]}function R1(Bi){return l[+(Bi.getUTCHours()>=12)]}function D1(Bi){return 1+~~(Bi.getUTCMonth()/3)}return{format:function(Fa){var ua=Zi(Fa+="",dn);return ua.toString=function(){return Fa},ua},parse:function(Fa){var ua=ti(Fa+="",!1);return ua.toString=function(){return Fa},ua},utcFormat:function(Fa){var ua=Zi(Fa+="",Fn);return ua.toString=function(){return Fa},ua},utcParse:function(Fa){var ua=ti(Fa+="",!0);return ua.toString=function(){return Fa},ua}}}var uv={"-":"",_:" ","0":"0"},Yu=/^\s*\d+/,cg=/^%/,fg=/[\\^$*+?|[\]().{}]/g;function ho(n,s,a){var u=n<0?"-":"",l=(u?-n:n)+"",d=l.length;return u+(d<a?new Array(a-d+1).join(s)+l:l)}function hg(n){return n.replace(fg,"\\$&")}function Wp(n){return new RegExp("^(?:"+n.map(hg).join("|")+")","i")}function Xp(n){for(var s={},a=-1,u=n.length;++a<u;)s[n[a].toLowerCase()]=a;return s}function pg(n,s,a){var u=Yu.exec(s.slice(a,a+1));return u?(n.w=+u[0],a+u[0].length):-1}function dg(n,s,a){var u=Yu.exec(s.slice(a,a+1));return u?(n.u=+u[0],a+u[0].length):-1}function vg(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.U=+u[0],a+u[0].length):-1}function mg(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.V=+u[0],a+u[0].length):-1}function gg(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.W=+u[0],a+u[0].length):-1}function lv(n,s,a){var u=Yu.exec(s.slice(a,a+4));return u?(n.y=+u[0],a+u[0].length):-1}function cv(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.y=+u[0]+(+u[0]>68?1900:2e3),a+u[0].length):-1}function yg(n,s,a){var u=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(s.slice(a,a+6));return u?(n.Z=u[1]?0:-(u[2]+(u[3]||"00")),a+u[0].length):-1}function _g(n,s,a){var u=Yu.exec(s.slice(a,a+1));return u?(n.q=u[0]*3-3,a+u[0].length):-1}function xg(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.m=u[0]-1,a+u[0].length):-1}function fv(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.d=+u[0],a+u[0].length):-1}function bg(n,s,a){var u=Yu.exec(s.slice(a,a+3));return u?(n.m=0,n.d=+u[0],a+u[0].length):-1}function hv(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.H=+u[0],a+u[0].length):-1}function Sg(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.M=+u[0],a+u[0].length):-1}function Eg(n,s,a){var u=Yu.exec(s.slice(a,a+2));return u?(n.S=+u[0],a+u[0].length):-1}function wg(n,s,a){var u=Yu.exec(s.slice(a,a+3));return u?(n.L=+u[0],a+u[0].length):-1}function Tg(n,s,a){var u=Yu.exec(s.slice(a,a+6));return u?(n.L=Math.floor(u[0]/1e3),a+u[0].length):-1}function Ag(n,s,a){var u=cg.exec(s.slice(a,a+1));return u?a+u[0].length:-1}function Cg(n,s,a){var u=Yu.exec(s.slice(a));return u?(n.Q=+u[0],a+u[0].length):-1}function Pg(n,s,a){var u=Yu.exec(s.slice(a));return u?(n.s=+u[0],a+u[0].length):-1}function pv(n,s){return ho(n.getDate(),s,2)}function Mg(n,s){return ho(n.getHours(),s,2)}function Ig(n,s){return ho(n.getHours()%12||12,s,2)}function Og(n,s){return ho(1+Hh.count(Kf(n),n),s,3)}function dv(n,s){return ho(n.getMilliseconds(),s,3)}function Lg(n,s){return dv(n,s)+"000"}function Rg(n,s){return ho(n.getMonth()+1,s,2)}function Dg(n,s){return ho(n.getMinutes(),s,2)}function kg(n,s){return ho(n.getSeconds(),s,2)}function Fg(n){var s=n.getDay();return s===0?7:s}function zg(n,s){return ho(Lf.count(Kf(n)-1,n),s,2)}function vv(n){var s=n.getDay();return s>=4||s===0?Qf(n):Qf.ceil(n)}function Ng(n,s){return n=vv(n),ho(Qf.count(Kf(n),n)+(Kf(n).getDay()===4),s,2)}function Bg(n){return n.getDay()}function Ug(n,s){return ho(Gh.count(Kf(n)-1,n),s,2)}function jg(n,s){return ho(n.getFullYear()%100,s,2)}function Zg(n,s){return n=vv(n),ho(n.getFullYear()%100,s,2)}function Vg(n,s){return ho(n.getFullYear()%1e4,s,4)}function Gg(n,s){var a=n.getDay();return n=a>=4||a===0?Qf(n):Qf.ceil(n),ho(n.getFullYear()%1e4,s,4)}function Hg(n){var s=n.getTimezoneOffset();return(s>0?"-":(s*=-1,"+"))+ho(s/60|0,"0",2)+ho(s%60,"0",2)}function mv(n,s){return ho(n.getUTCDate(),s,2)}function Wg(n,s){return ho(n.getUTCHours(),s,2)}function Xg(n,s){return ho(n.getUTCHours()%12||12,s,2)}function Yg(n,s){return ho(1+sv.count(Gp(n),n),s,3)}function gv(n,s){return ho(n.getUTCMilliseconds(),s,3)}function Kg(n,s){return gv(n,s)+"000"}function $g(n,s){return ho(n.getUTCMonth()+1,s,2)}function Jg(n,s){return ho(n.getUTCMinutes(),s,2)}function Qg(n,s){return ho(n.getUTCSeconds(),s,2)}function qg(n){var s=n.getUTCDay();return s===0?7:s}function ey(n,s){return ho(Mc.count(Gp(n)-1,n),s,2)}function yv(n){var s=n.getUTCDay();return s>=4||s===0?Df(n):Df.ceil(n)}function ty(n,s){return n=yv(n),ho(Df.count(Gp(n),n)+(Gp(n).getUTCDay()===4),s,2)}function ry(n){return n.getUTCDay()}function ny(n,s){return ho(eh.count(Gp(n)-1,n),s,2)}function iy(n,s){return ho(n.getUTCFullYear()%100,s,2)}function ay(n,s){return n=yv(n),ho(n.getUTCFullYear()%100,s,2)}function oy(n,s){return ho(n.getUTCFullYear()%1e4,s,4)}function sy(n,s){var a=n.getUTCDay();return n=a>=4||a===0?Df(n):Df.ceil(n),ho(n.getUTCFullYear()%1e4,s,4)}function uy(){return"+0000"}function _v(){return"%"}function xv(n){return+n}function bv(n){return Math.floor(+n/1e3)}var xp,Sv,ly,cy,fy;hy({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function hy(n){return xp=lg(n),Sv=xp.format,ly=xp.parse,cy=xp.utcFormat,fy=xp.utcParse,xp}var Yp=1e3,Kp=Yp*60,$p=Kp*60,Jp=$p*24,py=Jp*7,Ev=Jp*30,Xd=Jp*365;function dy(n){return new Date(n)}function vy(n){return n instanceof Date?+n:+new Date(+n)}function wv(n,s,a,u,l,d,y,w,P){var k=hh(is,is),$=k.invert,W=k.domain,me=P(".%L"),Je=P(":%S"),pt=P("%I:%M"),Zt=P("%I %p"),Pr=P("%a %d"),Mr=P("%b %d"),hn=P("%B"),dn=P("%Y"),Fn=[[y,1,Yp],[y,5,5*Yp],[y,15,15*Yp],[y,30,30*Yp],[d,1,Kp],[d,5,5*Kp],[d,15,15*Kp],[d,30,30*Kp],[l,1,$p],[l,3,3*$p],[l,6,6*$p],[l,12,12*$p],[u,1,Jp],[u,2,2*Jp],[a,1,py],[s,1,Ev],[s,3,3*Ev],[n,1,Xd]];function Xn(ti){return(y(ti)<ti?me:d(ti)<ti?Je:l(ti)<ti?pt:u(ti)<ti?Zt:s(ti)<ti?a(ti)<ti?Pr:Mr:n(ti)<ti?hn:dn)(ti)}function Zi(ti,$i,Ca,ka){if(ti==null&&(ti=10),typeof ti=="number"){var di=Math.abs(Ca-$i)/ti,_a=rs(function(to){return to[2]}).right(Fn,di);_a===Fn.length?(ka=t($i/Xd,Ca/Xd,ti),ti=n):_a?(_a=Fn[di/Fn[_a-1][2]<Fn[_a][2]/di?_a-1:_a],ka=_a[1],ti=_a[0]):(ka=Math.max(t($i,Ca,ti),1),ti=w)}return ka==null?ti:ti.every(ka)}return k.invert=function(ti){return new Date($(ti))},k.domain=function(ti){return arguments.length?W(qt.call(ti,vy)):W().map(dy)},k.ticks=function(ti,$i){var Ca=W(),ka=Ca[0],di=Ca[Ca.length-1],_a=di<ka,to;return _a&&(to=ka,ka=di,di=to),to=Zi(ti,ka,di,$i),to=to?to.range(ka,di+1):[],_a?to.reverse():to},k.tickFormat=function(ti,$i){return $i==null?Xn:P($i)},k.nice=function(ti,$i){var Ca=W();return(ti=Zi(ti,Ca[0],Ca[Ca.length-1],$i))?W(fp(Ca,ti)):k},k.copy=function(){return hc(k,wv(n,s,a,u,l,d,y,w,P))},k}function my(){return vr.apply(wv(Kf,ud,Lf,Hh,dd,md,Zd,Vd,Sv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function G1(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function bd(){var n=0,s=1,a,u,l,d,y=identity,w=!1,P;function k($){return isNaN($=+$)?P:y(l===0?.5:($=(d($)-a)*l,w?Math.max(0,Math.min(1,$)):$))}return k.domain=function($){return arguments.length?(a=d(n=+$[0]),u=d(s=+$[1]),l=a===u?0:1/(u-a),k):[n,s]},k.clamp=function($){return arguments.length?(w=!!$,k):w},k.interpolator=function($){return arguments.length?(y=$,k):y},k.unknown=function($){return arguments.length?(P=$,k):P},function($){return d=$,a=$(n),u=$(s),l=a===u?0:1/(u-a),k}}function Sd(n,s){return s.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function gy(){var n=linearish(bd()(identity));return n.copy=function(){return Sd(n,gy())},initInterpolator.apply(n,arguments)}function yy(){var n=loggish(bd()).domain([1,10]);return n.copy=function(){return Sd(n,yy()).base(n.base())},initInterpolator.apply(n,arguments)}function _y(){var n=symlogish(bd());return n.copy=function(){return Sd(n,_y()).constant(n.constant())},initInterpolator.apply(n,arguments)}function Tv(){var n=powish(bd());return n.copy=function(){return Sd(n,Tv()).exponent(n.exponent())},initInterpolator.apply(n,arguments)}function H1(){return Tv.apply(null,arguments).exponent(.5)}function xy(){var n=[],s=identity;function a(u){if(!isNaN(u=+u))return s((bisect(n,u)-1)/(n.length-1))}return a.domain=function(u){if(!arguments.length)return n.slice();n=[];for(var l=0,d=u.length,y;l<d;++l)y=u[l],y!=null&&!isNaN(y=+y)&&n.push(y);return n.sort(ascending),a},a.interpolator=function(u){return arguments.length?(s=u,a):s},a.copy=function(){return xy(s).domain(n)},initInterpolator.apply(a,arguments)}function Ed(){var n=0,s=.5,a=1,u,l,d,y,w,P=identity,k,$=!1,W;function me(Je){return isNaN(Je=+Je)?W:(Je=.5+((Je=+k(Je))-l)*(Je<l?y:w),P($?Math.max(0,Math.min(1,Je)):Je))}return me.domain=function(Je){return arguments.length?(u=k(n=+Je[0]),l=k(s=+Je[1]),d=k(a=+Je[2]),y=u===l?0:.5/(l-u),w=l===d?0:.5/(d-l),me):[n,s,a]},me.clamp=function(Je){return arguments.length?($=!!Je,me):$},me.interpolator=function(Je){return arguments.length?(P=Je,me):P},me.unknown=function(Je){return arguments.length?(W=Je,me):W},function(Je){return k=Je,u=Je(n),l=Je(s),d=Je(a),y=u===l?0:.5/(l-u),w=l===d?0:.5/(d-l),me}}function by(){var n=linearish(Ed()(identity));return n.copy=function(){return copy(n,by())},initInterpolator.apply(n,arguments)}function Sy(){var n=loggish(Ed()).domain([.1,1,10]);return n.copy=function(){return copy(n,Sy()).base(n.base())},initInterpolator.apply(n,arguments)}function Ey(){var n=symlogish(Ed());return n.copy=function(){return copy(n,Ey()).constant(n.constant())},initInterpolator.apply(n,arguments)}function Av(){var n=powish(Ed());return n.copy=function(){return copy(n,Av()).exponent(n.exponent())},initInterpolator.apply(n,arguments)}function W1(){return Av.apply(null,arguments).exponent(.5)}var yf,Cv,Pv,Mv,Iv,wd,Ov,Lv,wy=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Ty=(yf={},(0,F.Z)(yf,S.ScaleTypes.LINEAR,Yf),(0,F.Z)(yf,S.ScaleTypes.POWER,bh),(0,F.Z)(yf,S.ScaleTypes.LOG,pc),(0,F.Z)(yf,S.ScaleTypes.IDENTITY,_h),(0,F.Z)(yf,S.ScaleTypes.TIME,my),(0,F.Z)(yf,S.ScaleTypes.QUANTILE,dp),(0,F.Z)(yf,S.ScaleTypes.QUANTIZE,Bp),(0,F.Z)(yf,S.ScaleTypes.THRESHOLD,Sh),(0,F.Z)(yf,S.ScaleTypes.CAT,Tn),yf),Ay=(Cv=(0,Et.b2)(),Pv=(0,Et.f3)(S.vK.IGlobalConfigService),Mv=(0,Et.f3)(S.vK.ILogService),Cv(Iv=(wd=function(){function n(){(0,fe.Z)(this,n),(0,si.Z)(this,"configService",Ov,this),(0,si.Z)(this,"logger",Lv,this),this.scaleCache={},this.scaleOptions={}}return(0,Q.Z)(n,[{key:"apply",value:function(a,u){var l=this,d=u.styleAttributeService;a.hooks.init.tap("FeatureScalePlugin",function(){l.scaleOptions=a.getScaleOptions();var y=d.getLayerStyleAttributes(),w=a.getSource().data.dataArray;w.length!==0&&l.caculateScalesForAttributes(y||[],w)}),a.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){l.scaleOptions=a.getScaleOptions();var y=d.getLayerStyleAttributes(),w=a.getSource().data.dataArray;return l.caculateScalesForAttributes(y||[],w),a.layerModelNeedUpdate=!0,!0}),a.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!a.layerModelNeedUpdate){l.scaleOptions=a.getScaleOptions();var y=d.getLayerStyleAttributes();if(y){var w=a.getSource().data.dataArray;if(w.length===0)return;var P=y.filter(function(k){return k.needRescale});P.length&&(l.caculateScalesForAttributes(P,w),l.logger.debug("rescale finished"))}}})}},{key:"isNumber",value:function(a){return!isNaN(parseFloat(a))&&isFinite(a)}},{key:"caculateScalesForAttributes",value:function(a,u){var l=this;this.scaleCache={},a.forEach(function(d){if(d.scale){var y=d.scale,w=d.name;y.names=l.parseFields(d.scale.field||[]);var P=[];y.names.forEach(function(k){P.push(l.getOrCreateScale(k,d,u))}),P.some(function(k){return k.type===S.StyleScaleType.VARIABLE})?(y.type=S.StyleScaleType.VARIABLE,P.forEach(function(k){if(!y.callback){var $;if(y.values&&y.values!=="text"){var W;if(((W=k.option)===null||W===void 0?void 0:W.type)==="linear"&&y.values.length>2){var me=k.scale.ticks(y.values.length);w==="color"&&k.scale.domain(me)}k.scale.range(y.values)}else(($=k.option)===null||$===void 0?void 0:$.type)==="cat"&&k.scale.range(k.option.domain)}})):(y.type=S.StyleScaleType.CONSTANT,y.defaultValues=P.map(function(k,$){return k.scale(y.names[$])})),y.scalers=P.map(function(k){return{field:k.field,func:k.scale,option:k.option}}),d.needRescale=!1}})}},{key:"getOrCreateScale",value:function(a,u,l){var d,y=[a,u.name].join("_"),w=(d=u.scale)===null||d===void 0?void 0:d.values,P=this.createScale(a,u.name,w,l);return P}},{key:"parseFields",value:function(a){return Array.isArray(a)?a:Gl()(a)?a.split("*"):[a]}},{key:"createScale",value:function(a,u,l,d){var y,w=this.scaleOptions[u]&&this.scaleOptions[u].field===a?this.scaleOptions[u]:this.scaleOptions[a],P={field:a,scale:void 0,type:S.StyleScaleType.VARIABLE,option:w};if(!d||!d.length)return w&&w.type?P.scale=this.createDefaultScale(w):(P.scale=Tn([a]),P.type=S.StyleScaleType.CONSTANT),P;var k=(y=d.find(function(me){return!Cf()(me[a])}))===null||y===void 0?void 0:y[a];if(this.isNumber(a)||Cf()(k)&&!w)P.scale=Tn([a]),P.type=S.StyleScaleType.CONSTANT;else{var $=w&&w.type||this.getDefaultType(k);l==="text"&&($=S.ScaleTypes.CAT);var W=this.createDefaultScaleConfig($,a,d);Object.assign(W,w),P.scale=this.createDefaultScale(W),P.option=W}return P}},{key:"getDefaultType",value:function(a){var u=S.ScaleTypes.LINEAR;return typeof a=="string"&&(u=wy.test(a)?S.ScaleTypes.TIME:S.ScaleTypes.CAT),u}},{key:"createDefaultScaleConfig",value:function(a,u,l){var d={type:a},y=(l==null?void 0:l.map(function(w){return w[u]}))||[];return a!==S.ScaleTypes.CAT&&a!==S.ScaleTypes.QUANTILE?d.domain=fh(y):a===S.ScaleTypes.CAT?d.domain=Ip()(y):a===S.ScaleTypes.QUANTILE&&(d.domain=y),d}},{key:"createDefaultScale",value:function(a){var u=a.type,l=a.domain,d=Ty[u]();return l&&d.domain(l),d}}]),n}(),Ov=(0,Rn.Z)(wd.prototype,"configService",[Pv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lv=(0,Rn.Z)(wd.prototype,"logger",[Mv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wd))||Iv),Rv,Dv,kv,Fv,Td,zv,Nv;function Bv(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Cy(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Bv(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Bv(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}var Py=(Rv=(0,Et.b2)(),Dv=(0,Et.f3)(S.vK.ICameraService),kv=(0,Et.f3)(S.vK.IRendererService),Rv(Fv=(Td=function(){function n(){(0,fe.Z)(this,n),(0,si.Z)(this,"cameraService",zv,this),(0,si.Z)(this,"rendererService",Nv,this)}return(0,Q.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){a.models.forEach(function(u){u.addUniforms(Cy({},a.layerModel.getAnimateUniforms()))})})}}]),n}(),zv=(0,Rn.Z)(Td.prototype,"cameraService",[Dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nv=(0,Rn.Z)(Td.prototype,"rendererService",[kv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Td))||Fv),Uv,jv,My=(Uv=(0,Et.b2)(),Uv(jv=function(){function n(){(0,fe.Z)(this,n)}return(0,Q.Z)(n,[{key:"apply",value:function(a){a.hooks.init.tap("LayerModelPlugin",function(){a.prepareBuildModel(),a.buildModels(),a.styleNeedUpdate=!1}),a.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return a.prepareBuildModel(),a.clearModels(),a.buildModels(),a.layerModelNeedUpdate=!1,!1})}}]),n}())||jv),Zv,Vv,Iy=(Zv=(0,Et.b2)(),Zv(Vv=function(){function n(){(0,fe.Z)(this,n)}return(0,Q.Z)(n,[{key:"apply",value:function(a){a.hooks.afterInit.tap("LayerStylePlugin",function(){a.updateLayerConfig({});var u=a.getLayerConfig(),l=u.autoFit,d=u.fitBoundsOptions;l&&setTimeout(function(){a.fitBounds(d)},100)})}}]),n}())||Vv),Gv,Hv;function Wv(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Qp(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Wv(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Wv(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}var Xv={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Oy={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Ly={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Ry={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},X1=null;function Dy(n){var s={u_DirectionalLights:new Array(3).fill(Qp({},Ly)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Qp({},Ry)),u_NumOfSpotLights:0};return(!n||!n.length)&&(n=[Oy]),n.forEach(function(a,u){var l=a.type,d=l===void 0?"directional":l,y=(0,ki.Z)(a,["type"]),w=Xv[d].lights,P=Xv[d].num,k=s[P];s[w][k]=Qp(Qp({},s[w][k]),y),s[P]++}),s}var ky=(Gv=(0,Et.b2)(),Gv(Hv=function(){function n(){(0,fe.Z)(this,n)}return(0,Q.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("LightingPlugin",function(){var u=a.getLayerConfig(),l=u.enableLighting;l&&a.models.forEach(function(d){return d.addUniforms(Qp({},Dy()))})})}}]),n}())||Hv),Yv,Kv,Ad={NONE:0,ENCODE:1,HIGHLIGHT:2},Fy=(Yv=(0,Et.b2)(),Yv(Kv=function(){function n(){(0,fe.Z)(this,n)}return(0,Q.Z)(n,[{key:"apply",value:function(a,u){var l=u.rendererService,d=u.styleAttributeService;a.hooks.init.tap("PixelPickingPlugin",function(){var y=a.getLayerConfig(),w=y.enablePicking;d.registerStyleAttribute({name:"pickingColor",type:S.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:S.gl.FLOAT},size:3,update:function(k,$){var W=k.id;return w?(0,Xe.Z6)(W):[0,0,0]}}})}),a.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var y=a.getLayerConfig(),w=y.enablePicking;w&&a.isVisible()&&a.models.forEach(function(P){return P.addUniforms({u_PickingStage:Ad.ENCODE})})}),a.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var y=a.getLayerConfig(),w=y.enablePicking;w&&a.isVisible()&&a.models.forEach(function(P){return P.addUniforms({u_PickingStage:Ad.HIGHLIGHT})})}),a.hooks.beforeHighlight.tap("PixelPickingPlugin",function(y){var w=a.getLayerConfig(),P=w.highlightColor,k=typeof P=="string"?(0,Xe.CI)(P):P||[1,0,0,1];a.updateLayerConfig({pickedFeatureID:(0,Xe.W0)(new Uint8Array(y))}),a.models.forEach(function($){return $.addUniforms({u_PickingStage:Ad.HIGHLIGHT,u_PickingColor:y,u_HighlightColor:k.map(function(W){return W*255})})})}),a.hooks.beforeSelect.tap("PixelPickingPlugin",function(y){var w=a.getLayerConfig(),P=w.selectColor,k=typeof P=="string"?(0,Xe.CI)(P):P||[1,0,0,1];a.updateLayerConfig({pickedFeatureID:(0,Xe.W0)(new Uint8Array(y))}),a.models.forEach(function($){return $.addUniforms({u_PickingStage:Ad.HIGHLIGHT,u_PickingColor:y,u_HighlightColor:k.map(function(W){return W*255})})})})}}]),n}())||Kv),$v,Jv,Qv,Yd,qv,zy=($v=(0,Et.b2)(),Jv=(0,Et.f3)(S.vK.ILogService),$v(Qv=(Yd=function(){function n(){(0,fe.Z)(this,n),(0,si.Z)(this,"logger",qv,this)}return(0,Q.Z)(n,[{key:"apply",value:function(a,u){var l=this,d=u.styleAttributeService;a.hooks.init.tap("RegisterStyleAttributePlugin",function(){l.registerBuiltinAttributes(d)})}},{key:"registerBuiltinAttributes",value:function(a){a.registerStyleAttribute({name:"position",type:S.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:S.gl.FLOAT},size:3,update:function(l,d,y){return y.length===2?[y[0],y[1],0]:[y[0],y[1],y[2]]}}}),a.registerStyleAttribute({name:"filter",type:S.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(l,d){var y=l.filter;return y?[1]:[0]}}}),a.registerStyleAttribute({name:"color",type:S.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(l,d){var y=l.color;return!y||!y.length?[1,1,1,1]:y}}})}}]),n}(),qv=(0,Rn.Z)(Yd.prototype,"logger",[Jv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yd))||Qv),em,tm,rm,nm,im,am,bp,om,sm,um,lm,Ny=(em=(0,Et.b2)(),tm=(0,Et.f3)(S.vK.ICameraService),rm=(0,Et.f3)(S.vK.ICoordinateSystemService),nm=(0,Et.f3)(S.vK.IRendererService),im=(0,Et.f3)(S.vK.IMapService),em(am=(bp=function(){function n(){(0,fe.Z)(this,n),(0,si.Z)(this,"cameraService",om,this),(0,si.Z)(this,"coordinateSystemService",sm,this),(0,si.Z)(this,"rendererService",um,this),(0,si.Z)(this,"mapService",lm,this)}return(0,Q.Z)(n,[{key:"apply",value:function(a){var u=this,l=this.mapService.version,d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],y=[0,0];a.hooks.beforeRender.tap("ShaderUniformPlugin",function(){u.coordinateSystemService.refresh(),l==="GAODE2.x"&&(d=u.mapService.map.customCoords.getMVPMatrix(),y=u.mapService.getCustomCoordCenter());var w=u.rendererService.getViewportSize(),P=w.width,k=w.height;a.models.forEach(function($){var W;$.addUniforms((W={},(0,F.Z)(W,S.CameraUniform.ProjectionMatrix,u.cameraService.getProjectionMatrix()),(0,F.Z)(W,S.CameraUniform.ViewMatrix,u.cameraService.getViewMatrix()),(0,F.Z)(W,S.CameraUniform.ViewProjectionMatrix,u.cameraService.getViewProjectionMatrix()),(0,F.Z)(W,S.CameraUniform.Zoom,u.cameraService.getZoom()),(0,F.Z)(W,S.CameraUniform.ZoomScale,u.cameraService.getZoomScale()),(0,F.Z)(W,S.CameraUniform.FocalDistance,u.cameraService.getFocalDistance()),(0,F.Z)(W,S.CameraUniform.CameraPosition,u.cameraService.getCameraPosition()),(0,F.Z)(W,S.CoordinateUniform.CoordinateSystem,u.coordinateSystemService.getCoordinateSystem()),(0,F.Z)(W,S.CoordinateUniform.ViewportCenter,u.coordinateSystemService.getViewportCenter()),(0,F.Z)(W,S.CoordinateUniform.ViewportCenterProjection,u.coordinateSystemService.getViewportCenterProjection()),(0,F.Z)(W,S.CoordinateUniform.PixelsPerDegree,u.coordinateSystemService.getPixelsPerDegree()),(0,F.Z)(W,S.CoordinateUniform.PixelsPerDegree2,u.coordinateSystemService.getPixelsPerDegree2()),(0,F.Z)(W,S.CoordinateUniform.PixelsPerMeter,u.coordinateSystemService.getPixelsPerMeter()),(0,F.Z)(W,S.CoordinateUniform.Mvp,d),(0,F.Z)(W,"u_SceneCenterMKT",y),(0,F.Z)(W,"u_ViewportSize",[P,k]),(0,F.Z)(W,"u_DevicePixelRatio",window.devicePixelRatio),(0,F.Z)(W,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),(0,F.Z)(W,"u_PickingBuffer",a.getLayerConfig().pickingBuffer||0),W))})})}}]),n}(),om=(0,Rn.Z)(bp.prototype,"cameraService",[tm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sm=(0,Rn.Z)(bp.prototype,"coordinateSystemService",[rm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),um=(0,Rn.Z)(bp.prototype,"rendererService",[nm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lm=(0,Rn.Z)(bp.prototype,"mapService",[im],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bp))||am),cm,fm,By=(cm=(0,Et.b2)(),cm(fm=function(){function n(){(0,fe.Z)(this,n)}return(0,Q.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("UpdateModelPlugin",function(){a.layerModel&&a.layerModel.needUpdate()})}}]),n}())||fm),hm,pm,dm,Kd,vm,Uy=(hm=(0,Et.b2)(),pm=(0,Et.f3)(S.vK.ILogService),hm(dm=(Kd=function(){function n(){(0,fe.Z)(this,n),(0,si.Z)(this,"logger",vm,this)}return(0,Q.Z)(n,[{key:"apply",value:function(a,u){var l=this,d=u.styleAttributeService;a.hooks.init.tap("UpdateStyleAttributePlugin",function(){l.initStyleAttribute(a,{styleAttributeService:d})}),a.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){a.layerModelNeedUpdate||l.updateStyleAtrribute(a,{styleAttributeService:d})})}},{key:"updateStyleAtrribute",value:function(a,u){var l=this,d=u.styleAttributeService,y=d.getLayerStyleAttributes()||[],w=d.getLayerStyleAttribute("filter"),P=d.getLayerStyleAttribute("shape");if(w&&w.needRegenerateVertices||P&&P.needRegenerateVertices){a.layerModelNeedUpdate=!0,y.forEach(function(k){return k.needRegenerateVertices=!1});return}y.filter(function(k){return k.needRegenerateVertices}).forEach(function(k){d.updateAttributeByFeatureRange(k.name,a.getEncodedData(),k.featureRange.startIndex,k.featureRange.endIndex),k.needRegenerateVertices=!1,l.logger.debug("regenerate vertex attributes: ".concat(k.name," finished"))})}},{key:"initStyleAttribute",value:function(a,u){var l=this,d=u.styleAttributeService,y=d.getLayerStyleAttributes()||[];y.filter(function(w){return w.needRegenerateVertices}).forEach(function(w){d.updateAttributeByFeatureRange(w.name,a.getEncodedData(),w.featureRange.startIndex,w.featureRange.endIndex),w.needRegenerateVertices=!1,l.logger.debug("init vertex attributes: ".concat(w.name," finished"))})}}]),n}(),vm=(0,Rn.Z)(Kd.prototype,"logger",[pm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kd))||dm);S.nC.bind(S.vK.ILayerPlugin).to(nd).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(zy).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(Ay).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(rp).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(Iy).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(Uy).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(By).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(ta).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(Ny).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(Py).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(ky).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(Fy).inRequestScope(),S.nC.bind(S.vK.ILayerPlugin).to(My).inRequestScope();var Y1="2.4.1";function mm(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function K1(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?mm(Object(a),!0).forEach(function(u){jy(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):mm(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function jy(n,s,a){return s in n?Object.defineProperty(n,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[s]=a,n}function $1(n,s){return Hy(n)||Gy(n,s)||Vy(n,s)||Zy()}function Zy(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vy(n,s){if(!!n){if(typeof n=="string")return gm(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return gm(n,s)}}function gm(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function Gy(n,s){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var a=[],u=!0,l=!1,d=void 0;try{for(var y=n[Symbol.iterator](),w;!(u=(w=y.next()).done)&&(a.push(w.value),!(s&&a.length===s));u=!0);}catch(P){l=!0,d=P}finally{try{!u&&y.return!=null&&y.return()}finally{if(l)throw d}}return a}}function Hy(n){if(Array.isArray(n))return n}var J1=null,Q1=null,ym,_m,Cd,xm,bm;function Sm(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Em(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Sm(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Sm(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}var Wy=(ym=(0,S.yT)(S.vK.ILogService),_m=(0,S.yT)(S.vK.IGlobalConfigService),Cd=function(){function n(s){(0,fe.Z)(this,n),(0,si.Z)(this,"logger",xm,this),(0,si.Z)(this,"configService",bm,this),this.config=void 0,this.config=s}return(0,Q.Z)(n,[{key:"setContainer",value:function(a,u){a.bind(S.vK.MapConfig).toConstantValue(Em(Em({},this.config),{},{id:u})),a.bind(S.vK.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),n}(),xm=(0,Rn.Z)(Cd.prototype,"logger",[ym],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bm=(0,Rn.Z)(Cd.prototype,"configService",[_m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cd),Xy=_(19020),Yy=_.n(Xy),$d;(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.L7MAP="L7MAP"})($d||($d={}));function qp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Pd(n,s){var a=lf.fF([],s,n);return lf.bA(a,a,1/a[3]),a}function q1(n,s){var a=n%s;return a<0?s+a:a}function e_(n,s,a){return a*s+(1-a)*n}function Wh(n,s){if(!n)throw new Error(s||"viewport-mercator-project: assertion failed.")}var _f=Math.PI,wm=_f/4,th=_f/180,Tm=180/_f,Jd=512,Qd=4003e4,Ky=1.5;function Am(n){return Math.pow(2,n)}function $y(n){return Math.log2(n)}function Md(n,s){var a=(0,ie.Z)(n,2),u=a[0],l=a[1];Wh(Number.isFinite(u)&&Number.isFinite(s)),Wh(Number.isFinite(l)&&l>=-90&&l<=90,"invalid latitude"),s*=Jd;var d=u*th,y=l*th,w=s*(d+_f)/(2*_f),P=s*(_f-Math.log(Math.tan(wm+y*.5)))/(2*_f);return[w,P]}function qd(n,s){var a=(0,ie.Z)(n,2),u=a[0],l=a[1];s*=Jd;var d=u/s*(2*_f)-_f,y=2*(Math.atan(Math.exp(_f-l/s*(2*_f)))-wm);return[d*Tm,y*Tm]}function t_(n){var s=n.latitude;assert(Number.isFinite(s));var a=Math.cos(s*th);return $y(Qd*a)-9}function Cm(n){var s=n.latitude,a=n.longitude,u=n.zoom,l=n.scale,d=n.highPrecision,y=d===void 0?!1:d;l=l!==void 0?l:Am(u),Wh(Number.isFinite(s)&&Number.isFinite(a)&&Number.isFinite(l));var w={},P=Jd*l,k=Math.cos(s*th),$=P/360,W=$/k,me=P/Qd/k;if(w.pixelsPerMeter=[me,-me,me],w.metersPerPixel=[1/me,-1/me,1/me],w.pixelsPerDegree=[$,-W,me],w.degreesPerPixel=[1/$,-1/W,1/me],y){var Je=th*Math.tan(s*th)/k,pt=$*Je/2,Zt=P/Qd*Je,Pr=Zt/W*me;w.pixelsPerDegree2=[0,-pt,Zt],w.pixelsPerMeter2=[Pr,0,Pr]}return w}function r_(n,s){var a=_slicedToArray(n,3),u=a[0],l=a[1],d=a[2],y=_slicedToArray(s,3),w=y[0],P=y[1],k=y[2],$=1,W=Cm({longitude:u,latitude:l,scale:$,highPrecision:!0}),me=W.pixelsPerMeter,Je=W.pixelsPerMeter2,pt=Md(n,$);pt[0]+=w*(me[0]+Je[0]*P),pt[1]+=P*(me[1]+Je[1]*P);var Zt=qd(pt,$),Pr=(d||0)+(k||0);return Number.isFinite(d)||Number.isFinite(k)?[Zt[0],Zt[1],Pr]:Zt}function Jy(n){var s=n.height,a=n.pitch,u=n.bearing,l=n.altitude,d=n.center,y=d===void 0?null:d,w=n.flipY,P=w===void 0?!1:w,k=qp();return Oa.translate(k,k,[0,0,-l]),Oa.scale(k,k,[1,1,1/s]),Oa.rotateX(k,k,-a*th),Oa.rotateZ(k,k,u*th),P&&Oa.scale(k,k,[1,-1,1]),y&&Oa.translate(k,k,gc([],y)),k}function Qy(n){var s=n.width,a=n.height,u=n.altitude,l=u===void 0?Ky:u,d=n.pitch,y=d===void 0?0:d,w=n.nearZMultiplier,P=w===void 0?1:w,k=n.farZMultiplier,$=k===void 0?1:k,W=y*th,me=Math.atan(.5/l),Je=Math.sin(me)*l/Math.sin(Math.PI/2-W-me),pt=Math.cos(Math.PI/2-W)*Je+l;return{fov:2*Math.atan(a/2/l),aspect:s/a,focalDistance:l,near:P,far:pt*$}}function qy(n){var s=n.width,a=n.height,u=n.pitch,l=n.altitude,d=n.nearZMultiplier,y=n.farZMultiplier,w=Qy({width:s,height:a,altitude:l,pitch:u,nearZMultiplier:d,farZMultiplier:y}),P=w.fov,k=w.aspect,$=w.near,W=w.far,me=Oa.perspective([],P,k,$,W);return me}function e0(n,s){var a=(0,ie.Z)(n,3),u=a[0],l=a[1],d=a[2],y=d===void 0?0:d;return Wh(Number.isFinite(u)&&Number.isFinite(l)&&Number.isFinite(y)),Pd(s,[u,l,y,1])}function Pm(n,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=(0,ie.Z)(n,3),l=u[0],d=u[1],y=u[2];if(Wh(Number.isFinite(l)&&Number.isFinite(d),"invalid pixel coordinate"),Number.isFinite(y)){var w=Pd(s,[l,d,y,1]);return w}var P=Pd(s,[l,d,0,1]),k=Pd(s,[l,d,1,1]),$=P[2],W=k[2],me=$===W?0:((a||0)-$)/(W-$);return Tl([],P,k,me)}var Mm=qp(),t0=function(){function n(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=s.width,u=s.height,l=s.viewMatrix,d=l===void 0?Mm:l,y=s.projectionMatrix,w=y===void 0?Mm:y;(0,fe.Z)(this,n),this.width=a||1,this.height=u||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=d,this.projectionMatrix=w;var P=qp();Oa.multiply(P,P,this.projectionMatrix),Oa.multiply(P,P,this.viewMatrix),this.viewProjectionMatrix=P;var k=qp();Oa.scale(k,k,[this.width/2,-this.height/2,1]),Oa.translate(k,k,[1,-1,0]),Oa.multiply(k,k,this.viewProjectionMatrix);var $=Oa.invert(qp(),k);if(!$)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=k,this.pixelUnprojectionMatrix=$,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,Q.Z)(n,[{key:"equals",value:function(a){return a instanceof n?a.width===this.width&&a.height===this.height&&Oa.equals(a.projectionMatrix,this.projectionMatrix)&&Oa.equals(a.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=u.topLeft,d=l===void 0?!0:l,y=this.projectPosition(a),w=e0(y,this.pixelProjectionMatrix),P=(0,ie.Z)(w,2),k=P[0],$=P[1],W=d?$:this.height-$;return a.length===2?[k,W]:[k,W,w[2]]}},{key:"unproject",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=u.topLeft,d=l===void 0?!0:l,y=u.targetZ,w=(0,ie.Z)(a,3),P=w[0],k=w[1],$=w[2],W=d?k:this.height-k,me=y&&y*this.pixelsPerMeter,Je=Pm([P,W,$],this.pixelUnprojectionMatrix,me),pt=this.unprojectPosition(Je),Zt=(0,ie.Z)(pt,3),Pr=Zt[0],Mr=Zt[1],hn=Zt[2];return Number.isFinite($)?[Pr,Mr,hn]:Number.isFinite(y)?[Pr,Mr,y]:[Pr,Mr]}},{key:"projectPosition",value:function(a){var u=this.projectFlat(a),l=(0,ie.Z)(u,2),d=l[0],y=l[1],w=(a[2]||0)*this.pixelsPerMeter;return[d,y,w]}},{key:"unprojectPosition",value:function(a){var u=this.unprojectFlat(a),l=(0,ie.Z)(u,2),d=l[0],y=l[1],w=(a[2]||0)/this.pixelsPerMeter;return[d,y,w]}},{key:"projectFlat",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return a}},{key:"unprojectFlat",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return a}}]),n}();function r0(n){var s=n.width,a=n.height,u=n.bounds,l=n.minExtent,d=l===void 0?0:l,y=n.maxZoom,w=y===void 0?24:y,P=n.padding,k=P===void 0?0:P,$=n.offset,W=$===void 0?[0,0]:$,me=(0,ie.Z)(u,2),Je=(0,ie.Z)(me[0],2),pt=Je[0],Zt=Je[1],Pr=(0,ie.Z)(me[1],2),Mr=Pr[0],hn=Pr[1];if(Number.isFinite(k)){var dn=k;k={top:dn,bottom:dn,left:dn,right:dn}}else Wh(Number.isFinite(k.top)&&Number.isFinite(k.bottom)&&Number.isFinite(k.left)&&Number.isFinite(k.right));var Fn=new Im({width:s,height:a,longitude:0,latitude:0,zoom:0}),Xn=Fn.project([pt,hn]),Zi=Fn.project([Mr,Zt]),ti=[Math.max(Math.abs(Zi[0]-Xn[0]),d),Math.max(Math.abs(Zi[1]-Xn[1]),d)],$i=[s-k.left-k.right-Math.abs(W[0])*2,a-k.top-k.bottom-Math.abs(W[1])*2];Wh($i[0]>0&&$i[1]>0);var Ca=$i[0]/ti[0],ka=$i[1]/ti[1],di=(k.right-k.left)/2/Ca,_a=(k.bottom-k.top)/2/ka,to=[(Zi[0]+Xn[0])/2+di,(Zi[1]+Xn[1])/2+_a],Ku=Fn.unproject(to),Sp=Fn.zoom+Math.log2(Math.abs(Math.min(Ca,ka)));return{longitude:Ku[0],latitude:Ku[1],zoom:Math.min(Sp,w)}}var Im=function(n){(0,we.Z)(s,n);function s(){var a,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=u.width,d=u.height,y=u.latitude,w=y===void 0?0:y,P=u.longitude,k=P===void 0?0:P,$=u.zoom,W=$===void 0?0:$,me=u.pitch,Je=me===void 0?0:me,pt=u.bearing,Zt=pt===void 0?0:pt,Pr=u.altitude,Mr=Pr===void 0?1.5:Pr,hn=u.nearZMultiplier,dn=u.farZMultiplier;(0,fe.Z)(this,s),l=l||1,d=d||1;var Fn=Am(W);Mr=Math.max(.75,Mr);var Xn=Md([k,w],Fn);Xn[2]=0;var Zi=qy({width:l,height:d,pitch:Je,bearing:Zt,altitude:Mr,nearZMultiplier:hn||1/d,farZMultiplier:dn||1.01}),ti=Jy({height:d,center:Xn,pitch:Je,bearing:Zt,altitude:Mr,flipY:!0});return a=(0,Ie.Z)(this,(0,Be.Z)(s).call(this,{width:l,height:d,viewMatrix:ti,projectionMatrix:Zi})),a.latitude=w,a.longitude=k,a.zoom=W,a.pitch=Je,a.bearing=Zt,a.altitude=Mr,a.scale=Fn,a.center=Xn,a.pixelsPerMeter=Cm((0,Ht.Z)((0,Ht.Z)(a))).pixelsPerMeter[2],Object.freeze((0,Ht.Z)((0,Ht.Z)(a))),a}return(0,Q.Z)(s,[{key:"projectFlat",value:function(u){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Md(u,l)}},{key:"unprojectFlat",value:function(u){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return qd(u,l)}},{key:"getMapCenterByLngLatPosition",value:function(u){var l=u.lngLat,d=u.pos,y=Pm(d,this.pixelUnprojectionMatrix),w=Md(l,this.scale),P=So([],w,us([],y)),k=So([],this.center,P);return qd(k,this.scale)}},{key:"getLocationAtPoint",value:function(u){var l=u.lngLat,d=u.pos;return this.getMapCenterByLngLatPosition({lngLat:l,pos:d})}},{key:"fitBounds",value:function(u){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=this.width,y=this.height,w=r0(Object.assign({width:d,height:y,bounds:u},l)),P=w.longitude,k=w.latitude,$=w.zoom;return new s({width:d,height:y,longitude:P,latitude:k,zoom:$})}}]),s}(t0),n0=function(){function n(){(0,fe.Z)(this,n),this.viewport=void 0}return(0,Q.Z)(n,[{key:"syncWithMapCamera",value:function(a){var u=a.center,l=a.zoom,d=a.pitch,y=a.bearing,w=a.viewportHeight,P=a.viewportWidth;this.viewport=new Im({width:P,height:w,longitude:u&&u[0],latitude:u&&u[1],zoom:l,pitch:d,bearing:y})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a,u){return this.viewport.projectFlat(a,u)}}]),n}(),Om={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Lm,Rm,Dm,km,Fm,zm,Nm,Xh,Bm,Um,jm,Zm,Vm;function Gm(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function i0(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Gm(Object(a),!0).forEach(function(u){(0,F.Z)(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Gm(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}_(83772)(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Yy();var Hm={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},a0=0,o0=12,Wm="pk.eyJ1IjoibHp4dWUiLCJhIjoiY2tvaWZuM2s4MWZuYjJ1dHI5ZGduYTlrdiJ9.DQCfMRbZzx0VSwecQ69McA",s0=(Lm=(0,Et.b2)(),Rm=(0,Et.f3)(S.vK.MapConfig),Dm=(0,Et.f3)(S.vK.IGlobalConfigService),km=(0,Et.f3)(S.vK.ILogService),Fm=(0,Et.f3)(S.vK.ICoordinateSystemService),zm=(0,Et.f3)(S.vK.IEventEmitter),Lm(Nm=(Xh=function(){function n(){var s=this;(0,fe.Z)(this,n),this.version=$d.MAPBOX,this.map=void 0,(0,si.Z)(this,"config",Bm,this),(0,si.Z)(this,"configService",Um,this),(0,si.Z)(this,"logger",jm,this),(0,si.Z)(this,"coordinateSystemService",Zm,this),(0,si.Z)(this,"eventEmitter",Vm,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var a=s.map.getCenter().wrap(),u=a.lat,l=a.lng;s.viewport.syncWithMapCamera({bearing:s.map.getBearing(),center:[l,u],viewportHeight:s.map.transform.height,pitch:s.map.getPitch(),viewportWidth:s.map.transform.width,zoom:s.map.getZoom(),cameraHeight:0});var d=s.config.offsetZoom,y=d===void 0?o0:d;s.viewport.getZoom()>y?s.coordinateSystemService.setCoordinateSystem(S.CoordinateSystem.LNGLAT_OFFSET):s.coordinateSystemService.setCoordinateSystem(S.CoordinateSystem.LNGLAT),s.cameraChangedCallback(s.viewport)}}return(0,Q.Z)(n,[{key:"addMarkerContainer",value:function(){var a=this.map.getCanvasContainer();this.markerContainer=Xe.SO.create("div","l7-marker-container",a),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(a,u){S.MapServiceEvent.indexOf(a)!==-1?this.eventEmitter.on(a,u):this.map.on(Hm[a]||a,u)}},{key:"off",value:function(a,u){this.map.off(Hm[a]||a,u)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var a=this.map.transform;return[a.width,a.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(a){return this.map.setZoom(a)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(a){this.map.setCenter(a)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(a){this.map.setBearing(a)}},{key:"zoomIn",value:function(a,u){this.map.zoomIn(a,u)}},{key:"zoomOut",value:function(a,u){this.map.zoomOut(a,u)}},{key:"setPitch",value:function(a){return this.map.setPitch(a)}},{key:"panTo",value:function(a){this.map.panTo(a)}},{key:"panBy",value:function(a){this.panTo(a)}},{key:"fitBounds",value:function(a,u){this.map.fitBounds(a,u)}},{key:"setMaxZoom",value:function(a){this.map.setMaxZoom(a)}},{key:"setMinZoom",value:function(a){this.map.setMinZoom(a)}},{key:"setMapStatus",value:function(a){a.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),a.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),a.dragEnable===!1&&this.map.dragPan.disable(),a.dragEnable===!0&&this.map.dragPan.enable(),a.rotateEnable===!1&&this.map.dragRotate.disable(),a.rotateEnable===!0&&this.map.dragRotate.enable(),a.keyboardEnable===!1&&this.map.keyboard.disable(),a.keyboardEnable===!0&&this.map.keyboard.enable(),a.zoomEnable===!1&&this.map.scrollZoom.disable(),a.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(a,u){this.map.flyTo({zoom:a,center:u})}},{key:"setMapStyle",value:function(a){this.map.setStyle(this.getMapStyle(a))}},{key:"pixelToLngLat",value:function(a){return this.map.unproject(a)}},{key:"lngLatToPixel",value:function(a){return this.map.project(a)}},{key:"containerToLngLat",value:function(a){return this.map.unproject(a)}},{key:"lngLatToContainer",value:function(a){return this.map.project(a)}},{key:"lngLatToMercator",value:function(a,u){var l=window.mapboxgl.MercatorCoordinate.fromLngLat(a,u),d=l.x,y=d===void 0?0:d,w=l.y,P=w===void 0?0:w,k=l.z,$=k===void 0?0:k;return{x:y,y:P,z:$}}},{key:"getModelMatrix",value:function(a,u,l){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},w=window.mapboxgl.MercatorCoordinate.fromLngLat(a,u),P=w.meterInMercatorCoordinateUnits(),k=Oa.create();return Oa.translate(k,k,eu(w.x-y.x,w.y-y.y,w.z||0-y.z)),Oa.scale(k,k,eu(P*d[0],-P*d[1],P*d[2])),Oa.rotateX(k,k,l[0]),Oa.rotateY(k,k,l[1]),Oa.rotateZ(k,k,l[2]),k}},{key:"init",value:function(){var s=(0,ot.Z)(G().mark(function u(){var l,d,y,w,P,k,$,W,me,Je,pt,Zt,Pr;return G().wrap(function(hn){for(;;)switch(hn.prev=hn.next){case 0:l=this.config,d=l.id,y=d===void 0?"map":d,w=l.attributionControl,P=w===void 0?!1:w,k=l.style,$=k===void 0?"light":k,W=l.token,me=W===void 0?Wm:W,Je=l.rotation,pt=Je===void 0?0:Je,Zt=l.mapInstance,Pr=(0,ki.Z)(l,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new n0,!Zt&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),me===Wm&&$!=="blank"&&!window.mapboxgl.accessToken&&!Zt&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!Zt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=me),Zt?(this.map=Zt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(y),this.map=new window.mapboxgl.Map(i0({container:this.$mapContainer,style:this.getMapStyle($),attributionControl:P,bearing:pt},Pr))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return hn.stop()}},u,this)}));function a(){return s.apply(this,arguments)}return a}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(a){for(var u,l=arguments.length,d=new Array(l>1?l-1:0),y=1;y<l;y++)d[y-1]=arguments[y];(u=this.eventEmitter).emit.apply(u,[a].concat(d))}},{key:"once",value:function(a){for(var u,l=arguments.length,d=new Array(l>1?l-1:0),y=1;y<l;y++)d[y-1]=arguments[y];(u=this.eventEmitter).once.apply(u,[a].concat(d))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(a){var u=this.map.getCanvas(),l=a==="jpg"?u==null?void 0:u.toDataURL("image/jpeg"):u==null?void 0:u.toDataURL("image/png");return l}},{key:"onCameraChanged",value:function(a){this.cameraChangedCallback=a}},{key:"creatAmapContainer",value:function(a){var u=a;typeof a=="string"&&(u=document.getElementById(a));var l=document.createElement("div");return l.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,l.id="l7_mapbox_div"+a0++,u.appendChild(l),l}},{key:"getMapStyle",value:function(a){return typeof a!="string"?a:Om[a]?Om[a]:a}}]),n}(),Bm=(0,Rn.Z)(Xh.prototype,"config",[Rm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Um=(0,Rn.Z)(Xh.prototype,"configService",[Dm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jm=(0,Rn.Z)(Xh.prototype,"logger",[km],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zm=(0,Rn.Z)(Xh.prototype,"coordinateSystemService",[Fm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vm=(0,Rn.Z)(Xh.prototype,"eventEmitter",[zm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xh))||Nm);function u0(n){var s=l0();return function(){var u=(0,Be.Z)(n),l;if(s){var d=(0,Be.Z)(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return(0,Ie.Z)(this,l)}}function l0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}_(83772)(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var c0=function(n){(0,we.Z)(a,n);var s=u0(a);function a(){return(0,fe.Z)(this,a),s.apply(this,arguments)}return(0,Q.Z)(a,[{key:"getServiceConstructor",value:function(){return s0}}]),a}(Wy);function Xm(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Ym(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Xm(Object(a),!0).forEach(function(u){f0(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Xm(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function f0(n,s,a){return s in n?Object.defineProperty(n,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[s]=a,n}function h0(n,s){return m0(n)||v0(n,s)||d0(n,s)||p0()}function p0(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d0(n,s){if(!!n){if(typeof n=="string")return Km(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Km(n,s)}}function Km(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function v0(n,s){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var a=[],u=!0,l=!1,d=void 0;try{for(var y=n[Symbol.iterator](),w;!(u=(w=y.next()).done)&&(a.push(w.value),!(s&&a.length===s));u=!0);}catch(P){l=!0,d=P}finally{try{!u&&y.return!=null&&y.return()}finally{if(l)throw d}}return a}}function m0(n){if(Array.isArray(n))return n}var g0=b.memo(function(n){var s=n.style,a=n.className,u=n.map,l=n.option,d=n.onSceneLoaded,y=(0,b.createRef)(),w=(0,b.useState)(),P=h0(w,2),k=P[0],$=P[1];return(0,b.useEffect)(function(){var W=new bo(Ym(Ym({id:y.current},l),{},{map:new c0(u)}));return W.on("loaded",function(){$(W),d&&d(W)}),function(){W.destroy()}},[]),(0,b.useEffect)(function(){k&&u.style&&k.setMapStyle(u.style)},[JSON.stringify(u.style)]),(0,b.useEffect)(function(){k&&u.zoom&&k.setZoom(u.zoom)},[u.zoom]),(0,b.useEffect)(function(){k&&u.center&&k.setCenter(u.center)},[JSON.stringify(u.center)]),(0,b.useEffect)(function(){k&&u.pitch!==void 0&&k.setPitch(u.pitch||0)},[u.pitch]),(0,b.useEffect)(function(){k&&u.rotation&&k.setRotation(u.rotation)},[u.rotation]),b.createElement(p.Provider,{value:k},(0,b.createElement)("div",{ref:y,style:s,className:a},k&&n.children))}),y0=g0;function $m(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function n_(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?$m(Object(a),!0).forEach(function(u){_0(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):$m(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function _0(n,s,a){return s in n?Object.defineProperty(n,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[s]=a,n}function i_(n,s){return E0(n)||S0(n,s)||b0(n,s)||x0()}function x0(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b0(n,s){if(!!n){if(typeof n=="string")return Jm(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Jm(n,s)}}function Jm(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function S0(n,s){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var a=[],u=!0,l=!1,d=void 0;try{for(var y=n[Symbol.iterator](),w;!(u=(w=y.next()).done)&&(a.push(w.value),!(s&&a.length===s));u=!0);}catch(P){l=!0,d=P}finally{try{!u&&y.return!=null&&y.return()}finally{if(l)throw d}}return a}}function E0(n){if(Array.isArray(n))return n}var a_=null,o_=null;function s_(n,s){return C0(n)||A0(n,s)||T0(n,s)||w0()}function w0(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T0(n,s){if(!!n){if(typeof n=="string")return Qm(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Qm(n,s)}}function Qm(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function A0(n,s){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var a=[],u=!0,l=!1,d=void 0;try{for(var y=n[Symbol.iterator](),w;!(u=(w=y.next()).done)&&(a.push(w.value),!(s&&a.length===s));u=!0);}catch(P){l=!0,d=P}finally{try{!u&&y.return!=null&&y.return()}finally{if(l)throw d}}return a}}function C0(n){if(Array.isArray(n))return n}var u_=null,l_=null,qm=_(73935);function P0(n,s){return L0(n)||O0(n,s)||I0(n,s)||M0()}function M0(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I0(n,s){if(!!n){if(typeof n=="string")return eg(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return eg(n,s)}}function eg(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function O0(n,s){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var a=[],u=!0,l=!1,d=void 0;try{for(var y=n[Symbol.iterator](),w;!(u=(w=y.next()).done)&&(a.push(w.value),!(s&&a.length===s));u=!0);}catch(P){l=!0,d=P}finally{try{!u&&y.return!=null&&y.return()}finally{if(l)throw d}}return a}}function L0(n){if(Array.isArray(n))return n}var R0=b.useEffect,D0=b.useState;function c_(n){var s=n.className,a=n.style,u=n.children,l=n.position,d=useSceneValue(),y=D0(function(){return document.createElement("div")}),w=P0(y,1),P=w[0];return R0(function(){var k=new Control({position:l});return k.onAdd=function(){if(s&&(P.className=s),a){var $=Object.keys(a).map(function(W){return"".concat(W,":").concat(a[W])}).join(";");P.style.cssText=$}return P},d.addControl(k),function(){d.removeControl(k)}},[]),createPortal(u,P)}var tg=(0,b.createContext)({});function f_(){return useContext(tg)}var k0=b.useEffect,F0=b.memo(function(s){var a=s.layer,u=s.active;return k0(function(){a.active(u.option)},[JSON.stringify(u)]),null}),z0=b.useEffect,N0=b.memo(function(s){var a=s.layer,u=s.animate;return z0(function(){a.animate(u)},[JSON.stringify(u)]),null}),B0=b.useEffect,U0=b.memo(function(s){var a=s.layer,u=s.color;return B0(function(){u.field?a.color(u.field,u.values):a.color(u.values)},[u.field,u.scale,JSON.stringify(u.values),JSON.stringify(u.options)]),null}),j0=b.useEffect,Z0=b.memo(function(s){var a=s.layer,u=s.filter;return j0(function(){u.field&&a.filter(u.field,u.values)},[u.field,u.values,JSON.stringify(u.values),JSON.stringify(u.options)]),null}),V0=b.useEffect,G0=b.memo(function(s){var a=s.layer,u=s.scale;return V0(function(){a.scale(u.values)},[u.values]),null}),H0=b.useEffect,W0=b.memo(function(s){var a=s.layer,u=s.select;return H0(function(){a.select(u.option)},[JSON.stringify(u)]),null}),X0=b.useEffect,Y0=b.memo(function(s){var a=s.layer,u=s.shape;return X0(function(){u.field?a.shape(u.field,u.values):a.shape(u.values)},[u.field,JSON.stringify(u.values),JSON.stringify(u.options)]),null}),K0=b.useEffect,$0=b.memo(function(s){var a=s.layer,u=s.size;return K0(function(){u.field?a.size(u.field,u.values):a.size(u.values)},[u.field,u.scale,JSON.stringify(u.values),JSON.stringify(u.options)]),null});function J0(n,s){if(n==null)return{};var a=Q0(n,s),u,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(n);for(l=0;l<d.length;l++)u=d[l],!(s.indexOf(u)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,u)||(a[u]=n[u]))}return a}function Q0(n,s){if(n==null)return{};var a={},u=Object.keys(n),l,d;for(d=0;d<u.length;d++)l=u[d],!(s.indexOf(l)>=0)&&(a[l]=n[l]);return a}var q0=b.useEffect,e1=b.memo(function(s){var a=s.layer,u=s.source,l=u.data,d=J0(u,["data"]);return q0(function(){a.inited?a.setData(l,d):a.source(l,d),d.autoFit&&a.fitBounds(d&&d.fitBoundsOptions)},[l,JSON.stringify(d)]),null}),t1=b.useEffect,r1=b.memo(function(s){var a=s.layer,u=s.style;return t1(function(){a.style(u)},Object.keys(u).map(function(l){return u[l]})),null});function n1(n,s){return s1(n)||o1(n,s)||a1(n,s)||i1()}function i1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a1(n,s){if(!!n){if(typeof n=="string")return rg(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return rg(n,s)}}function rg(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=n[a];return u}function o1(n,s){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var a=[],u=!0,l=!1,d=void 0;try{for(var y=n[Symbol.iterator](),w;!(u=(w=y.next()).done)&&(a.push(w.value),!(s&&a.length===s));u=!0);}catch(P){l=!0,d=P}finally{try{!u&&y.return!=null&&y.return()}finally{if(l)throw d}}return a}}function s1(n){if(Array.isArray(n))return n}var ed=b.useEffect,u1=b.useState;function ng(n,s){var a=s.source,u=s.color,l=s.shape,d=s.style,y=s.size,w=s.scale,P=s.active,k=s.select,$=s.filter,W=s.animate,me=s.options,Je=s.onLayerLoaded,pt=H(),Zt=u1(),Pr=n1(Zt,2),Mr=Pr[0],hn=Pr[1];if(!Mr){var dn;switch(n){case"polygonLayer":dn=new $h(me);break;case"lineLayer":dn=new Ds(me);break;case"pointLayer":dn=new yo(me);break;case"heatmapLayer":dn=new ge(me);break;case"rasterLayer":dn=new Af(me);break;case"imageLayer":dn=new nr(me);break;case"citybuildingLayer":dn=new ao(me);break;default:dn=new $h(me)}dn.on("inited",function(){Je&&Je(dn,pt)}),hn(dn)}return ed(function(){if(Mr!==void 0)return pt.addLayer(Mr),function(){pt.removeLayer(Mr)}},[]),ed(function(){Mr&&Mr.inited&&me&&(Mr.updateLayerConfig(me),pt.render())},[me==null?void 0:me.minZoom,me==null?void 0:me.maxZoom,me==null?void 0:me.visible]),ed(function(){Mr&&Mr.inited&&me&&me.zIndex&&Mr.setIndex(me.zIndex)},[me==null?void 0:me.zIndex]),ed(function(){Mr&&Mr.inited&&me&&me.blend&&Mr.setBlend(me.blend)},[me==null?void 0:me.blend]),ed(function(){Mr&&pt.render()},[]),Mr!=null?b.createElement(tg.Provider,{value:Mr},b.createElement(e1,{layer:Mr,source:a}),w&&b.createElement(G0,{layer:Mr,scale:w}),u&&b.createElement(U0,{layer:Mr,color:u}),y&&b.createElement($0,{layer:Mr,size:y}),l&&b.createElement(Y0,{layer:Mr,shape:l}),d&&b.createElement(r1,{layer:Mr,style:d}),P&&b.createElement(F0,{layer:Mr,active:P}),k&&b.createElement(W0,{layer:Mr,select:k}),$&&b.createElement(Z0,{layer:Mr,filter:$}),W&&b.createElement(N0,{layer:Mr,animate:W}),s.children):null}var h_=null,p_=null,l1=b.memo(function(s){return ng("pointLayer",s)}),c1=b.memo(function(s){return ng("heatmapLayer",s)}),d_=null,v_=null,m_=null,g_=b.useEffect,y_=null,__=null;function Id(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Id=function(a){return typeof a}:Id=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Id(n)}function ig(n,s){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),a.push.apply(a,u)}return a}function Od(n){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ig(Object(a),!0).forEach(function(u){f1(n,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):ig(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function f1(n,s,a){return s in n?Object.defineProperty(n,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[s]=a,n}function h1(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function ag(n,s){for(var a=0;a<s.length;a++){var u=s[a];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}function p1(n,s,a){return s&&ag(n.prototype,s),a&&ag(n,a),n}function d1(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(s&&s.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),s&&ev(n,s)}function ev(n,s){return ev=Object.setPrototypeOf||function(u,l){return u.__proto__=l,u},ev(n,s)}function v1(n){var s=y1();return function(){var u=Ld(n),l;if(s){var d=Ld(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return m1(this,l)}}function m1(n,s){return s&&(Id(s)==="object"||typeof s=="function")?s:g1(n)}function g1(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function y1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}function Ld(n){return Ld=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},Ld(n)}var x_=function(n){d1(a,n);var s=v1(a);function a(u){var l;return h1(this,a),l=s.call(this,u),l.el=document.createElement("div"),l}return p1(a,[{key:"componentDidMount",value:function(){var l,d=this.props,y=d.lnglat,w=d.children,P=d.option,k=d.lngLat,$=new $e(Od(Od({},P),{},{stopPropagation:(l=this.props.option)===null||l===void 0?void 0:l.stopPropagation}));y&&$.setLnglat(y),k&&$.setLnglat(k),w&&$.setDOMContent(this.el),this.popup=$,this.scene.addPopup($)}},{key:"componentDidUpdate",value:function(l){var d,y,w,P,k,$,W=Array.isArray(l.lnglat)?l.lnglat:[l==null||(d=l.lnglat)===null||d===void 0?void 0:d.lng,l==null||(y=l.lnglat)===null||y===void 0?void 0:y.lat],me=Array.isArray(this.props.lnglat)?this.props.lnglat:[(w=this.props)===null||w===void 0||(P=w.lnglat)===null||P===void 0?void 0:P.lng,(k=this.props)===null||k===void 0||($=k.lnglat)===null||$===void 0?void 0:$.lat],Je=W.toString()!==me.toString();if(Je){var pt;this.popup.remove(),this.popup=new $e(Od(Od({},this.props.option),{},{stopPropagation:(pt=this.props.option)===null||pt===void 0?void 0:pt.stopPropagation})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup)}}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var l=this;return b.createElement(p.Consumer,{},function(d){return d&&(l.scene=d),(0,qm.createPortal)(l.props.children,l.el)})}}]),a}(b.PureComponent);function Rd(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Rd=function(a){return typeof a}:Rd=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Rd(n)}function _1(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function og(n,s){for(var a=0;a<s.length;a++){var u=s[a];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}function x1(n,s,a){return s&&og(n.prototype,s),a&&og(n,a),n}function b1(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(s&&s.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),s&&tv(n,s)}function tv(n,s){return tv=Object.setPrototypeOf||function(u,l){return u.__proto__=l,u},tv(n,s)}function S1(n){var s=T1();return function(){var u=Dd(n),l;if(s){var d=Dd(this).constructor;l=Reflect.construct(u,arguments,d)}else l=u.apply(this,arguments);return E1(this,l)}}function E1(n,s){return s&&(Rd(s)==="object"||typeof s=="function")?s:w1(n)}function w1(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function T1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}function Dd(n){return Dd=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},Dd(n)}var b_=function(n){b1(a,n);var s=S1(a);function a(u){var l;return _1(this,a),l=s.call(this,u),l.el=document.createElement("div"),l}return x1(a,[{key:"componentDidMount",value:function(){var l=this.props,d=l.lnglat,y=l.children,w=l.option,P=l.onMarkerLoaded,k=new Ir(w);d&&k.setLnglat(d),y&&k.setElement(this.el),this.marker=k,P&&P(k),this.scene.addMarker(k)}},{key:"componentDidUpdate",value:function(l){var d,y=(l==null?void 0:l.lnglat.toString())!==((d=this.props)===null||d===void 0?void 0:d.lnglat.toString());y&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var l=this;return b.createElement(p.Consumer,{},function(d){return d&&(l.scene=d),(0,qm.createPortal)(l.props.children,l.el)})}}]),a}(b.PureComponent),S_=b.useEffect,E_=null,w_=null,T_=b.useEffect,A_=null},2121:function(){},33010:function(_t,O,_){var X=_(11535);_t.exports=b;function b(fe,Q){switch(fe&&fe.type||null){case"FeatureCollection":return fe.features=fe.features.map(p(b,Q)),fe;case"GeometryCollection":return fe.geometries=fe.geometries.map(p(b,Q)),fe;case"Feature":return fe.geometry=b(fe.geometry,Q),fe;case"Polygon":case"MultiPolygon":return H(fe,Q);default:return fe}}function p(fe,Q){return function(we){return fe(we,Q)}}function H(fe,Q){return fe.type==="Polygon"?fe.coordinates=S(fe.coordinates,Q):fe.type==="MultiPolygon"&&(fe.coordinates=fe.coordinates.map(p(S,Q))),fe}function S(fe,Q){Q=!!Q,fe[0]=F(fe[0],Q);for(var we=1;we<fe.length;we++)fe[we]=F(fe[we],!Q);return fe}function F(fe,Q){return ie(fe)===Q?fe:fe.reverse()}function ie(fe){return X.ring(fe)>=0}},26759:function(_t,O,_){"use strict";_.d(O,{SO:function(){return X},z6:function(){return Or},a5:function(){return b},Z:function(){return Ot},rQ:function(){return sr},bV:function(){return Rt},zi:function(){return ar},ds:function(){return Tr},Ev:function(){return qe},oO:function(){return wr},W0:function(){return lr},Z6:function(){return Kr},We:function(){return Qe},Cl:function(){return gt},gJ:function(){return ce},vP:function(){return z},yM:function(){return Et},yA:function(){return dr},CI:function(){return dt}});var X={};_.r(X),_.d(X,{DPR:function(){return Ge},addClass:function(){return Xe},create:function(){return Ie},empty:function(){return xt},getClass:function(){return lt},getContainer:function(){return ie},getViewPortScale:function(){return St},hasClass:function(){return er},printCanvas:function(){return Ht},remove:function(){return Be},removeClass:function(){return Ut},setClass:function(){return Yt},setTransform:function(){return Sr},splitWords:function(){return Q},triggerResize:function(){return Ft},trim:function(){return fe}});var b={};_.r(b),_.d(b,{getColumn:function(){return oi},getSatByColumn:function(){return K},max:function(){return _n},mean:function(){return _i},min:function(){return xn},mode:function(){return Ui},statMap:function(){return Xi},sum:function(){return ci}});function p(I){var j=131,Y=137,ue=0;I+="x";for(var Le=Math.floor(9007199254740991/Y),Me=0;Me<I.length;Me++)ue>Le&&(ue=Math.floor(ue/Y)),ue=ue*j+I.charCodeAt(Me);return ue}function H(I){I=I.toString();for(var j=5381,Y=I.length;Y;)j=j*33^I.charCodeAt(--Y);return j>>>0}var S=_(21814),F=window.document.documentElement.style;function ie(I){var j=I;return typeof I=="string"&&(j=document.getElementById(I)),j}function fe(I){return I.trim?I.trim():I.replace(/^\s+|\s+$/g,"")}function Q(I){return fe(I).split(/\s+/)}function we(I){if(!F)return I[0];for(var j in I)if(I[j]&&I[j]in F)return I[j];return I[0]}function Ie(I,j,Y){var ue=document.createElement(I);return ue.className=j||"",Y&&Y.appendChild(ue),ue}function Be(I){var j=I.parentNode;j&&j.removeChild(I)}function Xe(I,j){if(I.classList!==void 0)for(var Y=Q(j),ue=0,Le=Y.length;ue<Le;ue++)I.classList.add(Y[ue]);else if(!er(I,j)){var Me=lt(I);Yt(I,(Me?Me+" ":"")+j)}}function Ut(I,j){I.classList!==void 0?I.classList.remove(j):Yt(I,fe((" "+lt(I)+" ").replace(" "+j+" "," ")))}function er(I,j){if(I.classList!==void 0)return I.classList.contains(j);var Y=lt(I);return Y.length>0&&new RegExp("(^|\\s)"+j+"(\\s|$)").test(Y)}function Yt(I,j){I instanceof HTMLElement?I.className=j:I.className.baseVal=j}function lt(I){return I instanceof SVGElement&&(I=I.correspondingElement),I.className.baseVal===void 0?I.className:I.className.baseVal}function xt(I){for(;I&&I.firstChild;)I.removeChild(I.firstChild)}var ct=we(["transform","WebkitTransform"]);function Sr(I,j){I.style[ct]=j}function Ft(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var I=window.document.createEvent("UIEvents");I.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(I)}}function Ht(I){var j=["padding: "+(I.height/2-8)+"px "+I.width/2+"px;","line-height: "+I.height+"px;","background-image: url("+I.toDataURL()+");"];console.log(`%c
`,j.join(""))}function St(){var I,j=document.querySelector('meta[name="viewport"]');if(!j)return 1;var Y=(I=j.content)===null||I===void 0?void 0:I.split(","),ue=Y.find(function(Le){var Me=Le.split("="),se=(0,S.Z)(Me,2),Ne=se[0],At=se[1];return Ne==="initial-scale"});return ue?ue.split("=")[1]*1:1}var Ge=St()<1?1:window.devicePixelRatio,vt=_(66221),Pe=_(16710),Te=_(96114),ze=_(70243),bt=_(99219),cr=_(59051);function ae(I){return Function.toString.call(I).indexOf("[native code]")!==-1}var Ee=_(1444);function le(I,j,Y){return(0,Ee.Z)()?le=Reflect.construct:le=function(Le,Me,se){var Ne=[null];Ne.push.apply(Ne,Me);var At=Function.bind.apply(Le,Ne),Dr=new At;return se&&(0,cr.Z)(Dr,se.prototype),Dr},le.apply(null,arguments)}function re(I){var j=typeof Map=="function"?new Map:void 0;return re=function(ue){if(ue===null||!ae(ue))return ue;if(typeof ue!="function")throw new TypeError("Super expression must either be null or a function");if(typeof j!="undefined"){if(j.has(ue))return j.get(ue);j.set(ue,Le)}function Le(){return le(ue,arguments,(0,bt.Z)(this).constructor)}return Le.prototype=Object.create(ue.prototype,{constructor:{value:Le,enumerable:!1,writable:!0,configurable:!0}}),(0,cr.Z)(Le,ue)},re(I)}function te(I){var j=ke();return function(){var ue=(0,bt.Z)(I),Le;if(j){var Me=(0,bt.Z)(this).constructor;Le=Reflect.construct(ue,arguments,Me)}else Le=ue.apply(this,arguments);return(0,ze.Z)(this,Le)}}function ke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(I){return!1}}var nt=function(I){(0,Te.Z)(Y,I);var j=te(Y);function Y(ue,Le,Me){var se;return(0,vt.Z)(this,Y),se=j.call(this,ue),se.status=void 0,se.url=void 0,se.status=Le,se.url=Me,se.name=se.constructor.name,se.message=ue,se}return(0,Pe.Z)(Y,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),Y}(re(Error));function Kt(I){var j=new XMLHttpRequest;j.open("GET",I.url,!0);for(var Y in I.headers)I.headers.hasOwnProperty(Y)&&j.setRequestHeader(Y,I.headers[Y]);return j.withCredentials=I.credentials==="include",j}var Ir=function(j,Y){var ue=Kt(j);return ue.setRequestHeader("Accept","application/json"),ue.onerror=function(){Y(new Error(ue.statusText))},ue.onload=function(){if(ue.status>=200&&ue.status<300&&ue.response){var Le;try{Le=JSON.parse(ue.response)}catch(Me){return Y(Me)}Y(null,Le)}else ue.status===401?Y(new nt("".concat(ue.statusText),ue.status,j.url)):Y(new nt(ue.statusText,ue.status,j.url))},ue.send(),ue},Lr=function(j,Y){var ue=Kt(j);return ue.responseType="arraybuffer",ue.onerror=function(){Y(new Error(ue.statusText))},ue.onload=function(){var Le=ue.response;if(Le.byteLength===0&&ue.status===200)return Y(new Error("http status 200 returned without content."));ue.status>=200&&ue.status<300&&ue.response?Y(null,{data:Le,cacheControl:ue.getResponseHeader("Cache-Control"),expires:ue.getResponseHeader("Expires")}):Y(new nt(ue.statusText,ue.status,j.url))},ue.send(),ue};function qr(I){var j=window.document.createElement("a");return j.href=I,j.protocol===window.document.location.protocol&&j.host===window.document.location.host}var tr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",ce=function(j,Y){return Lr(j,function(ue,Le){if(ue)Y(ue);else if(Le){var Me=new window.Image;Me.crossOrigin="anonymous";var se=window.URL||window.webkitURL;Me.onload=function(){Y(null,Me),se.revokeObjectURL(Me.src)};var Ne=new window.Blob([new Uint8Array(Le.data)],{type:"image/png"});Me.src=Le.data.byteLength?se.createObjectURL(Ne):tr}})},ye=_(7126),Re=2*Math.PI*6378137/2;function Qe(I){var j=[Infinity,Infinity,-Infinity,-Infinity];return I.forEach(function(Y){var ue=Y.coordinates;Dt(j,ue)}),j}function Dt(I,j){return Array.isArray(j[0])?j.forEach(function(Y){Dt(I,Y)}):(I[0]>j[0]&&(I[0]=j[0]),I[1]>j[1]&&(I[1]=j[1]),I[2]<j[0]&&(I[2]=j[0]),I[3]<j[1]&&(I[3]=j[1])),I}function Ct(I,j){return A(I,j)}function A(I,j){return Array.isArray(I[0])?I.map(function(Y){return A(Y,j)}):j(I)}function z(I){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};I=ot(I,j);var ue=I[0],Le=I[1],Me=ue*Re/180,se=Math.log(Math.tan((90+Le)*Math.PI/360))/(Math.PI/180);return se=se*Re/180,Y.enable&&(Me=Number(Me.toFixed(Y.decimal)),se=Number(se.toFixed(Y.decimal))),I.length===3?[Me,se,I[2]]:[Me,se]}function ve(I){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,Y=I[0],ue=I[1],Le=Y/Re*180,Me=ue/Re*180;return Me=180/Math.PI*(2*Math.atan(Math.exp(Me*Math.PI/180))-Math.PI/2),j!=null&&(Le=Number(Le.toFixed(j)),Me=Number(Me.toFixed(j))),I.length===3?[Le,Me,I[2]]:[Le,Me]}function Ce(I){if(I==null)throw new Error("lng is required");return(I>180||I<-180)&&(I=I%360,I>180&&(I=-360+I),I<-180&&(I=360+I),I===0&&(I=0)),I}function $e(I){if(I==null)throw new Error("lat is required");return(I>90||I<-90)&&(I=I%180,I>90&&(I=-180+I),I<-90&&(I=180+I),I===0&&(I=0)),I}function ot(I,j){if(j===!1)return I;var Y=Ce(I[0]),ue=$e(I[1]);return ue>85&&(ue=85),ue<-85&&(ue=-85),I.length===3?[Y,ue,I[2]]:[Y,ue]}function Ot(I){var j=85.0511287798,Y=Math.max(Math.min(j,I[1]),-j),ue=256<<20,Le=Math.PI/180,Me=I[0]*Le,se=Y*Le;se=Math.log(Math.tan(Math.PI/4+se/2));var Ne=.5/Math.PI,At=.5,Dr=-.5/Math.PI;return Le=.5,Me=ue*(Ne*Me+At),se=ue*(Dr*se+Le),[Math.floor(Me),Math.floor(se)]}function G(I){var j=.5/Math.PI,Y=.5,ue=-.5/Math.PI,Le=.5,Me=256<<20,se=_slicedToArray(I,2),Ne=se[0],At=se[1];Ne=(Ne/Me-Y)/j,At=(At/Me-Le)/ue,At=(Math.atan(Math.pow(Math.E,At))-Math.PI/4)*2,Le=Math.PI/180;var Dr=At/Le,Ur=Ne/Le;return[Ur,Dr]}function Et(I,j,Y){var ue=(0,ye.Ht)(j[1]-I[1]),Le=(0,ye.Ht)(j[0]-I[0]),Me=(0,ye.Ht)(I[1]),se=(0,ye.Ht)(j[1]),Ne=Math.pow(Math.sin(ue/2),2)+Math.pow(Math.sin(Le/2),2)*Math.cos(Me)*Math.cos(se);return(0,ye.DL)(2*Math.atan2(Math.sqrt(Ne),Math.sqrt(1-Ne)),Y="meters")}function Bt(I){var j=Math.PI/180,Y=85.0511287798,ue=6378137,Le=Math.max(Math.min(Y,I[1]),-Y),Me=Math.sin(Le*j),se=ue*I[0]*j,Ne=ue*Math.log((1+Me)/(1-Me))/2;return[se,Ne]}function dr(I,j){var Y=Math.abs(I[1][1]-I[0][1])*j,ue=Math.abs(I[1][0]-I[0][0])*j;return[[I[0][0]-ue,I[0][1]-Y],[I[1][0]+ue,I[1][1]+Y]]}function wr(I,j){return I[0][0]<=j[0][0]&&I[0][1]<=j[0][1]&&I[1][0]>=j[1][0]&&I[1][1]>=j[1][1]}function Tr(I){return[[I[0],I[1]],[I[2],I[3]]]}var Or=function(){function I(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,Y=arguments.length>1?arguments[1]:void 0;(0,vt.Z)(this,I),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=j,this.destroy=Y||this.defaultDestroy,this.order=[],this.clear()}return(0,Pe.Z)(I,[{key:"clear",value:function(){var Y=this;this.order.forEach(function(ue){Y.delete(ue)}),this.cache={},this.order=[]}},{key:"get",value:function(Y){var ue=this.cache[Y];return ue&&(this.deleteOrder(Y),this.appendOrder(Y)),ue}},{key:"set",value:function(Y,ue){this.cache[Y]?(this.delete(Y),this.cache[Y]=ue,this.appendOrder(Y)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[Y]=ue,this.appendOrder(Y))}},{key:"delete",value:function(Y){var ue=this.cache[Y];ue&&(this.deleteCache(Y),this.deleteOrder(Y),this.destroy(ue,Y))}},{key:"deleteCache",value:function(Y){delete this.cache[Y]}},{key:"deleteOrder",value:function(Y){var ue=this.order.findIndex(function(Le){return Le===Y});ue>=0&&this.order.splice(ue,1)}},{key:"appendOrder",value:function(Y){this.order.push(Y)}},{key:"defaultDestroy",value:function(Y,ue){return null}}]),I}();function qe(I,j){I.forEach(function(Y){!j[Y]||(j[Y]=j[Y].bind(j))})}var yt=_(82983);function dt(I){var j=yt.ZP(I),Y=[0,0,0,0];return j!=null&&(Y[0]=j.r/255,Y[1]=j.g/255,Y[2]=j.b/255,Y[3]=j.opacity),Y}function lr(I){var j=I&&I[0],Y=I&&I[1],ue=I&&I[2],Le=j+Y*256+ue*65536-1;return Le}function Kr(I){return[I+1&255,I+1>>8&255,I+1>>8>>8&255]}function gt(I){var j=document.createElement("canvas"),Y=j.getContext("2d");j.width=256,j.height=1;for(var ue=Y.createLinearGradient(0,0,256,1),Le=null,Me=I.positions[0],se=I.positions[I.positions.length-1],Ne=0;Ne<I.colors.length;++Ne){var At=(I.positions[Ne]-Me)/(se-Me);ue.addColorStop(At,I.colors[Ne])}return Y.fillStyle=ue,Y.fillRect(0,0,256,1),Le=new Uint8ClampedArray(Y.getImageData(0,0,256,1).data),new ImageData(Le,256,1)}var Rt;(function(I){I.CENTER="center",I.TOP="top",I["TOP-LEFT"]="top-left",I["TOP-RIGHT"]="top-right",I.BOTTOM="bottom",I["BOTTOM-LEFT"]="bottom-left",I.LEFT="left",I.RIGHT="right"})(Rt||(Rt={}));var sr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ar(I,j,Y){var ue=I.classList;for(var Le in sr)sr.hasOwnProperty(Le)&&ue.remove("l7-".concat(Y,"-anchor-").concat(Le));ue.add("l7-".concat(Y,"-anchor-").concat(j))}function _n(I){if(I.length===0)throw new Error("max requires at least one data point");for(var j=I[0],Y=1;Y<I.length;Y++)I[Y]>j&&(j=I[Y]);return j*1}function xn(I){if(I.length===0)throw new Error("min requires at least one data point");for(var j=I[0],Y=1;Y<I.length;Y++)I[Y]<j&&(j=I[Y]);return j*1}function ci(I){if(I.length===0)return 0;for(var j=I[0]*1,Y=1;Y<I.length;Y++)j+=I[Y]*1;return j}function _i(I){if(I.length===0)throw new Error("mean requires at least one data point");return ci(I)/I.length}function Ui(I){if(I.length===0)throw new Error("mean requires at least one data point");if(I.length<3)return I[0];I.sort();for(var j=I[0],Y=NaN,ue=0,Le=1,Me=1;Me<I.length+1;Me++)I[Me]!==j?(Le>ue&&(ue=Le,Y=j),Le=1,j=I[Me]):Le++;return Y*1}var Xi={min:xn,max:_n,mean:_i,sum:ci,mode:Ui};function oi(I,j){return I.map(function(Y){return Y[j]})}function K(I,j){return Xi[I](j)}},60623:function(_t,O,_){"use strict";_.d(O,{Z:function(){return X}});function X(b,p,H,S,F){var ie={};return Object.keys(S).forEach(function(fe){ie[fe]=S[fe]}),ie.enumerable=!!ie.enumerable,ie.configurable=!!ie.configurable,("value"in ie||ie.initializer)&&(ie.writable=!0),ie=H.slice().reverse().reduce(function(fe,Q){return Q(b,p,fe)||fe},ie),F&&ie.initializer!==void 0&&(ie.value=ie.initializer?ie.initializer.call(F):void 0,ie.initializer=void 0),ie.initializer===void 0&&(Object.defineProperty(b,p,ie),ie=null),ie}},93158:function(_t,O,_){"use strict";_.d(O,{Z:function(){return X}});function X(b,p,H,S){!H||Object.defineProperty(b,p,{enumerable:H.enumerable,configurable:H.configurable,writable:H.writable,value:H.initializer?H.initializer.call(S):void 0})}},11535:function(_t,O,_){var X=_(86940);_t.exports.geometry=b,_t.exports.ring=H;function b(F){var ie=0,fe;switch(F.type){case"Polygon":return p(F.coordinates);case"MultiPolygon":for(fe=0;fe<F.coordinates.length;fe++)ie+=p(F.coordinates[fe]);return ie;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(fe=0;fe<F.geometries.length;fe++)ie+=b(F.geometries[fe]);return ie}}function p(F){var ie=0;if(F&&F.length>0){ie+=Math.abs(H(F[0]));for(var fe=1;fe<F.length;fe++)ie-=Math.abs(H(F[fe]))}return ie}function H(F){var ie,fe,Q,we,Ie,Be,Xe,Ut=0,er=F.length;if(er>2){for(Xe=0;Xe<er;Xe++)Xe===er-2?(we=er-2,Ie=er-1,Be=0):Xe===er-1?(we=er-1,Ie=0,Be=1):(we=Xe,Ie=Xe+1,Be=Xe+2),ie=F[we],fe=F[Ie],Q=F[Be],Ut+=(S(Q[0])-S(ie[0]))*Math.sin(S(fe[1]));Ut=Ut*X.RADIUS*X.RADIUS/2}return Ut}function S(F){return F*Math.PI/180}},36739:function(_t){"use strict";_t.exports=_,_t.exports.default=_;var O=1e20;function _(S,F,ie,fe,Q,we){this.fontSize=S||24,this.buffer=F===void 0?3:F,this.cutoff=fe||.25,this.fontFamily=Q||"sans-serif",this.fontWeight=we||"normal",this.radius=ie||8;var Ie=this.size=this.fontSize+this.buffer*2,Be=Ie+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Ie,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Be*Be),this.gridInner=new Float64Array(Be*Be),this.f=new Float64Array(Be),this.z=new Float64Array(Be+1),this.v=new Uint16Array(Be),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(Ie/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function X(S,F,ie,fe,Q,we,Ie){we.fill(O,0,F*ie),Ie.fill(0,0,F*ie);for(var Be=(F-fe)/2,Xe=0;Xe<Q;Xe++)for(var Ut=0;Ut<fe;Ut++){var er=(Xe+Be)*F+Ut+Be,Yt=S.data[4*(Xe*fe+Ut)+3]/255;if(Yt===1)we[er]=0,Ie[er]=O;else if(Yt===0)we[er]=O,Ie[er]=0;else{var lt=Math.max(0,.5-Yt),xt=Math.max(0,Yt-.5);we[er]=lt*lt,Ie[er]=xt*xt}}}function b(S,F,ie,fe,Q,we,Ie){for(var Be=0;Be<F*ie;Be++){var Xe=Math.sqrt(fe[Be])-Math.sqrt(Q[Be]);S[Be]=Math.round(255-255*(Xe/we+Ie))}}_.prototype._draw=function(S,F){var ie=this.ctx.measureText(S),fe=ie.width,Q=2*this.buffer,we,Ie,Be,Xe,Ut,er,Yt,lt;F&&this.useMetrics?(Ut=Math.floor(ie.actualBoundingBoxAscent),lt=this.buffer+Math.ceil(ie.actualBoundingBoxAscent),er=this.buffer,Yt=this.buffer,Ie=Math.min(this.size,Math.ceil(ie.actualBoundingBoxRight-ie.actualBoundingBoxLeft)),Xe=Math.min(this.size-er,Math.ceil(ie.actualBoundingBoxAscent+ie.actualBoundingBoxDescent)),we=Ie+Q,Be=Xe+Q,this.ctx.textBaseline="alphabetic"):(we=Ie=this.size,Be=Xe=this.size,Ut=19*this.fontSize/24,er=Yt=0,lt=this.middle,this.ctx.textBaseline="middle");var xt;Ie&&Xe&&(this.ctx.clearRect(Yt,er,Ie,Xe),this.ctx.fillText(S,this.buffer,lt),xt=this.ctx.getImageData(Yt,er,Ie,Xe));var ct=new Uint8ClampedArray(we*Be);return X(xt,we,Be,Ie,Xe,this.gridOuter,this.gridInner),p(this.gridOuter,we,Be,this.f,this.v,this.z),p(this.gridInner,we,Be,this.f,this.v,this.z),b(ct,we,Be,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:ct,metrics:{width:Ie,height:Xe,sdfWidth:we,sdfHeight:Be,top:Ut,left:0,advance:fe}}},_.prototype.draw=function(S){return this._draw(S,!1).data},_.prototype.drawWithMetrics=function(S){return this._draw(S,!0)};function p(S,F,ie,fe,Q,we){for(var Ie=0;Ie<F;Ie++)H(S,Ie,F,ie,fe,Q,we);for(var Be=0;Be<ie;Be++)H(S,Be*F,1,F,fe,Q,we)}function H(S,F,ie,fe,Q,we,Ie){var Be,Xe,Ut,er;for(we[0]=0,Ie[0]=-O,Ie[1]=O,Be=0;Be<fe;Be++)Q[Be]=S[F+Be*ie];for(Be=1,Xe=0,Ut=0;Be<fe;Be++){do er=we[Xe],Ut=(Q[Be]-Q[er]+Be*Be-er*er)/(Be-er)/2;while(Ut<=Ie[Xe]&&--Xe>-1);Xe++,we[Xe]=Be,Ie[Xe]=Ut,Ie[Xe+1]=O}for(Be=0,Xe=0;Be<fe;Be++){for(;Ie[Xe+1]<Be;)Xe++;er=we[Xe],S[F+Be*ie]=Q[er]+(Be-er)*(Be-er)}}},7126:function(_t,O,_){"use strict";_.d(O,{zL:function(){return S},DL:function(){return ct},Ht:function(){return Ge}});var X=63710088e-1,b={centimeters:X*100,centimetres:X*100,degrees:X/111325,feet:X*3.28084,inches:X*39.37,kilometers:X/1e3,kilometres:X/1e3,meters:X,metres:X,miles:X/1609.344,millimeters:X*1e3,millimetres:X*1e3,nauticalmiles:X/1852,radians:1,yards:X/1.0936},p={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/X,yards:1/1.0936},H={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function S(ae,Ee,le){le===void 0&&(le={});var re={type:"Feature"};return(le.id===0||le.id)&&(re.id=le.id),le.bbox&&(re.bbox=le.bbox),re.properties=Ee||{},re.geometry=ae,re}function F(ae,Ee,le){switch(le===void 0&&(le={}),ae){case"Point":return ie(Ee).geometry;case"LineString":return Ie(Ee).geometry;case"Polygon":return Q(Ee).geometry;case"MultiPoint":return er(Ee).geometry;case"MultiLineString":return Ut(Ee).geometry;case"MultiPolygon":return Yt(Ee).geometry;default:throw new Error(ae+" is invalid")}}function ie(ae,Ee,le){if(le===void 0&&(le={}),!ae)throw new Error("coordinates is required");if(!Array.isArray(ae))throw new Error("coordinates must be an Array");if(ae.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Te(ae[0])||!Te(ae[1]))throw new Error("coordinates must contain numbers");var re={type:"Point",coordinates:ae};return S(re,Ee,le)}function fe(ae,Ee,le){return le===void 0&&(le={}),Xe(ae.map(function(re){return ie(re,Ee)}),le)}function Q(ae,Ee,le){le===void 0&&(le={});for(var re=0,te=ae;re<te.length;re++){var ke=te[re];if(ke.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var nt=0;nt<ke[ke.length-1].length;nt++)if(ke[ke.length-1][nt]!==ke[0][nt])throw new Error("First and last Position are not equivalent.")}var Kt={type:"Polygon",coordinates:ae};return S(Kt,Ee,le)}function we(ae,Ee,le){return le===void 0&&(le={}),Xe(ae.map(function(re){return Q(re,Ee)}),le)}function Ie(ae,Ee,le){if(le===void 0&&(le={}),ae.length<2)throw new Error("coordinates must be an array of two or more positions");var re={type:"LineString",coordinates:ae};return S(re,Ee,le)}function Be(ae,Ee,le){return le===void 0&&(le={}),Xe(ae.map(function(re){return Ie(re,Ee)}),le)}function Xe(ae,Ee){Ee===void 0&&(Ee={});var le={type:"FeatureCollection"};return Ee.id&&(le.id=Ee.id),Ee.bbox&&(le.bbox=Ee.bbox),le.features=ae,le}function Ut(ae,Ee,le){le===void 0&&(le={});var re={type:"MultiLineString",coordinates:ae};return S(re,Ee,le)}function er(ae,Ee,le){le===void 0&&(le={});var re={type:"MultiPoint",coordinates:ae};return S(re,Ee,le)}function Yt(ae,Ee,le){le===void 0&&(le={});var re={type:"MultiPolygon",coordinates:ae};return S(re,Ee,le)}function lt(ae,Ee,le){le===void 0&&(le={});var re={type:"GeometryCollection",geometries:ae};return S(re,Ee,le)}function xt(ae,Ee){if(Ee===void 0&&(Ee=0),Ee&&!(Ee>=0))throw new Error("precision must be a positive number");var le=Math.pow(10,Ee||0);return Math.round(ae*le)/le}function ct(ae,Ee){Ee===void 0&&(Ee="kilometers");var le=b[Ee];if(!le)throw new Error(Ee+" units is invalid");return ae*le}function Sr(ae,Ee){Ee===void 0&&(Ee="kilometers");var le=b[Ee];if(!le)throw new Error(Ee+" units is invalid");return ae/le}function Ft(ae,Ee){return St(Sr(ae,Ee))}function Ht(ae){var Ee=ae%360;return Ee<0&&(Ee+=360),Ee}function St(ae){var Ee=ae%(2*Math.PI);return Ee*180/Math.PI}function Ge(ae){var Ee=ae%360;return Ee*Math.PI/180}function vt(ae,Ee,le){if(Ee===void 0&&(Ee="kilometers"),le===void 0&&(le="kilometers"),!(ae>=0))throw new Error("length must be a positive number");return ct(Sr(ae,Ee),le)}function Pe(ae,Ee,le){if(Ee===void 0&&(Ee="meters"),le===void 0&&(le="kilometers"),!(ae>=0))throw new Error("area must be a positive number");var re=H[Ee];if(!re)throw new Error("invalid original units");var te=H[le];if(!te)throw new Error("invalid final units");return ae/re*te}function Te(ae){return!isNaN(ae)&&ae!==null&&!Array.isArray(ae)}function ze(ae){return!!ae&&ae.constructor===Object}function bt(ae){if(!ae)throw new Error("bbox is required");if(!Array.isArray(ae))throw new Error("bbox must be an Array");if(ae.length!==4&&ae.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");ae.forEach(function(Ee){if(!Te(Ee))throw new Error("bbox must only contain numbers")})}function cr(ae){if(!ae)throw new Error("id is required");if(["string","number"].indexOf(typeof ae)===-1)throw new Error("id must be a number or a string")}},15785:function(_t,O,_){"use strict";var X=_(16020);/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function b(Te,ze){if(Te===ze)return 0;for(var bt=Te.length,cr=ze.length,ae=0,Ee=Math.min(bt,cr);ae<Ee;++ae)if(Te[ae]!==ze[ae]){bt=Te[ae],cr=ze[ae];break}return bt<cr?-1:cr<bt?1:0}function p(Te){return _.g.Buffer&&typeof _.g.Buffer.isBuffer=="function"?_.g.Buffer.isBuffer(Te):!!(Te!=null&&Te._isBuffer)}var H=_(64245),S=Object.prototype.hasOwnProperty,F=Array.prototype.slice,ie=function(){return function(){}.name==="foo"}();function fe(Te){return Object.prototype.toString.call(Te)}function Q(Te){return p(Te)||typeof _.g.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Te):Te?!!(Te instanceof DataView||Te.buffer&&Te.buffer instanceof ArrayBuffer):!1}var we=_t.exports=lt,Ie=/\s*function\s+([^\(\s]*)\s*/;function Be(Te){if(!!H.isFunction(Te)){if(ie)return Te.name;var ze=Te.toString(),bt=ze.match(Ie);return bt&&bt[1]}}we.AssertionError=function(ze){this.name="AssertionError",this.actual=ze.actual,this.expected=ze.expected,this.operator=ze.operator,ze.message?(this.message=ze.message,this.generatedMessage=!1):(this.message=er(this),this.generatedMessage=!0);var bt=ze.stackStartFunction||Yt;if(Error.captureStackTrace)Error.captureStackTrace(this,bt);else{var cr=new Error;if(cr.stack){var ae=cr.stack,Ee=Be(bt),le=ae.indexOf(`
`+Ee);if(le>=0){var re=ae.indexOf(`
`,le+1);ae=ae.substring(re+1)}this.stack=ae}}},H.inherits(we.AssertionError,Error);function Xe(Te,ze){return typeof Te=="string"?Te.length<ze?Te:Te.slice(0,ze):Te}function Ut(Te){if(ie||!H.isFunction(Te))return H.inspect(Te);var ze=Be(Te),bt=ze?": "+ze:"";return"[Function"+bt+"]"}function er(Te){return Xe(Ut(Te.actual),128)+" "+Te.operator+" "+Xe(Ut(Te.expected),128)}function Yt(Te,ze,bt,cr,ae){throw new we.AssertionError({message:bt,actual:Te,expected:ze,operator:cr,stackStartFunction:ae})}we.fail=Yt;function lt(Te,ze){Te||Yt(Te,!0,ze,"==",we.ok)}we.ok=lt,we.equal=function(ze,bt,cr){ze!=bt&&Yt(ze,bt,cr,"==",we.equal)},we.notEqual=function(ze,bt,cr){ze==bt&&Yt(ze,bt,cr,"!=",we.notEqual)},we.deepEqual=function(ze,bt,cr){xt(ze,bt,!1)||Yt(ze,bt,cr,"deepEqual",we.deepEqual)},we.deepStrictEqual=function(ze,bt,cr){xt(ze,bt,!0)||Yt(ze,bt,cr,"deepStrictEqual",we.deepStrictEqual)};function xt(Te,ze,bt,cr){if(Te===ze)return!0;if(p(Te)&&p(ze))return b(Te,ze)===0;if(H.isDate(Te)&&H.isDate(ze))return Te.getTime()===ze.getTime();if(H.isRegExp(Te)&&H.isRegExp(ze))return Te.source===ze.source&&Te.global===ze.global&&Te.multiline===ze.multiline&&Te.lastIndex===ze.lastIndex&&Te.ignoreCase===ze.ignoreCase;if((Te===null||typeof Te!="object")&&(ze===null||typeof ze!="object"))return bt?Te===ze:Te==ze;if(Q(Te)&&Q(ze)&&fe(Te)===fe(ze)&&!(Te instanceof Float32Array||Te instanceof Float64Array))return b(new Uint8Array(Te.buffer),new Uint8Array(ze.buffer))===0;if(p(Te)!==p(ze))return!1;cr=cr||{actual:[],expected:[]};var ae=cr.actual.indexOf(Te);return ae!==-1&&ae===cr.expected.indexOf(ze)?!0:(cr.actual.push(Te),cr.expected.push(ze),Sr(Te,ze,bt,cr))}function ct(Te){return Object.prototype.toString.call(Te)=="[object Arguments]"}function Sr(Te,ze,bt,cr){if(Te==null||ze===null||ze===void 0)return!1;if(H.isPrimitive(Te)||H.isPrimitive(ze))return Te===ze;if(bt&&Object.getPrototypeOf(Te)!==Object.getPrototypeOf(ze))return!1;var ae=ct(Te),Ee=ct(ze);if(ae&&!Ee||!ae&&Ee)return!1;if(ae)return Te=F.call(Te),ze=F.call(ze),xt(Te,ze,bt);var le=Pe(Te),re=Pe(ze),te,ke;if(le.length!==re.length)return!1;for(le.sort(),re.sort(),ke=le.length-1;ke>=0;ke--)if(le[ke]!==re[ke])return!1;for(ke=le.length-1;ke>=0;ke--)if(te=le[ke],!xt(Te[te],ze[te],bt,cr))return!1;return!0}we.notDeepEqual=function(ze,bt,cr){xt(ze,bt,!1)&&Yt(ze,bt,cr,"notDeepEqual",we.notDeepEqual)},we.notDeepStrictEqual=Ft;function Ft(Te,ze,bt){xt(Te,ze,!0)&&Yt(Te,ze,bt,"notDeepStrictEqual",Ft)}we.strictEqual=function(ze,bt,cr){ze!==bt&&Yt(ze,bt,cr,"===",we.strictEqual)},we.notStrictEqual=function(ze,bt,cr){ze===bt&&Yt(ze,bt,cr,"!==",we.notStrictEqual)};function Ht(Te,ze){if(!Te||!ze)return!1;if(Object.prototype.toString.call(ze)=="[object RegExp]")return ze.test(Te);try{if(Te instanceof ze)return!0}catch(bt){}return Error.isPrototypeOf(ze)?!1:ze.call({},Te)===!0}function St(Te){var ze;try{Te()}catch(bt){ze=bt}return ze}function Ge(Te,ze,bt,cr){var ae;if(typeof ze!="function")throw new TypeError('"block" argument must be a function');typeof bt=="string"&&(cr=bt,bt=null),ae=St(ze),cr=(bt&&bt.name?" ("+bt.name+").":".")+(cr?" "+cr:"."),Te&&!ae&&Yt(ae,bt,"Missing expected exception"+cr);var Ee=typeof cr=="string",le=!Te&&H.isError(ae),re=!Te&&ae&&!bt;if((le&&Ee&&Ht(ae,bt)||re)&&Yt(ae,bt,"Got unwanted exception"+cr),Te&&ae&&bt&&!Ht(ae,bt)||!Te&&ae)throw ae}we.throws=function(Te,ze,bt){Ge(!0,Te,ze,bt)},we.doesNotThrow=function(Te,ze,bt){Ge(!1,Te,ze,bt)},we.ifError=function(Te){if(Te)throw Te};function vt(Te,ze){Te||Yt(Te,!0,ze,"==",vt)}we.strict=X(vt,we,{equal:we.strictEqual,deepEqual:we.deepStrictEqual,notEqual:we.notStrictEqual,notDeepEqual:we.notDeepStrictEqual}),we.strict.strict=we.strict;var Pe=Object.keys||function(Te){var ze=[];for(var bt in Te)S.call(Te,bt)&&ze.push(bt);return ze}},83742:function(_t){typeof Object.create=="function"?_t.exports=function(_,X){_.super_=X,_.prototype=Object.create(X.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}})}:_t.exports=function(_,X){_.super_=X;var b=function(){};b.prototype=X.prototype,_.prototype=new b,_.prototype.constructor=_}},77211:function(_t){_t.exports=function(_){return _&&typeof _=="object"&&typeof _.copy=="function"&&typeof _.fill=="function"&&typeof _.readUInt8=="function"}},64245:function(_t,O,_){var X=_(6661),b=/%[sdj%]/g;O.format=function(re){if(!Sr(re)){for(var te=[],ke=0;ke<arguments.length;ke++)te.push(S(arguments[ke]));return te.join(" ")}for(var ke=1,nt=arguments,Kt=nt.length,Ir=String(re).replace(b,function(qr){if(qr==="%%")return"%";if(ke>=Kt)return qr;switch(qr){case"%s":return String(nt[ke++]);case"%d":return Number(nt[ke++]);case"%j":try{return JSON.stringify(nt[ke++])}catch(tr){return"[Circular]"}default:return qr}}),Lr=nt[ke];ke<Kt;Lr=nt[++ke])lt(Lr)||!Ge(Lr)?Ir+=" "+Lr:Ir+=" "+S(Lr);return Ir},O.deprecate=function(re,te){if(Ht(_.g.process))return function(){return O.deprecate(re,te).apply(this,arguments)};if(X.noDeprecation===!0)return re;var ke=!1;function nt(){if(!ke){if(X.throwDeprecation)throw new Error(te);X.traceDeprecation?console.trace(te):console.error(te),ke=!0}return re.apply(this,arguments)}return nt};var p={},H;O.debuglog=function(re){if(Ht(H)&&(H={NODE_ENV:"production"}.NODE_DEBUG||""),re=re.toUpperCase(),!p[re])if(new RegExp("\\b"+re+"\\b","i").test(H)){var te=X.pid;p[re]=function(){var ke=O.format.apply(O,arguments);console.error("%s %d: %s",re,te,ke)}}else p[re]=function(){};return p[re]};function S(re,te){var ke={seen:[],stylize:ie};return arguments.length>=3&&(ke.depth=arguments[2]),arguments.length>=4&&(ke.colors=arguments[3]),Yt(te)?ke.showHidden=te:te&&O._extend(ke,te),Ht(ke.showHidden)&&(ke.showHidden=!1),Ht(ke.depth)&&(ke.depth=2),Ht(ke.colors)&&(ke.colors=!1),Ht(ke.customInspect)&&(ke.customInspect=!0),ke.colors&&(ke.stylize=F),Q(ke,re,ke.depth)}O.inspect=S,S.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},S.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function F(re,te){var ke=S.styles[te];return ke?"["+S.colors[ke][0]+"m"+re+"["+S.colors[ke][1]+"m":re}function ie(re,te){return re}function fe(re){var te={};return re.forEach(function(ke,nt){te[ke]=!0}),te}function Q(re,te,ke){if(re.customInspect&&te&&Te(te.inspect)&&te.inspect!==O.inspect&&!(te.constructor&&te.constructor.prototype===te)){var nt=te.inspect(ke,re);return Sr(nt)||(nt=Q(re,nt,ke)),nt}var Kt=we(re,te);if(Kt)return Kt;var Ir=Object.keys(te),Lr=fe(Ir);if(re.showHidden&&(Ir=Object.getOwnPropertyNames(te)),Pe(te)&&(Ir.indexOf("message")>=0||Ir.indexOf("description")>=0))return Ie(te);if(Ir.length===0){if(Te(te)){var qr=te.name?": "+te.name:"";return re.stylize("[Function"+qr+"]","special")}if(St(te))return re.stylize(RegExp.prototype.toString.call(te),"regexp");if(vt(te))return re.stylize(Date.prototype.toString.call(te),"date");if(Pe(te))return Ie(te)}var tr="",ce=!1,ye=["{","}"];if(er(te)&&(ce=!0,ye=["[","]"]),Te(te)){var Re=te.name?": "+te.name:"";tr=" [Function"+Re+"]"}if(St(te)&&(tr=" "+RegExp.prototype.toString.call(te)),vt(te)&&(tr=" "+Date.prototype.toUTCString.call(te)),Pe(te)&&(tr=" "+Ie(te)),Ir.length===0&&(!ce||te.length==0))return ye[0]+tr+ye[1];if(ke<0)return St(te)?re.stylize(RegExp.prototype.toString.call(te),"regexp"):re.stylize("[Object]","special");re.seen.push(te);var Qe;return ce?Qe=Be(re,te,ke,Lr,Ir):Qe=Ir.map(function(Dt){return Xe(re,te,ke,Lr,Dt,ce)}),re.seen.pop(),Ut(Qe,tr,ye)}function we(re,te){if(Ht(te))return re.stylize("undefined","undefined");if(Sr(te)){var ke="'"+JSON.stringify(te).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return re.stylize(ke,"string")}if(ct(te))return re.stylize(""+te,"number");if(Yt(te))return re.stylize(""+te,"boolean");if(lt(te))return re.stylize("null","null")}function Ie(re){return"["+Error.prototype.toString.call(re)+"]"}function Be(re,te,ke,nt,Kt){for(var Ir=[],Lr=0,qr=te.length;Lr<qr;++Lr)le(te,String(Lr))?Ir.push(Xe(re,te,ke,nt,String(Lr),!0)):Ir.push("");return Kt.forEach(function(tr){tr.match(/^\d+$/)||Ir.push(Xe(re,te,ke,nt,tr,!0))}),Ir}function Xe(re,te,ke,nt,Kt,Ir){var Lr,qr,tr;if(tr=Object.getOwnPropertyDescriptor(te,Kt)||{value:te[Kt]},tr.get?tr.set?qr=re.stylize("[Getter/Setter]","special"):qr=re.stylize("[Getter]","special"):tr.set&&(qr=re.stylize("[Setter]","special")),le(nt,Kt)||(Lr="["+Kt+"]"),qr||(re.seen.indexOf(tr.value)<0?(lt(ke)?qr=Q(re,tr.value,null):qr=Q(re,tr.value,ke-1),qr.indexOf(`
`)>-1&&(Ir?qr=qr.split(`
`).map(function(ce){return"  "+ce}).join(`
`).substr(2):qr=`
`+qr.split(`
`).map(function(ce){return"   "+ce}).join(`
`))):qr=re.stylize("[Circular]","special")),Ht(Lr)){if(Ir&&Kt.match(/^\d+$/))return qr;Lr=JSON.stringify(""+Kt),Lr.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Lr=Lr.substr(1,Lr.length-2),Lr=re.stylize(Lr,"name")):(Lr=Lr.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Lr=re.stylize(Lr,"string"))}return Lr+": "+qr}function Ut(re,te,ke){var nt=0,Kt=re.reduce(function(Ir,Lr){return nt++,Lr.indexOf(`
`)>=0&&nt++,Ir+Lr.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Kt>60?ke[0]+(te===""?"":te+`
 `)+" "+re.join(`,
  `)+" "+ke[1]:ke[0]+te+" "+re.join(", ")+" "+ke[1]}function er(re){return Array.isArray(re)}O.isArray=er;function Yt(re){return typeof re=="boolean"}O.isBoolean=Yt;function lt(re){return re===null}O.isNull=lt;function xt(re){return re==null}O.isNullOrUndefined=xt;function ct(re){return typeof re=="number"}O.isNumber=ct;function Sr(re){return typeof re=="string"}O.isString=Sr;function Ft(re){return typeof re=="symbol"}O.isSymbol=Ft;function Ht(re){return re===void 0}O.isUndefined=Ht;function St(re){return Ge(re)&&bt(re)==="[object RegExp]"}O.isRegExp=St;function Ge(re){return typeof re=="object"&&re!==null}O.isObject=Ge;function vt(re){return Ge(re)&&bt(re)==="[object Date]"}O.isDate=vt;function Pe(re){return Ge(re)&&(bt(re)==="[object Error]"||re instanceof Error)}O.isError=Pe;function Te(re){return typeof re=="function"}O.isFunction=Te;function ze(re){return re===null||typeof re=="boolean"||typeof re=="number"||typeof re=="string"||typeof re=="symbol"||typeof re=="undefined"}O.isPrimitive=ze,O.isBuffer=_(77211);function bt(re){return Object.prototype.toString.call(re)}function cr(re){return re<10?"0"+re.toString(10):re.toString(10)}var ae=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ee(){var re=new Date,te=[cr(re.getHours()),cr(re.getMinutes()),cr(re.getSeconds())].join(":");return[re.getDate(),ae[re.getMonth()],te].join(" ")}O.log=function(){console.log("%s - %s",Ee(),O.format.apply(O,arguments))},O.inherits=_(83742),O._extend=function(re,te){if(!te||!Ge(te))return re;for(var ke=Object.keys(te),nt=ke.length;nt--;)re[ke[nt]]=te[ke[nt]];return re};function le(re,te){return Object.prototype.hasOwnProperty.call(re,te)}},82983:function(_t,O,_){"use strict";_.d(O,{ZP:function(){return Sr},B8:function(){return Ge}});function X(re,te,ke){re.prototype=te.prototype=ke,ke.constructor=re}function b(re,te){var ke=Object.create(re.prototype);for(var nt in te)ke[nt]=te[nt];return ke}function p(){}var H=.7,S=1/H,F="\\s*([+-]?\\d+)\\s*",ie="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",fe="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Q=/^#([0-9a-f]{3,8})$/,we=new RegExp("^rgb\\("+[F,F,F]+"\\)$"),Ie=new RegExp("^rgb\\("+[fe,fe,fe]+"\\)$"),Be=new RegExp("^rgba\\("+[F,F,F,ie]+"\\)$"),Xe=new RegExp("^rgba\\("+[fe,fe,fe,ie]+"\\)$"),Ut=new RegExp("^hsl\\("+[ie,fe,fe]+"\\)$"),er=new RegExp("^hsla\\("+[ie,fe,fe,ie]+"\\)$"),Yt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};X(p,Sr,{copy:function(te){return Object.assign(new this.constructor,this,te)},displayable:function(){return this.rgb().displayable()},hex:lt,formatHex:lt,formatHsl:xt,formatRgb:ct,toString:ct});function lt(){return this.rgb().formatHex()}function xt(){return cr(this).formatHsl()}function ct(){return this.rgb().formatRgb()}function Sr(re){var te,ke;return re=(re+"").trim().toLowerCase(),(te=Q.exec(re))?(ke=te[1].length,te=parseInt(te[1],16),ke===6?Ft(te):ke===3?new vt(te>>8&15|te>>4&240,te>>4&15|te&240,(te&15)<<4|te&15,1):ke===8?Ht(te>>24&255,te>>16&255,te>>8&255,(te&255)/255):ke===4?Ht(te>>12&15|te>>8&240,te>>8&15|te>>4&240,te>>4&15|te&240,((te&15)<<4|te&15)/255):null):(te=we.exec(re))?new vt(te[1],te[2],te[3],1):(te=Ie.exec(re))?new vt(te[1]*255/100,te[2]*255/100,te[3]*255/100,1):(te=Be.exec(re))?Ht(te[1],te[2],te[3],te[4]):(te=Xe.exec(re))?Ht(te[1]*255/100,te[2]*255/100,te[3]*255/100,te[4]):(te=Ut.exec(re))?bt(te[1],te[2]/100,te[3]/100,1):(te=er.exec(re))?bt(te[1],te[2]/100,te[3]/100,te[4]):Yt.hasOwnProperty(re)?Ft(Yt[re]):re==="transparent"?new vt(NaN,NaN,NaN,0):null}function Ft(re){return new vt(re>>16&255,re>>8&255,re&255,1)}function Ht(re,te,ke,nt){return nt<=0&&(re=te=ke=NaN),new vt(re,te,ke,nt)}function St(re){return re instanceof p||(re=Sr(re)),re?(re=re.rgb(),new vt(re.r,re.g,re.b,re.opacity)):new vt}function Ge(re,te,ke,nt){return arguments.length===1?St(re):new vt(re,te,ke,nt==null?1:nt)}function vt(re,te,ke,nt){this.r=+re,this.g=+te,this.b=+ke,this.opacity=+nt}X(vt,Ge,b(p,{brighter:function(te){return te=te==null?S:Math.pow(S,te),new vt(this.r*te,this.g*te,this.b*te,this.opacity)},darker:function(te){return te=te==null?H:Math.pow(H,te),new vt(this.r*te,this.g*te,this.b*te,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pe,formatHex:Pe,formatRgb:Te,toString:Te}));function Pe(){return"#"+ze(this.r)+ze(this.g)+ze(this.b)}function Te(){var re=this.opacity;return re=isNaN(re)?1:Math.max(0,Math.min(1,re)),(re===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(re===1?")":", "+re+")")}function ze(re){return re=Math.max(0,Math.min(255,Math.round(re)||0)),(re<16?"0":"")+re.toString(16)}function bt(re,te,ke,nt){return nt<=0?re=te=ke=NaN:ke<=0||ke>=1?re=te=NaN:te<=0&&(re=NaN),new Ee(re,te,ke,nt)}function cr(re){if(re instanceof Ee)return new Ee(re.h,re.s,re.l,re.opacity);if(re instanceof p||(re=Sr(re)),!re)return new Ee;if(re instanceof Ee)return re;re=re.rgb();var te=re.r/255,ke=re.g/255,nt=re.b/255,Kt=Math.min(te,ke,nt),Ir=Math.max(te,ke,nt),Lr=NaN,qr=Ir-Kt,tr=(Ir+Kt)/2;return qr?(te===Ir?Lr=(ke-nt)/qr+(ke<nt)*6:ke===Ir?Lr=(nt-te)/qr+2:Lr=(te-ke)/qr+4,qr/=tr<.5?Ir+Kt:2-Ir-Kt,Lr*=60):qr=tr>0&&tr<1?0:Lr,new Ee(Lr,qr,tr,re.opacity)}function ae(re,te,ke,nt){return arguments.length===1?cr(re):new Ee(re,te,ke,nt==null?1:nt)}function Ee(re,te,ke,nt){this.h=+re,this.s=+te,this.l=+ke,this.opacity=+nt}X(Ee,ae,b(p,{brighter:function(te){return te=te==null?S:Math.pow(S,te),new Ee(this.h,this.s,this.l*te,this.opacity)},darker:function(te){return te=te==null?H:Math.pow(H,te),new Ee(this.h,this.s,this.l*te,this.opacity)},rgb:function(){var te=this.h%360+(this.h<0)*360,ke=isNaN(te)||isNaN(this.s)?0:this.s,nt=this.l,Kt=nt+(nt<.5?nt:1-nt)*ke,Ir=2*nt-Kt;return new vt(le(te>=240?te-240:te+120,Ir,Kt),le(te,Ir,Kt),le(te<120?te+240:te-120,Ir,Kt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var te=this.opacity;return te=isNaN(te)?1:Math.max(0,Math.min(1,te)),(te===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(te===1?")":", "+te+")")}}));function le(re,te,ke){return(re<60?te+(ke-te)*re/60:re<180?ke:re<240?te+(ke-te)*(240-re)/60:te)*255}},61829:function(_t){"use strict";_t.exports=O,_t.exports.default=O;function O(ae,Ee,le){le=le||2;var re=Ee&&Ee.length,te=re?Ee[0]*le:ae.length,ke=_(ae,0,te,le,!0),nt=[];if(!ke||ke.next===ke.prev)return nt;var Kt,Ir,Lr,qr,tr,ce,ye;if(re&&(ke=ie(ae,Ee,ke,le)),ae.length>80*le){Kt=Lr=ae[0],Ir=qr=ae[1];for(var Re=le;Re<te;Re+=le)tr=ae[Re],ce=ae[Re+1],tr<Kt&&(Kt=tr),ce<Ir&&(Ir=ce),tr>Lr&&(Lr=tr),ce>qr&&(qr=ce);ye=Math.max(Lr-Kt,qr-Ir),ye=ye!==0?1/ye:0}return b(ke,nt,le,Kt,Ir,ye),nt}function _(ae,Ee,le,re,te){var ke,nt;if(te===cr(ae,Ee,le,re)>0)for(ke=Ee;ke<le;ke+=re)nt=Te(ke,ae[ke],ae[ke+1],nt);else for(ke=le-re;ke>=Ee;ke-=re)nt=Te(ke,ae[ke],ae[ke+1],nt);return nt&&ct(nt,nt.next)&&(ze(nt),nt=nt.next),nt}function X(ae,Ee){if(!ae)return ae;Ee||(Ee=ae);var le=ae,re;do if(re=!1,!le.steiner&&(ct(le,le.next)||xt(le.prev,le,le.next)===0)){if(ze(le),le=Ee=le.prev,le===le.next)break;re=!0}else le=le.next;while(re||le!==Ee);return Ee}function b(ae,Ee,le,re,te,ke,nt){if(!!ae){!nt&&ke&&Be(ae,re,te,ke);for(var Kt=ae,Ir,Lr;ae.prev!==ae.next;){if(Ir=ae.prev,Lr=ae.next,ke?H(ae,re,te,ke):p(ae)){Ee.push(Ir.i/le),Ee.push(ae.i/le),Ee.push(Lr.i/le),ze(ae),ae=Lr.next,Kt=Lr.next;continue}if(ae=Lr,ae===Kt){nt?nt===1?(ae=S(X(ae),Ee,le),b(ae,Ee,le,re,te,ke,2)):nt===2&&F(ae,Ee,le,re,te,ke):b(X(ae),Ee,le,re,te,ke,1);break}}}}function p(ae){var Ee=ae.prev,le=ae,re=ae.next;if(xt(Ee,le,re)>=0)return!1;for(var te=ae.next.next;te!==ae.prev;){if(Yt(Ee.x,Ee.y,le.x,le.y,re.x,re.y,te.x,te.y)&&xt(te.prev,te,te.next)>=0)return!1;te=te.next}return!0}function H(ae,Ee,le,re){var te=ae.prev,ke=ae,nt=ae.next;if(xt(te,ke,nt)>=0)return!1;for(var Kt=te.x<ke.x?te.x<nt.x?te.x:nt.x:ke.x<nt.x?ke.x:nt.x,Ir=te.y<ke.y?te.y<nt.y?te.y:nt.y:ke.y<nt.y?ke.y:nt.y,Lr=te.x>ke.x?te.x>nt.x?te.x:nt.x:ke.x>nt.x?ke.x:nt.x,qr=te.y>ke.y?te.y>nt.y?te.y:nt.y:ke.y>nt.y?ke.y:nt.y,tr=Ut(Kt,Ir,Ee,le,re),ce=Ut(Lr,qr,Ee,le,re),ye=ae.prevZ,Re=ae.nextZ;ye&&ye.z>=tr&&Re&&Re.z<=ce;){if(ye!==ae.prev&&ye!==ae.next&&Yt(te.x,te.y,ke.x,ke.y,nt.x,nt.y,ye.x,ye.y)&&xt(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,Re!==ae.prev&&Re!==ae.next&&Yt(te.x,te.y,ke.x,ke.y,nt.x,nt.y,Re.x,Re.y)&&xt(Re.prev,Re,Re.next)>=0))return!1;Re=Re.nextZ}for(;ye&&ye.z>=tr;){if(ye!==ae.prev&&ye!==ae.next&&Yt(te.x,te.y,ke.x,ke.y,nt.x,nt.y,ye.x,ye.y)&&xt(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;Re&&Re.z<=ce;){if(Re!==ae.prev&&Re!==ae.next&&Yt(te.x,te.y,ke.x,ke.y,nt.x,nt.y,Re.x,Re.y)&&xt(Re.prev,Re,Re.next)>=0)return!1;Re=Re.nextZ}return!0}function S(ae,Ee,le){var re=ae;do{var te=re.prev,ke=re.next.next;!ct(te,ke)&&Sr(te,re,re.next,ke)&&Ge(te,ke)&&Ge(ke,te)&&(Ee.push(te.i/le),Ee.push(re.i/le),Ee.push(ke.i/le),ze(re),ze(re.next),re=ae=ke),re=re.next}while(re!==ae);return X(re)}function F(ae,Ee,le,re,te,ke){var nt=ae;do{for(var Kt=nt.next.next;Kt!==nt.prev;){if(nt.i!==Kt.i&&lt(nt,Kt)){var Ir=Pe(nt,Kt);nt=X(nt,nt.next),Ir=X(Ir,Ir.next),b(nt,Ee,le,re,te,ke),b(Ir,Ee,le,re,te,ke);return}Kt=Kt.next}nt=nt.next}while(nt!==ae)}function ie(ae,Ee,le,re){var te=[],ke,nt,Kt,Ir,Lr;for(ke=0,nt=Ee.length;ke<nt;ke++)Kt=Ee[ke]*re,Ir=ke<nt-1?Ee[ke+1]*re:ae.length,Lr=_(ae,Kt,Ir,re,!1),Lr===Lr.next&&(Lr.steiner=!0),te.push(er(Lr));for(te.sort(fe),ke=0;ke<te.length;ke++)Q(te[ke],le),le=X(le,le.next);return le}function fe(ae,Ee){return ae.x-Ee.x}function Q(ae,Ee){if(Ee=we(ae,Ee),Ee){var le=Pe(Ee,ae);X(Ee,Ee.next),X(le,le.next)}}function we(ae,Ee){var le=Ee,re=ae.x,te=ae.y,ke=-Infinity,nt;do{if(te<=le.y&&te>=le.next.y&&le.next.y!==le.y){var Kt=le.x+(te-le.y)*(le.next.x-le.x)/(le.next.y-le.y);if(Kt<=re&&Kt>ke){if(ke=Kt,Kt===re){if(te===le.y)return le;if(te===le.next.y)return le.next}nt=le.x<le.next.x?le:le.next}}le=le.next}while(le!==Ee);if(!nt)return null;if(re===ke)return nt;var Ir=nt,Lr=nt.x,qr=nt.y,tr=Infinity,ce;le=nt;do re>=le.x&&le.x>=Lr&&re!==le.x&&Yt(te<qr?re:ke,te,Lr,qr,te<qr?ke:re,te,le.x,le.y)&&(ce=Math.abs(te-le.y)/(re-le.x),Ge(le,ae)&&(ce<tr||ce===tr&&(le.x>nt.x||le.x===nt.x&&Ie(nt,le)))&&(nt=le,tr=ce)),le=le.next;while(le!==Ir);return nt}function Ie(ae,Ee){return xt(ae.prev,ae,Ee.prev)<0&&xt(Ee.next,ae,ae.next)<0}function Be(ae,Ee,le,re){var te=ae;do te.z===null&&(te.z=Ut(te.x,te.y,Ee,le,re)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next;while(te!==ae);te.prevZ.nextZ=null,te.prevZ=null,Xe(te)}function Xe(ae){var Ee,le,re,te,ke,nt,Kt,Ir,Lr=1;do{for(le=ae,ae=null,ke=null,nt=0;le;){for(nt++,re=le,Kt=0,Ee=0;Ee<Lr&&(Kt++,re=re.nextZ,!!re);Ee++);for(Ir=Lr;Kt>0||Ir>0&&re;)Kt!==0&&(Ir===0||!re||le.z<=re.z)?(te=le,le=le.nextZ,Kt--):(te=re,re=re.nextZ,Ir--),ke?ke.nextZ=te:ae=te,te.prevZ=ke,ke=te;le=re}ke.nextZ=null,Lr*=2}while(nt>1);return ae}function Ut(ae,Ee,le,re,te){return ae=32767*(ae-le)*te,Ee=32767*(Ee-re)*te,ae=(ae|ae<<8)&16711935,ae=(ae|ae<<4)&252645135,ae=(ae|ae<<2)&858993459,ae=(ae|ae<<1)&1431655765,Ee=(Ee|Ee<<8)&16711935,Ee=(Ee|Ee<<4)&252645135,Ee=(Ee|Ee<<2)&858993459,Ee=(Ee|Ee<<1)&1431655765,ae|Ee<<1}function er(ae){var Ee=ae,le=ae;do(Ee.x<le.x||Ee.x===le.x&&Ee.y<le.y)&&(le=Ee),Ee=Ee.next;while(Ee!==ae);return le}function Yt(ae,Ee,le,re,te,ke,nt,Kt){return(te-nt)*(Ee-Kt)-(ae-nt)*(ke-Kt)>=0&&(ae-nt)*(re-Kt)-(le-nt)*(Ee-Kt)>=0&&(le-nt)*(ke-Kt)-(te-nt)*(re-Kt)>=0}function lt(ae,Ee){return ae.next.i!==Ee.i&&ae.prev.i!==Ee.i&&!St(ae,Ee)&&(Ge(ae,Ee)&&Ge(Ee,ae)&&vt(ae,Ee)&&(xt(ae.prev,ae,Ee.prev)||xt(ae,Ee.prev,Ee))||ct(ae,Ee)&&xt(ae.prev,ae,ae.next)>0&&xt(Ee.prev,Ee,Ee.next)>0)}function xt(ae,Ee,le){return(Ee.y-ae.y)*(le.x-Ee.x)-(Ee.x-ae.x)*(le.y-Ee.y)}function ct(ae,Ee){return ae.x===Ee.x&&ae.y===Ee.y}function Sr(ae,Ee,le,re){var te=Ht(xt(ae,Ee,le)),ke=Ht(xt(ae,Ee,re)),nt=Ht(xt(le,re,ae)),Kt=Ht(xt(le,re,Ee));return!!(te!==ke&&nt!==Kt||te===0&&Ft(ae,le,Ee)||ke===0&&Ft(ae,re,Ee)||nt===0&&Ft(le,ae,re)||Kt===0&&Ft(le,Ee,re))}function Ft(ae,Ee,le){return Ee.x<=Math.max(ae.x,le.x)&&Ee.x>=Math.min(ae.x,le.x)&&Ee.y<=Math.max(ae.y,le.y)&&Ee.y>=Math.min(ae.y,le.y)}function Ht(ae){return ae>0?1:ae<0?-1:0}function St(ae,Ee){var le=ae;do{if(le.i!==ae.i&&le.next.i!==ae.i&&le.i!==Ee.i&&le.next.i!==Ee.i&&Sr(le,le.next,ae,Ee))return!0;le=le.next}while(le!==ae);return!1}function Ge(ae,Ee){return xt(ae.prev,ae,ae.next)<0?xt(ae,Ee,ae.next)>=0&&xt(ae,ae.prev,Ee)>=0:xt(ae,Ee,ae.prev)<0||xt(ae,ae.next,Ee)<0}function vt(ae,Ee){var le=ae,re=!1,te=(ae.x+Ee.x)/2,ke=(ae.y+Ee.y)/2;do le.y>ke!=le.next.y>ke&&le.next.y!==le.y&&te<(le.next.x-le.x)*(ke-le.y)/(le.next.y-le.y)+le.x&&(re=!re),le=le.next;while(le!==ae);return re}function Pe(ae,Ee){var le=new bt(ae.i,ae.x,ae.y),re=new bt(Ee.i,Ee.x,Ee.y),te=ae.next,ke=Ee.prev;return ae.next=Ee,Ee.prev=ae,le.next=te,te.prev=le,re.next=le,le.prev=re,ke.next=re,re.prev=ke,re}function Te(ae,Ee,le,re){var te=new bt(ae,Ee,le);return re?(te.next=re.next,te.prev=re,re.next.prev=te,re.next=te):(te.prev=te,te.next=te),te}function ze(ae){ae.next.prev=ae.prev,ae.prev.next=ae.next,ae.prevZ&&(ae.prevZ.nextZ=ae.nextZ),ae.nextZ&&(ae.nextZ.prevZ=ae.prevZ)}function bt(ae,Ee,le){this.i=ae,this.x=Ee,this.y=le,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}O.deviation=function(ae,Ee,le,re){var te=Ee&&Ee.length,ke=te?Ee[0]*le:ae.length,nt=Math.abs(cr(ae,0,ke,le));if(te)for(var Kt=0,Ir=Ee.length;Kt<Ir;Kt++){var Lr=Ee[Kt]*le,qr=Kt<Ir-1?Ee[Kt+1]*le:ae.length;nt-=Math.abs(cr(ae,Lr,qr,le))}var tr=0;for(Kt=0;Kt<re.length;Kt+=3){var ce=re[Kt]*le,ye=re[Kt+1]*le,Re=re[Kt+2]*le;tr+=Math.abs((ae[ce]-ae[Re])*(ae[ye+1]-ae[ce+1])-(ae[ce]-ae[ye])*(ae[Re+1]-ae[ce+1]))}return nt===0&&tr===0?0:Math.abs((tr-nt)/nt)};function cr(ae,Ee,le,re){for(var te=0,ke=Ee,nt=le-re;ke<le;ke+=re)te+=(ae[nt]-ae[ke])*(ae[ke+1]+ae[nt+1]),nt=ke;return te}O.flatten=function(ae){for(var Ee=ae[0][0].length,le={vertices:[],holes:[],dimensions:Ee},re=0,te=0;te<ae.length;te++){for(var ke=0;ke<ae[te].length;ke++)for(var nt=0;nt<Ee;nt++)le.vertices.push(ae[te][ke][nt]);te>0&&(re+=ae[te-1].length,le.holes.push(re))}return le}},33488:function(_t){function O(X){var b=X.target||X.srcElement;b.__resizeRAF__&&cancelAnimationFrame(b.__resizeRAF__),b.__resizeRAF__=requestAnimationFrame(function(){var p=b.__resizeTrigger__,H=p&&p.__resizeListeners__;H&&H.forEach(function(S){S.call(p,X)})})}var _=function(b,p){var H=this,S=H.document,F,ie=S.attachEvent;typeof navigator!="undefined"&&(F=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function fe(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",O)}if(!b.__resizeListeners__)if(b.__resizeListeners__=[],ie)b.__resizeTrigger__=b,b.attachEvent("onresize",O);else{getComputedStyle(b).position==="static"&&(b.style.position="relative");var Q=b.__resizeTrigger__=S.createElement("object");Q.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),Q.setAttribute("class","resize-sensor"),Q.setAttribute("tabindex","-1"),Q.setAttribute("title",""),Q.__resizeElement__=b,Q.onload=fe,Q.type="text/html",F&&b.appendChild(Q),Q.data="about:blank",F||b.appendChild(Q)}b.__resizeListeners__.push(p)};_t.exports=typeof window=="undefined"?_:_.bind(window),_t.exports.unbind=function(X,b){var p=document.attachEvent,H=X.__resizeListeners__||[];if(b){var S=H.indexOf(b);S!==-1&&H.splice(S,1)}else H=X.__resizeListeners__=[];if(!H.length){if(p)X.detachEvent("onresize",O);else if(X.__resizeTrigger__){var F=X.__resizeTrigger__.contentDocument,ie=F&&F.defaultView;ie&&(ie.removeEventListener("resize",O),delete ie.__resizeTrigger__),X.__resizeTrigger__=!X.removeChild(X.__resizeTrigger__)}delete X.__resizeListeners__}}},60121:function(_t){"use strict";var O=Object.prototype.hasOwnProperty,_="~";function X(){}Object.create&&(X.prototype=Object.create(null),new X().__proto__||(_=!1));function b(F,ie,fe){this.fn=F,this.context=ie,this.once=fe||!1}function p(F,ie,fe,Q,we){if(typeof fe!="function")throw new TypeError("The listener must be a function");var Ie=new b(fe,Q||F,we),Be=_?_+ie:ie;return F._events[Be]?F._events[Be].fn?F._events[Be]=[F._events[Be],Ie]:F._events[Be].push(Ie):(F._events[Be]=Ie,F._eventsCount++),F}function H(F,ie){--F._eventsCount==0?F._events=new X:delete F._events[ie]}function S(){this._events=new X,this._eventsCount=0}S.prototype.eventNames=function(){var ie=[],fe,Q;if(this._eventsCount===0)return ie;for(Q in fe=this._events)O.call(fe,Q)&&ie.push(_?Q.slice(1):Q);return Object.getOwnPropertySymbols?ie.concat(Object.getOwnPropertySymbols(fe)):ie},S.prototype.listeners=function(ie){var fe=_?_+ie:ie,Q=this._events[fe];if(!Q)return[];if(Q.fn)return[Q.fn];for(var we=0,Ie=Q.length,Be=new Array(Ie);we<Ie;we++)Be[we]=Q[we].fn;return Be},S.prototype.listenerCount=function(ie){var fe=_?_+ie:ie,Q=this._events[fe];return Q?Q.fn?1:Q.length:0},S.prototype.emit=function(ie,fe,Q,we,Ie,Be){var Xe=_?_+ie:ie;if(!this._events[Xe])return!1;var Ut=this._events[Xe],er=arguments.length,Yt,lt;if(Ut.fn){switch(Ut.once&&this.removeListener(ie,Ut.fn,void 0,!0),er){case 1:return Ut.fn.call(Ut.context),!0;case 2:return Ut.fn.call(Ut.context,fe),!0;case 3:return Ut.fn.call(Ut.context,fe,Q),!0;case 4:return Ut.fn.call(Ut.context,fe,Q,we),!0;case 5:return Ut.fn.call(Ut.context,fe,Q,we,Ie),!0;case 6:return Ut.fn.call(Ut.context,fe,Q,we,Ie,Be),!0}for(lt=1,Yt=new Array(er-1);lt<er;lt++)Yt[lt-1]=arguments[lt];Ut.fn.apply(Ut.context,Yt)}else{var xt=Ut.length,ct;for(lt=0;lt<xt;lt++)switch(Ut[lt].once&&this.removeListener(ie,Ut[lt].fn,void 0,!0),er){case 1:Ut[lt].fn.call(Ut[lt].context);break;case 2:Ut[lt].fn.call(Ut[lt].context,fe);break;case 3:Ut[lt].fn.call(Ut[lt].context,fe,Q);break;case 4:Ut[lt].fn.call(Ut[lt].context,fe,Q,we);break;default:if(!Yt)for(ct=1,Yt=new Array(er-1);ct<er;ct++)Yt[ct-1]=arguments[ct];Ut[lt].fn.apply(Ut[lt].context,Yt)}}return!0},S.prototype.on=function(ie,fe,Q){return p(this,ie,fe,Q,!1)},S.prototype.once=function(ie,fe,Q){return p(this,ie,fe,Q,!0)},S.prototype.removeListener=function(ie,fe,Q,we){var Ie=_?_+ie:ie;if(!this._events[Ie])return this;if(!fe)return H(this,Ie),this;var Be=this._events[Ie];if(Be.fn)Be.fn===fe&&(!we||Be.once)&&(!Q||Be.context===Q)&&H(this,Ie);else{for(var Xe=0,Ut=[],er=Be.length;Xe<er;Xe++)(Be[Xe].fn!==fe||we&&!Be[Xe].once||Q&&Be[Xe].context!==Q)&&Ut.push(Be[Xe]);Ut.length?this._events[Ie]=Ut.length===1?Ut[0]:Ut:H(this,Ie)}return this},S.prototype.removeAllListeners=function(ie){var fe;return ie?(fe=_?_+ie:ie,this._events[fe]&&H(this,fe)):(this._events=new X,this._eventsCount=0),this},S.prototype.off=S.prototype.removeListener,S.prototype.addListener=S.prototype.on,S.prefixed=_,S.EventEmitter=S,_t.exports=S},90208:function(_t,O,_){"use strict";_.d(O,{Ib:function(){return X},WT:function(){return b},FD:function(){return p}});var X=1e-6,b=typeof Float32Array!="undefined"?Float32Array:Array,p=Math.random;function H(fe){b=fe}var S=Math.PI/180;function F(fe){return fe*S}function ie(fe,Q){return Math.abs(fe-Q)<=X*Math.max(1,Math.abs(fe),Math.abs(Q))}Math.hypot||(Math.hypot=function(){for(var fe=0,Q=arguments.length;Q--;)fe+=arguments[Q]*arguments[Q];return Math.sqrt(fe)})},98604:function(_t,O,_){"use strict";_.r(O),_.d(O,{create:function(){return b},clone:function(){return p},copy:function(){return H},fromValues:function(){return S},set:function(){return F},identity:function(){return ie},transpose:function(){return fe},invert:function(){return Q},adjoint:function(){return we},determinant:function(){return Ie},multiply:function(){return Be},translate:function(){return Xe},scale:function(){return Ut},rotate:function(){return er},rotateX:function(){return Yt},rotateY:function(){return lt},rotateZ:function(){return xt},fromTranslation:function(){return ct},fromScaling:function(){return Sr},fromRotation:function(){return Ft},fromXRotation:function(){return Ht},fromYRotation:function(){return St},fromZRotation:function(){return Ge},fromRotationTranslation:function(){return vt},fromQuat2:function(){return Pe},getTranslation:function(){return Te},getScaling:function(){return ze},getRotation:function(){return bt},fromRotationTranslationScale:function(){return cr},fromRotationTranslationScaleOrigin:function(){return ae},fromQuat:function(){return Ee},frustum:function(){return le},perspective:function(){return re},perspectiveFromFieldOfView:function(){return te},ortho:function(){return ke},lookAt:function(){return nt},targetTo:function(){return Kt},str:function(){return Ir},frob:function(){return Lr},add:function(){return qr},subtract:function(){return tr},multiplyScalar:function(){return ce},multiplyScalarAndAdd:function(){return ye},exactEquals:function(){return Re},equals:function(){return Qe},mul:function(){return Dt},sub:function(){return Ct}});var X=_(90208);function b(){var A=new X.WT(16);return X.WT!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=0,A[12]=0,A[13]=0,A[14]=0),A[0]=1,A[5]=1,A[10]=1,A[15]=1,A}function p(A){var z=new X.WT(16);return z[0]=A[0],z[1]=A[1],z[2]=A[2],z[3]=A[3],z[4]=A[4],z[5]=A[5],z[6]=A[6],z[7]=A[7],z[8]=A[8],z[9]=A[9],z[10]=A[10],z[11]=A[11],z[12]=A[12],z[13]=A[13],z[14]=A[14],z[15]=A[15],z}function H(A,z){return A[0]=z[0],A[1]=z[1],A[2]=z[2],A[3]=z[3],A[4]=z[4],A[5]=z[5],A[6]=z[6],A[7]=z[7],A[8]=z[8],A[9]=z[9],A[10]=z[10],A[11]=z[11],A[12]=z[12],A[13]=z[13],A[14]=z[14],A[15]=z[15],A}function S(A,z,ve,Ce,$e,ot,Ot,G,Et,Bt,dr,wr,Tr,Or,qe,yt){var dt=new X.WT(16);return dt[0]=A,dt[1]=z,dt[2]=ve,dt[3]=Ce,dt[4]=$e,dt[5]=ot,dt[6]=Ot,dt[7]=G,dt[8]=Et,dt[9]=Bt,dt[10]=dr,dt[11]=wr,dt[12]=Tr,dt[13]=Or,dt[14]=qe,dt[15]=yt,dt}function F(A,z,ve,Ce,$e,ot,Ot,G,Et,Bt,dr,wr,Tr,Or,qe,yt,dt){return A[0]=z,A[1]=ve,A[2]=Ce,A[3]=$e,A[4]=ot,A[5]=Ot,A[6]=G,A[7]=Et,A[8]=Bt,A[9]=dr,A[10]=wr,A[11]=Tr,A[12]=Or,A[13]=qe,A[14]=yt,A[15]=dt,A}function ie(A){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function fe(A,z){if(A===z){var ve=z[1],Ce=z[2],$e=z[3],ot=z[6],Ot=z[7],G=z[11];A[1]=z[4],A[2]=z[8],A[3]=z[12],A[4]=ve,A[6]=z[9],A[7]=z[13],A[8]=Ce,A[9]=ot,A[11]=z[14],A[12]=$e,A[13]=Ot,A[14]=G}else A[0]=z[0],A[1]=z[4],A[2]=z[8],A[3]=z[12],A[4]=z[1],A[5]=z[5],A[6]=z[9],A[7]=z[13],A[8]=z[2],A[9]=z[6],A[10]=z[10],A[11]=z[14],A[12]=z[3],A[13]=z[7],A[14]=z[11],A[15]=z[15];return A}function Q(A,z){var ve=z[0],Ce=z[1],$e=z[2],ot=z[3],Ot=z[4],G=z[5],Et=z[6],Bt=z[7],dr=z[8],wr=z[9],Tr=z[10],Or=z[11],qe=z[12],yt=z[13],dt=z[14],lr=z[15],Kr=ve*G-Ce*Ot,gt=ve*Et-$e*Ot,Rt=ve*Bt-ot*Ot,sr=Ce*Et-$e*G,ar=Ce*Bt-ot*G,_n=$e*Bt-ot*Et,xn=dr*yt-wr*qe,ci=dr*dt-Tr*qe,_i=dr*lr-Or*qe,Ui=wr*dt-Tr*yt,Xi=wr*lr-Or*yt,oi=Tr*lr-Or*dt,K=Kr*oi-gt*Xi+Rt*Ui+sr*_i-ar*ci+_n*xn;return K?(K=1/K,A[0]=(G*oi-Et*Xi+Bt*Ui)*K,A[1]=($e*Xi-Ce*oi-ot*Ui)*K,A[2]=(yt*_n-dt*ar+lr*sr)*K,A[3]=(Tr*ar-wr*_n-Or*sr)*K,A[4]=(Et*_i-Ot*oi-Bt*ci)*K,A[5]=(ve*oi-$e*_i+ot*ci)*K,A[6]=(dt*Rt-qe*_n-lr*gt)*K,A[7]=(dr*_n-Tr*Rt+Or*gt)*K,A[8]=(Ot*Xi-G*_i+Bt*xn)*K,A[9]=(Ce*_i-ve*Xi-ot*xn)*K,A[10]=(qe*ar-yt*Rt+lr*Kr)*K,A[11]=(wr*Rt-dr*ar-Or*Kr)*K,A[12]=(G*ci-Ot*Ui-Et*xn)*K,A[13]=(ve*Ui-Ce*ci+$e*xn)*K,A[14]=(yt*gt-qe*sr-dt*Kr)*K,A[15]=(dr*sr-wr*gt+Tr*Kr)*K,A):null}function we(A,z){var ve=z[0],Ce=z[1],$e=z[2],ot=z[3],Ot=z[4],G=z[5],Et=z[6],Bt=z[7],dr=z[8],wr=z[9],Tr=z[10],Or=z[11],qe=z[12],yt=z[13],dt=z[14],lr=z[15];return A[0]=G*(Tr*lr-Or*dt)-wr*(Et*lr-Bt*dt)+yt*(Et*Or-Bt*Tr),A[1]=-(Ce*(Tr*lr-Or*dt)-wr*($e*lr-ot*dt)+yt*($e*Or-ot*Tr)),A[2]=Ce*(Et*lr-Bt*dt)-G*($e*lr-ot*dt)+yt*($e*Bt-ot*Et),A[3]=-(Ce*(Et*Or-Bt*Tr)-G*($e*Or-ot*Tr)+wr*($e*Bt-ot*Et)),A[4]=-(Ot*(Tr*lr-Or*dt)-dr*(Et*lr-Bt*dt)+qe*(Et*Or-Bt*Tr)),A[5]=ve*(Tr*lr-Or*dt)-dr*($e*lr-ot*dt)+qe*($e*Or-ot*Tr),A[6]=-(ve*(Et*lr-Bt*dt)-Ot*($e*lr-ot*dt)+qe*($e*Bt-ot*Et)),A[7]=ve*(Et*Or-Bt*Tr)-Ot*($e*Or-ot*Tr)+dr*($e*Bt-ot*Et),A[8]=Ot*(wr*lr-Or*yt)-dr*(G*lr-Bt*yt)+qe*(G*Or-Bt*wr),A[9]=-(ve*(wr*lr-Or*yt)-dr*(Ce*lr-ot*yt)+qe*(Ce*Or-ot*wr)),A[10]=ve*(G*lr-Bt*yt)-Ot*(Ce*lr-ot*yt)+qe*(Ce*Bt-ot*G),A[11]=-(ve*(G*Or-Bt*wr)-Ot*(Ce*Or-ot*wr)+dr*(Ce*Bt-ot*G)),A[12]=-(Ot*(wr*dt-Tr*yt)-dr*(G*dt-Et*yt)+qe*(G*Tr-Et*wr)),A[13]=ve*(wr*dt-Tr*yt)-dr*(Ce*dt-$e*yt)+qe*(Ce*Tr-$e*wr),A[14]=-(ve*(G*dt-Et*yt)-Ot*(Ce*dt-$e*yt)+qe*(Ce*Et-$e*G)),A[15]=ve*(G*Tr-Et*wr)-Ot*(Ce*Tr-$e*wr)+dr*(Ce*Et-$e*G),A}function Ie(A){var z=A[0],ve=A[1],Ce=A[2],$e=A[3],ot=A[4],Ot=A[5],G=A[6],Et=A[7],Bt=A[8],dr=A[9],wr=A[10],Tr=A[11],Or=A[12],qe=A[13],yt=A[14],dt=A[15],lr=z*Ot-ve*ot,Kr=z*G-Ce*ot,gt=z*Et-$e*ot,Rt=ve*G-Ce*Ot,sr=ve*Et-$e*Ot,ar=Ce*Et-$e*G,_n=Bt*qe-dr*Or,xn=Bt*yt-wr*Or,ci=Bt*dt-Tr*Or,_i=dr*yt-wr*qe,Ui=dr*dt-Tr*qe,Xi=wr*dt-Tr*yt;return lr*Xi-Kr*Ui+gt*_i+Rt*ci-sr*xn+ar*_n}function Be(A,z,ve){var Ce=z[0],$e=z[1],ot=z[2],Ot=z[3],G=z[4],Et=z[5],Bt=z[6],dr=z[7],wr=z[8],Tr=z[9],Or=z[10],qe=z[11],yt=z[12],dt=z[13],lr=z[14],Kr=z[15],gt=ve[0],Rt=ve[1],sr=ve[2],ar=ve[3];return A[0]=gt*Ce+Rt*G+sr*wr+ar*yt,A[1]=gt*$e+Rt*Et+sr*Tr+ar*dt,A[2]=gt*ot+Rt*Bt+sr*Or+ar*lr,A[3]=gt*Ot+Rt*dr+sr*qe+ar*Kr,gt=ve[4],Rt=ve[5],sr=ve[6],ar=ve[7],A[4]=gt*Ce+Rt*G+sr*wr+ar*yt,A[5]=gt*$e+Rt*Et+sr*Tr+ar*dt,A[6]=gt*ot+Rt*Bt+sr*Or+ar*lr,A[7]=gt*Ot+Rt*dr+sr*qe+ar*Kr,gt=ve[8],Rt=ve[9],sr=ve[10],ar=ve[11],A[8]=gt*Ce+Rt*G+sr*wr+ar*yt,A[9]=gt*$e+Rt*Et+sr*Tr+ar*dt,A[10]=gt*ot+Rt*Bt+sr*Or+ar*lr,A[11]=gt*Ot+Rt*dr+sr*qe+ar*Kr,gt=ve[12],Rt=ve[13],sr=ve[14],ar=ve[15],A[12]=gt*Ce+Rt*G+sr*wr+ar*yt,A[13]=gt*$e+Rt*Et+sr*Tr+ar*dt,A[14]=gt*ot+Rt*Bt+sr*Or+ar*lr,A[15]=gt*Ot+Rt*dr+sr*qe+ar*Kr,A}function Xe(A,z,ve){var Ce=ve[0],$e=ve[1],ot=ve[2],Ot,G,Et,Bt,dr,wr,Tr,Or,qe,yt,dt,lr;return z===A?(A[12]=z[0]*Ce+z[4]*$e+z[8]*ot+z[12],A[13]=z[1]*Ce+z[5]*$e+z[9]*ot+z[13],A[14]=z[2]*Ce+z[6]*$e+z[10]*ot+z[14],A[15]=z[3]*Ce+z[7]*$e+z[11]*ot+z[15]):(Ot=z[0],G=z[1],Et=z[2],Bt=z[3],dr=z[4],wr=z[5],Tr=z[6],Or=z[7],qe=z[8],yt=z[9],dt=z[10],lr=z[11],A[0]=Ot,A[1]=G,A[2]=Et,A[3]=Bt,A[4]=dr,A[5]=wr,A[6]=Tr,A[7]=Or,A[8]=qe,A[9]=yt,A[10]=dt,A[11]=lr,A[12]=Ot*Ce+dr*$e+qe*ot+z[12],A[13]=G*Ce+wr*$e+yt*ot+z[13],A[14]=Et*Ce+Tr*$e+dt*ot+z[14],A[15]=Bt*Ce+Or*$e+lr*ot+z[15]),A}function Ut(A,z,ve){var Ce=ve[0],$e=ve[1],ot=ve[2];return A[0]=z[0]*Ce,A[1]=z[1]*Ce,A[2]=z[2]*Ce,A[3]=z[3]*Ce,A[4]=z[4]*$e,A[5]=z[5]*$e,A[6]=z[6]*$e,A[7]=z[7]*$e,A[8]=z[8]*ot,A[9]=z[9]*ot,A[10]=z[10]*ot,A[11]=z[11]*ot,A[12]=z[12],A[13]=z[13],A[14]=z[14],A[15]=z[15],A}function er(A,z,ve,Ce){var $e=Ce[0],ot=Ce[1],Ot=Ce[2],G=Math.hypot($e,ot,Ot),Et,Bt,dr,wr,Tr,Or,qe,yt,dt,lr,Kr,gt,Rt,sr,ar,_n,xn,ci,_i,Ui,Xi,oi,K,I;return G<X.Ib?null:(G=1/G,$e*=G,ot*=G,Ot*=G,Et=Math.sin(ve),Bt=Math.cos(ve),dr=1-Bt,wr=z[0],Tr=z[1],Or=z[2],qe=z[3],yt=z[4],dt=z[5],lr=z[6],Kr=z[7],gt=z[8],Rt=z[9],sr=z[10],ar=z[11],_n=$e*$e*dr+Bt,xn=ot*$e*dr+Ot*Et,ci=Ot*$e*dr-ot*Et,_i=$e*ot*dr-Ot*Et,Ui=ot*ot*dr+Bt,Xi=Ot*ot*dr+$e*Et,oi=$e*Ot*dr+ot*Et,K=ot*Ot*dr-$e*Et,I=Ot*Ot*dr+Bt,A[0]=wr*_n+yt*xn+gt*ci,A[1]=Tr*_n+dt*xn+Rt*ci,A[2]=Or*_n+lr*xn+sr*ci,A[3]=qe*_n+Kr*xn+ar*ci,A[4]=wr*_i+yt*Ui+gt*Xi,A[5]=Tr*_i+dt*Ui+Rt*Xi,A[6]=Or*_i+lr*Ui+sr*Xi,A[7]=qe*_i+Kr*Ui+ar*Xi,A[8]=wr*oi+yt*K+gt*I,A[9]=Tr*oi+dt*K+Rt*I,A[10]=Or*oi+lr*K+sr*I,A[11]=qe*oi+Kr*K+ar*I,z!==A&&(A[12]=z[12],A[13]=z[13],A[14]=z[14],A[15]=z[15]),A)}function Yt(A,z,ve){var Ce=Math.sin(ve),$e=Math.cos(ve),ot=z[4],Ot=z[5],G=z[6],Et=z[7],Bt=z[8],dr=z[9],wr=z[10],Tr=z[11];return z!==A&&(A[0]=z[0],A[1]=z[1],A[2]=z[2],A[3]=z[3],A[12]=z[12],A[13]=z[13],A[14]=z[14],A[15]=z[15]),A[4]=ot*$e+Bt*Ce,A[5]=Ot*$e+dr*Ce,A[6]=G*$e+wr*Ce,A[7]=Et*$e+Tr*Ce,A[8]=Bt*$e-ot*Ce,A[9]=dr*$e-Ot*Ce,A[10]=wr*$e-G*Ce,A[11]=Tr*$e-Et*Ce,A}function lt(A,z,ve){var Ce=Math.sin(ve),$e=Math.cos(ve),ot=z[0],Ot=z[1],G=z[2],Et=z[3],Bt=z[8],dr=z[9],wr=z[10],Tr=z[11];return z!==A&&(A[4]=z[4],A[5]=z[5],A[6]=z[6],A[7]=z[7],A[12]=z[12],A[13]=z[13],A[14]=z[14],A[15]=z[15]),A[0]=ot*$e-Bt*Ce,A[1]=Ot*$e-dr*Ce,A[2]=G*$e-wr*Ce,A[3]=Et*$e-Tr*Ce,A[8]=ot*Ce+Bt*$e,A[9]=Ot*Ce+dr*$e,A[10]=G*Ce+wr*$e,A[11]=Et*Ce+Tr*$e,A}function xt(A,z,ve){var Ce=Math.sin(ve),$e=Math.cos(ve),ot=z[0],Ot=z[1],G=z[2],Et=z[3],Bt=z[4],dr=z[5],wr=z[6],Tr=z[7];return z!==A&&(A[8]=z[8],A[9]=z[9],A[10]=z[10],A[11]=z[11],A[12]=z[12],A[13]=z[13],A[14]=z[14],A[15]=z[15]),A[0]=ot*$e+Bt*Ce,A[1]=Ot*$e+dr*Ce,A[2]=G*$e+wr*Ce,A[3]=Et*$e+Tr*Ce,A[4]=Bt*$e-ot*Ce,A[5]=dr*$e-Ot*Ce,A[6]=wr*$e-G*Ce,A[7]=Tr*$e-Et*Ce,A}function ct(A,z){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=z[0],A[13]=z[1],A[14]=z[2],A[15]=1,A}function Sr(A,z){return A[0]=z[0],A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=z[1],A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=z[2],A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function Ft(A,z,ve){var Ce=ve[0],$e=ve[1],ot=ve[2],Ot=Math.hypot(Ce,$e,ot),G,Et,Bt;return Ot<X.Ib?null:(Ot=1/Ot,Ce*=Ot,$e*=Ot,ot*=Ot,G=Math.sin(z),Et=Math.cos(z),Bt=1-Et,A[0]=Ce*Ce*Bt+Et,A[1]=$e*Ce*Bt+ot*G,A[2]=ot*Ce*Bt-$e*G,A[3]=0,A[4]=Ce*$e*Bt-ot*G,A[5]=$e*$e*Bt+Et,A[6]=ot*$e*Bt+Ce*G,A[7]=0,A[8]=Ce*ot*Bt+$e*G,A[9]=$e*ot*Bt-Ce*G,A[10]=ot*ot*Bt+Et,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A)}function Ht(A,z){var ve=Math.sin(z),Ce=Math.cos(z);return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=Ce,A[6]=ve,A[7]=0,A[8]=0,A[9]=-ve,A[10]=Ce,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function St(A,z){var ve=Math.sin(z),Ce=Math.cos(z);return A[0]=Ce,A[1]=0,A[2]=-ve,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=ve,A[9]=0,A[10]=Ce,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function Ge(A,z){var ve=Math.sin(z),Ce=Math.cos(z);return A[0]=Ce,A[1]=ve,A[2]=0,A[3]=0,A[4]=-ve,A[5]=Ce,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function vt(A,z,ve){var Ce=z[0],$e=z[1],ot=z[2],Ot=z[3],G=Ce+Ce,Et=$e+$e,Bt=ot+ot,dr=Ce*G,wr=Ce*Et,Tr=Ce*Bt,Or=$e*Et,qe=$e*Bt,yt=ot*Bt,dt=Ot*G,lr=Ot*Et,Kr=Ot*Bt;return A[0]=1-(Or+yt),A[1]=wr+Kr,A[2]=Tr-lr,A[3]=0,A[4]=wr-Kr,A[5]=1-(dr+yt),A[6]=qe+dt,A[7]=0,A[8]=Tr+lr,A[9]=qe-dt,A[10]=1-(dr+Or),A[11]=0,A[12]=ve[0],A[13]=ve[1],A[14]=ve[2],A[15]=1,A}function Pe(A,z){var ve=new X.WT(3),Ce=-z[0],$e=-z[1],ot=-z[2],Ot=z[3],G=z[4],Et=z[5],Bt=z[6],dr=z[7],wr=Ce*Ce+$e*$e+ot*ot+Ot*Ot;return wr>0?(ve[0]=(G*Ot+dr*Ce+Et*ot-Bt*$e)*2/wr,ve[1]=(Et*Ot+dr*$e+Bt*Ce-G*ot)*2/wr,ve[2]=(Bt*Ot+dr*ot+G*$e-Et*Ce)*2/wr):(ve[0]=(G*Ot+dr*Ce+Et*ot-Bt*$e)*2,ve[1]=(Et*Ot+dr*$e+Bt*Ce-G*ot)*2,ve[2]=(Bt*Ot+dr*ot+G*$e-Et*Ce)*2),vt(A,z,ve),A}function Te(A,z){return A[0]=z[12],A[1]=z[13],A[2]=z[14],A}function ze(A,z){var ve=z[0],Ce=z[1],$e=z[2],ot=z[4],Ot=z[5],G=z[6],Et=z[8],Bt=z[9],dr=z[10];return A[0]=Math.hypot(ve,Ce,$e),A[1]=Math.hypot(ot,Ot,G),A[2]=Math.hypot(Et,Bt,dr),A}function bt(A,z){var ve=new X.WT(3);ze(ve,z);var Ce=1/ve[0],$e=1/ve[1],ot=1/ve[2],Ot=z[0]*Ce,G=z[1]*$e,Et=z[2]*ot,Bt=z[4]*Ce,dr=z[5]*$e,wr=z[6]*ot,Tr=z[8]*Ce,Or=z[9]*$e,qe=z[10]*ot,yt=Ot+dr+qe,dt=0;return yt>0?(dt=Math.sqrt(yt+1)*2,A[3]=.25*dt,A[0]=(wr-Or)/dt,A[1]=(Tr-Et)/dt,A[2]=(G-Bt)/dt):Ot>dr&&Ot>qe?(dt=Math.sqrt(1+Ot-dr-qe)*2,A[3]=(wr-Or)/dt,A[0]=.25*dt,A[1]=(G+Bt)/dt,A[2]=(Tr+Et)/dt):dr>qe?(dt=Math.sqrt(1+dr-Ot-qe)*2,A[3]=(Tr-Et)/dt,A[0]=(G+Bt)/dt,A[1]=.25*dt,A[2]=(wr+Or)/dt):(dt=Math.sqrt(1+qe-Ot-dr)*2,A[3]=(G-Bt)/dt,A[0]=(Tr+Et)/dt,A[1]=(wr+Or)/dt,A[2]=.25*dt),A}function cr(A,z,ve,Ce){var $e=z[0],ot=z[1],Ot=z[2],G=z[3],Et=$e+$e,Bt=ot+ot,dr=Ot+Ot,wr=$e*Et,Tr=$e*Bt,Or=$e*dr,qe=ot*Bt,yt=ot*dr,dt=Ot*dr,lr=G*Et,Kr=G*Bt,gt=G*dr,Rt=Ce[0],sr=Ce[1],ar=Ce[2];return A[0]=(1-(qe+dt))*Rt,A[1]=(Tr+gt)*Rt,A[2]=(Or-Kr)*Rt,A[3]=0,A[4]=(Tr-gt)*sr,A[5]=(1-(wr+dt))*sr,A[6]=(yt+lr)*sr,A[7]=0,A[8]=(Or+Kr)*ar,A[9]=(yt-lr)*ar,A[10]=(1-(wr+qe))*ar,A[11]=0,A[12]=ve[0],A[13]=ve[1],A[14]=ve[2],A[15]=1,A}function ae(A,z,ve,Ce,$e){var ot=z[0],Ot=z[1],G=z[2],Et=z[3],Bt=ot+ot,dr=Ot+Ot,wr=G+G,Tr=ot*Bt,Or=ot*dr,qe=ot*wr,yt=Ot*dr,dt=Ot*wr,lr=G*wr,Kr=Et*Bt,gt=Et*dr,Rt=Et*wr,sr=Ce[0],ar=Ce[1],_n=Ce[2],xn=$e[0],ci=$e[1],_i=$e[2],Ui=(1-(yt+lr))*sr,Xi=(Or+Rt)*sr,oi=(qe-gt)*sr,K=(Or-Rt)*ar,I=(1-(Tr+lr))*ar,j=(dt+Kr)*ar,Y=(qe+gt)*_n,ue=(dt-Kr)*_n,Le=(1-(Tr+yt))*_n;return A[0]=Ui,A[1]=Xi,A[2]=oi,A[3]=0,A[4]=K,A[5]=I,A[6]=j,A[7]=0,A[8]=Y,A[9]=ue,A[10]=Le,A[11]=0,A[12]=ve[0]+xn-(Ui*xn+K*ci+Y*_i),A[13]=ve[1]+ci-(Xi*xn+I*ci+ue*_i),A[14]=ve[2]+_i-(oi*xn+j*ci+Le*_i),A[15]=1,A}function Ee(A,z){var ve=z[0],Ce=z[1],$e=z[2],ot=z[3],Ot=ve+ve,G=Ce+Ce,Et=$e+$e,Bt=ve*Ot,dr=Ce*Ot,wr=Ce*G,Tr=$e*Ot,Or=$e*G,qe=$e*Et,yt=ot*Ot,dt=ot*G,lr=ot*Et;return A[0]=1-wr-qe,A[1]=dr+lr,A[2]=Tr-dt,A[3]=0,A[4]=dr-lr,A[5]=1-Bt-qe,A[6]=Or+yt,A[7]=0,A[8]=Tr+dt,A[9]=Or-yt,A[10]=1-Bt-wr,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function le(A,z,ve,Ce,$e,ot,Ot){var G=1/(ve-z),Et=1/($e-Ce),Bt=1/(ot-Ot);return A[0]=ot*2*G,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=ot*2*Et,A[6]=0,A[7]=0,A[8]=(ve+z)*G,A[9]=($e+Ce)*Et,A[10]=(Ot+ot)*Bt,A[11]=-1,A[12]=0,A[13]=0,A[14]=Ot*ot*2*Bt,A[15]=0,A}function re(A,z,ve,Ce,$e){var ot=1/Math.tan(z/2),Ot;return A[0]=ot/ve,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=ot,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=-1,A[12]=0,A[13]=0,A[15]=0,$e!=null&&$e!==Infinity?(Ot=1/(Ce-$e),A[10]=($e+Ce)*Ot,A[14]=2*$e*Ce*Ot):(A[10]=-1,A[14]=-2*Ce),A}function te(A,z,ve,Ce){var $e=Math.tan(z.upDegrees*Math.PI/180),ot=Math.tan(z.downDegrees*Math.PI/180),Ot=Math.tan(z.leftDegrees*Math.PI/180),G=Math.tan(z.rightDegrees*Math.PI/180),Et=2/(Ot+G),Bt=2/($e+ot);return A[0]=Et,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=Bt,A[6]=0,A[7]=0,A[8]=-((Ot-G)*Et*.5),A[9]=($e-ot)*Bt*.5,A[10]=Ce/(ve-Ce),A[11]=-1,A[12]=0,A[13]=0,A[14]=Ce*ve/(ve-Ce),A[15]=0,A}function ke(A,z,ve,Ce,$e,ot,Ot){var G=1/(z-ve),Et=1/(Ce-$e),Bt=1/(ot-Ot);return A[0]=-2*G,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=-2*Et,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=2*Bt,A[11]=0,A[12]=(z+ve)*G,A[13]=($e+Ce)*Et,A[14]=(Ot+ot)*Bt,A[15]=1,A}function nt(A,z,ve,Ce){var $e,ot,Ot,G,Et,Bt,dr,wr,Tr,Or,qe=z[0],yt=z[1],dt=z[2],lr=Ce[0],Kr=Ce[1],gt=Ce[2],Rt=ve[0],sr=ve[1],ar=ve[2];return Math.abs(qe-Rt)<X.Ib&&Math.abs(yt-sr)<X.Ib&&Math.abs(dt-ar)<X.Ib?ie(A):(dr=qe-Rt,wr=yt-sr,Tr=dt-ar,Or=1/Math.hypot(dr,wr,Tr),dr*=Or,wr*=Or,Tr*=Or,$e=Kr*Tr-gt*wr,ot=gt*dr-lr*Tr,Ot=lr*wr-Kr*dr,Or=Math.hypot($e,ot,Ot),Or?(Or=1/Or,$e*=Or,ot*=Or,Ot*=Or):($e=0,ot=0,Ot=0),G=wr*Ot-Tr*ot,Et=Tr*$e-dr*Ot,Bt=dr*ot-wr*$e,Or=Math.hypot(G,Et,Bt),Or?(Or=1/Or,G*=Or,Et*=Or,Bt*=Or):(G=0,Et=0,Bt=0),A[0]=$e,A[1]=G,A[2]=dr,A[3]=0,A[4]=ot,A[5]=Et,A[6]=wr,A[7]=0,A[8]=Ot,A[9]=Bt,A[10]=Tr,A[11]=0,A[12]=-($e*qe+ot*yt+Ot*dt),A[13]=-(G*qe+Et*yt+Bt*dt),A[14]=-(dr*qe+wr*yt+Tr*dt),A[15]=1,A)}function Kt(A,z,ve,Ce){var $e=z[0],ot=z[1],Ot=z[2],G=Ce[0],Et=Ce[1],Bt=Ce[2],dr=$e-ve[0],wr=ot-ve[1],Tr=Ot-ve[2],Or=dr*dr+wr*wr+Tr*Tr;Or>0&&(Or=1/Math.sqrt(Or),dr*=Or,wr*=Or,Tr*=Or);var qe=Et*Tr-Bt*wr,yt=Bt*dr-G*Tr,dt=G*wr-Et*dr;return Or=qe*qe+yt*yt+dt*dt,Or>0&&(Or=1/Math.sqrt(Or),qe*=Or,yt*=Or,dt*=Or),A[0]=qe,A[1]=yt,A[2]=dt,A[3]=0,A[4]=wr*dt-Tr*yt,A[5]=Tr*qe-dr*dt,A[6]=dr*yt-wr*qe,A[7]=0,A[8]=dr,A[9]=wr,A[10]=Tr,A[11]=0,A[12]=$e,A[13]=ot,A[14]=Ot,A[15]=1,A}function Ir(A){return"mat4("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+", "+A[4]+", "+A[5]+", "+A[6]+", "+A[7]+", "+A[8]+", "+A[9]+", "+A[10]+", "+A[11]+", "+A[12]+", "+A[13]+", "+A[14]+", "+A[15]+")"}function Lr(A){return Math.hypot(A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15])}function qr(A,z,ve){return A[0]=z[0]+ve[0],A[1]=z[1]+ve[1],A[2]=z[2]+ve[2],A[3]=z[3]+ve[3],A[4]=z[4]+ve[4],A[5]=z[5]+ve[5],A[6]=z[6]+ve[6],A[7]=z[7]+ve[7],A[8]=z[8]+ve[8],A[9]=z[9]+ve[9],A[10]=z[10]+ve[10],A[11]=z[11]+ve[11],A[12]=z[12]+ve[12],A[13]=z[13]+ve[13],A[14]=z[14]+ve[14],A[15]=z[15]+ve[15],A}function tr(A,z,ve){return A[0]=z[0]-ve[0],A[1]=z[1]-ve[1],A[2]=z[2]-ve[2],A[3]=z[3]-ve[3],A[4]=z[4]-ve[4],A[5]=z[5]-ve[5],A[6]=z[6]-ve[6],A[7]=z[7]-ve[7],A[8]=z[8]-ve[8],A[9]=z[9]-ve[9],A[10]=z[10]-ve[10],A[11]=z[11]-ve[11],A[12]=z[12]-ve[12],A[13]=z[13]-ve[13],A[14]=z[14]-ve[14],A[15]=z[15]-ve[15],A}function ce(A,z,ve){return A[0]=z[0]*ve,A[1]=z[1]*ve,A[2]=z[2]*ve,A[3]=z[3]*ve,A[4]=z[4]*ve,A[5]=z[5]*ve,A[6]=z[6]*ve,A[7]=z[7]*ve,A[8]=z[8]*ve,A[9]=z[9]*ve,A[10]=z[10]*ve,A[11]=z[11]*ve,A[12]=z[12]*ve,A[13]=z[13]*ve,A[14]=z[14]*ve,A[15]=z[15]*ve,A}function ye(A,z,ve,Ce){return A[0]=z[0]+ve[0]*Ce,A[1]=z[1]+ve[1]*Ce,A[2]=z[2]+ve[2]*Ce,A[3]=z[3]+ve[3]*Ce,A[4]=z[4]+ve[4]*Ce,A[5]=z[5]+ve[5]*Ce,A[6]=z[6]+ve[6]*Ce,A[7]=z[7]+ve[7]*Ce,A[8]=z[8]+ve[8]*Ce,A[9]=z[9]+ve[9]*Ce,A[10]=z[10]+ve[10]*Ce,A[11]=z[11]+ve[11]*Ce,A[12]=z[12]+ve[12]*Ce,A[13]=z[13]+ve[13]*Ce,A[14]=z[14]+ve[14]*Ce,A[15]=z[15]+ve[15]*Ce,A}function Re(A,z){return A[0]===z[0]&&A[1]===z[1]&&A[2]===z[2]&&A[3]===z[3]&&A[4]===z[4]&&A[5]===z[5]&&A[6]===z[6]&&A[7]===z[7]&&A[8]===z[8]&&A[9]===z[9]&&A[10]===z[10]&&A[11]===z[11]&&A[12]===z[12]&&A[13]===z[13]&&A[14]===z[14]&&A[15]===z[15]}function Qe(A,z){var ve=A[0],Ce=A[1],$e=A[2],ot=A[3],Ot=A[4],G=A[5],Et=A[6],Bt=A[7],dr=A[8],wr=A[9],Tr=A[10],Or=A[11],qe=A[12],yt=A[13],dt=A[14],lr=A[15],Kr=z[0],gt=z[1],Rt=z[2],sr=z[3],ar=z[4],_n=z[5],xn=z[6],ci=z[7],_i=z[8],Ui=z[9],Xi=z[10],oi=z[11],K=z[12],I=z[13],j=z[14],Y=z[15];return Math.abs(ve-Kr)<=X.Ib*Math.max(1,Math.abs(ve),Math.abs(Kr))&&Math.abs(Ce-gt)<=X.Ib*Math.max(1,Math.abs(Ce),Math.abs(gt))&&Math.abs($e-Rt)<=X.Ib*Math.max(1,Math.abs($e),Math.abs(Rt))&&Math.abs(ot-sr)<=X.Ib*Math.max(1,Math.abs(ot),Math.abs(sr))&&Math.abs(Ot-ar)<=X.Ib*Math.max(1,Math.abs(Ot),Math.abs(ar))&&Math.abs(G-_n)<=X.Ib*Math.max(1,Math.abs(G),Math.abs(_n))&&Math.abs(Et-xn)<=X.Ib*Math.max(1,Math.abs(Et),Math.abs(xn))&&Math.abs(Bt-ci)<=X.Ib*Math.max(1,Math.abs(Bt),Math.abs(ci))&&Math.abs(dr-_i)<=X.Ib*Math.max(1,Math.abs(dr),Math.abs(_i))&&Math.abs(wr-Ui)<=X.Ib*Math.max(1,Math.abs(wr),Math.abs(Ui))&&Math.abs(Tr-Xi)<=X.Ib*Math.max(1,Math.abs(Tr),Math.abs(Xi))&&Math.abs(Or-oi)<=X.Ib*Math.max(1,Math.abs(Or),Math.abs(oi))&&Math.abs(qe-K)<=X.Ib*Math.max(1,Math.abs(qe),Math.abs(K))&&Math.abs(yt-I)<=X.Ib*Math.max(1,Math.abs(yt),Math.abs(I))&&Math.abs(dt-j)<=X.Ib*Math.max(1,Math.abs(dt),Math.abs(j))&&Math.abs(lr-Y)<=X.Ib*Math.max(1,Math.abs(lr),Math.abs(Y))}var Dt=Be,Ct=tr},76721:function(_t,O,_){"use strict";_.d(O,{Ue:function(){return b},al:function(){return H},bA:function(){return Yt},fF:function(){return bt}});var X=_(90208);function b(){var ce=new X.WT(4);return X.WT!=Float32Array&&(ce[0]=0,ce[1]=0,ce[2]=0,ce[3]=0),ce}function p(ce){var ye=new glMatrix.ARRAY_TYPE(4);return ye[0]=ce[0],ye[1]=ce[1],ye[2]=ce[2],ye[3]=ce[3],ye}function H(ce,ye,Re,Qe){var Dt=new X.WT(4);return Dt[0]=ce,Dt[1]=ye,Dt[2]=Re,Dt[3]=Qe,Dt}function S(ce,ye){return ce[0]=ye[0],ce[1]=ye[1],ce[2]=ye[2],ce[3]=ye[3],ce}function F(ce,ye,Re,Qe,Dt){return ce[0]=ye,ce[1]=Re,ce[2]=Qe,ce[3]=Dt,ce}function ie(ce,ye,Re){return ce[0]=ye[0]+Re[0],ce[1]=ye[1]+Re[1],ce[2]=ye[2]+Re[2],ce[3]=ye[3]+Re[3],ce}function fe(ce,ye,Re){return ce[0]=ye[0]-Re[0],ce[1]=ye[1]-Re[1],ce[2]=ye[2]-Re[2],ce[3]=ye[3]-Re[3],ce}function Q(ce,ye,Re){return ce[0]=ye[0]*Re[0],ce[1]=ye[1]*Re[1],ce[2]=ye[2]*Re[2],ce[3]=ye[3]*Re[3],ce}function we(ce,ye,Re){return ce[0]=ye[0]/Re[0],ce[1]=ye[1]/Re[1],ce[2]=ye[2]/Re[2],ce[3]=ye[3]/Re[3],ce}function Ie(ce,ye){return ce[0]=Math.ceil(ye[0]),ce[1]=Math.ceil(ye[1]),ce[2]=Math.ceil(ye[2]),ce[3]=Math.ceil(ye[3]),ce}function Be(ce,ye){return ce[0]=Math.floor(ye[0]),ce[1]=Math.floor(ye[1]),ce[2]=Math.floor(ye[2]),ce[3]=Math.floor(ye[3]),ce}function Xe(ce,ye,Re){return ce[0]=Math.min(ye[0],Re[0]),ce[1]=Math.min(ye[1],Re[1]),ce[2]=Math.min(ye[2],Re[2]),ce[3]=Math.min(ye[3],Re[3]),ce}function Ut(ce,ye,Re){return ce[0]=Math.max(ye[0],Re[0]),ce[1]=Math.max(ye[1],Re[1]),ce[2]=Math.max(ye[2],Re[2]),ce[3]=Math.max(ye[3],Re[3]),ce}function er(ce,ye){return ce[0]=Math.round(ye[0]),ce[1]=Math.round(ye[1]),ce[2]=Math.round(ye[2]),ce[3]=Math.round(ye[3]),ce}function Yt(ce,ye,Re){return ce[0]=ye[0]*Re,ce[1]=ye[1]*Re,ce[2]=ye[2]*Re,ce[3]=ye[3]*Re,ce}function lt(ce,ye,Re,Qe){return ce[0]=ye[0]+Re[0]*Qe,ce[1]=ye[1]+Re[1]*Qe,ce[2]=ye[2]+Re[2]*Qe,ce[3]=ye[3]+Re[3]*Qe,ce}function xt(ce,ye){var Re=ye[0]-ce[0],Qe=ye[1]-ce[1],Dt=ye[2]-ce[2],Ct=ye[3]-ce[3];return Math.hypot(Re,Qe,Dt,Ct)}function ct(ce,ye){var Re=ye[0]-ce[0],Qe=ye[1]-ce[1],Dt=ye[2]-ce[2],Ct=ye[3]-ce[3];return Re*Re+Qe*Qe+Dt*Dt+Ct*Ct}function Sr(ce){var ye=ce[0],Re=ce[1],Qe=ce[2],Dt=ce[3];return Math.hypot(ye,Re,Qe,Dt)}function Ft(ce){var ye=ce[0],Re=ce[1],Qe=ce[2],Dt=ce[3];return ye*ye+Re*Re+Qe*Qe+Dt*Dt}function Ht(ce,ye){return ce[0]=-ye[0],ce[1]=-ye[1],ce[2]=-ye[2],ce[3]=-ye[3],ce}function St(ce,ye){return ce[0]=1/ye[0],ce[1]=1/ye[1],ce[2]=1/ye[2],ce[3]=1/ye[3],ce}function Ge(ce,ye){var Re=ye[0],Qe=ye[1],Dt=ye[2],Ct=ye[3],A=Re*Re+Qe*Qe+Dt*Dt+Ct*Ct;return A>0&&(A=1/Math.sqrt(A)),ce[0]=Re*A,ce[1]=Qe*A,ce[2]=Dt*A,ce[3]=Ct*A,ce}function vt(ce,ye){return ce[0]*ye[0]+ce[1]*ye[1]+ce[2]*ye[2]+ce[3]*ye[3]}function Pe(ce,ye,Re,Qe){var Dt=Re[0]*Qe[1]-Re[1]*Qe[0],Ct=Re[0]*Qe[2]-Re[2]*Qe[0],A=Re[0]*Qe[3]-Re[3]*Qe[0],z=Re[1]*Qe[2]-Re[2]*Qe[1],ve=Re[1]*Qe[3]-Re[3]*Qe[1],Ce=Re[2]*Qe[3]-Re[3]*Qe[2],$e=ye[0],ot=ye[1],Ot=ye[2],G=ye[3];return ce[0]=ot*Ce-Ot*ve+G*z,ce[1]=-($e*Ce)+Ot*A-G*Ct,ce[2]=$e*ve-ot*A+G*Dt,ce[3]=-($e*z)+ot*Ct-Ot*Dt,ce}function Te(ce,ye,Re,Qe){var Dt=ye[0],Ct=ye[1],A=ye[2],z=ye[3];return ce[0]=Dt+Qe*(Re[0]-Dt),ce[1]=Ct+Qe*(Re[1]-Ct),ce[2]=A+Qe*(Re[2]-A),ce[3]=z+Qe*(Re[3]-z),ce}function ze(ce,ye){ye=ye||1;var Re,Qe,Dt,Ct,A,z;do Re=glMatrix.RANDOM()*2-1,Qe=glMatrix.RANDOM()*2-1,A=Re*Re+Qe*Qe;while(A>=1);do Dt=glMatrix.RANDOM()*2-1,Ct=glMatrix.RANDOM()*2-1,z=Dt*Dt+Ct*Ct;while(z>=1);var ve=Math.sqrt((1-A)/z);return ce[0]=ye*Re,ce[1]=ye*Qe,ce[2]=ye*Dt*ve,ce[3]=ye*Ct*ve,ce}function bt(ce,ye,Re){var Qe=ye[0],Dt=ye[1],Ct=ye[2],A=ye[3];return ce[0]=Re[0]*Qe+Re[4]*Dt+Re[8]*Ct+Re[12]*A,ce[1]=Re[1]*Qe+Re[5]*Dt+Re[9]*Ct+Re[13]*A,ce[2]=Re[2]*Qe+Re[6]*Dt+Re[10]*Ct+Re[14]*A,ce[3]=Re[3]*Qe+Re[7]*Dt+Re[11]*Ct+Re[15]*A,ce}function cr(ce,ye,Re){var Qe=ye[0],Dt=ye[1],Ct=ye[2],A=Re[0],z=Re[1],ve=Re[2],Ce=Re[3],$e=Ce*Qe+z*Ct-ve*Dt,ot=Ce*Dt+ve*Qe-A*Ct,Ot=Ce*Ct+A*Dt-z*Qe,G=-A*Qe-z*Dt-ve*Ct;return ce[0]=$e*Ce+G*-A+ot*-ve-Ot*-z,ce[1]=ot*Ce+G*-z+Ot*-A-$e*-ve,ce[2]=Ot*Ce+G*-ve+$e*-z-ot*-A,ce[3]=ye[3],ce}function ae(ce){return ce[0]=0,ce[1]=0,ce[2]=0,ce[3]=0,ce}function Ee(ce){return"vec4("+ce[0]+", "+ce[1]+", "+ce[2]+", "+ce[3]+")"}function le(ce,ye){return ce[0]===ye[0]&&ce[1]===ye[1]&&ce[2]===ye[2]&&ce[3]===ye[3]}function re(ce,ye){var Re=ce[0],Qe=ce[1],Dt=ce[2],Ct=ce[3],A=ye[0],z=ye[1],ve=ye[2],Ce=ye[3];return Math.abs(Re-A)<=glMatrix.EPSILON*Math.max(1,Math.abs(Re),Math.abs(A))&&Math.abs(Qe-z)<=glMatrix.EPSILON*Math.max(1,Math.abs(Qe),Math.abs(z))&&Math.abs(Dt-ve)<=glMatrix.EPSILON*Math.max(1,Math.abs(Dt),Math.abs(ve))&&Math.abs(Ct-Ce)<=glMatrix.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(Ce))}var te=null,ke=null,nt=null,Kt=null,Ir=null,Lr=null,qr=null,tr=function(){var ce=b();return function(ye,Re,Qe,Dt,Ct,A){var z,ve;for(Re||(Re=4),Qe||(Qe=0),Dt?ve=Math.min(Dt*Re+Qe,ye.length):ve=ye.length,z=Qe;z<ve;z+=Re)ce[0]=ye[z],ce[1]=ye[z+1],ce[2]=ye[z+2],ce[3]=ye[z+3],Ct(ce,ce,A),ye[z]=ce[0],ye[z+1]=ce[1],ye[z+2]=ce[2],ye[z+3]=ce[3];return ye}}()},47364:function(_t,O,_){var X;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(b,p,H,S){"use strict";var F=["","webkit","Moz","MS","ms","o"],ie=p.createElement("div"),fe="function",Q=Math.round,we=Math.abs,Ie=Date.now;function Be(rt,pe,Ye){return setTimeout(Sr(rt,Ye),pe)}function Xe(rt,pe,Ye){return Array.isArray(rt)?(Ut(rt,Ye[pe],Ye),!0):!1}function Ut(rt,pe,Ye){var Qt;if(!!rt)if(rt.forEach)rt.forEach(pe,Ye);else if(rt.length!==S)for(Qt=0;Qt<rt.length;)pe.call(Ye,rt[Qt],Qt,rt),Qt++;else for(Qt in rt)rt.hasOwnProperty(Qt)&&pe.call(Ye,rt[Qt],Qt,rt)}function er(rt,pe,Ye){var Qt="DEPRECATED METHOD: "+pe+`
`+Ye+` AT 
`;return function(){var Zr=new Error("get-stack-trace"),nn=Zr&&Zr.stack?Zr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ai=b.console&&(b.console.warn||b.console.log);return Ai&&Ai.call(b.console,Qt,nn),rt.apply(this,arguments)}}var Yt;typeof Object.assign!="function"?Yt=function(pe){if(pe===S||pe===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ye=Object(pe),Qt=1;Qt<arguments.length;Qt++){var Zr=arguments[Qt];if(Zr!==S&&Zr!==null)for(var nn in Zr)Zr.hasOwnProperty(nn)&&(Ye[nn]=Zr[nn])}return Ye}:Yt=Object.assign;var lt=er(function(pe,Ye,Qt){for(var Zr=Object.keys(Ye),nn=0;nn<Zr.length;)(!Qt||Qt&&pe[Zr[nn]]===S)&&(pe[Zr[nn]]=Ye[Zr[nn]]),nn++;return pe},"extend","Use `assign`."),xt=er(function(pe,Ye){return lt(pe,Ye,!0)},"merge","Use `assign`.");function ct(rt,pe,Ye){var Qt=pe.prototype,Zr;Zr=rt.prototype=Object.create(Qt),Zr.constructor=rt,Zr._super=Qt,Ye&&Yt(Zr,Ye)}function Sr(rt,pe){return function(){return rt.apply(pe,arguments)}}function Ft(rt,pe){return typeof rt==fe?rt.apply(pe&&pe[0]||S,pe):rt}function Ht(rt,pe){return rt===S?pe:rt}function St(rt,pe,Ye){Ut(Te(pe),function(Qt){rt.addEventListener(Qt,Ye,!1)})}function Ge(rt,pe,Ye){Ut(Te(pe),function(Qt){rt.removeEventListener(Qt,Ye,!1)})}function vt(rt,pe){for(;rt;){if(rt==pe)return!0;rt=rt.parentNode}return!1}function Pe(rt,pe){return rt.indexOf(pe)>-1}function Te(rt){return rt.trim().split(/\s+/g)}function ze(rt,pe,Ye){if(rt.indexOf&&!Ye)return rt.indexOf(pe);for(var Qt=0;Qt<rt.length;){if(Ye&&rt[Qt][Ye]==pe||!Ye&&rt[Qt]===pe)return Qt;Qt++}return-1}function bt(rt){return Array.prototype.slice.call(rt,0)}function cr(rt,pe,Ye){for(var Qt=[],Zr=[],nn=0;nn<rt.length;){var Ai=pe?rt[nn][pe]:rt[nn];ze(Zr,Ai)<0&&Qt.push(rt[nn]),Zr[nn]=Ai,nn++}return Ye&&(pe?Qt=Qt.sort(function(Ma,va){return Ma[pe]>va[pe]}):Qt=Qt.sort()),Qt}function ae(rt,pe){for(var Ye,Qt,Zr=pe[0].toUpperCase()+pe.slice(1),nn=0;nn<F.length;){if(Ye=F[nn],Qt=Ye?Ye+Zr:pe,Qt in rt)return Qt;nn++}return S}var Ee=1;function le(){return Ee++}function re(rt){var pe=rt.ownerDocument||rt;return pe.defaultView||pe.parentWindow||b}var te=/mobile|tablet|ip(ad|hone|od)|android/i,ke="ontouchstart"in b,nt=ae(b,"PointerEvent")!==S,Kt=ke&&te.test(navigator.userAgent),Ir="touch",Lr="pen",qr="mouse",tr="kinect",ce=25,ye=1,Re=2,Qe=4,Dt=8,Ct=1,A=2,z=4,ve=8,Ce=16,$e=A|z,ot=ve|Ce,Ot=$e|ot,G=["x","y"],Et=["clientX","clientY"];function Bt(rt,pe){var Ye=this;this.manager=rt,this.callback=pe,this.element=rt.element,this.target=rt.options.inputTarget,this.domHandler=function(Qt){Ft(rt.options.enable,[rt])&&Ye.handler(Qt)},this.init()}Bt.prototype={handler:function(){},init:function(){this.evEl&&St(this.element,this.evEl,this.domHandler),this.evTarget&&St(this.target,this.evTarget,this.domHandler),this.evWin&&St(re(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ge(this.element,this.evEl,this.domHandler),this.evTarget&&Ge(this.target,this.evTarget,this.domHandler),this.evWin&&Ge(re(this.element),this.evWin,this.domHandler)}};function dr(rt){var pe,Ye=rt.options.inputClass;return Ye?pe=Ye:nt?pe=I:Kt?pe=At:ke?pe=zr:pe=_i,new pe(rt,wr)}function wr(rt,pe,Ye){var Qt=Ye.pointers.length,Zr=Ye.changedPointers.length,nn=pe&ye&&Qt-Zr==0,Ai=pe&(Qe|Dt)&&Qt-Zr==0;Ye.isFirst=!!nn,Ye.isFinal=!!Ai,nn&&(rt.session={}),Ye.eventType=pe,Tr(rt,Ye),rt.emit("hammer.input",Ye),rt.recognize(Ye),rt.session.prevInput=Ye}function Tr(rt,pe){var Ye=rt.session,Qt=pe.pointers,Zr=Qt.length;Ye.firstInput||(Ye.firstInput=yt(pe)),Zr>1&&!Ye.firstMultiple?Ye.firstMultiple=yt(pe):Zr===1&&(Ye.firstMultiple=!1);var nn=Ye.firstInput,Ai=Ye.firstMultiple,ya=Ai?Ai.center:nn.center,Ma=pe.center=dt(Qt);pe.timeStamp=Ie(),pe.deltaTime=pe.timeStamp-nn.timeStamp,pe.angle=Rt(ya,Ma),pe.distance=gt(ya,Ma),Or(Ye,pe),pe.offsetDirection=Kr(pe.deltaX,pe.deltaY);var va=lr(pe.deltaTime,pe.deltaX,pe.deltaY);pe.overallVelocityX=va.x,pe.overallVelocityY=va.y,pe.overallVelocity=we(va.x)>we(va.y)?va.x:va.y,pe.scale=Ai?ar(Ai.pointers,Qt):1,pe.rotation=Ai?sr(Ai.pointers,Qt):0,pe.maxPointers=Ye.prevInput?pe.pointers.length>Ye.prevInput.maxPointers?pe.pointers.length:Ye.prevInput.maxPointers:pe.pointers.length,qe(Ye,pe);var Ia=rt.element;vt(pe.srcEvent.target,Ia)&&(Ia=pe.srcEvent.target),pe.target=Ia}function Or(rt,pe){var Ye=pe.center,Qt=rt.offsetDelta||{},Zr=rt.prevDelta||{},nn=rt.prevInput||{};(pe.eventType===ye||nn.eventType===Qe)&&(Zr=rt.prevDelta={x:nn.deltaX||0,y:nn.deltaY||0},Qt=rt.offsetDelta={x:Ye.x,y:Ye.y}),pe.deltaX=Zr.x+(Ye.x-Qt.x),pe.deltaY=Zr.y+(Ye.y-Qt.y)}function qe(rt,pe){var Ye=rt.lastInterval||pe,Qt=pe.timeStamp-Ye.timeStamp,Zr,nn,Ai,ya;if(pe.eventType!=Dt&&(Qt>ce||Ye.velocity===S)){var Ma=pe.deltaX-Ye.deltaX,va=pe.deltaY-Ye.deltaY,Ia=lr(Qt,Ma,va);nn=Ia.x,Ai=Ia.y,Zr=we(Ia.x)>we(Ia.y)?Ia.x:Ia.y,ya=Kr(Ma,va),rt.lastInterval=pe}else Zr=Ye.velocity,nn=Ye.velocityX,Ai=Ye.velocityY,ya=Ye.direction;pe.velocity=Zr,pe.velocityX=nn,pe.velocityY=Ai,pe.direction=ya}function yt(rt){for(var pe=[],Ye=0;Ye<rt.pointers.length;)pe[Ye]={clientX:Q(rt.pointers[Ye].clientX),clientY:Q(rt.pointers[Ye].clientY)},Ye++;return{timeStamp:Ie(),pointers:pe,center:dt(pe),deltaX:rt.deltaX,deltaY:rt.deltaY}}function dt(rt){var pe=rt.length;if(pe===1)return{x:Q(rt[0].clientX),y:Q(rt[0].clientY)};for(var Ye=0,Qt=0,Zr=0;Zr<pe;)Ye+=rt[Zr].clientX,Qt+=rt[Zr].clientY,Zr++;return{x:Q(Ye/pe),y:Q(Qt/pe)}}function lr(rt,pe,Ye){return{x:pe/rt||0,y:Ye/rt||0}}function Kr(rt,pe){return rt===pe?Ct:we(rt)>=we(pe)?rt<0?A:z:pe<0?ve:Ce}function gt(rt,pe,Ye){Ye||(Ye=G);var Qt=pe[Ye[0]]-rt[Ye[0]],Zr=pe[Ye[1]]-rt[Ye[1]];return Math.sqrt(Qt*Qt+Zr*Zr)}function Rt(rt,pe,Ye){Ye||(Ye=G);var Qt=pe[Ye[0]]-rt[Ye[0]],Zr=pe[Ye[1]]-rt[Ye[1]];return Math.atan2(Zr,Qt)*180/Math.PI}function sr(rt,pe){return Rt(pe[1],pe[0],Et)+Rt(rt[1],rt[0],Et)}function ar(rt,pe){return gt(pe[0],pe[1],Et)/gt(rt[0],rt[1],Et)}var _n={mousedown:ye,mousemove:Re,mouseup:Qe},xn="mousedown",ci="mousemove mouseup";function _i(){this.evEl=xn,this.evWin=ci,this.pressed=!1,Bt.apply(this,arguments)}ct(_i,Bt,{handler:function(pe){var Ye=_n[pe.type];Ye&ye&&pe.button===0&&(this.pressed=!0),Ye&Re&&pe.which!==1&&(Ye=Qe),!!this.pressed&&(Ye&Qe&&(this.pressed=!1),this.callback(this.manager,Ye,{pointers:[pe],changedPointers:[pe],pointerType:qr,srcEvent:pe}))}});var Ui={pointerdown:ye,pointermove:Re,pointerup:Qe,pointercancel:Dt,pointerout:Dt},Xi={2:Ir,3:Lr,4:qr,5:tr},oi="pointerdown",K="pointermove pointerup pointercancel";b.MSPointerEvent&&!b.PointerEvent&&(oi="MSPointerDown",K="MSPointerMove MSPointerUp MSPointerCancel");function I(){this.evEl=oi,this.evWin=K,Bt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ct(I,Bt,{handler:function(pe){var Ye=this.store,Qt=!1,Zr=pe.type.toLowerCase().replace("ms",""),nn=Ui[Zr],Ai=Xi[pe.pointerType]||pe.pointerType,ya=Ai==Ir,Ma=ze(Ye,pe.pointerId,"pointerId");nn&ye&&(pe.button===0||ya)?Ma<0&&(Ye.push(pe),Ma=Ye.length-1):nn&(Qe|Dt)&&(Qt=!0),!(Ma<0)&&(Ye[Ma]=pe,this.callback(this.manager,nn,{pointers:Ye,changedPointers:[pe],pointerType:Ai,srcEvent:pe}),Qt&&Ye.splice(Ma,1))}});var j={touchstart:ye,touchmove:Re,touchend:Qe,touchcancel:Dt},Y="touchstart",ue="touchstart touchmove touchend touchcancel";function Le(){this.evTarget=Y,this.evWin=ue,this.started=!1,Bt.apply(this,arguments)}ct(Le,Bt,{handler:function(pe){var Ye=j[pe.type];if(Ye===ye&&(this.started=!0),!!this.started){var Qt=Me.call(this,pe,Ye);Ye&(Qe|Dt)&&Qt[0].length-Qt[1].length==0&&(this.started=!1),this.callback(this.manager,Ye,{pointers:Qt[0],changedPointers:Qt[1],pointerType:Ir,srcEvent:pe})}}});function Me(rt,pe){var Ye=bt(rt.touches),Qt=bt(rt.changedTouches);return pe&(Qe|Dt)&&(Ye=cr(Ye.concat(Qt),"identifier",!0)),[Ye,Qt]}var se={touchstart:ye,touchmove:Re,touchend:Qe,touchcancel:Dt},Ne="touchstart touchmove touchend touchcancel";function At(){this.evTarget=Ne,this.targetIds={},Bt.apply(this,arguments)}ct(At,Bt,{handler:function(pe){var Ye=se[pe.type],Qt=Dr.call(this,pe,Ye);!Qt||this.callback(this.manager,Ye,{pointers:Qt[0],changedPointers:Qt[1],pointerType:Ir,srcEvent:pe})}});function Dr(rt,pe){var Ye=bt(rt.touches),Qt=this.targetIds;if(pe&(ye|Re)&&Ye.length===1)return Qt[Ye[0].identifier]=!0,[Ye,Ye];var Zr,nn,Ai=bt(rt.changedTouches),ya=[],Ma=this.target;if(nn=Ye.filter(function(va){return vt(va.target,Ma)}),pe===ye)for(Zr=0;Zr<nn.length;)Qt[nn[Zr].identifier]=!0,Zr++;for(Zr=0;Zr<Ai.length;)Qt[Ai[Zr].identifier]&&ya.push(Ai[Zr]),pe&(Qe|Dt)&&delete Qt[Ai[Zr].identifier],Zr++;if(!!ya.length)return[cr(nn.concat(ya),"identifier",!0),ya]}var Ur=2500,Xt=25;function zr(){Bt.apply(this,arguments);var rt=Sr(this.handler,this);this.touch=new At(this.manager,rt),this.mouse=new _i(this.manager,rt),this.primaryTouch=null,this.lastTouches=[]}ct(zr,Bt,{handler:function(pe,Ye,Qt){var Zr=Qt.pointerType==Ir,nn=Qt.pointerType==qr;if(!(nn&&Qt.sourceCapabilities&&Qt.sourceCapabilities.firesTouchEvents)){if(Zr)On.call(this,Ye,Qt);else if(nn&&hr.call(this,Qt))return;this.callback(pe,Ye,Qt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function On(rt,pe){rt&ye?(this.primaryTouch=pe.changedPointers[0].identifier,vn.call(this,pe)):rt&(Qe|Dt)&&vn.call(this,pe)}function vn(rt){var pe=rt.changedPointers[0];if(pe.identifier===this.primaryTouch){var Ye={x:pe.clientX,y:pe.clientY};this.lastTouches.push(Ye);var Qt=this.lastTouches,Zr=function(){var Ai=Qt.indexOf(Ye);Ai>-1&&Qt.splice(Ai,1)};setTimeout(Zr,Ur)}}function hr(rt){for(var pe=rt.srcEvent.clientX,Ye=rt.srcEvent.clientY,Qt=0;Qt<this.lastTouches.length;Qt++){var Zr=this.lastTouches[Qt],nn=Math.abs(pe-Zr.x),Ai=Math.abs(Ye-Zr.y);if(nn<=Xt&&Ai<=Xt)return!0}return!1}var pn=ae(ie.style,"touchAction"),un=pn!==S,fn="compute",hi="auto",Jr="manipulation",vi="none",Li="pan-x",Qn="pan-y",xi=ki();function Ti(rt,pe){this.manager=rt,this.set(pe)}Ti.prototype={set:function(pe){pe==fn&&(pe=this.compute()),un&&this.manager.element.style&&xi[pe]&&(this.manager.element.style[pn]=pe),this.actions=pe.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var pe=[];return Ut(this.manager.recognizers,function(Ye){Ft(Ye.options.enable,[Ye])&&(pe=pe.concat(Ye.getTouchAction()))}),bo(pe.join(" "))},preventDefaults:function(pe){var Ye=pe.srcEvent,Qt=pe.offsetDirection;if(this.manager.session.prevented){Ye.preventDefault();return}var Zr=this.actions,nn=Pe(Zr,vi)&&!xi[vi],Ai=Pe(Zr,Qn)&&!xi[Qn],ya=Pe(Zr,Li)&&!xi[Li];if(nn){var Ma=pe.pointers.length===1,va=pe.distance<2,Ia=pe.deltaTime<250;if(Ma&&va&&Ia)return}if(!(ya&&Ai)&&(nn||Ai&&Qt&$e||ya&&Qt&ot))return this.preventSrc(Ye)},preventSrc:function(pe){this.manager.session.prevented=!0,pe.preventDefault()}};function bo(rt){if(Pe(rt,vi))return vi;var pe=Pe(rt,Li),Ye=Pe(rt,Qn);return pe&&Ye?vi:pe||Ye?pe?Li:Qn:Pe(rt,Jr)?Jr:hi}function ki(){if(!un)return!1;var rt={},pe=b.CSS&&b.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ye){rt[Ye]=pe?b.CSS.supports("touch-action",Ye):!0}),rt}var si=1,Rn=2,Ri=4,Zn=8,za=Zn,ys=16,Fi=32;function ha(rt){this.options=Yt({},this.defaults,rt||{}),this.id=le(),this.manager=null,this.options.enable=Ht(this.options.enable,!0),this.state=si,this.simultaneous={},this.requireFail=[]}ha.prototype={defaults:{},set:function(pe){return Yt(this.options,pe),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(pe){if(Xe(pe,"recognizeWith",this))return this;var Ye=this.simultaneous;return pe=mi(pe,this),Ye[pe.id]||(Ye[pe.id]=pe,pe.recognizeWith(this)),this},dropRecognizeWith:function(pe){return Xe(pe,"dropRecognizeWith",this)?this:(pe=mi(pe,this),delete this.simultaneous[pe.id],this)},requireFailure:function(pe){if(Xe(pe,"requireFailure",this))return this;var Ye=this.requireFail;return pe=mi(pe,this),ze(Ye,pe)===-1&&(Ye.push(pe),pe.requireFailure(this)),this},dropRequireFailure:function(pe){if(Xe(pe,"dropRequireFailure",this))return this;pe=mi(pe,this);var Ye=ze(this.requireFail,pe);return Ye>-1&&this.requireFail.splice(Ye,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(pe){return!!this.simultaneous[pe.id]},emit:function(pe){var Ye=this,Qt=this.state;function Zr(nn){Ye.manager.emit(nn,pe)}Qt<Zn&&Zr(Ye.options.event+Sl(Qt)),Zr(Ye.options.event),pe.additionalEvent&&Zr(pe.additionalEvent),Qt>=Zn&&Zr(Ye.options.event+Sl(Qt))},tryEmit:function(pe){if(this.canEmit())return this.emit(pe);this.state=Fi},canEmit:function(){for(var pe=0;pe<this.requireFail.length;){if(!(this.requireFail[pe].state&(Fi|si)))return!1;pe++}return!0},recognize:function(pe){var Ye=Yt({},pe);if(!Ft(this.options.enable,[this,Ye])){this.reset(),this.state=Fi;return}this.state&(za|ys|Fi)&&(this.state=si),this.state=this.process(Ye),this.state&(Rn|Ri|Zn|ys)&&this.tryEmit(Ye)},process:function(pe){},getTouchAction:function(){},reset:function(){}};function Sl(rt){return rt&ys?"cancel":rt&Zn?"end":rt&Ri?"move":rt&Rn?"start":""}function Ga(rt){return rt==Ce?"down":rt==ve?"up":rt==A?"left":rt==z?"right":""}function mi(rt,pe){var Ye=pe.manager;return Ye?Ye.get(rt):rt}function ro(){ha.apply(this,arguments)}ct(ro,ha,{defaults:{pointers:1},attrTest:function(pe){var Ye=this.options.pointers;return Ye===0||pe.pointers.length===Ye},process:function(pe){var Ye=this.state,Qt=pe.eventType,Zr=Ye&(Rn|Ri),nn=this.attrTest(pe);return Zr&&(Qt&Dt||!nn)?Ye|ys:Zr||nn?Qt&Qe?Ye|Zn:Ye&Rn?Ye|Ri:Rn:Fi}});function Na(){ro.apply(this,arguments),this.pX=null,this.pY=null}ct(Na,ro,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ot},getTouchAction:function(){var pe=this.options.direction,Ye=[];return pe&$e&&Ye.push(Qn),pe&ot&&Ye.push(Li),Ye},directionTest:function(pe){var Ye=this.options,Qt=!0,Zr=pe.distance,nn=pe.direction,Ai=pe.deltaX,ya=pe.deltaY;return nn&Ye.direction||(Ye.direction&$e?(nn=Ai===0?Ct:Ai<0?A:z,Qt=Ai!=this.pX,Zr=Math.abs(pe.deltaX)):(nn=ya===0?Ct:ya<0?ve:Ce,Qt=ya!=this.pY,Zr=Math.abs(pe.deltaY))),pe.direction=nn,Qt&&Zr>Ye.threshold&&nn&Ye.direction},attrTest:function(pe){return ro.prototype.attrTest.call(this,pe)&&(this.state&Rn||!(this.state&Rn)&&this.directionTest(pe))},emit:function(pe){this.pX=pe.deltaX,this.pY=pe.deltaY;var Ye=Ga(pe.direction);Ye&&(pe.additionalEvent=this.options.event+Ye),this._super.emit.call(this,pe)}});function Ba(){ro.apply(this,arguments)}ct(Ba,ro,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[vi]},attrTest:function(pe){return this._super.attrTest.call(this,pe)&&(Math.abs(pe.scale-1)>this.options.threshold||this.state&Rn)},emit:function(pe){if(pe.scale!==1){var Ye=pe.scale<1?"in":"out";pe.additionalEvent=this.options.event+Ye}this._super.emit.call(this,pe)}});function Go(){ha.apply(this,arguments),this._timer=null,this._input=null}ct(Go,ha,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hi]},process:function(pe){var Ye=this.options,Qt=pe.pointers.length===Ye.pointers,Zr=pe.distance<Ye.threshold,nn=pe.deltaTime>Ye.time;if(this._input=pe,!Zr||!Qt||pe.eventType&(Qe|Dt)&&!nn)this.reset();else if(pe.eventType&ye)this.reset(),this._timer=Be(function(){this.state=za,this.tryEmit()},Ye.time,this);else if(pe.eventType&Qe)return za;return Fi},reset:function(){clearTimeout(this._timer)},emit:function(pe){this.state===za&&(pe&&pe.eventType&Qe?this.manager.emit(this.options.event+"up",pe):(this._input.timeStamp=Ie(),this.manager.emit(this.options.event,this._input)))}});function ta(){ro.apply(this,arguments)}ct(ta,ro,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[vi]},attrTest:function(pe){return this._super.attrTest.call(this,pe)&&(Math.abs(pe.rotation)>this.options.threshold||this.state&Rn)}});function Ua(){ro.apply(this,arguments)}ct(Ua,ro,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:$e|ot,pointers:1},getTouchAction:function(){return Na.prototype.getTouchAction.call(this)},attrTest:function(pe){var Ye=this.options.direction,Qt;return Ye&($e|ot)?Qt=pe.overallVelocity:Ye&$e?Qt=pe.overallVelocityX:Ye&ot&&(Qt=pe.overallVelocityY),this._super.attrTest.call(this,pe)&&Ye&pe.offsetDirection&&pe.distance>this.options.threshold&&pe.maxPointers==this.options.pointers&&we(Qt)>this.options.velocity&&pe.eventType&Qe},emit:function(pe){var Ye=Ga(pe.offsetDirection);Ye&&this.manager.emit(this.options.event+Ye,pe),this.manager.emit(this.options.event,pe)}});function xa(){ha.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ct(xa,ha,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Jr]},process:function(pe){var Ye=this.options,Qt=pe.pointers.length===Ye.pointers,Zr=pe.distance<Ye.threshold,nn=pe.deltaTime<Ye.time;if(this.reset(),pe.eventType&ye&&this.count===0)return this.failTimeout();if(Zr&&nn&&Qt){if(pe.eventType!=Qe)return this.failTimeout();var Ai=this.pTime?pe.timeStamp-this.pTime<Ye.interval:!0,ya=!this.pCenter||gt(this.pCenter,pe.center)<Ye.posThreshold;this.pTime=pe.timeStamp,this.pCenter=pe.center,!ya||!Ai?this.count=1:this.count+=1,this._input=pe;var Ma=this.count%Ye.taps;if(Ma===0)return this.hasRequireFailures()?(this._timer=Be(function(){this.state=za,this.tryEmit()},Ye.interval,this),Rn):za}return Fi},failTimeout:function(){return this._timer=Be(function(){this.state=Fi},this.options.interval,this),Fi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==za&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function os(rt,pe){return pe=pe||{},pe.recognizers=Ht(pe.recognizers,os.defaults.preset),new Jo(rt,pe)}os.VERSION="2.0.7",os.defaults={domEvents:!1,touchAction:fn,enable:!0,inputTarget:null,inputClass:null,preset:[[ta,{enable:!1}],[Ba,{enable:!1},["rotate"]],[Ua,{direction:$e}],[Na,{direction:$e},["swipe"]],[xa],[xa,{event:"doubletap",taps:2},["tap"]],[Go]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var $o=1,El=2;function Jo(rt,pe){this.options=Yt({},os.defaults,pe||{}),this.options.inputTarget=this.options.inputTarget||rt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=rt,this.input=dr(this),this.touchAction=new Ti(this,this.options.touchAction),Pa(this,!0),Ut(this.options.recognizers,function(Ye){var Qt=this.add(new Ye[0](Ye[1]));Ye[2]&&Qt.recognizeWith(Ye[2]),Ye[3]&&Qt.requireFailure(Ye[3])},this)}Jo.prototype={set:function(pe){return Yt(this.options,pe),pe.touchAction&&this.touchAction.update(),pe.inputTarget&&(this.input.destroy(),this.input.target=pe.inputTarget,this.input.init()),this},stop:function(pe){this.session.stopped=pe?El:$o},recognize:function(pe){var Ye=this.session;if(!Ye.stopped){this.touchAction.preventDefaults(pe);var Qt,Zr=this.recognizers,nn=Ye.curRecognizer;(!nn||nn&&nn.state&za)&&(nn=Ye.curRecognizer=null);for(var Ai=0;Ai<Zr.length;)Qt=Zr[Ai],Ye.stopped!==El&&(!nn||Qt==nn||Qt.canRecognizeWith(nn))?Qt.recognize(pe):Qt.reset(),!nn&&Qt.state&(Rn|Ri|Zn)&&(nn=Ye.curRecognizer=Qt),Ai++}},get:function(pe){if(pe instanceof ha)return pe;for(var Ye=this.recognizers,Qt=0;Qt<Ye.length;Qt++)if(Ye[Qt].options.event==pe)return Ye[Qt];return null},add:function(pe){if(Xe(pe,"add",this))return this;var Ye=this.get(pe.options.event);return Ye&&this.remove(Ye),this.recognizers.push(pe),pe.manager=this,this.touchAction.update(),pe},remove:function(pe){if(Xe(pe,"remove",this))return this;if(pe=this.get(pe),pe){var Ye=this.recognizers,Qt=ze(Ye,pe);Qt!==-1&&(Ye.splice(Qt,1),this.touchAction.update())}return this},on:function(pe,Ye){if(pe!==S&&Ye!==S){var Qt=this.handlers;return Ut(Te(pe),function(Zr){Qt[Zr]=Qt[Zr]||[],Qt[Zr].push(Ye)}),this}},off:function(pe,Ye){if(pe!==S){var Qt=this.handlers;return Ut(Te(pe),function(Zr){Ye?Qt[Zr]&&Qt[Zr].splice(ze(Qt[Zr],Ye),1):delete Qt[Zr]}),this}},emit:function(pe,Ye){this.options.domEvents&&Ha(pe,Ye);var Qt=this.handlers[pe]&&this.handlers[pe].slice();if(!(!Qt||!Qt.length)){Ye.type=pe,Ye.preventDefault=function(){Ye.srcEvent.preventDefault()};for(var Zr=0;Zr<Qt.length;)Qt[Zr](Ye),Zr++}},destroy:function(){this.element&&Pa(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Pa(rt,pe){var Ye=rt.element;if(!!Ye.style){var Qt;Ut(rt.options.cssProps,function(Zr,nn){Qt=ae(Ye.style,nn),pe?(rt.oldCssProps[Qt]=Ye.style[Qt],Ye.style[Qt]=Zr):Ye.style[Qt]=rt.oldCssProps[Qt]||""}),pe||(rt.oldCssProps={})}}function Ha(rt,pe){var Ye=p.createEvent("Event");Ye.initEvent(rt,!0,!0),Ye.gesture=pe,pe.target.dispatchEvent(Ye)}Yt(os,{INPUT_START:ye,INPUT_MOVE:Re,INPUT_END:Qe,INPUT_CANCEL:Dt,STATE_POSSIBLE:si,STATE_BEGAN:Rn,STATE_CHANGED:Ri,STATE_ENDED:Zn,STATE_RECOGNIZED:za,STATE_CANCELLED:ys,STATE_FAILED:Fi,DIRECTION_NONE:Ct,DIRECTION_LEFT:A,DIRECTION_RIGHT:z,DIRECTION_UP:ve,DIRECTION_DOWN:Ce,DIRECTION_HORIZONTAL:$e,DIRECTION_VERTICAL:ot,DIRECTION_ALL:Ot,Manager:Jo,Input:Bt,TouchAction:Ti,TouchInput:At,MouseInput:_i,PointerEventInput:I,TouchMouseInput:zr,SingleTouchInput:Le,Recognizer:ha,AttrRecognizer:ro,Tap:xa,Pan:Na,Swipe:Ua,Pinch:Ba,Rotate:ta,Press:Go,on:St,off:Ge,each:Ut,merge:xt,extend:lt,assign:Yt,inherit:ct,bindFn:Sr,prefixed:ae});var pa=typeof b!="undefined"?b:typeof self!="undefined"?self:{};pa.Hammer=os,X=function(){return os}.call(O,_,O,_t),X!==S&&(_t.exports=X)})(window,document,"Hammer")},61356:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0});var _=Symbol.for("INJECTION");function X(F,ie,fe,Q){function we(){return Q&&!Reflect.hasMetadata(_,this,ie)&&Reflect.defineMetadata(_,fe(),this,ie),Reflect.hasMetadata(_,this,ie)?Reflect.getMetadata(_,this,ie):fe()}function Ie(Be){Reflect.defineMetadata(_,Be,this,ie)}Object.defineProperty(F,ie,{configurable:!0,enumerable:!0,get:we,set:Ie})}function b(F,ie){return function(fe){return function(Q,we){var Ie=function(){return F.get(fe)};X(Q,we,Ie,ie)}}}O.makePropertyInjectDecorator=b;function p(F,ie){return function(fe,Q){return function(we,Ie){var Be=function(){return F.getNamed(fe,Q)};X(we,Ie,Be,ie)}}}O.makePropertyInjectNamedDecorator=p;function H(F,ie){return function(fe,Q,we){return function(Ie,Be){var Xe=function(){return F.getTagged(fe,Q,we)};X(Ie,Be,Xe,ie)}}}O.makePropertyInjectTaggedDecorator=H;function S(F,ie){return function(fe){return function(Q,we){var Ie=function(){return F.getAll(fe)};X(Q,we,Ie,ie)}}}O.makePropertyMultiInjectDecorator=S},60544:function(_t,O,_){"use strict";var X;X={value:!0};var b=_(61356);function p(H,S){S===void 0&&(S=!0);var F=b.makePropertyInjectDecorator(H,S),ie=b.makePropertyInjectNamedDecorator(H,S),fe=b.makePropertyInjectTaggedDecorator(H,S),Q=b.makePropertyMultiInjectDecorator(H,S);return{lazyInject:F,lazyInjectNamed:ie,lazyInjectTagged:fe,lazyMultiInject:Q}}O.Z=p},4770:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.tagProperty=O.tagParameter=O.decorate=void 0;var X=_(55700),b=_(67565);function p(Q,we,Ie,Be){var Xe=b.TAGGED;S(Xe,Q,we,Be,Ie)}O.tagParameter=p;function H(Q,we,Ie){var Be=b.TAGGED_PROP;S(Be,Q.constructor,we,Ie)}O.tagProperty=H;function S(Q,we,Ie,Be,Xe){var Ut={},er=typeof Xe=="number",Yt=Xe!==void 0&&er?Xe.toString():Ie;if(er&&Ie!==void 0)throw new Error(X.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(Q,we)&&(Ut=Reflect.getMetadata(Q,we));var lt=Ut[Yt];if(!Array.isArray(lt))lt=[];else for(var xt=0,ct=lt;xt<ct.length;xt++){var Sr=ct[xt];if(Sr.key===Be.key)throw new Error(X.DUPLICATED_METADATA+" "+Sr.key.toString())}lt.push(Be),Ut[Yt]=lt,Reflect.defineMetadata(Q,Ut,we)}function F(Q,we){Reflect.decorate(Q,we)}function ie(Q,we){return function(Ie,Be){we(Ie,Be,Q)}}function fe(Q,we,Ie){typeof Ie=="number"?F([ie(Ie,Q)],we):typeof Ie=="string"?Reflect.decorate([Q],we,Ie):F([Q],we)}O.decorate=fe},17395:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.inject=O.LazyServiceIdentifer=void 0;var X=_(55700),b=_(67565),p=_(55690),H=_(4770),S=function(){function ie(fe){this._cb=fe}return ie.prototype.unwrap=function(){return this._cb()},ie}();O.LazyServiceIdentifer=S;function F(ie){return function(fe,Q,we){if(ie===void 0)throw new Error(X.UNDEFINED_INJECT_ANNOTATION(fe.name));var Ie=new p.Metadata(b.INJECT_TAG,ie);typeof we=="number"?H.tagParameter(fe,Q,we,Ie):H.tagProperty(fe,Q,Ie)}}O.inject=F},78185:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.injectable=void 0;var X=_(55700),b=_(67565);function p(){return function(H){if(Reflect.hasOwnMetadata(b.PARAM_TYPES,H))throw new Error(X.DUPLICATED_INJECTABLE_DECORATOR);var S=Reflect.getMetadata(b.DESIGN_PARAM_TYPES,H)||[];return Reflect.defineMetadata(b.PARAM_TYPES,S,H),H}}O.injectable=p},14509:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.multiInject=void 0;var X=_(67565),b=_(55690),p=_(4770);function H(S){return function(F,ie,fe){var Q=new b.Metadata(X.MULTI_INJECT_TAG,S);typeof fe=="number"?p.tagParameter(F,ie,fe,Q):p.tagProperty(F,ie,Q)}}O.multiInject=H},93277:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.named=void 0;var X=_(67565),b=_(55690),p=_(4770);function H(S){return function(F,ie,fe){var Q=new b.Metadata(X.NAMED_TAG,S);typeof fe=="number"?p.tagParameter(F,ie,fe,Q):p.tagProperty(F,ie,Q)}}O.named=H},45568:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.optional=void 0;var X=_(67565),b=_(55690),p=_(4770);function H(){return function(S,F,ie){var fe=new b.Metadata(X.OPTIONAL_TAG,!0);typeof ie=="number"?p.tagParameter(S,F,ie,fe):p.tagProperty(S,F,fe)}}O.optional=H},80145:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.postConstruct=void 0;var X=_(55700),b=_(67565),p=_(55690);function H(){return function(S,F,ie){var fe=new p.Metadata(b.POST_CONSTRUCT,F);if(Reflect.hasOwnMetadata(b.POST_CONSTRUCT,S.constructor))throw new Error(X.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(b.POST_CONSTRUCT,fe,S.constructor)}}O.postConstruct=H},70830:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.tagged=void 0;var X=_(55690),b=_(4770);function p(H,S){return function(F,ie,fe){var Q=new X.Metadata(H,S);typeof fe=="number"?b.tagParameter(F,ie,fe,Q):b.tagProperty(F,ie,Q)}}O.tagged=p},2749:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.targetName=void 0;var X=_(67565),b=_(55690),p=_(4770);function H(S){return function(F,ie,fe){var Q=new b.Metadata(X.NAME_TAG,S);p.tagParameter(F,ie,fe,Q)}}O.targetName=H},58067:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.unmanaged=void 0;var X=_(67565),b=_(55690),p=_(4770);function H(){return function(S,F,ie){var fe=new b.Metadata(X.UNMANAGED_TAG,!0);p.tagParameter(S,F,ie,fe)}}O.unmanaged=H},99968:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Binding=void 0;var X=_(60442),b=_(21871),p=function(){function H(S,F){this.id=b.id(),this.activated=!1,this.serviceIdentifier=S,this.scope=F,this.type=X.BindingTypeEnum.Invalid,this.constraint=function(ie){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return H.prototype.clone=function(){var S=new H(this.serviceIdentifier,this.scope);return S.activated=S.scope===X.BindingScopeEnum.Singleton?this.activated:!1,S.implementationType=this.implementationType,S.dynamicValue=this.dynamicValue,S.scope=this.scope,S.type=this.type,S.factory=this.factory,S.provider=this.provider,S.constraint=this.constraint,S.onActivation=this.onActivation,S.cache=this.cache,S},H}();O.Binding=p},26019:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.BindingCount=void 0;var _={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};O.BindingCount=_},55700:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.STACK_OVERFLOW=O.CIRCULAR_DEPENDENCY_IN_FACTORY=O.POST_CONSTRUCT_ERROR=O.MULTIPLE_POST_CONSTRUCT_METHODS=O.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=O.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=O.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=O.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=O.ARGUMENTS_LENGTH_MISMATCH=O.INVALID_DECORATOR_OPERATION=O.INVALID_TO_SELF_VALUE=O.INVALID_FUNCTION_BINDING=O.INVALID_MIDDLEWARE_RETURN=O.NO_MORE_SNAPSHOTS_AVAILABLE=O.INVALID_BINDING_TYPE=O.NOT_IMPLEMENTED=O.CIRCULAR_DEPENDENCY=O.UNDEFINED_INJECT_ANNOTATION=O.MISSING_INJECT_ANNOTATION=O.MISSING_INJECTABLE_ANNOTATION=O.NOT_REGISTERED=O.CANNOT_UNBIND=O.AMBIGUOUS_MATCH=O.KEY_NOT_FOUND=O.NULL_ARGUMENT=O.DUPLICATED_METADATA=O.DUPLICATED_INJECTABLE_DECORATOR=void 0,O.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",O.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",O.NULL_ARGUMENT="NULL argument",O.KEY_NOT_FOUND="Key Not Found",O.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",O.CANNOT_UNBIND="Could not unbind serviceIdentifier:",O.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",O.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",O.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var _=function(S){return"@inject called with undefined this could mean that the class "+S+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};O.UNDEFINED_INJECT_ANNOTATION=_,O.CIRCULAR_DEPENDENCY="Circular dependency found:",O.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",O.INVALID_BINDING_TYPE="Invalid binding type:",O.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",O.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",O.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",O.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",O.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var X=function(){for(var S=[],F=0;F<arguments.length;F++)S[F]=arguments[F];return"The number of constructor arguments in the derived class "+(S[0]+" must be >= than the number of constructor arguments of its base class.")};O.ARGUMENTS_LENGTH_MISMATCH=X,O.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",O.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",O.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",O.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",O.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var b=function(){for(var S=[],F=0;F<arguments.length;F++)S[F]=arguments[F];return"@postConstruct error in class "+S[0]+": "+S[1]};O.POST_CONSTRUCT_ERROR=b;var p=function(){for(var S=[],F=0;F<arguments.length;F++)S[F]=arguments[F];return"It looks like there is a circular dependency "+("in one of the '"+S[0]+"' bindings. Please investigate bindings with")+("service identifier '"+S[1]+"'.")};O.CIRCULAR_DEPENDENCY_IN_FACTORY=p,O.STACK_OVERFLOW="Maximum call stack size exceeded"},60442:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.TargetTypeEnum=O.BindingTypeEnum=O.BindingScopeEnum=void 0;var _={Request:"Request",Singleton:"Singleton",Transient:"Transient"};O.BindingScopeEnum=_;var X={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};O.BindingTypeEnum=X;var b={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};O.TargetTypeEnum=b},67565:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.NON_CUSTOM_TAG_KEYS=O.POST_CONSTRUCT=O.DESIGN_PARAM_TYPES=O.PARAM_TYPES=O.TAGGED_PROP=O.TAGGED=O.MULTI_INJECT_TAG=O.INJECT_TAG=O.OPTIONAL_TAG=O.UNMANAGED_TAG=O.NAME_TAG=O.NAMED_TAG=void 0,O.NAMED_TAG="named",O.NAME_TAG="name",O.UNMANAGED_TAG="unmanaged",O.OPTIONAL_TAG="optional",O.INJECT_TAG="inject",O.MULTI_INJECT_TAG="multi_inject",O.TAGGED="inversify:tagged",O.TAGGED_PROP="inversify:tagged_props",O.PARAM_TYPES="inversify:paramtypes",O.DESIGN_PARAM_TYPES="design:paramtypes",O.POST_CONSTRUCT="post_construct";function _(){return[O.INJECT_TAG,O.MULTI_INJECT_TAG,O.NAME_TAG,O.UNMANAGED_TAG,O.NAMED_TAG,O.OPTIONAL_TAG]}O.NON_CUSTOM_TAG_KEYS=_()},2409:function(_t,O,_){"use strict";var X=this&&this.__awaiter||function(lt,xt,ct,Sr){function Ft(Ht){return Ht instanceof ct?Ht:new ct(function(St){St(Ht)})}return new(ct||(ct=Promise))(function(Ht,St){function Ge(Te){try{Pe(Sr.next(Te))}catch(ze){St(ze)}}function vt(Te){try{Pe(Sr.throw(Te))}catch(ze){St(ze)}}function Pe(Te){Te.done?Ht(Te.value):Ft(Te.value).then(Ge,vt)}Pe((Sr=Sr.apply(lt,xt||[])).next())})},b=this&&this.__generator||function(lt,xt){var ct={label:0,sent:function(){if(Ht[0]&1)throw Ht[1];return Ht[1]},trys:[],ops:[]},Sr,Ft,Ht,St;return St={next:Ge(0),throw:Ge(1),return:Ge(2)},typeof Symbol=="function"&&(St[Symbol.iterator]=function(){return this}),St;function Ge(Pe){return function(Te){return vt([Pe,Te])}}function vt(Pe){if(Sr)throw new TypeError("Generator is already executing.");for(;ct;)try{if(Sr=1,Ft&&(Ht=Pe[0]&2?Ft.return:Pe[0]?Ft.throw||((Ht=Ft.return)&&Ht.call(Ft),0):Ft.next)&&!(Ht=Ht.call(Ft,Pe[1])).done)return Ht;switch(Ft=0,Ht&&(Pe=[Pe[0]&2,Ht.value]),Pe[0]){case 0:case 1:Ht=Pe;break;case 4:return ct.label++,{value:Pe[1],done:!1};case 5:ct.label++,Ft=Pe[1],Pe=[0];continue;case 7:Pe=ct.ops.pop(),ct.trys.pop();continue;default:if(Ht=ct.trys,!(Ht=Ht.length>0&&Ht[Ht.length-1])&&(Pe[0]===6||Pe[0]===2)){ct=0;continue}if(Pe[0]===3&&(!Ht||Pe[1]>Ht[0]&&Pe[1]<Ht[3])){ct.label=Pe[1];break}if(Pe[0]===6&&ct.label<Ht[1]){ct.label=Ht[1],Ht=Pe;break}if(Ht&&ct.label<Ht[2]){ct.label=Ht[2],ct.ops.push(Pe);break}Ht[2]&&ct.ops.pop(),ct.trys.pop();continue}Pe=xt.call(lt,ct)}catch(Te){Pe=[6,Te],Ft=0}finally{Sr=Ht=0}if(Pe[0]&5)throw Pe[1];return{value:Pe[0]?Pe[1]:void 0,done:!0}}},p=this&&this.__spreadArray||function(lt,xt){for(var ct=0,Sr=xt.length,Ft=lt.length;ct<Sr;ct++,Ft++)lt[Ft]=xt[ct];return lt};Object.defineProperty(O,"__esModule",{value:!0}),O.Container=void 0;var H=_(99968),S=_(55700),F=_(60442),ie=_(67565),fe=_(57567),Q=_(82807),we=_(18129),Ie=_(24120),Be=_(21871),Xe=_(96814),Ut=_(54973),er=_(61531),Yt=function(){function lt(xt){this._appliedMiddleware=[];var ct=xt||{};if(typeof ct!="object")throw new Error(""+S.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(ct.defaultScope===void 0)ct.defaultScope=F.BindingScopeEnum.Transient;else if(ct.defaultScope!==F.BindingScopeEnum.Singleton&&ct.defaultScope!==F.BindingScopeEnum.Transient&&ct.defaultScope!==F.BindingScopeEnum.Request)throw new Error(""+S.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(ct.autoBindInjectable===void 0)ct.autoBindInjectable=!1;else if(typeof ct.autoBindInjectable!="boolean")throw new Error(""+S.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(ct.skipBaseClassChecks===void 0)ct.skipBaseClassChecks=!1;else if(typeof ct.skipBaseClassChecks!="boolean")throw new Error(""+S.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:ct.autoBindInjectable,defaultScope:ct.defaultScope,skipBaseClassChecks:ct.skipBaseClassChecks},this.id=Be.id(),this._bindingDictionary=new er.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new fe.MetadataReader}return lt.merge=function(xt,ct){for(var Sr=[],Ft=2;Ft<arguments.length;Ft++)Sr[Ft-2]=arguments[Ft];var Ht=new lt,St=p([xt,ct],Sr).map(function(Pe){return Q.getBindingDictionary(Pe)}),Ge=Q.getBindingDictionary(Ht);function vt(Pe,Te){Pe.traverse(function(ze,bt){bt.forEach(function(cr){Te.add(cr.serviceIdentifier,cr.clone())})})}return St.forEach(function(Pe){vt(Pe,Ge)}),Ht},lt.prototype.load=function(){for(var xt=[],ct=0;ct<arguments.length;ct++)xt[ct]=arguments[ct];for(var Sr=this._getContainerModuleHelpersFactory(),Ft=0,Ht=xt;Ft<Ht.length;Ft++){var St=Ht[Ft],Ge=Sr(St.id);St.registry(Ge.bindFunction,Ge.unbindFunction,Ge.isboundFunction,Ge.rebindFunction)}},lt.prototype.loadAsync=function(){for(var xt=[],ct=0;ct<arguments.length;ct++)xt[ct]=arguments[ct];return X(this,void 0,void 0,function(){var Sr,Ft,Ht,St,Ge;return b(this,function(vt){switch(vt.label){case 0:Sr=this._getContainerModuleHelpersFactory(),Ft=0,Ht=xt,vt.label=1;case 1:return Ft<Ht.length?(St=Ht[Ft],Ge=Sr(St.id),[4,St.registry(Ge.bindFunction,Ge.unbindFunction,Ge.isboundFunction,Ge.rebindFunction)]):[3,4];case 2:vt.sent(),vt.label=3;case 3:return Ft++,[3,1];case 4:return[2]}})})},lt.prototype.unload=function(){for(var xt=this,ct=[],Sr=0;Sr<arguments.length;Sr++)ct[Sr]=arguments[Sr];var Ft=function(St){return function(Ge){return Ge.moduleId===St}};ct.forEach(function(Ht){var St=Ft(Ht.id);xt._bindingDictionary.removeByCondition(St)})},lt.prototype.bind=function(xt){var ct=this.options.defaultScope||F.BindingScopeEnum.Transient,Sr=new H.Binding(xt,ct);return this._bindingDictionary.add(xt,Sr),new Ie.BindingToSyntax(Sr)},lt.prototype.rebind=function(xt){return this.unbind(xt),this.bind(xt)},lt.prototype.unbind=function(xt){try{this._bindingDictionary.remove(xt)}catch(ct){throw new Error(S.CANNOT_UNBIND+" "+Xe.getServiceIdentifierAsString(xt))}},lt.prototype.unbindAll=function(){this._bindingDictionary=new er.Lookup},lt.prototype.isBound=function(xt){var ct=this._bindingDictionary.hasKey(xt);return!ct&&this.parent&&(ct=this.parent.isBound(xt)),ct},lt.prototype.isBoundNamed=function(xt,ct){return this.isBoundTagged(xt,ie.NAMED_TAG,ct)},lt.prototype.isBoundTagged=function(xt,ct,Sr){var Ft=!1;if(this._bindingDictionary.hasKey(xt)){var Ht=this._bindingDictionary.get(xt),St=Q.createMockRequest(this,xt,ct,Sr);Ft=Ht.some(function(Ge){return Ge.constraint(St)})}return!Ft&&this.parent&&(Ft=this.parent.isBoundTagged(xt,ct,Sr)),Ft},lt.prototype.snapshot=function(){this._snapshots.push(Ut.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},lt.prototype.restore=function(){var xt=this._snapshots.pop();if(xt===void 0)throw new Error(S.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=xt.bindings,this._middleware=xt.middleware},lt.prototype.createChild=function(xt){var ct=new lt(xt||this.options);return ct.parent=this,ct},lt.prototype.applyMiddleware=function(){for(var xt=[],ct=0;ct<arguments.length;ct++)xt[ct]=arguments[ct];this._appliedMiddleware=this._appliedMiddleware.concat(xt);var Sr=this._middleware?this._middleware:this._planAndResolve();this._middleware=xt.reduce(function(Ft,Ht){return Ht(Ft)},Sr)},lt.prototype.applyCustomMetadataReader=function(xt){this._metadataReader=xt},lt.prototype.get=function(xt){return this._get(!1,!1,F.TargetTypeEnum.Variable,xt)},lt.prototype.getTagged=function(xt,ct,Sr){return this._get(!1,!1,F.TargetTypeEnum.Variable,xt,ct,Sr)},lt.prototype.getNamed=function(xt,ct){return this.getTagged(xt,ie.NAMED_TAG,ct)},lt.prototype.getAll=function(xt){return this._get(!0,!0,F.TargetTypeEnum.Variable,xt)},lt.prototype.getAllTagged=function(xt,ct,Sr){return this._get(!1,!0,F.TargetTypeEnum.Variable,xt,ct,Sr)},lt.prototype.getAllNamed=function(xt,ct){return this.getAllTagged(xt,ie.NAMED_TAG,ct)},lt.prototype.resolve=function(xt){var ct=this.createChild();return ct.bind(xt).toSelf(),this._appliedMiddleware.forEach(function(Sr){ct.applyMiddleware(Sr)}),ct.get(xt)},lt.prototype._getContainerModuleHelpersFactory=function(){var xt=this,ct=function(vt,Pe){vt._binding.moduleId=Pe},Sr=function(vt){return function(Pe){var Te=xt.bind.bind(xt),ze=Te(Pe);return ct(ze,vt),ze}},Ft=function(vt){return function(Pe){var Te=xt.unbind.bind(xt);Te(Pe)}},Ht=function(vt){return function(Pe){var Te=xt.isBound.bind(xt);return Te(Pe)}},St=function(vt){return function(Pe){var Te=xt.rebind.bind(xt),ze=Te(Pe);return ct(ze,vt),ze}};return function(Ge){return{bindFunction:Sr(Ge),isboundFunction:Ht(Ge),rebindFunction:St(Ge),unbindFunction:Ft(Ge)}}},lt.prototype._get=function(xt,ct,Sr,Ft,Ht,St){var Ge=null,vt={avoidConstraints:xt,contextInterceptor:function(Te){return Te},isMultiInject:ct,key:Ht,serviceIdentifier:Ft,targetType:Sr,value:St};if(this._middleware){if(Ge=this._middleware(vt),Ge==null)throw new Error(S.INVALID_MIDDLEWARE_RETURN)}else Ge=this._planAndResolve()(vt);return Ge},lt.prototype._planAndResolve=function(){var xt=this;return function(ct){var Sr=Q.plan(xt._metadataReader,xt,ct.isMultiInject,ct.targetType,ct.serviceIdentifier,ct.key,ct.value,ct.avoidConstraints);Sr=ct.contextInterceptor(Sr);var Ft=we.resolve(Sr);return Ft}},lt}();O.Container=Yt},7730:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.AsyncContainerModule=O.ContainerModule=void 0;var X=_(21871),b=function(){function H(S){this.id=X.id(),this.registry=S}return H}();O.ContainerModule=b;var p=function(){function H(S){this.id=X.id(),this.registry=S}return H}();O.AsyncContainerModule=p},54973:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.ContainerSnapshot=void 0;var _=function(){function X(){}return X.of=function(b,p){var H=new X;return H.bindings=b,H.middleware=p,H},X}();O.ContainerSnapshot=_},61531:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Lookup=void 0;var X=_(55700),b=function(){function p(){this._map=new Map}return p.prototype.getMap=function(){return this._map},p.prototype.add=function(H,S){if(H==null)throw new Error(X.NULL_ARGUMENT);if(S==null)throw new Error(X.NULL_ARGUMENT);var F=this._map.get(H);F!==void 0?(F.push(S),this._map.set(H,F)):this._map.set(H,[S])},p.prototype.get=function(H){if(H==null)throw new Error(X.NULL_ARGUMENT);var S=this._map.get(H);if(S!==void 0)return S;throw new Error(X.KEY_NOT_FOUND)},p.prototype.remove=function(H){if(H==null)throw new Error(X.NULL_ARGUMENT);if(!this._map.delete(H))throw new Error(X.KEY_NOT_FOUND)},p.prototype.removeByCondition=function(H){var S=this;this._map.forEach(function(F,ie){var fe=F.filter(function(Q){return!H(Q)});fe.length>0?S._map.set(ie,fe):S._map.delete(ie)})},p.prototype.hasKey=function(H){if(H==null)throw new Error(X.NULL_ARGUMENT);return this._map.has(H)},p.prototype.clone=function(){var H=new p;return this._map.forEach(function(S,F){S.forEach(function(ie){return H.add(F,ie.clone())})}),H},p.prototype.traverse=function(H){this._map.forEach(function(S,F){H(F,S)})},p}();O.Lookup=b},38045:function(_t,O,_){"use strict";var X;X={value:!0},X=X=X=X=X=X=O.GW=X=X=O.zY=X=X=X=X=X=O.f3=X=X=O.b2=X=X=X=X=X=O.W2=X=void 0;var b=_(67565);X=b;var p=_(2409);Object.defineProperty(O,"W2",{enumerable:!0,get:function(){return p.Container}});var H=_(60442);X={enumerable:!0,get:function(){return H.BindingScopeEnum}},X={enumerable:!0,get:function(){return H.BindingTypeEnum}},X={enumerable:!0,get:function(){return H.TargetTypeEnum}};var S=_(7730);X={enumerable:!0,get:function(){return S.AsyncContainerModule}},X={enumerable:!0,get:function(){return S.ContainerModule}};var F=_(78185);Object.defineProperty(O,"b2",{enumerable:!0,get:function(){return F.injectable}});var ie=_(70830);X={enumerable:!0,get:function(){return ie.tagged}};var fe=_(93277);X={enumerable:!0,get:function(){return fe.named}};var Q=_(17395);Object.defineProperty(O,"f3",{enumerable:!0,get:function(){return Q.inject}}),X={enumerable:!0,get:function(){return Q.LazyServiceIdentifer}};var we=_(45568);X={enumerable:!0,get:function(){return we.optional}};var Ie=_(58067);X={enumerable:!0,get:function(){return Ie.unmanaged}};var Be=_(14509);X={enumerable:!0,get:function(){return Be.multiInject}};var Xe=_(2749);X={enumerable:!0,get:function(){return Xe.targetName}};var Ut=_(80145);Object.defineProperty(O,"zY",{enumerable:!0,get:function(){return Ut.postConstruct}});var er=_(57567);X={enumerable:!0,get:function(){return er.MetadataReader}};var Yt=_(21871);X={enumerable:!0,get:function(){return Yt.id}};var lt=_(4770);Object.defineProperty(O,"GW",{enumerable:!0,get:function(){return lt.decorate}});var xt=_(95068);X={enumerable:!0,get:function(){return xt.traverseAncerstors}},X={enumerable:!0,get:function(){return xt.taggedConstraint}},X={enumerable:!0,get:function(){return xt.namedConstraint}},X={enumerable:!0,get:function(){return xt.typeConstraint}};var ct=_(96814);X={enumerable:!0,get:function(){return ct.getServiceIdentifierAsString}};var Sr=_(51119);X={enumerable:!0,get:function(){return Sr.multiBindToService}}},13536:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Context=void 0;var X=_(21871),b=function(){function p(H){this.id=X.id(),this.container=H}return p.prototype.addPlan=function(H){this.plan=H},p.prototype.setCurrentRequest=function(H){this.currentRequest=H},p}();O.Context=b},55690:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Metadata=void 0;var X=_(67565),b=function(){function p(H,S){this.key=H,this.value=S}return p.prototype.toString=function(){return this.key===X.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},p}();O.Metadata=b},57567:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.MetadataReader=void 0;var X=_(67565),b=function(){function p(){}return p.prototype.getConstructorMetadata=function(H){var S=Reflect.getMetadata(X.PARAM_TYPES,H),F=Reflect.getMetadata(X.TAGGED,H);return{compilerGeneratedMetadata:S,userGeneratedMetadata:F||{}}},p.prototype.getPropertiesMetadata=function(H){var S=Reflect.getMetadata(X.TAGGED_PROP,H)||[];return S},p}();O.MetadataReader=b},35277:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Plan=void 0;var _=function(){function X(b,p){this.parentContext=b,this.rootRequest=p}return X}();O.Plan=_},82807:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.getBindingDictionary=O.createMockRequest=O.plan=void 0;var X=_(26019),b=_(55700),p=_(60442),H=_(67565),S=_(69993),F=_(96814),ie=_(13536),fe=_(55690),Q=_(35277),we=_(68191),Ie=_(63421),Be=_(58321);function Xe(Ft){return Ft._bindingDictionary}O.getBindingDictionary=Xe;function Ut(Ft,Ht,St,Ge,vt,Pe){var Te=Ft?H.MULTI_INJECT_TAG:H.INJECT_TAG,ze=new fe.Metadata(Te,St),bt=new Be.Target(Ht,Ge,St,ze);if(vt!==void 0){var cr=new fe.Metadata(vt,Pe);bt.metadata.push(cr)}return bt}function er(Ft,Ht,St,Ge,vt){var Pe=xt(St.container,vt.serviceIdentifier),Te=[];return Pe.length===X.BindingCount.NoBindingsAvailable&&St.container.options.autoBindInjectable&&typeof vt.serviceIdentifier=="function"&&Ft.getConstructorMetadata(vt.serviceIdentifier).compilerGeneratedMetadata&&(St.container.bind(vt.serviceIdentifier).toSelf(),Pe=xt(St.container,vt.serviceIdentifier)),Ht?Te=Pe:Te=Pe.filter(function(ze){var bt=new Ie.Request(ze.serviceIdentifier,St,Ge,ze,vt);return ze.constraint(bt)}),Yt(vt.serviceIdentifier,Te,vt,St.container),Te}function Yt(Ft,Ht,St,Ge){switch(Ht.length){case X.BindingCount.NoBindingsAvailable:if(St.isOptional())return Ht;var vt=F.getServiceIdentifierAsString(Ft),Pe=b.NOT_REGISTERED;throw Pe+=F.listMetadataForTarget(vt,St),Pe+=F.listRegisteredBindingsForServiceIdentifier(Ge,vt,xt),new Error(Pe);case X.BindingCount.OnlyOneBindingAvailable:if(!St.isArray())return Ht;case X.BindingCount.MultipleBindingsAvailable:default:if(St.isArray())return Ht;var vt=F.getServiceIdentifierAsString(Ft),Pe=b.AMBIGUOUS_MATCH+" "+vt;throw Pe+=F.listRegisteredBindingsForServiceIdentifier(Ge,vt,xt),new Error(Pe)}}function lt(Ft,Ht,St,Ge,vt,Pe){var Te,ze;if(vt===null){Te=er(Ft,Ht,Ge,null,Pe),ze=new Ie.Request(St,Ge,null,Te,Pe);var bt=new Q.Plan(Ge,ze);Ge.addPlan(bt)}else Te=er(Ft,Ht,Ge,vt,Pe),ze=vt.addChildRequest(Pe.serviceIdentifier,Te,Pe);Te.forEach(function(cr){var ae=null;if(Pe.isArray())ae=ze.addChildRequest(cr.serviceIdentifier,cr,Pe);else{if(cr.cache)return;ae=ze}if(cr.type===p.BindingTypeEnum.Instance&&cr.implementationType!==null){var Ee=we.getDependencies(Ft,cr.implementationType);if(!Ge.container.options.skipBaseClassChecks){var le=we.getBaseClassDependencyCount(Ft,cr.implementationType);if(Ee.length<le){var re=b.ARGUMENTS_LENGTH_MISMATCH(we.getFunctionName(cr.implementationType));throw new Error(re)}}Ee.forEach(function(te){lt(Ft,!1,te.serviceIdentifier,Ge,ae,te)})}})}function xt(Ft,Ht){var St=[],Ge=Xe(Ft);return Ge.hasKey(Ht)?St=Ge.get(Ht):Ft.parent!==null&&(St=xt(Ft.parent,Ht)),St}function ct(Ft,Ht,St,Ge,vt,Pe,Te,ze){ze===void 0&&(ze=!1);var bt=new ie.Context(Ht),cr=Ut(St,Ge,vt,"",Pe,Te);try{return lt(Ft,ze,vt,bt,null,cr),bt}catch(ae){throw S.isStackOverflowExeption(ae)&&bt.plan&&F.circularDependencyToException(bt.plan.rootRequest),ae}}O.plan=ct;function Sr(Ft,Ht,St,Ge){var vt=new Be.Target(p.TargetTypeEnum.Variable,"",Ht,new fe.Metadata(St,Ge)),Pe=new ie.Context(Ft),Te=new Ie.Request(Ht,Pe,null,[],vt);return Te}O.createMockRequest=Sr},73653:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.QueryableString=void 0;var _=function(){function X(b){this.str=b}return X.prototype.startsWith=function(b){return this.str.indexOf(b)===0},X.prototype.endsWith=function(b){var p="",H=b.split("").reverse().join("");return p=this.str.split("").reverse().join(""),this.startsWith.call({str:p},H)},X.prototype.contains=function(b){return this.str.indexOf(b)!==-1},X.prototype.equals=function(b){return this.str===b},X.prototype.value=function(){return this.str},X}();O.QueryableString=_},68191:function(_t,O,_){"use strict";var X=this&&this.__spreadArray||function(er,Yt){for(var lt=0,xt=Yt.length,ct=er.length;lt<xt;lt++,ct++)er[ct]=Yt[lt];return er};Object.defineProperty(O,"__esModule",{value:!0}),O.getFunctionName=O.getBaseClassDependencyCount=O.getDependencies=void 0;var b=_(17395),p=_(55700),H=_(60442),S=_(67565),F=_(96814);Object.defineProperty(O,"getFunctionName",{enumerable:!0,get:function(){return F.getFunctionName}});var ie=_(58321);function fe(er,Yt){var lt=F.getFunctionName(Yt),xt=Q(er,lt,Yt,!1);return xt}O.getDependencies=fe;function Q(er,Yt,lt,xt){var ct=er.getConstructorMetadata(lt),Sr=ct.compilerGeneratedMetadata;if(Sr===void 0){var Ft=p.MISSING_INJECTABLE_ANNOTATION+" "+Yt+".";throw new Error(Ft)}var Ht=ct.userGeneratedMetadata,St=Object.keys(Ht),Ge=lt.length===0&&St.length>0,vt=St.length>lt.length,Pe=Ge||vt?St.length:lt.length,Te=Ie(xt,Yt,Sr,Ht,Pe),ze=Be(er,lt),bt=X(X([],Te),ze);return bt}function we(er,Yt,lt,xt,ct){var Sr=ct[er.toString()]||[],Ft=Ut(Sr),Ht=Ft.unmanaged!==!0,St=xt[er],Ge=Ft.inject||Ft.multiInject;if(St=Ge||St,St instanceof b.LazyServiceIdentifer&&(St=St.unwrap()),Ht){var vt=St===Object,Pe=St===Function,Te=St===void 0,ze=vt||Pe||Te;if(!Yt&&ze){var bt=p.MISSING_INJECT_ANNOTATION+" argument "+er+" in class "+lt+".";throw new Error(bt)}var cr=new ie.Target(H.TargetTypeEnum.ConstructorArgument,Ft.targetName,St);return cr.metadata=Sr,cr}return null}function Ie(er,Yt,lt,xt,ct){for(var Sr=[],Ft=0;Ft<ct;Ft++){var Ht=Ft,St=we(Ht,er,Yt,lt,xt);St!==null&&Sr.push(St)}return Sr}function Be(er,Yt){for(var lt=er.getPropertiesMetadata(Yt),xt=[],ct=Object.keys(lt),Sr=0,Ft=ct;Sr<Ft.length;Sr++){var Ht=Ft[Sr],St=lt[Ht],Ge=Ut(lt[Ht]),vt=Ge.targetName||Ht,Pe=Ge.inject||Ge.multiInject,Te=new ie.Target(H.TargetTypeEnum.ClassProperty,vt,Pe);Te.metadata=St,xt.push(Te)}var ze=Object.getPrototypeOf(Yt.prototype).constructor;if(ze!==Object){var bt=Be(er,ze);xt=X(X([],xt),bt)}return xt}function Xe(er,Yt){var lt=Object.getPrototypeOf(Yt.prototype).constructor;if(lt!==Object){var xt=F.getFunctionName(lt),ct=Q(er,xt,lt,!0),Sr=ct.map(function(St){return St.metadata.filter(function(Ge){return Ge.key===S.UNMANAGED_TAG})}),Ft=[].concat.apply([],Sr).length,Ht=ct.length-Ft;return Ht>0?Ht:Xe(er,lt)}else return 0}O.getBaseClassDependencyCount=Xe;function Ut(er){var Yt={};return er.forEach(function(lt){Yt[lt.key.toString()]=lt.value}),{inject:Yt[S.INJECT_TAG],multiInject:Yt[S.MULTI_INJECT_TAG],targetName:Yt[S.NAME_TAG],unmanaged:Yt[S.UNMANAGED_TAG]}}},63421:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Request=void 0;var X=_(21871),b=function(){function p(H,S,F,ie,fe){this.id=X.id(),this.serviceIdentifier=H,this.parentContext=S,this.parentRequest=F,this.target=fe,this.childRequests=[],this.bindings=Array.isArray(ie)?ie:[ie],this.requestScope=F===null?new Map:null}return p.prototype.addChildRequest=function(H,S,F){var ie=new p(H,this.parentContext,this,S,F);return this.childRequests.push(ie),ie},p}();O.Request=b},58321:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.Target=void 0;var X=_(67565),b=_(21871),p=_(55690),H=_(73653),S=function(){function F(ie,fe,Q,we){this.id=b.id(),this.type=ie,this.serviceIdentifier=Q,this.name=new H.QueryableString(fe||""),this.metadata=new Array;var Ie=null;typeof we=="string"?Ie=new p.Metadata(X.NAMED_TAG,we):we instanceof p.Metadata&&(Ie=we),Ie!==null&&this.metadata.push(Ie)}return F.prototype.hasTag=function(ie){for(var fe=0,Q=this.metadata;fe<Q.length;fe++){var we=Q[fe];if(we.key===ie)return!0}return!1},F.prototype.isArray=function(){return this.hasTag(X.MULTI_INJECT_TAG)},F.prototype.matchesArray=function(ie){return this.matchesTag(X.MULTI_INJECT_TAG)(ie)},F.prototype.isNamed=function(){return this.hasTag(X.NAMED_TAG)},F.prototype.isTagged=function(){return this.metadata.some(function(ie){return X.NON_CUSTOM_TAG_KEYS.every(function(fe){return ie.key!==fe})})},F.prototype.isOptional=function(){return this.matchesTag(X.OPTIONAL_TAG)(!0)},F.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(ie){return ie.key===X.NAMED_TAG})[0]:null},F.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(ie){return X.NON_CUSTOM_TAG_KEYS.every(function(fe){return ie.key!==fe})}):null},F.prototype.matchesNamedTag=function(ie){return this.matchesTag(X.NAMED_TAG)(ie)},F.prototype.matchesTag=function(ie){var fe=this;return function(Q){for(var we=0,Ie=fe.metadata;we<Ie.length;we++){var Be=Ie[we];if(Be.key===ie&&Be.value===Q)return!0}return!1}},F}();O.Target=S},8149:function(_t,O,_){"use strict";var X=this&&this.__spreadArray||function(Q,we){for(var Ie=0,Be=we.length,Xe=Q.length;Ie<Be;Ie++,Xe++)Q[Xe]=we[Ie];return Q};Object.defineProperty(O,"__esModule",{value:!0}),O.resolveInstance=void 0;var b=_(55700),p=_(60442),H=_(67565);function S(Q,we,Ie){var Be=we.filter(function(Ut){return Ut.target!==null&&Ut.target.type===p.TargetTypeEnum.ClassProperty}),Xe=Be.map(Ie);return Be.forEach(function(Ut,er){var Yt="";Yt=Ut.target.name.value();var lt=Xe[er];Q[Yt]=lt}),Q}function F(Q,we){return new(Q.bind.apply(Q,X([void 0],we)))}function ie(Q,we){if(Reflect.hasMetadata(H.POST_CONSTRUCT,Q)){var Ie=Reflect.getMetadata(H.POST_CONSTRUCT,Q);try{we[Ie.value]()}catch(Be){throw new Error(b.POST_CONSTRUCT_ERROR(Q.name,Be.message))}}}function fe(Q,we,Ie){var Be=null;if(we.length>0){var Xe=we.filter(function(er){return er.target!==null&&er.target.type===p.TargetTypeEnum.ConstructorArgument}),Ut=Xe.map(Ie);Be=F(Q,Ut),Be=S(Be,we,Ie)}else Be=new Q;return ie(Q,Be),Be}O.resolveInstance=fe},18129:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.resolve=void 0;var X=_(55700),b=_(60442),p=_(69993),H=_(96814),S=_(8149),F=function(we,Ie,Be){try{return Be()}catch(Xe){throw p.isStackOverflowExeption(Xe)?new Error(X.CIRCULAR_DEPENDENCY_IN_FACTORY(we,Ie.toString())):Xe}},ie=function Q(we){return function(Ie){Ie.parentContext.setCurrentRequest(Ie);var Be=Ie.bindings,Xe=Ie.childRequests,Ut=Ie.target&&Ie.target.isArray(),er=!Ie.parentRequest||!Ie.parentRequest.target||!Ie.target||!Ie.parentRequest.target.matchesArray(Ie.target.serviceIdentifier);if(Ut&&er)return Xe.map(function(Ft){var Ht=Q(we);return Ht(Ft)});var Yt=null;if(Ie.target.isOptional()&&Be.length===0)return;var lt=Be[0],xt=lt.scope===b.BindingScopeEnum.Singleton,ct=lt.scope===b.BindingScopeEnum.Request;if(xt&&lt.activated)return lt.cache;if(ct&&we!==null&&we.has(lt.id))return we.get(lt.id);if(lt.type===b.BindingTypeEnum.ConstantValue)Yt=lt.cache,lt.activated=!0;else if(lt.type===b.BindingTypeEnum.Function)Yt=lt.cache,lt.activated=!0;else if(lt.type===b.BindingTypeEnum.Constructor)Yt=lt.implementationType;else if(lt.type===b.BindingTypeEnum.DynamicValue&&lt.dynamicValue!==null)Yt=F("toDynamicValue",lt.serviceIdentifier,function(){return lt.dynamicValue(Ie.parentContext)});else if(lt.type===b.BindingTypeEnum.Factory&&lt.factory!==null)Yt=F("toFactory",lt.serviceIdentifier,function(){return lt.factory(Ie.parentContext)});else if(lt.type===b.BindingTypeEnum.Provider&&lt.provider!==null)Yt=F("toProvider",lt.serviceIdentifier,function(){return lt.provider(Ie.parentContext)});else if(lt.type===b.BindingTypeEnum.Instance&&lt.implementationType!==null)Yt=S.resolveInstance(lt.implementationType,Xe,Q(we));else{var Sr=H.getServiceIdentifierAsString(Ie.serviceIdentifier);throw new Error(X.INVALID_BINDING_TYPE+" "+Sr)}return typeof lt.onActivation=="function"&&(Yt=lt.onActivation(Ie.parentContext,Yt)),xt&&(lt.cache=Yt,lt.activated=!0),ct&&we!==null&&!we.has(lt.id)&&we.set(lt.id,Yt),Yt}};function fe(Q){var we=ie(Q.plan.rootRequest.requestScope);return we(Q.plan.rootRequest)}O.resolve=fe},21242:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.BindingInSyntax=void 0;var X=_(60442),b=_(39510),p=function(){function H(S){this._binding=S}return H.prototype.inRequestScope=function(){return this._binding.scope=X.BindingScopeEnum.Request,new b.BindingWhenOnSyntax(this._binding)},H.prototype.inSingletonScope=function(){return this._binding.scope=X.BindingScopeEnum.Singleton,new b.BindingWhenOnSyntax(this._binding)},H.prototype.inTransientScope=function(){return this._binding.scope=X.BindingScopeEnum.Transient,new b.BindingWhenOnSyntax(this._binding)},H}();O.BindingInSyntax=p},47644:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.BindingInWhenOnSyntax=void 0;var X=_(21242),b=_(32377),p=_(20740),H=function(){function S(F){this._binding=F,this._bindingWhenSyntax=new p.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new b.BindingOnSyntax(this._binding),this._bindingInSyntax=new X.BindingInSyntax(F)}return S.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},S.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},S.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},S.prototype.when=function(F){return this._bindingWhenSyntax.when(F)},S.prototype.whenTargetNamed=function(F){return this._bindingWhenSyntax.whenTargetNamed(F)},S.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},S.prototype.whenTargetTagged=function(F,ie){return this._bindingWhenSyntax.whenTargetTagged(F,ie)},S.prototype.whenInjectedInto=function(F){return this._bindingWhenSyntax.whenInjectedInto(F)},S.prototype.whenParentNamed=function(F){return this._bindingWhenSyntax.whenParentNamed(F)},S.prototype.whenParentTagged=function(F,ie){return this._bindingWhenSyntax.whenParentTagged(F,ie)},S.prototype.whenAnyAncestorIs=function(F){return this._bindingWhenSyntax.whenAnyAncestorIs(F)},S.prototype.whenNoAncestorIs=function(F){return this._bindingWhenSyntax.whenNoAncestorIs(F)},S.prototype.whenAnyAncestorNamed=function(F){return this._bindingWhenSyntax.whenAnyAncestorNamed(F)},S.prototype.whenAnyAncestorTagged=function(F,ie){return this._bindingWhenSyntax.whenAnyAncestorTagged(F,ie)},S.prototype.whenNoAncestorNamed=function(F){return this._bindingWhenSyntax.whenNoAncestorNamed(F)},S.prototype.whenNoAncestorTagged=function(F,ie){return this._bindingWhenSyntax.whenNoAncestorTagged(F,ie)},S.prototype.whenAnyAncestorMatches=function(F){return this._bindingWhenSyntax.whenAnyAncestorMatches(F)},S.prototype.whenNoAncestorMatches=function(F){return this._bindingWhenSyntax.whenNoAncestorMatches(F)},S.prototype.onActivation=function(F){return this._bindingOnSyntax.onActivation(F)},S}();O.BindingInWhenOnSyntax=H},32377:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.BindingOnSyntax=void 0;var X=_(20740),b=function(){function p(H){this._binding=H}return p.prototype.onActivation=function(H){return this._binding.onActivation=H,new X.BindingWhenSyntax(this._binding)},p}();O.BindingOnSyntax=b},24120:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.BindingToSyntax=void 0;var X=_(55700),b=_(60442),p=_(47644),H=_(39510),S=function(){function F(ie){this._binding=ie}return F.prototype.to=function(ie){return this._binding.type=b.BindingTypeEnum.Instance,this._binding.implementationType=ie,new p.BindingInWhenOnSyntax(this._binding)},F.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+X.INVALID_TO_SELF_VALUE);var ie=this._binding.serviceIdentifier;return this.to(ie)},F.prototype.toConstantValue=function(ie){return this._binding.type=b.BindingTypeEnum.ConstantValue,this._binding.cache=ie,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=b.BindingScopeEnum.Singleton,new H.BindingWhenOnSyntax(this._binding)},F.prototype.toDynamicValue=function(ie){return this._binding.type=b.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=ie,this._binding.implementationType=null,new p.BindingInWhenOnSyntax(this._binding)},F.prototype.toConstructor=function(ie){return this._binding.type=b.BindingTypeEnum.Constructor,this._binding.implementationType=ie,this._binding.scope=b.BindingScopeEnum.Singleton,new H.BindingWhenOnSyntax(this._binding)},F.prototype.toFactory=function(ie){return this._binding.type=b.BindingTypeEnum.Factory,this._binding.factory=ie,this._binding.scope=b.BindingScopeEnum.Singleton,new H.BindingWhenOnSyntax(this._binding)},F.prototype.toFunction=function(ie){if(typeof ie!="function")throw new Error(X.INVALID_FUNCTION_BINDING);var fe=this.toConstantValue(ie);return this._binding.type=b.BindingTypeEnum.Function,this._binding.scope=b.BindingScopeEnum.Singleton,fe},F.prototype.toAutoFactory=function(ie){return this._binding.type=b.BindingTypeEnum.Factory,this._binding.factory=function(fe){var Q=function(){return fe.container.get(ie)};return Q},this._binding.scope=b.BindingScopeEnum.Singleton,new H.BindingWhenOnSyntax(this._binding)},F.prototype.toProvider=function(ie){return this._binding.type=b.BindingTypeEnum.Provider,this._binding.provider=ie,this._binding.scope=b.BindingScopeEnum.Singleton,new H.BindingWhenOnSyntax(this._binding)},F.prototype.toService=function(ie){this.toDynamicValue(function(fe){return fe.container.get(ie)})},F}();O.BindingToSyntax=S},39510:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.BindingWhenOnSyntax=void 0;var X=_(32377),b=_(20740),p=function(){function H(S){this._binding=S,this._bindingWhenSyntax=new b.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new X.BindingOnSyntax(this._binding)}return H.prototype.when=function(S){return this._bindingWhenSyntax.when(S)},H.prototype.whenTargetNamed=function(S){return this._bindingWhenSyntax.whenTargetNamed(S)},H.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},H.prototype.whenTargetTagged=function(S,F){return this._bindingWhenSyntax.whenTargetTagged(S,F)},H.prototype.whenInjectedInto=function(S){return this._bindingWhenSyntax.whenInjectedInto(S)},H.prototype.whenParentNamed=function(S){return this._bindingWhenSyntax.whenParentNamed(S)},H.prototype.whenParentTagged=function(S,F){return this._bindingWhenSyntax.whenParentTagged(S,F)},H.prototype.whenAnyAncestorIs=function(S){return this._bindingWhenSyntax.whenAnyAncestorIs(S)},H.prototype.whenNoAncestorIs=function(S){return this._bindingWhenSyntax.whenNoAncestorIs(S)},H.prototype.whenAnyAncestorNamed=function(S){return this._bindingWhenSyntax.whenAnyAncestorNamed(S)},H.prototype.whenAnyAncestorTagged=function(S,F){return this._bindingWhenSyntax.whenAnyAncestorTagged(S,F)},H.prototype.whenNoAncestorNamed=function(S){return this._bindingWhenSyntax.whenNoAncestorNamed(S)},H.prototype.whenNoAncestorTagged=function(S,F){return this._bindingWhenSyntax.whenNoAncestorTagged(S,F)},H.prototype.whenAnyAncestorMatches=function(S){return this._bindingWhenSyntax.whenAnyAncestorMatches(S)},H.prototype.whenNoAncestorMatches=function(S){return this._bindingWhenSyntax.whenNoAncestorMatches(S)},H.prototype.onActivation=function(S){return this._bindingOnSyntax.onActivation(S)},H}();O.BindingWhenOnSyntax=p},20740:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.BindingWhenSyntax=void 0;var X=_(32377),b=_(95068),p=function(){function H(S){this._binding=S}return H.prototype.when=function(S){return this._binding.constraint=S,new X.BindingOnSyntax(this._binding)},H.prototype.whenTargetNamed=function(S){return this._binding.constraint=b.namedConstraint(S),new X.BindingOnSyntax(this._binding)},H.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(S){var F=S.target!==null&&!S.target.isNamed()&&!S.target.isTagged();return F},new X.BindingOnSyntax(this._binding)},H.prototype.whenTargetTagged=function(S,F){return this._binding.constraint=b.taggedConstraint(S)(F),new X.BindingOnSyntax(this._binding)},H.prototype.whenInjectedInto=function(S){return this._binding.constraint=function(F){return b.typeConstraint(S)(F.parentRequest)},new X.BindingOnSyntax(this._binding)},H.prototype.whenParentNamed=function(S){return this._binding.constraint=function(F){return b.namedConstraint(S)(F.parentRequest)},new X.BindingOnSyntax(this._binding)},H.prototype.whenParentTagged=function(S,F){return this._binding.constraint=function(ie){return b.taggedConstraint(S)(F)(ie.parentRequest)},new X.BindingOnSyntax(this._binding)},H.prototype.whenAnyAncestorIs=function(S){return this._binding.constraint=function(F){return b.traverseAncerstors(F,b.typeConstraint(S))},new X.BindingOnSyntax(this._binding)},H.prototype.whenNoAncestorIs=function(S){return this._binding.constraint=function(F){return!b.traverseAncerstors(F,b.typeConstraint(S))},new X.BindingOnSyntax(this._binding)},H.prototype.whenAnyAncestorNamed=function(S){return this._binding.constraint=function(F){return b.traverseAncerstors(F,b.namedConstraint(S))},new X.BindingOnSyntax(this._binding)},H.prototype.whenNoAncestorNamed=function(S){return this._binding.constraint=function(F){return!b.traverseAncerstors(F,b.namedConstraint(S))},new X.BindingOnSyntax(this._binding)},H.prototype.whenAnyAncestorTagged=function(S,F){return this._binding.constraint=function(ie){return b.traverseAncerstors(ie,b.taggedConstraint(S)(F))},new X.BindingOnSyntax(this._binding)},H.prototype.whenNoAncestorTagged=function(S,F){return this._binding.constraint=function(ie){return!b.traverseAncerstors(ie,b.taggedConstraint(S)(F))},new X.BindingOnSyntax(this._binding)},H.prototype.whenAnyAncestorMatches=function(S){return this._binding.constraint=function(F){return b.traverseAncerstors(F,S)},new X.BindingOnSyntax(this._binding)},H.prototype.whenNoAncestorMatches=function(S){return this._binding.constraint=function(F){return!b.traverseAncerstors(F,S)},new X.BindingOnSyntax(this._binding)},H}();O.BindingWhenSyntax=p},95068:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.typeConstraint=O.namedConstraint=O.taggedConstraint=O.traverseAncerstors=void 0;var X=_(67565),b=_(55690),p=function ie(fe,Q){var we=fe.parentRequest;return we!==null?Q(we)?!0:ie(we,Q):!1};O.traverseAncerstors=p;var H=function(fe){return function(Q){var we=function(Be){return Be!==null&&Be.target!==null&&Be.target.matchesTag(fe)(Q)};return we.metaData=new b.Metadata(fe,Q),we}};O.taggedConstraint=H;var S=H(X.NAMED_TAG);O.namedConstraint=S;var F=function(fe){return function(Q){var we=null;if(Q!==null)if(we=Q.bindings[0],typeof fe=="string"){var Ie=we.serviceIdentifier;return Ie===fe}else{var Be=Q.bindings[0].implementationType;return fe===Be}return!1}};O.typeConstraint=F},51119:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.multiBindToService=void 0;var _=function(b){return function(p){return function(){for(var H=[],S=0;S<arguments.length;S++)H[S]=arguments[S];return H.forEach(function(F){return b.bind(F).toService(p)})}}};O.multiBindToService=_},69993:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.isStackOverflowExeption=void 0;var X=_(55700);function b(p){return p instanceof RangeError||p.message===X.STACK_OVERFLOW}O.isStackOverflowExeption=b},21871:function(_t,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.id=void 0;var _=0;function X(){return _++}O.id=X},96814:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.circularDependencyToException=O.listMetadataForTarget=O.listRegisteredBindingsForServiceIdentifier=O.getServiceIdentifierAsString=O.getFunctionName=void 0;var X=_(55700);function b(Q){if(typeof Q=="function"){var we=Q;return we.name}else{if(typeof Q=="symbol")return Q.toString();var we=Q;return we}}O.getServiceIdentifierAsString=b;function p(Q,we,Ie){var Be="",Xe=Ie(Q,we);return Xe.length!==0&&(Be=`
Registered bindings:`,Xe.forEach(function(Ut){var er="Object";Ut.implementationType!==null&&(er=fe(Ut.implementationType)),Be=Be+`
 `+er,Ut.constraint.metaData&&(Be=Be+" - "+Ut.constraint.metaData)})),Be}O.listRegisteredBindingsForServiceIdentifier=p;function H(Q,we){return Q.parentRequest===null?!1:Q.parentRequest.serviceIdentifier===we?!0:H(Q.parentRequest,we)}function S(Q){function we(Be,Xe){Xe===void 0&&(Xe=[]);var Ut=b(Be.serviceIdentifier);return Xe.push(Ut),Be.parentRequest!==null?we(Be.parentRequest,Xe):Xe}var Ie=we(Q);return Ie.reverse().join(" --> ")}function F(Q){Q.childRequests.forEach(function(we){if(H(we,we.serviceIdentifier)){var Ie=S(we);throw new Error(X.CIRCULAR_DEPENDENCY+" "+Ie)}else F(we)})}O.circularDependencyToException=F;function ie(Q,we){if(we.isTagged()||we.isNamed()){var Ie="",Be=we.getNamedTag(),Xe=we.getCustomTags();return Be!==null&&(Ie+=Be.toString()+`
`),Xe!==null&&Xe.forEach(function(Ut){Ie+=Ut.toString()+`
`})," "+Q+`
 `+Q+" - "+Ie}else return" "+Q}O.listMetadataForTarget=ie;function fe(Q){if(Q.name)return Q.name;var we=Q.toString(),Ie=we.match(/^function\s*([^\s(]+)/);return Ie?Ie[1]:"Anonymous function: "+we}O.getFunctionName=fe},83772:function(_t){_t.exports=O;function O(_,X){X||(X=document);var b=X.head||X.getElementsByTagName("head")[0];if(!b){b=X.createElement("head");var p=X.body||X.getElementsByTagName("body")[0];p?p.parentNode.insertBefore(b,p):X.documentElement.appendChild(b)}var H=X.createElement("style");return H.type="text/css",H.styleSheet?H.styleSheet.cssText=_:H.appendChild(X.createTextNode(_)),b.appendChild(H),H}},54898:function(_t){var O=Array.isArray;_t.exports=O},19550:function(_t){function O(_){return _==null}_t.exports=O},48882:function(_t){var O="[object Object]";function _(Ie){var Be=!1;if(Ie!=null&&typeof Ie.toString!="function")try{Be=!!(Ie+"")}catch(Xe){}return Be}function X(Ie,Be){return function(Xe){return Ie(Be(Xe))}}var b=Function.prototype,p=Object.prototype,H=b.toString,S=p.hasOwnProperty,F=H.call(Object),ie=p.toString,fe=X(Object.getPrototypeOf,Object);function Q(Ie){return!!Ie&&typeof Ie=="object"}function we(Ie){if(!Q(Ie)||ie.call(Ie)!=O||_(Ie))return!1;var Be=fe(Ie);if(Be===null)return!0;var Xe=S.call(Be,"constructor")&&Be.constructor;return typeof Xe=="function"&&Xe instanceof Xe&&H.call(Xe)==F}_t.exports=we},55056:function(_t,O,_){_t=_.nmd(_t);var X=200,b="__lodash_hash_undefined__",p=800,H=16,S=9007199254740991,F="[object Arguments]",ie="[object Array]",fe="[object AsyncFunction]",Q="[object Boolean]",we="[object Date]",Ie="[object Error]",Be="[object Function]",Xe="[object GeneratorFunction]",Ut="[object Map]",er="[object Number]",Yt="[object Null]",lt="[object Object]",xt="[object Proxy]",ct="[object RegExp]",Sr="[object Set]",Ft="[object String]",Ht="[object Undefined]",St="[object WeakMap]",Ge="[object ArrayBuffer]",vt="[object DataView]",Pe="[object Float32Array]",Te="[object Float64Array]",ze="[object Int8Array]",bt="[object Int16Array]",cr="[object Int32Array]",ae="[object Uint8Array]",Ee="[object Uint8ClampedArray]",le="[object Uint16Array]",re="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,ke=/^\[object .+?Constructor\]$/,nt=/^(?:0|[1-9]\d*)$/,Kt={};Kt[Pe]=Kt[Te]=Kt[ze]=Kt[bt]=Kt[cr]=Kt[ae]=Kt[Ee]=Kt[le]=Kt[re]=!0,Kt[F]=Kt[ie]=Kt[Ge]=Kt[Q]=Kt[vt]=Kt[we]=Kt[Ie]=Kt[Be]=Kt[Ut]=Kt[er]=Kt[lt]=Kt[ct]=Kt[Sr]=Kt[Ft]=Kt[St]=!1;var Ir=typeof _.g=="object"&&_.g&&_.g.Object===Object&&_.g,Lr=typeof self=="object"&&self&&self.Object===Object&&self,qr=Ir||Lr||Function("return this")(),tr=O&&!O.nodeType&&O,ce=tr&&!0&&_t&&!_t.nodeType&&_t,ye=ce&&ce.exports===tr,Re=ye&&Ir.process,Qe=function(){try{var Ze=ce&&ce.require&&ce.require("util").types;return Ze||Re&&Re.binding&&Re.binding("util")}catch(Nt){}}(),Dt=Qe&&Qe.isTypedArray;function Ct(Ze,Nt,mr){switch(mr.length){case 0:return Ze.call(Nt);case 1:return Ze.call(Nt,mr[0]);case 2:return Ze.call(Nt,mr[0],mr[1]);case 3:return Ze.call(Nt,mr[0],mr[1],mr[2])}return Ze.apply(Nt,mr)}function A(Ze,Nt){for(var mr=-1,zn=Array(Ze);++mr<Ze;)zn[mr]=Nt(mr);return zn}function z(Ze){return function(Nt){return Ze(Nt)}}function ve(Ze,Nt){return Ze==null?void 0:Ze[Nt]}function Ce(Ze,Nt){return function(mr){return Ze(Nt(mr))}}var $e=Array.prototype,ot=Function.prototype,Ot=Object.prototype,G=qr["__core-js_shared__"],Et=ot.toString,Bt=Ot.hasOwnProperty,dr=function(){var Ze=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||"");return Ze?"Symbol(src)_1."+Ze:""}(),wr=Ot.toString,Tr=Et.call(Object),Or=RegExp("^"+Et.call(Bt).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=ye?qr.Buffer:void 0,yt=qr.Symbol,dt=qr.Uint8Array,lr=qe?qe.allocUnsafe:void 0,Kr=Ce(Object.getPrototypeOf,Object),gt=Object.create,Rt=Ot.propertyIsEnumerable,sr=$e.splice,ar=yt?yt.toStringTag:void 0,_n=function(){try{var Ze=os(Object,"defineProperty");return Ze({},"",{}),Ze}catch(Nt){}}(),xn=qe?qe.isBuffer:void 0,ci=Math.max,_i=Date.now,Ui=os(qr,"Map"),Xi=os(Object,"create"),oi=function(){function Ze(){}return function(Nt){if(!$n(Nt))return{};if(gt)return gt(Nt);Ze.prototype=Nt;var mr=new Ze;return Ze.prototype=void 0,mr}}();function K(Ze){var Nt=-1,mr=Ze==null?0:Ze.length;for(this.clear();++Nt<mr;){var zn=Ze[Nt];this.set(zn[0],zn[1])}}function I(){this.__data__=Xi?Xi(null):{},this.size=0}function j(Ze){var Nt=this.has(Ze)&&delete this.__data__[Ze];return this.size-=Nt?1:0,Nt}function Y(Ze){var Nt=this.__data__;if(Xi){var mr=Nt[Ze];return mr===b?void 0:mr}return Bt.call(Nt,Ze)?Nt[Ze]:void 0}function ue(Ze){var Nt=this.__data__;return Xi?Nt[Ze]!==void 0:Bt.call(Nt,Ze)}function Le(Ze,Nt){var mr=this.__data__;return this.size+=this.has(Ze)?0:1,mr[Ze]=Xi&&Nt===void 0?b:Nt,this}K.prototype.clear=I,K.prototype.delete=j,K.prototype.get=Y,K.prototype.has=ue,K.prototype.set=Le;function Me(Ze){var Nt=-1,mr=Ze==null?0:Ze.length;for(this.clear();++Nt<mr;){var zn=Ze[Nt];this.set(zn[0],zn[1])}}function se(){this.__data__=[],this.size=0}function Ne(Ze){var Nt=this.__data__,mr=bo(Nt,Ze);if(mr<0)return!1;var zn=Nt.length-1;return mr==zn?Nt.pop():sr.call(Nt,mr,1),--this.size,!0}function At(Ze){var Nt=this.__data__,mr=bo(Nt,Ze);return mr<0?void 0:Nt[mr][1]}function Dr(Ze){return bo(this.__data__,Ze)>-1}function Ur(Ze,Nt){var mr=this.__data__,zn=bo(mr,Ze);return zn<0?(++this.size,mr.push([Ze,Nt])):mr[zn][1]=Nt,this}Me.prototype.clear=se,Me.prototype.delete=Ne,Me.prototype.get=At,Me.prototype.has=Dr,Me.prototype.set=Ur;function Xt(Ze){var Nt=-1,mr=Ze==null?0:Ze.length;for(this.clear();++Nt<mr;){var zn=Ze[Nt];this.set(zn[0],zn[1])}}function zr(){this.size=0,this.__data__={hash:new K,map:new(Ui||Me),string:new K}}function On(Ze){var Nt=xa(this,Ze).delete(Ze);return this.size-=Nt?1:0,Nt}function vn(Ze){return xa(this,Ze).get(Ze)}function hr(Ze){return xa(this,Ze).has(Ze)}function pn(Ze,Nt){var mr=xa(this,Ze),zn=mr.size;return mr.set(Ze,Nt),this.size+=mr.size==zn?0:1,this}Xt.prototype.clear=zr,Xt.prototype.delete=On,Xt.prototype.get=vn,Xt.prototype.has=hr,Xt.prototype.set=pn;function un(Ze){var Nt=this.__data__=new Me(Ze);this.size=Nt.size}function fn(){this.__data__=new Me,this.size=0}function hi(Ze){var Nt=this.__data__,mr=Nt.delete(Ze);return this.size=Nt.size,mr}function Jr(Ze){return this.__data__.get(Ze)}function vi(Ze){return this.__data__.has(Ze)}function Li(Ze,Nt){var mr=this.__data__;if(mr instanceof Me){var zn=mr.__data__;if(!Ui||zn.length<X-1)return zn.push([Ze,Nt]),this.size=++mr.size,this;mr=this.__data__=new Xt(zn)}return mr.set(Ze,Nt),this.size=mr.size,this}un.prototype.clear=fn,un.prototype.delete=hi,un.prototype.get=Jr,un.prototype.has=vi,un.prototype.set=Li;function Qn(Ze,Nt){var mr=Ia(Ze),zn=!mr&&va(Ze),oa=!mr&&!zn&&wl(Ze),Sa=!mr&&!zn&&!oa&&Wa(Ze),wa=mr||zn||oa||Sa,sa=wa?A(Ze.length,String):[],Ta=sa.length;for(var ss in Ze)(Nt||Bt.call(Ze,ss))&&!(wa&&(ss=="length"||oa&&(ss=="offset"||ss=="parent")||Sa&&(ss=="buffer"||ss=="byteLength"||ss=="byteOffset")||Jo(ss,Ta)))&&sa.push(ss);return sa}function xi(Ze,Nt,mr){(mr!==void 0&&!Ma(Ze[Nt],mr)||mr===void 0&&!(Nt in Ze))&&ki(Ze,Nt,mr)}function Ti(Ze,Nt,mr){var zn=Ze[Nt];(!(Bt.call(Ze,Nt)&&Ma(zn,mr))||mr===void 0&&!(Nt in Ze))&&ki(Ze,Nt,mr)}function bo(Ze,Nt){for(var mr=Ze.length;mr--;)if(Ma(Ze[mr][0],Nt))return mr;return-1}function ki(Ze,Nt,mr){Nt=="__proto__"&&_n?_n(Ze,Nt,{configurable:!0,enumerable:!0,value:mr,writable:!0}):Ze[Nt]=mr}var si=Ua();function Rn(Ze){return Ze==null?Ze===void 0?Ht:Yt:ar&&ar in Object(Ze)?$o(Ze):Ye(Ze)}function Ri(Ze){return js(Ze)&&Rn(Ze)==F}function Zn(Ze){if(!$n(Ze)||pa(Ze))return!1;var Nt=Po(Ze)?Or:ke;return Nt.test(ya(Ze))}function za(Ze){return js(Ze)&&ba(Ze.length)&&!!Kt[Rn(Ze)]}function ys(Ze){if(!$n(Ze))return pe(Ze);var Nt=rt(Ze),mr=[];for(var zn in Ze)zn=="constructor"&&(Nt||!Bt.call(Ze,zn))||mr.push(zn);return mr}function Fi(Ze,Nt,mr,zn,oa){Ze!==Nt&&si(Nt,function(Sa,wa){if(oa||(oa=new un),$n(Sa))ha(Ze,Nt,wa,mr,Fi,zn,oa);else{var sa=zn?zn(Zr(Ze,wa),Sa,wa+"",Ze,Nt,oa):void 0;sa===void 0&&(sa=Sa),xi(Ze,wa,sa)}},Wo)}function ha(Ze,Nt,mr,zn,oa,Sa,wa){var sa=Zr(Ze,mr),Ta=Zr(Nt,mr),ss=wa.get(Ta);if(ss){xi(Ze,mr,ss);return}var As=Sa?Sa(sa,Ta,mr+"",Ze,Nt,wa):void 0,ja=As===void 0;if(ja){var Xl=Ia(Ta),Su=!Xl&&wl(Ta),us=!Xl&&!Su&&Wa(Ta);As=Ta,Xl||Su||us?Ia(sa)?As=sa:$u(sa)?As=Ba(sa):Su?(ja=!1,As=mi(Ta,!0)):us?(ja=!1,As=Na(Ta,!0)):As=[]:Ho(Ta)||va(Ta)?(As=sa,va(sa)?As=Xa(sa):(!$n(sa)||Po(sa))&&(As=El(Ta))):ja=!1}ja&&(wa.set(Ta,As),oa(As,Ta,zn,Sa,wa),wa.delete(Ta)),xi(Ze,mr,As)}function Sl(Ze,Nt){return nn(Qt(Ze,Nt,Il),Ze+"")}var Ga=_n?function(Ze,Nt){return _n(Ze,"toString",{configurable:!0,enumerable:!1,value:bu(Nt),writable:!0})}:Il;function mi(Ze,Nt){if(Nt)return Ze.slice();var mr=Ze.length,zn=lr?lr(mr):new Ze.constructor(mr);return Ze.copy(zn),zn}function ro(Ze){var Nt=new Ze.constructor(Ze.byteLength);return new dt(Nt).set(new dt(Ze)),Nt}function Na(Ze,Nt){var mr=Nt?ro(Ze.buffer):Ze.buffer;return new Ze.constructor(mr,Ze.byteOffset,Ze.length)}function Ba(Ze,Nt){var mr=-1,zn=Ze.length;for(Nt||(Nt=Array(zn));++mr<zn;)Nt[mr]=Ze[mr];return Nt}function Go(Ze,Nt,mr,zn){var oa=!mr;mr||(mr={});for(var Sa=-1,wa=Nt.length;++Sa<wa;){var sa=Nt[Sa],Ta=zn?zn(mr[sa],Ze[sa],sa,mr,Ze):void 0;Ta===void 0&&(Ta=Ze[sa]),oa?ki(mr,sa,Ta):Ti(mr,sa,Ta)}return mr}function ta(Ze){return Sl(function(Nt,mr){var zn=-1,oa=mr.length,Sa=oa>1?mr[oa-1]:void 0,wa=oa>2?mr[2]:void 0;for(Sa=Ze.length>3&&typeof Sa=="function"?(oa--,Sa):void 0,wa&&Pa(mr[0],mr[1],wa)&&(Sa=oa<3?void 0:Sa,oa=1),Nt=Object(Nt);++zn<oa;){var sa=mr[zn];sa&&Ze(Nt,sa,zn,Sa)}return Nt})}function Ua(Ze){return function(Nt,mr,zn){for(var oa=-1,Sa=Object(Nt),wa=zn(Nt),sa=wa.length;sa--;){var Ta=wa[Ze?sa:++oa];if(mr(Sa[Ta],Ta,Sa)===!1)break}return Nt}}function xa(Ze,Nt){var mr=Ze.__data__;return Ha(Nt)?mr[typeof Nt=="string"?"string":"hash"]:mr.map}function os(Ze,Nt){var mr=ve(Ze,Nt);return Zn(mr)?mr:void 0}function $o(Ze){var Nt=Bt.call(Ze,ar),mr=Ze[ar];try{Ze[ar]=void 0;var zn=!0}catch(Sa){}var oa=wr.call(Ze);return zn&&(Nt?Ze[ar]=mr:delete Ze[ar]),oa}function El(Ze){return typeof Ze.constructor=="function"&&!rt(Ze)?oi(Kr(Ze)):{}}function Jo(Ze,Nt){var mr=typeof Ze;return Nt=Nt==null?S:Nt,!!Nt&&(mr=="number"||mr!="symbol"&&nt.test(Ze))&&Ze>-1&&Ze%1==0&&Ze<Nt}function Pa(Ze,Nt,mr){if(!$n(mr))return!1;var zn=typeof Nt;return(zn=="number"?Fu(mr)&&Jo(Nt,mr.length):zn=="string"&&Nt in mr)?Ma(mr[Nt],Ze):!1}function Ha(Ze){var Nt=typeof Ze;return Nt=="string"||Nt=="number"||Nt=="symbol"||Nt=="boolean"?Ze!=="__proto__":Ze===null}function pa(Ze){return!!dr&&dr in Ze}function rt(Ze){var Nt=Ze&&Ze.constructor,mr=typeof Nt=="function"&&Nt.prototype||Ot;return Ze===mr}function pe(Ze){var Nt=[];if(Ze!=null)for(var mr in Object(Ze))Nt.push(mr);return Nt}function Ye(Ze){return wr.call(Ze)}function Qt(Ze,Nt,mr){return Nt=ci(Nt===void 0?Ze.length-1:Nt,0),function(){for(var zn=arguments,oa=-1,Sa=ci(zn.length-Nt,0),wa=Array(Sa);++oa<Sa;)wa[oa]=zn[Nt+oa];oa=-1;for(var sa=Array(Nt+1);++oa<Nt;)sa[oa]=zn[oa];return sa[Nt]=mr(wa),Ct(Ze,this,sa)}}function Zr(Ze,Nt){if(!(Nt==="constructor"&&typeof Ze[Nt]=="function")&&Nt!="__proto__")return Ze[Nt]}var nn=Ai(Ga);function Ai(Ze){var Nt=0,mr=0;return function(){var zn=_i(),oa=H-(zn-mr);if(mr=zn,oa>0){if(++Nt>=p)return arguments[0]}else Nt=0;return Ze.apply(void 0,arguments)}}function ya(Ze){if(Ze!=null){try{return Et.call(Ze)}catch(Nt){}try{return Ze+""}catch(Nt){}}return""}function Ma(Ze,Nt){return Ze===Nt||Ze!==Ze&&Nt!==Nt}var va=Ri(function(){return arguments}())?Ri:function(Ze){return js(Ze)&&Bt.call(Ze,"callee")&&!Rt.call(Ze,"callee")},Ia=Array.isArray;function Fu(Ze){return Ze!=null&&ba(Ze.length)&&!Po(Ze)}function $u(Ze){return js(Ze)&&Fu(Ze)}var wl=xn||So;function Po(Ze){if(!$n(Ze))return!1;var Nt=Rn(Ze);return Nt==Be||Nt==Xe||Nt==fe||Nt==xt}function ba(Ze){return typeof Ze=="number"&&Ze>-1&&Ze%1==0&&Ze<=S}function $n(Ze){var Nt=typeof Ze;return Ze!=null&&(Nt=="object"||Nt=="function")}function js(Ze){return Ze!=null&&typeof Ze=="object"}function Ho(Ze){if(!js(Ze)||Rn(Ze)!=lt)return!1;var Nt=Kr(Ze);if(Nt===null)return!0;var mr=Bt.call(Nt,"constructor")&&Nt.constructor;return typeof mr=="function"&&mr instanceof mr&&Et.call(mr)==Tr}var Wa=Dt?z(Dt):za;function Xa(Ze){return Go(Ze,Wo(Ze))}function Wo(Ze){return Fu(Ze)?Qn(Ze,!0):ys(Ze)}var Ya=ta(function(Ze,Nt,mr,zn){Fi(Ze,Nt,mr,zn)});function bu(Ze){return function(){return Ze}}function Il(Ze){return Ze}function So(){return!1}_t.exports=Ya},73634:function(_t,O,_){var X=200,b="__lodash_hash_undefined__",p=1/0,H="[object Function]",S="[object GeneratorFunction]",F=/[\\^$.*+?()[\]{}|]/g,ie=/^\[object .+?Constructor\]$/,fe=typeof _.g=="object"&&_.g&&_.g.Object===Object&&_.g,Q=typeof self=="object"&&self&&self.Object===Object&&self,we=fe||Q||Function("return this")();function Ie(gt,Rt){var sr=gt?gt.length:0;return!!sr&&Ut(gt,Rt,0)>-1}function Be(gt,Rt,sr){for(var ar=-1,_n=gt?gt.length:0;++ar<_n;)if(sr(Rt,gt[ar]))return!0;return!1}function Xe(gt,Rt,sr,ar){for(var _n=gt.length,xn=sr+(ar?1:-1);ar?xn--:++xn<_n;)if(Rt(gt[xn],xn,gt))return xn;return-1}function Ut(gt,Rt,sr){if(Rt!==Rt)return Xe(gt,er,sr);for(var ar=sr-1,_n=gt.length;++ar<_n;)if(gt[ar]===Rt)return ar;return-1}function er(gt){return gt!==gt}function Yt(gt,Rt){return gt.has(Rt)}function lt(gt,Rt){return gt==null?void 0:gt[Rt]}function xt(gt){var Rt=!1;if(gt!=null&&typeof gt.toString!="function")try{Rt=!!(gt+"")}catch(sr){}return Rt}function ct(gt){var Rt=-1,sr=Array(gt.size);return gt.forEach(function(ar){sr[++Rt]=ar}),sr}var Sr=Array.prototype,Ft=Function.prototype,Ht=Object.prototype,St=we["__core-js_shared__"],Ge=function(){var gt=/[^.]+$/.exec(St&&St.keys&&St.keys.IE_PROTO||"");return gt?"Symbol(src)_1."+gt:""}(),vt=Ft.toString,Pe=Ht.hasOwnProperty,Te=Ht.toString,ze=RegExp("^"+vt.call(Pe).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bt=Sr.splice,cr=dr(we,"Map"),ae=dr(we,"Set"),Ee=dr(Object,"create");function le(gt){var Rt=-1,sr=gt?gt.length:0;for(this.clear();++Rt<sr;){var ar=gt[Rt];this.set(ar[0],ar[1])}}function re(){this.__data__=Ee?Ee(null):{}}function te(gt){return this.has(gt)&&delete this.__data__[gt]}function ke(gt){var Rt=this.__data__;if(Ee){var sr=Rt[gt];return sr===b?void 0:sr}return Pe.call(Rt,gt)?Rt[gt]:void 0}function nt(gt){var Rt=this.__data__;return Ee?Rt[gt]!==void 0:Pe.call(Rt,gt)}function Kt(gt,Rt){var sr=this.__data__;return sr[gt]=Ee&&Rt===void 0?b:Rt,this}le.prototype.clear=re,le.prototype.delete=te,le.prototype.get=ke,le.prototype.has=nt,le.prototype.set=Kt;function Ir(gt){var Rt=-1,sr=gt?gt.length:0;for(this.clear();++Rt<sr;){var ar=gt[Rt];this.set(ar[0],ar[1])}}function Lr(){this.__data__=[]}function qr(gt){var Rt=this.__data__,sr=ot(Rt,gt);if(sr<0)return!1;var ar=Rt.length-1;return sr==ar?Rt.pop():bt.call(Rt,sr,1),!0}function tr(gt){var Rt=this.__data__,sr=ot(Rt,gt);return sr<0?void 0:Rt[sr][1]}function ce(gt){return ot(this.__data__,gt)>-1}function ye(gt,Rt){var sr=this.__data__,ar=ot(sr,gt);return ar<0?sr.push([gt,Rt]):sr[ar][1]=Rt,this}Ir.prototype.clear=Lr,Ir.prototype.delete=qr,Ir.prototype.get=tr,Ir.prototype.has=ce,Ir.prototype.set=ye;function Re(gt){var Rt=-1,sr=gt?gt.length:0;for(this.clear();++Rt<sr;){var ar=gt[Rt];this.set(ar[0],ar[1])}}function Qe(){this.__data__={hash:new le,map:new(cr||Ir),string:new le}}function Dt(gt){return Bt(this,gt).delete(gt)}function Ct(gt){return Bt(this,gt).get(gt)}function A(gt){return Bt(this,gt).has(gt)}function z(gt,Rt){return Bt(this,gt).set(gt,Rt),this}Re.prototype.clear=Qe,Re.prototype.delete=Dt,Re.prototype.get=Ct,Re.prototype.has=A,Re.prototype.set=z;function ve(gt){var Rt=-1,sr=gt?gt.length:0;for(this.__data__=new Re;++Rt<sr;)this.add(gt[Rt])}function Ce(gt){return this.__data__.set(gt,b),this}function $e(gt){return this.__data__.has(gt)}ve.prototype.add=ve.prototype.push=Ce,ve.prototype.has=$e;function ot(gt,Rt){for(var sr=gt.length;sr--;)if(yt(gt[sr][0],Rt))return sr;return-1}function Ot(gt){if(!lr(gt)||Tr(gt))return!1;var Rt=dt(gt)||xt(gt)?ze:ie;return Rt.test(Or(gt))}function G(gt,Rt,sr){var ar=-1,_n=Ie,xn=gt.length,ci=!0,_i=[],Ui=_i;if(sr)ci=!1,_n=Be;else if(xn>=X){var Xi=Rt?null:Et(gt);if(Xi)return ct(Xi);ci=!1,_n=Yt,Ui=new ve}else Ui=Rt?[]:_i;e:for(;++ar<xn;){var oi=gt[ar],K=Rt?Rt(oi):oi;if(oi=sr||oi!==0?oi:0,ci&&K===K){for(var I=Ui.length;I--;)if(Ui[I]===K)continue e;Rt&&Ui.push(K),_i.push(oi)}else _n(Ui,K,sr)||(Ui!==_i&&Ui.push(K),_i.push(oi))}return _i}var Et=ae&&1/ct(new ae([,-0]))[1]==p?function(gt){return new ae(gt)}:Kr;function Bt(gt,Rt){var sr=gt.__data__;return wr(Rt)?sr[typeof Rt=="string"?"string":"hash"]:sr.map}function dr(gt,Rt){var sr=lt(gt,Rt);return Ot(sr)?sr:void 0}function wr(gt){var Rt=typeof gt;return Rt=="string"||Rt=="number"||Rt=="symbol"||Rt=="boolean"?gt!=="__proto__":gt===null}function Tr(gt){return!!Ge&&Ge in gt}function Or(gt){if(gt!=null){try{return vt.call(gt)}catch(Rt){}try{return gt+""}catch(Rt){}}return""}function qe(gt){return gt&&gt.length?G(gt):[]}function yt(gt,Rt){return gt===Rt||gt!==gt&&Rt!==Rt}function dt(gt){var Rt=lr(gt)?Te.call(gt):"";return Rt==H||Rt==S}function lr(gt){var Rt=typeof gt;return!!gt&&(Rt=="object"||Rt=="function")}function Kr(){}_t.exports=qe},19020:function(_t){(function(O,_){_t.exports=_()})(this,function(){"use strict";var O,_,X;function b(p,H){if(!O)O=H;else if(!_)_=H;else{var S="var sharedChunk = {}; ("+O+")(sharedChunk); ("+_+")(sharedChunk);",F={};O(F),X=H(F),typeof window!="undefined"&&(X.workerUrl=window.URL.createObjectURL(new Blob([S],{type:"text/javascript"})))}}return b(["exports"],function(p){"use strict";function H(e,t){return e(t={exports:{}},t.exports),t.exports}var S=F;function F(e,t,r,f){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(f-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=f,this.p2x=r,this.p2y=f}F.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},F.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},F.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},F.prototype.solveCurveX=function(e,t){var r,f,v,m,x;for(t===void 0&&(t=1e-6),v=e,x=0;x<8;x++){if(m=this.sampleCurveX(v)-e,Math.abs(m)<t)return v;var T=this.sampleCurveDerivativeX(v);if(Math.abs(T)<1e-6)break;v-=m/T}if((v=e)<(r=0))return r;if(v>(f=1))return f;for(;r<f;){if(m=this.sampleCurveX(v),Math.abs(m-e)<t)return v;e>m?r=v:f=v,v=.5*(f-r)+r}return v},F.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var ie=fe;function fe(e,t){this.x=e,this.y=t}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,f=t.y-this.y;return r*r+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),f=Math.sin(t),v=f*this.x+r*this.y;return this.x=r*this.x-f*this.y,this.y=v,this},_rotateAround:function(t,r){var f=Math.cos(t),v=Math.sin(t),m=r.y+v*(this.x-r.x)+f*(this.y-r.y);return this.x=r.x+f*(this.x-r.x)-v*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fe.convert=function(e){return e instanceof fe?e:Array.isArray(e)?new fe(e[0],e[1]):e};var Q=typeof self!="undefined"?self:{},we=Math.pow(2,53)-1;function Ie(e,t,r,f){var v=new S(e,t,r,f);return function(m){return v.solve(m)}}var Be=Ie(.25,.1,.25,1);function Xe(e,t,r){return Math.min(r,Math.max(t,e))}function Ut(e,t,r){var f=r-t,v=((e-t)%f+f)%f+t;return v===t?r:v}function er(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var f=0,v=t;f<v.length;f+=1){var m=v[f];for(var x in m)e[x]=m[x]}return e}var Yt=1;function lt(){return Yt++}function xt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function ct(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Sr(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function Ft(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ht(e,t,r){var f={};for(var v in e)f[v]=t.call(r||this,e[v],v,e);return f}function St(e,t,r){var f={};for(var v in e)t.call(r||this,e[v],v,e)&&(f[v]=e[v]);return f}function Ge(e){return Array.isArray(e)?e.map(Ge):typeof e=="object"&&e?Ht(e,Ge):e}var vt={};function Pe(e){vt[e]||(typeof console!="undefined"&&console.warn(e),vt[e]=!0)}function Te(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function ze(e){for(var t=0,r=0,f=e.length,v=f-1,m=void 0,x=void 0;r<f;v=r++)t+=((x=e[v]).x-(m=e[r]).x)*(m.y+x.y);return t}function bt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function cr(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(f,v,m,x){var T=m||x;return t[v]=!T||T.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var ae=null;function Ee(e){if(ae==null){var t=e.navigator?e.navigator.userAgent:null;ae=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ae}function le(e){try{var t=Q[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var re,te,ke,nt,Kt=Q.performance&&Q.performance.now?Q.performance.now.bind(Q.performance):Date.now.bind(Date),Ir=Q.requestAnimationFrame||Q.mozRequestAnimationFrame||Q.webkitRequestAnimationFrame||Q.msRequestAnimationFrame,Lr=Q.cancelAnimationFrame||Q.mozCancelAnimationFrame||Q.webkitCancelAnimationFrame||Q.msCancelAnimationFrame,qr={now:Kt,frame:function(t){var r=Ir(t);return{cancel:function(){return Lr(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var f=Q.document.createElement("canvas"),v=f.getContext("2d");if(!v)throw new Error("failed to create canvas 2d context");return f.width=t.width,f.height=t.height,v.drawImage(t,0,0,t.width,t.height),v.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return re||(re=Q.document.createElement("a")),re.href=t,re.href},hardwareConcurrency:Q.navigator&&Q.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Q.devicePixelRatio},get prefersReducedMotion(){return!!Q.matchMedia&&(te==null&&(te=Q.matchMedia("(prefers-reduced-motion: reduce)")),te.matches)}},tr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ce={supported:!1,testSupport:function(t){!ye&&nt&&(Re?Qe(t):ke=t)}},ye=!1,Re=!1;function Qe(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,nt),e.isContextLost())return;ce.supported=!0}catch(r){}e.deleteTexture(t),ye=!0}Q.document&&((nt=Q.document.createElement("img")).onload=function(){ke&&Qe(ke),ke=null,Re=!0},nt.onerror=function(){ye=!0,ke=null},nt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Dt="01",Ct=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function A(e){return e.indexOf("mapbox:")===0}Ct.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Dt,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Ct.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ct.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Ct.prototype.normalizeStyleURL=function(e,t){if(!A(e))return e;var r=$e(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Ct.prototype.normalizeGlyphsURL=function(e,t){if(!A(e))return e;var r=$e(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Ct.prototype.normalizeSourceURL=function(e,t){if(!A(e))return e;var r=$e(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},Ct.prototype.normalizeSpriteURL=function(e,t,r,f){var v=$e(e);return A(e)?(v.path="/styles/v1"+v.path+"/sprite"+t+r,this._makeAPIURL(v,this._customAccessToken||f)):(v.path+=""+t+r,ot(v))},Ct.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!A(e))return e;var r=$e(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(qr.devicePixelRatio>=2||t===512?"@2x":"")+(ce.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var f=this._customAccessToken||function(v){for(var m=0,x=v;m<x.length;m+=1){var T=x[m].match(/^access_token=(.*)$/);if(T)return T[1]}return null}(r.params)||tr.ACCESS_TOKEN;return tr.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,f)},Ct.prototype.canonicalizeTileURL=function(e,t){var r=$e(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var f="mapbox://tiles/";f+=r.path.replace("/v4/","");var v=r.params;return t&&(v=v.filter(function(m){return!m.match(/^access_token=/)})),v.length&&(f+="?"+v.join("&")),f},Ct.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&A(t),f=[],v=0,m=e.tiles||[];v<m.length;v+=1){var x=m[v];ve(x)?f.push(this.canonicalizeTileURL(x,r)):f.push(x)}return f},Ct.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",f=$e(tr.API_URL);if(e.protocol=f.protocol,e.authority=f.authority,e.protocol==="http"){var v=e.params.indexOf("secure");v>=0&&e.params.splice(v,1)}if(f.path!=="/"&&(e.path=""+f.path+e.path),!tr.REQUIRE_ACCESS_TOKEN)return ot(e);if(!(t=t||tr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),ot(e)};var z=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ve(e){return z.test(e)}var Ce=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $e(e){var t=e.match(Ce);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ot(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ot(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(Q.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var G=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};G.prototype.getStorageKey=function(e){var t,r=Ot(tr.ACCESS_TOKEN);return t=r&&r.u?Q.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(f,v){return String.fromCharCode(Number("0x"+v))})):tr.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},G.prototype.fetchEventData=function(){var e=le("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var f=Q.localStorage.getItem(t);f&&(this.eventData=JSON.parse(f));var v=Q.localStorage.getItem(r);v&&(this.anonId=v)}catch(m){Pe("Unable to read from LocalStorage")}},G.prototype.saveEventData=function(){var e=le("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{Q.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&Q.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(f){Pe("Unable to write to LocalStorage")}},G.prototype.processRequests=function(e){},G.prototype.postEvent=function(e,t,r,f){var v=this;if(tr.EVENTS_URL){var m=$e(tr.EVENTS_URL);m.params.push("access_token="+(f||tr.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.1",skuId:Dt,userId:this.anonId},T=t?er(x,t):x,D={url:ot(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};this.pendingRequest=oi(D,function(N){v.pendingRequest=null,r(N),v.saveEventData(),v.processRequests(f)})}},G.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Et,Bt,dr=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,f,v,m){this.skuToken=v,(tr.EVENTS_URL&&m||tr.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(x){return A(x)||ve(x)}))&&this.queueRequest({id:f,timestamp:Date.now()},m)},t.prototype.processRequests=function(r){var f=this;if(!this.pendingRequest&&this.queue.length!==0){var v=this.queue.shift(),m=v.id,x=v.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),ct(this.anonId)||(this.anonId=xt()),this.postEvent(x,{skuToken:this.skuToken},function(T){T||m&&(f.success[m]=!0)},r))}},t}(G),wr=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,f){tr.EVENTS_URL&&tr.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(v){return A(v)||ve(v)})&&this.queueRequest(Date.now(),f)},t.prototype.processRequests=function(r){var f=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var v=Ot(tr.ACCESS_TOKEN),m=v?v.u:tr.ACCESS_TOKEN,x=m!==this.eventData.tokenU;ct(this.anonId)||(this.anonId=xt(),x=!0);var T=this.queue.shift();if(this.eventData.lastSuccess){var D=new Date(this.eventData.lastSuccess),N=new Date(T),V=(T-this.eventData.lastSuccess)/864e5;x=x||V>=1||V<-1||D.getDate()!==N.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(T,{"enabled.telemetry":!1},function(ne){ne||(f.eventData.lastSuccess=T,f.eventData.tokenU=m)},r)}},t}(G)),Tr=wr.postTurnstileEvent.bind(wr),Or=new dr,qe=Or.postMapLoadEvent.bind(Or),yt=500,dt=50;function lr(){Q.caches&&!Et&&(Et=Q.caches.open("mapbox-tiles"))}function Kr(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var gt,Rt=1/0;function sr(){return gt==null&&(gt=Q.OffscreenCanvas&&new Q.OffscreenCanvas(1,1).getContext("2d")&&typeof Q.createImageBitmap=="function"),gt}var ar={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ar);var _n=function(e){function t(r,f,v){f===401&&ve(v)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=f,this.url=v,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),xn=bt()?function(){return self.worker&&self.worker.referrer}:function(){return(Q.location.protocol==="blob:"?Q.parent:Q).location.href},ci,_i,Ui=function(t,r){if(!(/^file:/.test(f=t.url)||/^file:/.test(xn())&&!/^\w+:/.test(f))){if(Q.fetch&&Q.Request&&Q.AbortController&&Q.Request.prototype.hasOwnProperty("signal"))return function(v,m){var x,T=new Q.AbortController,D=new Q.Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,referrer:xn(),signal:T.signal}),N=!1,V=!1,ne=(x=D.url).indexOf("sku=")>0&&ve(x);v.type==="json"&&D.headers.set("Accept","application/json");var oe=function(Fe,tt,at){if(!V){if(Fe&&Fe.message!=="SecurityError"&&Pe(Fe),tt&&at)return Se(tt);var Lt=Date.now();Q.fetch(D).then(function(Wt){if(Wt.ok){var qt=ne?Wt.clone():null;return Se(Wt,qt,Lt)}return m(new _n(Wt.statusText,Wt.status,v.url))}).catch(function(Wt){Wt.code!==20&&m(new Error(Wt.message))})}},Se=function(Fe,tt,at){(v.type==="arrayBuffer"?Fe.arrayBuffer():v.type==="json"?Fe.json():Fe.text()).then(function(Lt){V||(tt&&at&&function(Wt,qt,Cr){if(lr(),Et){var vr={status:qt.status,statusText:qt.statusText,headers:new Q.Headers};qt.headers.forEach(function(sn,Tn){return vr.headers.set(Tn,sn)});var an=cr(qt.headers.get("Cache-Control")||"");an["no-store"]||(an["max-age"]&&vr.headers.set("Expires",new Date(Cr+1e3*an["max-age"]).toUTCString()),new Date(vr.headers.get("Expires")).getTime()-Cr<42e4||function(sn,Tn){if(Bt===void 0)try{new Response(new ReadableStream),Bt=!0}catch(Un){Bt=!1}Bt?Tn(sn.body):sn.blob().then(Tn)}(qt,function(sn){var Tn=new Q.Response(sn,vr);lr(),Et&&Et.then(function(Un){return Un.put(Kr(Wt.url),Tn)}).catch(function(Un){return Pe(Un.message)})}))}}(D,tt,at),N=!0,m(null,Lt,Fe.headers.get("Cache-Control"),Fe.headers.get("Expires")))}).catch(function(Lt){V||m(new Error(Lt.message))})};return ne?function(je,Fe){if(lr(),!Et)return Fe(null);var tt=Kr(je.url);Et.then(function(at){at.match(tt).then(function(Lt){var Wt=function(qt){if(!qt)return!1;var Cr=new Date(qt.headers.get("Expires")||0),vr=cr(qt.headers.get("Cache-Control")||"");return Cr>Date.now()&&!vr["no-cache"]}(Lt);at.delete(tt),Wt&&at.put(tt,Lt.clone()),Fe(null,Lt,Wt)}).catch(Fe)}).catch(Fe)}(D,oe):oe(null,null),{cancel:function(){V=!0,N||T.abort()}}}(t,r);if(bt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var f;return function(v,m){var x=new Q.XMLHttpRequest;for(var T in x.open(v.method||"GET",v.url,!0),v.type==="arrayBuffer"&&(x.responseType="arraybuffer"),v.headers)x.setRequestHeader(T,v.headers[T]);return v.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=v.credentials==="include",x.onerror=function(){m(new Error(x.statusText))},x.onload=function(){if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){var D=x.response;if(v.type==="json")try{D=JSON.parse(x.response)}catch(N){return m(N)}m(null,D,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else m(new _n(x.statusText,x.status,v.url))},x.send(v.body),{cancel:function(){return x.abort()}}}(t,r)},Xi=function(t,r){return Ui(er(t,{type:"arrayBuffer"}),r)},oi=function(t,r){return Ui(er(t,{method:"POST"}),r)},K="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ci=[],_i=0;var I=function e(t,r){if(ce.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),_i>=tr.MAX_PARALLEL_IMAGE_REQUESTS){var f={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return ci.push(f),f}_i++;var v=!1,m=function(){if(!v)for(v=!0,_i--;ci.length&&_i<tr.MAX_PARALLEL_IMAGE_REQUESTS;){var D=ci.shift();D.cancelled||(D.cancel=e(D.requestParameters,D.callback).cancel)}},x=Xi(t,function(T,D,N,V){m(),T?r(T):D&&(sr()?function(ne,oe){var Se=new Q.Blob([new Uint8Array(ne)],{type:"image/png"});Q.createImageBitmap(Se).then(function(je){oe(null,je)}).catch(function(je){oe(new Error("Could not load image because of "+je.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(D,r):function(ne,oe,Se,je){var Fe=new Q.Image,tt=Q.URL;Fe.onload=function(){oe(null,Fe),tt.revokeObjectURL(Fe.src),Fe.onload=null,Q.requestAnimationFrame(function(){Fe.src=K})},Fe.onerror=function(){return oe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var at=new Q.Blob([new Uint8Array(ne)],{type:"image/png"});Fe.cacheControl=Se,Fe.expires=je,Fe.src=ne.byteLength?tt.createObjectURL(at):K}(D,r,N,V))});return{cancel:function(){x.cancel(),m()}}};function j(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function Y(e,t,r){if(r&&r[e]){var f=r[e].indexOf(t);f!==-1&&r[e].splice(f,1)}}var ue=function(t,r){r===void 0&&(r={}),er(this,r),this.type=t},Le=function(e){function t(r,f){f===void 0&&(f={}),e.call(this,"error",er({error:r},f))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ue),Me=function(){};Me.prototype.on=function(e,t){return this._listeners=this._listeners||{},j(e,t,this._listeners),this},Me.prototype.off=function(e,t){return Y(e,t,this._listeners),Y(e,t,this._oneTimeListeners),this},Me.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},j(e,t,this._oneTimeListeners),this},Me.prototype.fire=function(e,t){typeof e=="string"&&(e=new ue(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var f=0,v=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];f<v.length;f+=1)v[f].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];m<x.length;m+=1){var T=x[m];Y(r,T,this._oneTimeListeners),T.call(this,e)}var D=this._eventedParent;D&&(er(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),D.fire(e))}else e instanceof Le&&console.error(e.error);return this},Me.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Me.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var se={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ne=function(t,r,f,v){this.message=(t?t+": ":"")+f,v&&(this.identifier=v),r!=null&&r.__line__&&(this.line=r.__line__)};function At(e){var t=e.value;return t?[new Ne(e.key,t,"constants have been deprecated as of v8")]:[]}function Dr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var f=0,v=t;f<v.length;f+=1){var m=v[f];for(var x in m)e[x]=m[x]}return e}function Ur(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Xt(e){if(Array.isArray(e))return e.map(Xt);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=Xt(e[r]);return t}return Ur(e)}var zr=function(e){function t(r,f){e.call(this,f),this.message=f,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),On=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var f=0,v=r;f<v.length;f+=1){var m=v[f];this.bindings[m[0]]=m[1]}};On.prototype.concat=function(e){return new On(this,e)},On.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},On.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var vn={kind:"null"},hr={kind:"number"},pn={kind:"string"},un={kind:"boolean"},fn={kind:"color"},hi={kind:"object"},Jr={kind:"value"},vi={kind:"collator"},Li={kind:"formatted"},Qn={kind:"resolvedImage"};function xi(e,t){return{kind:"array",itemType:e,N:t}}function Ti(e){if(e.kind==="array"){var t=Ti(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var bo=[vn,hr,pn,un,fn,Li,hi,xi(Jr),Qn];function ki(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ki(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,f=bo;r<f.length;r+=1)if(!ki(f[r],t))return null}}return"Expected "+Ti(e)+" but found "+Ti(t)+" instead."}function si(e,t){return t.some(function(r){return r.kind===e.kind})}function Rn(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var Ri=H(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function f(T){return(T=Math.round(T))<0?0:T>255?255:T}function v(T){return f(T[T.length-1]==="%"?parseFloat(T)/100*255:parseInt(T))}function m(T){return(D=T[T.length-1]==="%"?parseFloat(T)/100:parseFloat(T))<0?0:D>1?1:D;var D}function x(T,D,N){return N<0?N+=1:N>1&&(N-=1),6*N<1?T+(D-T)*N*6:2*N<1?D:3*N<2?T+(D-T)*(2/3-N)*6:T}try{t.parseCSSColor=function(T){var D,N=T.replace(/ /g,"").toLowerCase();if(N in r)return r[N].slice();if(N[0]==="#")return N.length===4?(D=parseInt(N.substr(1),16))>=0&&D<=4095?[(3840&D)>>4|(3840&D)>>8,240&D|(240&D)>>4,15&D|(15&D)<<4,1]:null:N.length===7&&(D=parseInt(N.substr(1),16))>=0&&D<=16777215?[(16711680&D)>>16,(65280&D)>>8,255&D,1]:null;var V=N.indexOf("("),ne=N.indexOf(")");if(V!==-1&&ne+1===N.length){var oe=N.substr(0,V),Se=N.substr(V+1,ne-(V+1)).split(","),je=1;switch(oe){case"rgba":if(Se.length!==4)return null;je=m(Se.pop());case"rgb":return Se.length!==3?null:[v(Se[0]),v(Se[1]),v(Se[2]),je];case"hsla":if(Se.length!==4)return null;je=m(Se.pop());case"hsl":if(Se.length!==3)return null;var Fe=(parseFloat(Se[0])%360+360)%360/360,tt=m(Se[1]),at=m(Se[2]),Lt=at<=.5?at*(tt+1):at+tt-at*tt,Wt=2*at-Lt;return[f(255*x(Wt,Lt,Fe+1/3)),f(255*x(Wt,Lt,Fe)),f(255*x(Wt,Lt,Fe-1/3)),je];default:return null}}return null}}catch(T){}}).parseCSSColor,Zn=function(t,r,f,v){v===void 0&&(v=1),this.r=t,this.g=r,this.b=f,this.a=v};Zn.parse=function(e){if(e){if(e instanceof Zn)return e;if(typeof e=="string"){var t=Ri(e);if(t)return new Zn(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Zn.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],f=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+f+")"},Zn.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Zn.black=new Zn(0,0,0,1),Zn.white=new Zn(1,1,1,1),Zn.transparent=new Zn(0,0,0,0),Zn.red=new Zn(1,0,0,1);var za=function(t,r,f){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};za.prototype.compare=function(e,t){return this.collator.compare(e,t)},za.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ys=function(t,r,f,v,m){this.text=t,this.image=r,this.scale=f,this.fontStack=v,this.textColor=m},Fi=function(t){this.sections=t};Fi.fromString=function(e){return new Fi([new ys(e,null,null,null,null)])},Fi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Fi.factory=function(e){return e instanceof Fi?e:Fi.fromString(e)},Fi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Fi.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var f=r[t];if(f.image)e.push(["image",f.image.name]);else{e.push(f.text);var v={};f.fontStack&&(v["text-font"]=["literal",f.fontStack.split(",")]),f.scale&&(v["font-scale"]=f.scale),f.textColor&&(v["text-color"]=["rgba"].concat(f.textColor.toArray())),e.push(v)}}return e};var ha=function(t){this.name=t.name,this.available=t.available};function Sl(e,t,r,f){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:"Invalid rgba value ["+[e,t,r,f].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof f=="number"?[e,t,r,f]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ga(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Zn||e instanceof za||e instanceof Fi||e instanceof ha)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Ga(r[t]))return!1;return!0}if(typeof e=="object"){for(var f in e)if(!Ga(e[f]))return!1;return!0}return!1}function mi(e){if(e===null)return vn;if(typeof e=="string")return pn;if(typeof e=="boolean")return un;if(typeof e=="number")return hr;if(e instanceof Zn)return fn;if(e instanceof za)return vi;if(e instanceof Fi)return Li;if(e instanceof ha)return Qn;if(Array.isArray(e)){for(var t,r=e.length,f=0,v=e;f<v.length;f+=1){var m=mi(v[f]);if(t){if(t===m)continue;t=Jr;break}t=m}return xi(t||Jr,r)}return hi}function ro(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof Zn||e instanceof Fi||e instanceof ha?e.toString():JSON.stringify(e)}ha.prototype.toString=function(){return this.name},ha.fromString=function(e){return e?new ha({name:e,available:!1}):null},ha.prototype.serialize=function(){return["image",this.name]};var Na=function(t,r){this.type=t,this.value=r};Na.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ga(e[1]))return t.error("invalid value");var r=e[1],f=mi(r),v=t.expectedType;return f.kind!=="array"||f.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(f=v),new Na(f,r)},Na.prototype.evaluate=function(){return this.value},Na.prototype.eachChild=function(){},Na.prototype.outputDefined=function(){return!0},Na.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Zn?["rgba"].concat(this.value.toArray()):this.value instanceof Fi?this.value.serialize():this.value};var Ba=function(t){this.name="ExpressionEvaluationError",this.message=t};Ba.prototype.toJSON=function(){return this.message};var Go={string:pn,number:hr,boolean:un,object:hi},ta=function(t,r){this.type=t,this.args=r};ta.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,f=1,v=e[0];if(v==="array"){var m,x;if(e.length>2){var T=e[1];if(typeof T!="string"||!(T in Go)||T==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=Go[T],f++}else m=Jr;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],f++}r=xi(m,x)}else r=Go[v];for(var D=[];f<e.length;f++){var N=t.parse(e[f],f,Jr);if(!N)return null;D.push(N)}return new ta(r,D)},ta.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!ki(this.type,mi(r)))return r;if(t===this.args.length-1)throw new Ba("Expected value to be of type "+Ti(this.type)+", but found "+Ti(mi(r))+" instead.")}return null},ta.prototype.eachChild=function(e){this.args.forEach(e)},ta.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ta.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var f=e.N;(typeof f=="number"||this.args.length>1)&&t.push(f)}}return t.concat(this.args.map(function(v){return v.serialize()}))};var Ua=function(t){this.type=Li,this.sections=t};Ua.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var f=[],v=!1,m=1;m<=e.length-1;++m){var x=e[m];if(v&&typeof x=="object"&&!Array.isArray(x)){v=!1;var T=null;if(x["font-scale"]&&!(T=t.parse(x["font-scale"],1,hr)))return null;var D=null;if(x["text-font"]&&!(D=t.parse(x["text-font"],1,xi(pn))))return null;var N=null;if(x["text-color"]&&!(N=t.parse(x["text-color"],1,fn)))return null;var V=f[f.length-1];V.scale=T,V.font=D,V.textColor=N}else{var ne=t.parse(e[m],1,Jr);if(!ne)return null;var oe=ne.type.kind;if(oe!=="string"&&oe!=="value"&&oe!=="null"&&oe!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,f.push({content:ne,scale:null,font:null,textColor:null})}}return new Ua(f)},Ua.prototype.evaluate=function(e){return new Fi(this.sections.map(function(t){var r=t.content.evaluate(e);return mi(r)===Qn?new ys("",r,null,null,null):new ys(ro(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Ua.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var f=r[t];e(f.content),f.scale&&e(f.scale),f.font&&e(f.font),f.textColor&&e(f.textColor)}},Ua.prototype.outputDefined=function(){return!1},Ua.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var f=r[t];e.push(f.content.serialize());var v={};f.scale&&(v["font-scale"]=f.scale.serialize()),f.font&&(v["text-font"]=f.font.serialize()),f.textColor&&(v["text-color"]=f.textColor.serialize()),e.push(v)}return e};var xa=function(t){this.type=Qn,this.input=t};xa.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,pn);return r?new xa(r):t.error("No image name provided.")},xa.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=ha.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},xa.prototype.eachChild=function(e){e(this.input)},xa.prototype.outputDefined=function(){return!1},xa.prototype.serialize=function(){return["image",this.input.serialize()]};var os={"to-boolean":un,"to-color":fn,"to-number":hr,"to-string":pn},$o=function(t,r){this.type=t,this.args=r};$o.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var f=os[r],v=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,Jr);if(!x)return null;v.push(x)}return new $o(f,v)},$o.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,f=0,v=this.args;f<v.length;f+=1){if(r=null,(t=v[f].evaluate(e))instanceof Zn)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Sl(t[0],t[1],t[2],t[3])))return new Zn(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ba(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,T=0,D=this.args;T<D.length;T+=1){if((x=D[T].evaluate(e))===null)return 0;var N=Number(x);if(!isNaN(N))return N}throw new Ba("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?Fi.fromString(ro(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ha.fromString(ro(this.args[0].evaluate(e))):ro(this.args[0].evaluate(e))},$o.prototype.eachChild=function(e){this.args.forEach(e)},$o.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},$o.prototype.serialize=function(){if(this.type.kind==="formatted")return new Ua([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new xa(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var El=["Unknown","Point","LineString","Polygon"],Jo=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Jo.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Jo.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?El[this.feature.type]:this.feature.type:null},Jo.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Jo.prototype.canonicalID=function(){return this.canonical},Jo.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Jo.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Zn.parse(e)),t};var Pa=function(t,r,f,v){this.name=t,this.type=r,this._evaluate=f,this.args=v};Pa.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Pa.prototype.eachChild=function(e){this.args.forEach(e)},Pa.prototype.outputDefined=function(){return!1},Pa.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Pa.parse=function(e,t){var r,f=e[0],v=Pa.definitions[f];if(!v)return t.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(v)?v[0]:v.type,x=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,T=x.filter(function(kn){var Pn=kn[0];return!Array.isArray(Pn)||Pn.length===e.length-1}),D=null,N=0,V=T;N<V.length;N+=1){var ne=V[N],oe=ne[0],Se=ne[1];D=new Wa(t.registry,t.path,null,t.scope);for(var je=[],Fe=!1,tt=1;tt<e.length;tt++){var at=e[tt],Lt=Array.isArray(oe)?oe[tt-1]:oe.type,Wt=D.parse(at,1+je.length,Lt);if(!Wt){Fe=!0;break}je.push(Wt)}if(!Fe)if(Array.isArray(oe)&&oe.length!==je.length)D.error("Expected "+oe.length+" arguments, but found "+je.length+" instead.");else{for(var qt=0;qt<je.length;qt++){var Cr=Array.isArray(oe)?oe[qt]:oe.type,vr=je[qt];D.concat(qt+1).checkSubtype(Cr,vr.type)}if(D.errors.length===0)return new Pa(f,m,Se,je)}}if(T.length===1)(r=t.errors).push.apply(r,D.errors);else{for(var an=(T.length?T:x).map(function(kn){var Pn;return Pn=kn[0],Array.isArray(Pn)?"("+Pn.map(Ti).join(", ")+")":"("+Ti(Pn.type)+"...)"}).join(" | "),sn=[],Tn=1;Tn<e.length;Tn++){var Un=t.parse(e[Tn],1+sn.length);if(!Un)return null;sn.push(Ti(Un.type))}t.error("Expected arguments of type "+an+", but found ("+sn.join(", ")+") instead.")}return null},Pa.register=function(e,t){for(var r in Pa.definitions=t,t)e[r]=Pa};var Ha=function(t,r,f){this.type=vi,this.locale=f,this.caseSensitive=t,this.diacriticSensitive=r};function pa(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function rt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function pe(e,t){var r=(180+e[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,v=Math.pow(2,t.z);return[Math.round(r*v*8192),Math.round(f*v*8192)]}function Ye(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Qt(e,t){for(var r,f,v,m,x,T,D,N=!1,V=0,ne=t.length;V<ne;V++)for(var oe=t[V],Se=0,je=oe.length;Se<je-1;Se++){if((m=(r=e)[0]-(f=oe[Se])[0])*(D=r[1]-(v=oe[Se+1])[1])-(T=r[0]-v[0])*(x=r[1]-f[1])==0&&m*T<=0&&x*D<=0)return!1;Ye(e,oe[Se],oe[Se+1])&&(N=!N)}return N}function Zr(e,t){for(var r=0;r<t.length;r++)if(Qt(e,t[r]))return!0;return!1}function nn(e,t,r,f){var v=f[0]-r[0],m=f[1]-r[1],x=(e[0]-r[0])*m-v*(e[1]-r[1]),T=(t[0]-r[0])*m-v*(t[1]-r[1]);return x>0&&T<0||x<0&&T>0}function Ai(e,t,r){for(var f=0,v=r;f<v.length;f+=1)for(var m=v[f],x=0;x<m.length-1;++x)if((ne=[(V=m[x+1])[0]-(N=m[x])[0],V[1]-N[1]])[0]*(oe=[(D=t)[0]-(T=e)[0],D[1]-T[1]])[1]-ne[1]*oe[0]!=0&&nn(T,D,N,V)&&nn(N,V,T,D))return!0;var T,D,N,V,ne,oe;return!1}function ya(e,t){for(var r=0;r<e.length;++r)if(!Qt(e[r],t))return!1;for(var f=0;f<e.length-1;++f)if(Ai(e[f],e[f+1],t))return!1;return!0}function Ma(e,t){for(var r=0;r<t.length;r++)if(ya(e,t[r]))return!0;return!1}function va(e,t,r){for(var f=[],v=0;v<e.length;v++){for(var m=[],x=0;x<e[v].length;x++){var T=pe(e[v][x],r);pa(t,T),m.push(T)}f.push(m)}return f}function Ia(e,t,r){for(var f=[],v=0;v<e.length;v++){var m=va(e[v],t,r);f.push(m)}return f}function Fu(e,t,r,f){if(e[0]<r[0]||e[0]>r[2]){var v=.5*f,m=e[0]-r[0]>v?-f:r[0]-e[0]>v?f:0;m===0&&(m=e[0]-r[2]>v?-f:r[2]-e[0]>v?f:0),e[0]+=m}pa(t,e)}function $u(e,t,r,f){for(var v=8192*Math.pow(2,f.z),m=[8192*f.x,8192*f.y],x=[],T=0,D=e;T<D.length;T+=1)for(var N=0,V=D[T];N<V.length;N+=1){var ne=V[N],oe=[ne.x+m[0],ne.y+m[1]];Fu(oe,t,r,v),x.push(oe)}return x}function wl(e,t,r,f){for(var v,m=8192*Math.pow(2,f.z),x=[8192*f.x,8192*f.y],T=[],D=0,N=e;D<N.length;D+=1){for(var V=[],ne=0,oe=N[D];ne<oe.length;ne+=1){var Se=oe[ne],je=[Se.x+x[0],Se.y+x[1]];pa(t,je),V.push(je)}T.push(V)}if(t[2]-t[0]<=m/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(var Fe=0,tt=T;Fe<tt.length;Fe+=1)for(var at=0,Lt=tt[Fe];at<Lt.length;at+=1)Fu(Lt[at],t,r,m)}return T}Ha.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var f=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,un);if(!f)return null;var v=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,un);if(!v)return null;var m=null;return r.locale&&!(m=t.parse(r.locale,1,pn))?null:new Ha(f,v,m)},Ha.prototype.evaluate=function(e){return new za(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Ha.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Ha.prototype.outputDefined=function(){return!1},Ha.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Po=function(t,r){this.type=un,this.geojson=t,this.geometries=r};function ba(e){if(e instanceof Pa&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Po)return!1;var t=!0;return e.eachChild(function(r){t&&!ba(r)&&(t=!1)}),t}function $n(e){if(e instanceof Pa&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!$n(r)&&(t=!1)}),t}function js(e,t){if(e instanceof Pa&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(f){r&&!js(f,t)&&(r=!1)}),r}Po.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ga(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var f=0;f<r.features.length;++f){var v=r.features[f].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Po(r,r.features[f].geometry)}else if(r.type==="Feature"){var m=r.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Po(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Po(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Po.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var x=va(r.coordinates,v,m),T=$u(t.geometry(),f,v,m);if(!rt(f,v))return!1;for(var D=0,N=T;D<N.length;D+=1)if(!Qt(N[D],x))return!1}if(r.type==="MultiPolygon"){var V=Ia(r.coordinates,v,m),ne=$u(t.geometry(),f,v,m);if(!rt(f,v))return!1;for(var oe=0,Se=ne;oe<Se.length;oe+=1)if(!Zr(Se[oe],V))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var x=va(r.coordinates,v,m),T=wl(t.geometry(),f,v,m);if(!rt(f,v))return!1;for(var D=0,N=T;D<N.length;D+=1)if(!ya(N[D],x))return!1}if(r.type==="MultiPolygon"){var V=Ia(r.coordinates,v,m),ne=wl(t.geometry(),f,v,m);if(!rt(f,v))return!1;for(var oe=0,Se=ne;oe<Se.length;oe+=1)if(!Ma(Se[oe],V))return!1}return!0}(e,this.geometries)}return!1},Po.prototype.eachChild=function(){},Po.prototype.outputDefined=function(){return!0},Po.prototype.serialize=function(){return["within",this.geojson]};var Ho=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Ho.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Ho(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Ho.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ho.prototype.eachChild=function(){},Ho.prototype.outputDefined=function(){return!1},Ho.prototype.serialize=function(){return["var",this.name]};var Wa=function(t,r,f,v,m){r===void 0&&(r=[]),v===void 0&&(v=new On),m===void 0&&(m=[]),this.registry=t,this.path=r,this.key=r.map(function(x){return"["+x+"]"}).join(""),this.scope=v,this.errors=m,this.expectedType=f};function Xa(e,t){for(var r,f=e.length-1,v=0,m=f,x=0;v<=m;)if((r=e[x=Math.floor((v+m)/2)])<=t){if(x===f||t<e[x+1])return x;v=x+1}else{if(!(r>t))throw new Ba("Input is not a number.");m=x-1}return 0}Wa.prototype.parse=function(e,t,r,f,v){return v===void 0&&(v={}),t?this.concat(t,r,f)._parse(e,v):this._parse(e,v)},Wa.prototype._parse=function(e,t){function r(N,V,ne){return ne==="assert"?new ta(V,[N]):ne==="coerce"?new $o(V,[N]):N}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var f=e[0];if(typeof f!="string")return this.error("Expression name must be a string, but found "+typeof f+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var v=this.registry[f];if(v){var m=v.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,T=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||T.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(x,T))return null}else m=r(m,x,t.typeAnnotation||"coerce");else m=r(m,x,t.typeAnnotation||"assert")}if(!(m instanceof Na)&&m.type.kind!=="resolvedImage"&&function N(V){if(V instanceof Ho)return N(V.boundExpression);if(V instanceof Pa&&V.name==="error"||V instanceof Ha||V instanceof Po)return!1;var ne=V instanceof $o||V instanceof ta,oe=!0;return V.eachChild(function(Se){oe=ne?oe&&N(Se):oe&&Se instanceof Na}),!!oe&&ba(V)&&js(V,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var D=new Jo;try{m=new Na(m.type,m.evaluate(D))}catch(N){return this.error(N.message),null}}return m}return this.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Wa.prototype.concat=function(e,t,r){var f=typeof e=="number"?this.path.concat(e):this.path,v=r?this.scope.concat(r):this.scope;return new Wa(this.registry,f,t||null,v,this.errors)},Wa.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var f=""+this.key+t.map(function(v){return"["+v+"]"}).join("");this.errors.push(new zr(f,e))},Wa.prototype.checkSubtype=function(e,t){var r=ki(e,t);return r&&this.error(r),r};var Wo=function(t,r,f){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var v=0,m=f;v<m.length;v+=1){var x=m[v],T=x[1];this.labels.push(x[0]),this.outputs.push(T)}};function Ya(e,t,r){return e*(1-r)+t*r}Wo.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,hr);if(!r)return null;var f=[],v=null;t.expectedType&&t.expectedType.kind!=="value"&&(v=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],T=e[m+1],D=m,N=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(f.length&&f[f.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);var V=t.parse(T,N,v);if(!V)return null;v=v||V.type,f.push([x,V])}return new Wo(v,r,f)},Wo.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var f=this.input.evaluate(e);if(f<=t[0])return r[0].evaluate(e);var v=t.length;return f>=t[v-1]?r[v-1].evaluate(e):r[Xa(t,f)].evaluate(e)},Wo.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Wo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Wo.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var bu=Object.freeze({__proto__:null,number:Ya,color:function(t,r,f){return new Zn(Ya(t.r,r.r,f),Ya(t.g,r.g,f),Ya(t.b,r.b,f),Ya(t.a,r.a,f))},array:function(t,r,f){return t.map(function(v,m){return Ya(v,r[m],f)})}}),Il=6/29*3*(6/29),So=Math.PI/180,Ze=180/Math.PI;function Nt(e){return e>.008856451679035631?Math.pow(e,1/3):e/Il+4/29}function mr(e){return e>6/29?e*e*e:Il*(e-4/29)}function zn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function oa(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Sa(e){var t=oa(e.r),r=oa(e.g),f=oa(e.b),v=Nt((.4124564*t+.3575761*r+.1804375*f)/.95047),m=Nt((.2126729*t+.7151522*r+.072175*f)/1);return{l:116*m-16,a:500*(v-m),b:200*(m-Nt((.0193339*t+.119192*r+.9503041*f)/1.08883)),alpha:e.a}}function wa(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,f=isNaN(e.b)?t:t-e.b/200;return t=1*mr(t),r=.95047*mr(r),f=1.08883*mr(f),new Zn(zn(3.2404542*r-1.5371385*t-.4985314*f),zn(-.969266*r+1.8760108*t+.041556*f),zn(.0556434*r-.2040259*t+1.0572252*f),e.alpha)}function sa(e,t,r){var f=t-e;return e+r*(f>180||f<-180?f-360*Math.round(f/360):f)}var Ta={forward:Sa,reverse:wa,interpolate:function(t,r,f){return{l:Ya(t.l,r.l,f),a:Ya(t.a,r.a,f),b:Ya(t.b,r.b,f),alpha:Ya(t.alpha,r.alpha,f)}}},ss={forward:function(t){var r=Sa(t),f=r.l,v=r.a,m=r.b,x=Math.atan2(m,v)*Ze;return{h:x<0?x+360:x,c:Math.sqrt(v*v+m*m),l:f,alpha:t.a}},reverse:function(t){var r=t.h*So,f=t.c;return wa({l:t.l,a:Math.cos(r)*f,b:Math.sin(r)*f,alpha:t.alpha})},interpolate:function(t,r,f){return{h:sa(t.h,r.h,f),c:Ya(t.c,r.c,f),l:Ya(t.l,r.l,f),alpha:Ya(t.alpha,r.alpha,f)}}},As=Object.freeze({__proto__:null,lab:Ta,hcl:ss}),ja=function(t,r,f,v,m){this.type=t,this.operator=r,this.interpolation=f,this.input=v,this.labels=[],this.outputs=[];for(var x=0,T=m;x<T.length;x+=1){var D=T[x],N=D[1];this.labels.push(D[0]),this.outputs.push(N)}};function Xl(e,t,r,f){var v=f-r,m=e-r;return v===0?0:t===1?m/v:(Math.pow(t,m)-1)/(Math.pow(t,v)-1)}ja.interpolationFactor=function(e,t,r,f){var v=0;if(e.name==="exponential")v=Xl(t,e.base,r,f);else if(e.name==="linear")v=Xl(t,1,r,f);else if(e.name==="cubic-bezier"){var m=e.controlPoints;v=new S(m[0],m[1],m[2],m[3]).solve(Xl(t,1,r,f))}return v},ja.parse=function(e,t){var r=e[0],f=e[1],v=e[2],m=e.slice(3);if(!Array.isArray(f)||f.length===0)return t.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){var x=f[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:x}}else{if(f[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(f[0]),1,0);var T=f.slice(1);if(T.length!==4||T.some(function(tt){return typeof tt!="number"||tt<0||tt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:T}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(v=t.parse(v,2,hr)))return null;var D=[],N=null;r==="interpolate-hcl"||r==="interpolate-lab"?N=fn:t.expectedType&&t.expectedType.kind!=="value"&&(N=t.expectedType);for(var V=0;V<m.length;V+=2){var ne=m[V],oe=m[V+1],Se=V+3,je=V+4;if(typeof ne!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Se);if(D.length&&D[D.length-1][0]>=ne)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Se);var Fe=t.parse(oe,je,N);if(!Fe)return null;N=N||Fe.type,D.push([ne,Fe])}return N.kind==="number"||N.kind==="color"||N.kind==="array"&&N.itemType.kind==="number"&&typeof N.N=="number"?new ja(N,r,f,v,D):t.error("Type "+Ti(N)+" is not interpolatable.")},ja.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var f=this.input.evaluate(e);if(f<=t[0])return r[0].evaluate(e);var v=t.length;if(f>=t[v-1])return r[v-1].evaluate(e);var m=Xa(t,f),x=ja.interpolationFactor(this.interpolation,f,t[m],t[m+1]),T=r[m].evaluate(e),D=r[m+1].evaluate(e);return this.operator==="interpolate"?bu[this.type.kind.toLowerCase()](T,D,x):this.operator==="interpolate-hcl"?ss.reverse(ss.interpolate(ss.forward(T),ss.forward(D),x)):Ta.reverse(Ta.interpolate(Ta.forward(T),Ta.forward(D),x))},ja.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},ja.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},ja.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var Su=function(t,r){this.type=t,this.args=r};Su.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,f=t.expectedType;f&&f.kind!=="value"&&(r=f);for(var v=[],m=0,x=e.slice(1);m<x.length;m+=1){var T=t.parse(x[m],1+v.length,r,void 0,{typeAnnotation:"omit"});if(!T)return null;r=r||T.type,v.push(T)}var D=f&&v.some(function(N){return ki(f,N.type)});return new Su(D?Jr:r,v)},Su.prototype.evaluate=function(e){for(var t,r=null,f=0,v=0,m=this.args;v<m.length&&(f++,(r=m[v].evaluate(e))&&r instanceof ha&&!r.available&&(t||(t=r.name),r=null,f===this.args.length&&(r=t)),r===null);v+=1);return r},Su.prototype.eachChild=function(e){this.args.forEach(e)},Su.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Su.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var us=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};us.prototype.evaluate=function(e){return this.result.evaluate(e)},us.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},us.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],f=1;f<e.length-1;f+=2){var v=e[f];if(typeof v!="string")return t.error("Expected string, but found "+typeof v+" instead.",f);if(/[^a-zA-Z0-9_]/.test(v))return t.error("Variable names must contain only alphanumeric characters or '_'.",f);var m=t.parse(e[f+1],f+1);if(!m)return null;r.push([v,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return x?new us(r,x):null},us.prototype.outputDefined=function(){return this.result.outputDefined()},us.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var f=r[t];e.push(f[0],f[1].serialize())}return e.push(this.result.serialize()),e};var Ol=function(t,r,f){this.type=t,this.index=r,this.input=f};Ol.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,hr),f=t.parse(e[2],2,xi(t.expectedType||Jr));return r&&f?new Ol(f.type.itemType,r,f):null},Ol.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Ba("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Ba("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Ba("Array index must be an integer, but found "+t+" instead.");return r[t]},Ol.prototype.eachChild=function(e){e(this.index),e(this.input)},Ol.prototype.outputDefined=function(){return!1},Ol.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var _s=function(t,r){this.type=un,this.needle=t,this.haystack=r};_s.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Jr),f=t.parse(e[2],2,Jr);return r&&f?si(r.type,[un,pn,hr,vn,Jr])?new _s(r,f):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ti(r.type)+" instead"):null},_s.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Rn(t,["boolean","string","number","null"]))throw new Ba("Expected first argument to be of type boolean, string, number or null, but found "+Ti(mi(t))+" instead.");if(!Rn(r,["string","array"]))throw new Ba("Expected second argument to be of type array or string, but found "+Ti(mi(r))+" instead.");return r.indexOf(t)>=0},_s.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},_s.prototype.outputDefined=function(){return!0},_s.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Eu=function(t,r,f){this.type=hr,this.needle=t,this.haystack=r,this.fromIndex=f};Eu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Jr),f=t.parse(e[2],2,Jr);if(!r||!f)return null;if(!si(r.type,[un,pn,hr,vn,Jr]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ti(r.type)+" instead");if(e.length===4){var v=t.parse(e[3],3,hr);return v?new Eu(r,f,v):null}return new Eu(r,f)},Eu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Rn(t,["boolean","string","number","null"]))throw new Ba("Expected first argument to be of type boolean, string, number or null, but found "+Ti(mi(t))+" instead.");if(!Rn(r,["string","array"]))throw new Ba("Expected second argument to be of type array or string, but found "+Ti(mi(r))+" instead.");if(this.fromIndex){var f=this.fromIndex.evaluate(e);return r.indexOf(t,f)}return r.indexOf(t)},Eu.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Eu.prototype.outputDefined=function(){return!1},Eu.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var wu=function(t,r,f,v,m,x){this.inputType=t,this.type=r,this.input=f,this.cases=v,this.outputs=m,this.otherwise=x};wu.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,f;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var v={},m=[],x=2;x<e.length-1;x+=2){var T=e[x],D=e[x+1];Array.isArray(T)||(T=[T]);var N=t.concat(x);if(T.length===0)return N.error("Expected at least one branch label.");for(var V=0,ne=T;V<ne.length;V+=1){var oe=ne[V];if(typeof oe!="number"&&typeof oe!="string")return N.error("Branch labels must be numbers or strings.");if(typeof oe=="number"&&Math.abs(oe)>Number.MAX_SAFE_INTEGER)return N.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof oe=="number"&&Math.floor(oe)!==oe)return N.error("Numeric branch labels must be integer values.");if(r){if(N.checkSubtype(r,mi(oe)))return null}else r=mi(oe);if(v[String(oe)]!==void 0)return N.error("Branch labels must be unique.");v[String(oe)]=m.length}var Se=t.parse(D,x,f);if(!Se)return null;f=f||Se.type,m.push(Se)}var je=t.parse(e[1],1,Jr);if(!je)return null;var Fe=t.parse(e[e.length-1],e.length-1,f);return Fe?je.type.kind!=="value"&&t.concat(1).checkSubtype(r,je.type)?null:new wu(r,f,je,v,m,Fe):null},wu.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(mi(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},wu.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},wu.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},wu.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],f={},v=0,m=Object.keys(this.cases).sort();v<m.length;v+=1){var x=m[v];(ne=f[this.cases[x]])===void 0?(f[this.cases[x]]=r.length,r.push([this.cases[x],[x]])):r[ne][1].push(x)}for(var T=function(je){return e.inputType.kind==="number"?Number(je):je},D=0,N=r;D<N.length;D+=1){var V=N[D],ne=V[0],oe=V[1];t.push(oe.length===1?T(oe[0]):oe.map(T)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Tl=function(t,r,f){this.type=t,this.branches=r,this.otherwise=f};Tl.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var f=[],v=1;v<e.length-1;v+=2){var m=t.parse(e[v],v,un);if(!m)return null;var x=t.parse(e[v+1],v+1,r);if(!x)return null;f.push([m,x]),r=r||x.type}var T=t.parse(e[e.length-1],e.length-1,r);return T?new Tl(r,f,T):null},Tl.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var f=r[t],v=f[1];if(f[0].evaluate(e))return v.evaluate(e)}return this.otherwise.evaluate(e)},Tl.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var f=r[t],v=f[1];e(f[0]),e(v)}e(this.otherwise)},Tl.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Tl.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Zs=function(t,r,f,v){this.type=t,this.input=r,this.beginIndex=f,this.endIndex=v};function tf(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Lc(e,t,r,f){return f.compare(t,r)===0}function ma(e,t,r){var f=e!=="=="&&e!=="!=";return function(){function v(m,x,T){this.type=un,this.lhs=m,this.rhs=x,this.collator=T,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return v.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var T=m[0],D=x.parse(m[1],1,Jr);if(!D)return null;if(!tf(T,D.type))return x.concat(1).error('"'+T+`" comparisons are not supported for type '`+Ti(D.type)+"'.");var N=x.parse(m[2],2,Jr);if(!N)return null;if(!tf(T,N.type))return x.concat(2).error('"'+T+`" comparisons are not supported for type '`+Ti(N.type)+"'.");if(D.type.kind!==N.type.kind&&D.type.kind!=="value"&&N.type.kind!=="value")return x.error("Cannot compare types '"+Ti(D.type)+"' and '"+Ti(N.type)+"'.");f&&(D.type.kind==="value"&&N.type.kind!=="value"?D=new ta(N.type,[D]):D.type.kind!=="value"&&N.type.kind==="value"&&(N=new ta(D.type,[N])));var V=null;if(m.length===4){if(D.type.kind!=="string"&&N.type.kind!=="string"&&D.type.kind!=="value"&&N.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(V=x.parse(m[3],3,vi)))return null}return new v(D,N,V)},v.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),T=this.rhs.evaluate(m);if(f&&this.hasUntypedArgument){var D=mi(x),N=mi(T);if(D.kind!==N.kind||D.kind!=="string"&&D.kind!=="number")throw new Ba('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+D.kind+", "+N.kind+") instead.")}if(this.collator&&!f&&this.hasUntypedArgument){var V=mi(x),ne=mi(T);if(V.kind!=="string"||ne.kind!=="string")return t(m,x,T)}return this.collator?r(m,x,T,this.collator.evaluate(m)):t(m,x,T)},v.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},v.prototype.outputDefined=function(){return!0},v.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},v}()}Zs.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Jr),f=t.parse(e[2],2,hr);if(!r||!f)return null;if(!si(r.type,[xi(Jr),pn,Jr]))return t.error("Expected first argument to be of type array or string, but found "+Ti(r.type)+" instead");if(e.length===4){var v=t.parse(e[3],3,hr);return v?new Zs(r.type,r,f,v):null}return new Zs(r.type,r,f)},Zs.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Rn(t,["string","array"]))throw new Ba("Expected first argument to be of type array or string, but found "+Ti(mi(t))+" instead.");if(this.endIndex){var f=this.endIndex.evaluate(e);return t.slice(r,f)}return t.slice(r)},Zs.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Zs.prototype.outputDefined=function(){return!1},Zs.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var zu=ma("==",function(e,t,r){return t===r},Lc),rf=ma("!=",function(e,t,r){return t!==r},function(e,t,r,f){return!Lc(0,t,r,f)}),bf=ma("<",function(e,t,r){return t<r},function(e,t,r,f){return f.compare(t,r)<0}),rh=ma(">",function(e,t,r){return t>r},function(e,t,r,f){return f.compare(t,r)>0}),kf=ma("<=",function(e,t,r){return t<=r},function(e,t,r,f){return f.compare(t,r)<=0}),no=ma(">=",function(e,t,r){return t>=r},function(e,t,r,f){return f.compare(t,r)>=0}),Yl=function(t,r,f,v,m){this.type=pn,this.number=t,this.locale=r,this.currency=f,this.minFractionDigits=v,this.maxFractionDigits=m};Yl.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,hr);if(!r)return null;var f=e[2];if(typeof f!="object"||Array.isArray(f))return t.error("NumberFormat options argument must be an object.");var v=null;if(f.locale&&!(v=t.parse(f.locale,1,pn)))return null;var m=null;if(f.currency&&!(m=t.parse(f.currency,1,pn)))return null;var x=null;if(f["min-fraction-digits"]&&!(x=t.parse(f["min-fraction-digits"],1,hr)))return null;var T=null;return f["max-fraction-digits"]&&!(T=t.parse(f["max-fraction-digits"],1,hr))?null:new Yl(r,v,m,x,T)},Yl.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Yl.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Yl.prototype.outputDefined=function(){return!1},Yl.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var hu=function(t){this.type=hr,this.input=t};hu.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ti(r.type)+" instead."):new hu(r):null},hu.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Ba("Expected value to be of type string or array, but found "+Ti(mi(t))+" instead.")},hu.prototype.eachChild=function(e){e(this.input)},hu.prototype.outputDefined=function(){return!1},hu.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var po={"==":zu,"!=":rf,">":rh,"<":bf,">=":no,"<=":kf,array:ta,at:Ol,boolean:ta,case:Tl,coalesce:Su,collator:Ha,format:Ua,image:xa,in:_s,"index-of":Eu,interpolate:ja,"interpolate-hcl":ja,"interpolate-lab":ja,length:hu,let:us,literal:Na,match:wu,number:ta,"number-format":Yl,object:ta,slice:Zs,step:Wo,string:ta,"to-boolean":$o,"to-color":$o,"to-number":$o,"to-string":$o,var:Ho,within:Po};function nf(e,t){var r=t[0],f=t[1],v=t[2],m=t[3];r=r.evaluate(e),f=f.evaluate(e),v=v.evaluate(e);var x=m?m.evaluate(e):1,T=Sl(r,f,v,x);if(T)throw new Ba(T);return new Zn(r/255*x,f/255*x,v/255*x,x)}function Cs(e,t){return e in t}function Ju(e,t){var r=t[e];return r===void 0?null:r}function Qu(e){return{type:e}}function Rc(e){return{result:"success",value:e}}function Tu(e){return{result:"error",value:e}}function Vs(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function af(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Eo(e){return!!e.expression&&e.expression.interpolated}function la(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Ll(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function of(e){return e}function pu(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function qu(e,t,r,f,v){return pu(typeof r===v?f[r]:void 0,e.default,t.default)}function Dc(e,t,r){if(la(r)!=="number")return pu(e.default,t.default);var f=e.stops.length;if(f===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var v=Xa(e.stops.map(function(m){return m[0]}),r);return e.stops[v][1]}function kc(e,t,r){var f=e.base!==void 0?e.base:1;if(la(r)!=="number")return pu(e.default,t.default);var v=e.stops.length;if(v===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[v-1][0])return e.stops[v-1][1];var m=Xa(e.stops.map(function(ne){return ne[0]}),r),x=function(ne,oe,Se,je){var Fe=je-Se,tt=ne-Se;return Fe===0?0:oe===1?tt/Fe:(Math.pow(oe,tt)-1)/(Math.pow(oe,Fe)-1)}(r,f,e.stops[m][0],e.stops[m+1][0]),T=e.stops[m][1],D=e.stops[m+1][1],N=bu[t.type]||of;if(e.colorSpace&&e.colorSpace!=="rgb"){var V=As[e.colorSpace];N=function(oe,Se){return V.reverse(V.interpolate(V.forward(oe),V.forward(Se),x))}}return typeof T.evaluate=="function"?{evaluate:function(){for(var oe=[],Se=arguments.length;Se--;)oe[Se]=arguments[Se];var je=T.evaluate.apply(void 0,oe),Fe=D.evaluate.apply(void 0,oe);if(je!==void 0&&Fe!==void 0)return N(je,Fe,x)}}:N(T,D,x)}function Rl(e,t,r){return t.type==="color"?r=Zn.parse(r):t.type==="formatted"?r=Fi.fromString(r.toString()):t.type==="resolvedImage"?r=ha.fromString(r.toString()):la(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),pu(r,e.default,t.default)}Pa.register(po,{error:[{kind:"error"},[pn],function(e,t){throw new Ba(t[0].evaluate(e))}],typeof:[pn,[Jr],function(e,t){return Ti(mi(t[0].evaluate(e)))}],"to-rgba":[xi(hr,4),[fn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[fn,[hr,hr,hr],nf],rgba:[fn,[hr,hr,hr,hr],nf],has:{type:un,overloads:[[[pn],function(e,t){return Cs(t[0].evaluate(e),e.properties())}],[[pn,hi],function(e,t){var r=t[1];return Cs(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:Jr,overloads:[[[pn],function(e,t){return Ju(t[0].evaluate(e),e.properties())}],[[pn,hi],function(e,t){var r=t[1];return Ju(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[Jr,[pn],function(e,t){return Ju(t[0].evaluate(e),e.featureState||{})}],properties:[hi,[],function(e){return e.properties()}],"geometry-type":[pn,[],function(e){return e.geometryType()}],id:[Jr,[],function(e){return e.id()}],zoom:[hr,[],function(e){return e.globals.zoom}],"heatmap-density":[hr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[hr,[],function(e){return e.globals.lineProgress||0}],accumulated:[Jr,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[hr,Qu(hr),function(e,t){for(var r=0,f=0,v=t;f<v.length;f+=1)r+=v[f].evaluate(e);return r}],"*":[hr,Qu(hr),function(e,t){for(var r=1,f=0,v=t;f<v.length;f+=1)r*=v[f].evaluate(e);return r}],"-":{type:hr,overloads:[[[hr,hr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[hr],function(e,t){return-t[0].evaluate(e)}]]},"/":[hr,[hr,hr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[hr,[hr,hr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[hr,[],function(){return Math.LN2}],pi:[hr,[],function(){return Math.PI}],e:[hr,[],function(){return Math.E}],"^":[hr,[hr,hr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[hr,[hr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[hr,[hr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[hr,[hr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[hr,[hr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[hr,[hr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[hr,[hr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[hr,[hr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[hr,[hr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[hr,[hr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[hr,[hr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[hr,Qu(hr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[hr,Qu(hr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[hr,[hr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[hr,[hr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[hr,[hr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[hr,[hr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[un,[pn,Jr],function(e,t){var r=t[0],f=t[1];return e.properties()[r.value]===f.value}],"filter-id-==":[un,[Jr],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[un,[pn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[un,[pn,Jr],function(e,t){var r=t[0],f=t[1],v=e.properties()[r.value],m=f.value;return typeof v==typeof m&&v<m}],"filter-id-<":[un,[Jr],function(e,t){var r=t[0],f=e.id(),v=r.value;return typeof f==typeof v&&f<v}],"filter->":[un,[pn,Jr],function(e,t){var r=t[0],f=t[1],v=e.properties()[r.value],m=f.value;return typeof v==typeof m&&v>m}],"filter-id->":[un,[Jr],function(e,t){var r=t[0],f=e.id(),v=r.value;return typeof f==typeof v&&f>v}],"filter-<=":[un,[pn,Jr],function(e,t){var r=t[0],f=t[1],v=e.properties()[r.value],m=f.value;return typeof v==typeof m&&v<=m}],"filter-id-<=":[un,[Jr],function(e,t){var r=t[0],f=e.id(),v=r.value;return typeof f==typeof v&&f<=v}],"filter->=":[un,[pn,Jr],function(e,t){var r=t[0],f=t[1],v=e.properties()[r.value],m=f.value;return typeof v==typeof m&&v>=m}],"filter-id->=":[un,[Jr],function(e,t){var r=t[0],f=e.id(),v=r.value;return typeof f==typeof v&&f>=v}],"filter-has":[un,[Jr],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[un,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[un,[xi(pn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[un,[xi(Jr)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[un,[pn,xi(Jr)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[un,[pn,xi(Jr)],function(e,t){var r=t[0],f=t[1];return function(v,m,x,T){for(;x<=T;){var D=x+T>>1;if(m[D]===v)return!0;m[D]>v?T=D-1:x=D+1}return!1}(e.properties()[r.value],f.value,0,f.value.length-1)}],all:{type:un,overloads:[[[un,un],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Qu(un),function(e,t){for(var r=0,f=t;r<f.length;r+=1)if(!f[r].evaluate(e))return!1;return!0}]]},any:{type:un,overloads:[[[un,un],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Qu(un),function(e,t){for(var r=0,f=t;r<f.length;r+=1)if(f[r].evaluate(e))return!0;return!1}]]},"!":[un,[un],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[un,[pn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[pn,[pn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[pn,[pn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[pn,Qu(Jr),function(e,t){return t.map(function(r){return ro(r.evaluate(e))}).join("")}],"resolved-locale":[pn,[vi],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Al=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new Jo,this._defaultValue=r?function(f){return f.type==="color"&&Ll(f.default)?new Zn(0,0,0,0):f.type==="color"?Zn.parse(f.default)||null:f.default===void 0?null:f.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Au(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in po}function Cu(e,t){var r=new Wa(po,[],t?function(v){var m={color:fn,string:pn,number:hr,enum:pn,boolean:un,formatted:Li,resolvedImage:Qn};return v.type==="array"?xi(m[v.value]||Jr,v.length):m[v.type]}(t):void 0),f=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Rc(new Al(f,t)):Tu(r.errors)}Al.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,v,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},Al.prototype.evaluate=function(e,t,r,f,v,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new Ba("Expected value to be one of "+Object.keys(this._enumValues).map(function(T){return JSON.stringify(T)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console!="undefined"&&console.warn(T.message)),this._defaultValue}};var du=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!$n(r.expression)};du.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,v,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,f,v,m)},du.prototype.evaluate=function(e,t,r,f,v,m){return this._styleExpression.evaluate(e,t,r,f,v,m)};var el=function(t,r,f,v){this.kind=t,this.zoomStops=f,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!$n(r.expression),this.interpolationType=v};function Kl(e,t){if((e=Cu(e,t)).result==="error")return e;var r=e.value.expression,f=ba(r);if(!f&&!Vs(t))return Tu([new zr("","data expressions not supported")]);var v=js(r,["zoom"]);if(!v&&!af(t))return Tu([new zr("","zoom expressions not supported")]);var m=function x(T){var D=null;if(T instanceof us)D=x(T.result);else if(T instanceof Su)for(var N=0,V=T.args;N<V.length&&!(D=x(V[N]));N+=1);else(T instanceof Wo||T instanceof ja)&&T.input instanceof Pa&&T.input.name==="zoom"&&(D=T);return D instanceof zr||T.eachChild(function(ne){var oe=x(ne);oe instanceof zr?D=oe:!D&&oe?D=new zr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):D&&oe&&D!==oe&&(D=new zr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),D}(r);return m||v?m instanceof zr?Tu([m]):m instanceof ja&&!Eo(t)?Tu([new zr("",'"interpolate" expressions cannot be used with this property')]):Rc(m?new el(f?"camera":"composite",e.value,m.labels,m instanceof ja?m.interpolation:void 0):new du(f?"constant":"source",e.value)):Tu([new zr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}el.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,v,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,f,v,m)},el.prototype.evaluate=function(e,t,r,f,v,m){return this._styleExpression.evaluate(e,t,r,f,v,m)},el.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?ja.interpolationFactor(this.interpolationType,e,t,r):0};var eu=function(t,r){this._parameters=t,this._specification=r,Dr(this,function f(v,m){var x,T,D,N=m.type==="color",V=v.stops&&typeof v.stops[0][0]=="object",ne=V||!(V||v.property!==void 0),oe=v.type||(Eo(m)?"exponential":"interval");if(N&&((v=Dr({},v)).stops&&(v.stops=v.stops.map(function(kn){return[kn[0],Zn.parse(kn[1])]})),v.default=Zn.parse(v.default?v.default:m.default)),v.colorSpace&&v.colorSpace!=="rgb"&&!As[v.colorSpace])throw new Error("Unknown color space: "+v.colorSpace);if(oe==="exponential")x=kc;else if(oe==="interval")x=Dc;else if(oe==="categorical"){x=qu,T=Object.create(null);for(var Se=0,je=v.stops;Se<je.length;Se+=1){var Fe=je[Se];T[Fe[0]]=Fe[1]}D=typeof v.stops[0][0]}else{if(oe!=="identity")throw new Error('Unknown function type "'+oe+'"');x=Rl}if(V){for(var tt={},at=[],Lt=0;Lt<v.stops.length;Lt++){var Wt=v.stops[Lt],qt=Wt[0].zoom;tt[qt]===void 0&&(tt[qt]={zoom:qt,type:v.type,property:v.property,default:v.default,stops:[]},at.push(qt)),tt[qt].stops.push([Wt[0].value,Wt[1]])}for(var Cr=[],vr=0,an=at;vr<an.length;vr+=1){var sn=an[vr];Cr.push([tt[sn].zoom,f(tt[sn],m)])}var Tn={name:"linear"};return{kind:"composite",interpolationType:Tn,interpolationFactor:ja.interpolationFactor.bind(void 0,Tn),zoomStops:Cr.map(function(kn){return kn[0]}),evaluate:function(Pn,ui){var Jn=Pn.zoom;return kc({stops:Cr,base:v.base},m,Jn).evaluate(Jn,ui)}}}if(ne){var Un=oe==="exponential"?{name:"exponential",base:v.base!==void 0?v.base:1}:null;return{kind:"camera",interpolationType:Un,interpolationFactor:ja.interpolationFactor.bind(void 0,Un),zoomStops:v.stops.map(function(kn){return kn[0]}),evaluate:function(Pn){return x(v,m,Pn.zoom,T,D)}}}return{kind:"source",evaluate:function(Pn,ui){var Jn=ui&&ui.properties?ui.properties[v.property]:void 0;return Jn===void 0?pu(v.default,m.default):x(v,m,Jn,T,D)}}}(this._parameters,this._specification))};function tu(e){var t=e.key,r=e.value,f=e.valueSpec||{},v=e.objectElementValidators||{},m=e.style,x=e.styleSpec,T=[],D=la(r);if(D!=="object")return[new Ne(t,r,"object expected, "+D+" found")];for(var N in r){var V=N.split(".")[0],ne=f[V]||f["*"],oe=void 0;if(v[V])oe=v[V];else if(f[V])oe=ji;else if(v["*"])oe=v["*"];else{if(!f["*"]){T.push(new Ne(t,r[N],'unknown property "'+N+'"'));continue}oe=ji}T=T.concat(oe({key:(t&&t+".")+N,value:r[N],valueSpec:ne,style:m,styleSpec:x,object:r,objectKey:N},r))}for(var Se in f)v[Se]||f[Se].required&&f[Se].default===void 0&&r[Se]===void 0&&T.push(new Ne(t,r,'missing required property "'+Se+'"'));return T}function Fc(e){var t=e.value,r=e.valueSpec,f=e.style,v=e.styleSpec,m=e.key,x=e.arrayElementValidator||ji;if(la(t)!=="array")return[new Ne(m,t,"array expected, "+la(t)+" found")];if(r.length&&t.length!==r.length)return[new Ne(m,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Ne(m,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var T={type:r.value,values:r.values};v.$version<7&&(T.function=r.function),la(r.value)==="object"&&(T=r.value);for(var D=[],N=0;N<t.length;N++)D=D.concat(x({array:t,arrayIndex:N,value:t[N],valueSpec:T,style:f,styleSpec:v,key:m+"["+N+"]"}));return D}function zc(e){var t=e.key,r=e.value,f=e.valueSpec,v=la(r);return v==="number"&&r!=r&&(v="NaN"),v!=="number"?[new Ne(t,r,"number expected, "+v+" found")]:"minimum"in f&&r<f.minimum?[new Ne(t,r,r+" is less than the minimum value "+f.minimum)]:"maximum"in f&&r>f.maximum?[new Ne(t,r,r+" is greater than the maximum value "+f.maximum)]:[]}function mc(e){var t,r,f,v=e.valueSpec,m=Ur(e.value.type),x={},T=m!=="categorical"&&e.value.property===void 0,D=!T,N=la(e.value.stops)==="array"&&la(e.value.stops[0])==="array"&&la(e.value.stops[0][0])==="object",V=tu({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(je){if(m==="identity")return[new Ne(je.key,je.value,'identity function may not have a "stops" property')];var Fe=[],tt=je.value;return Fe=Fe.concat(Fc({key:je.key,value:tt,valueSpec:je.valueSpec,style:je.style,styleSpec:je.styleSpec,arrayElementValidator:ne})),la(tt)==="array"&&tt.length===0&&Fe.push(new Ne(je.key,tt,"array must have at least one stop")),Fe},default:function(je){return ji({key:je.key,value:je.value,valueSpec:v,style:je.style,styleSpec:je.styleSpec})}}});return m==="identity"&&T&&V.push(new Ne(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||V.push(new Ne(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!Eo(e.valueSpec)&&V.push(new Ne(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(D&&!Vs(e.valueSpec)?V.push(new Ne(e.key,e.value,"property functions not supported")):T&&!af(e.valueSpec)&&V.push(new Ne(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!N||e.value.property!==void 0||V.push(new Ne(e.key,e.value,'"property" property is required')),V;function ne(Se){var je=[],Fe=Se.value,tt=Se.key;if(la(Fe)!=="array")return[new Ne(tt,Fe,"array expected, "+la(Fe)+" found")];if(Fe.length!==2)return[new Ne(tt,Fe,"array length 2 expected, length "+Fe.length+" found")];if(N){if(la(Fe[0])!=="object")return[new Ne(tt,Fe,"object expected, "+la(Fe[0])+" found")];if(Fe[0].zoom===void 0)return[new Ne(tt,Fe,"object stop key must have zoom")];if(Fe[0].value===void 0)return[new Ne(tt,Fe,"object stop key must have value")];if(f&&f>Ur(Fe[0].zoom))return[new Ne(tt,Fe[0].zoom,"stop zoom values must appear in ascending order")];Ur(Fe[0].zoom)!==f&&(f=Ur(Fe[0].zoom),r=void 0,x={}),je=je.concat(tu({key:tt+"[0]",value:Fe[0],valueSpec:{zoom:{}},style:Se.style,styleSpec:Se.styleSpec,objectElementValidators:{zoom:zc,value:oe}}))}else je=je.concat(oe({key:tt+"[0]",value:Fe[0],valueSpec:{},style:Se.style,styleSpec:Se.styleSpec},Fe));return Au(Xt(Fe[1]))?je.concat([new Ne(tt+"[1]",Fe[1],"expressions are not allowed in function stops.")]):je.concat(ji({key:tt+"[1]",value:Fe[1],valueSpec:v,style:Se.style,styleSpec:Se.styleSpec}))}function oe(Se,je){var Fe=la(Se.value),tt=Ur(Se.value),at=Se.value!==null?Se.value:je;if(t){if(Fe!==t)return[new Ne(Se.key,at,Fe+" stop domain type must match previous stop domain type "+t)]}else t=Fe;if(Fe!=="number"&&Fe!=="string"&&Fe!=="boolean")return[new Ne(Se.key,at,"stop domain value must be a number, string, or boolean")];if(Fe!=="number"&&m!=="categorical"){var Lt="number expected, "+Fe+" found";return Vs(v)&&m===void 0&&(Lt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(Se.key,at,Lt)]}return m!=="categorical"||Fe!=="number"||isFinite(tt)&&Math.floor(tt)===tt?m!=="categorical"&&Fe==="number"&&r!==void 0&&tt<r?[new Ne(Se.key,at,"stop domain values must appear in ascending order")]:(r=tt,m==="categorical"&&tt in x?[new Ne(Se.key,at,"stop domain values must be unique")]:(x[tt]=!0,[])):[new Ne(Se.key,at,"integer expected, found "+tt)]}}function Nu(e){var t=(e.expressionContext==="property"?Kl:Cu)(Xt(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(f){return new Ne(""+e.key+f.key,e.value,f.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Ne(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!$n(r))return[new Ne(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!$n(r))return[new Ne(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!js(r,["zoom","feature-state"]))return[new Ne(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!ba(r))return[new Ne(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Cl(e){var t=e.key,r=e.value,f=e.valueSpec,v=[];return Array.isArray(f.values)?f.values.indexOf(Ur(r))===-1&&v.push(new Ne(t,r,"expected one of ["+f.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(f.values).indexOf(Ur(r))===-1&&v.push(new Ne(t,r,"expected one of ["+Object.keys(f.values).join(", ")+"], "+JSON.stringify(r)+" found")),v}function $l(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var f=r[t];if(!$l(f)&&typeof f!="boolean")return!1}return!0;default:return!0}}eu.deserialize=function(e){return new eu(e._parameters,e._specification)},eu.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var tl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Dl(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};$l(e)||(e=rl(e));var t=Cu(e,tl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(f,v,m){return t.value.evaluate(f,v,{},m)},needGeometry:function r(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(var v=1;v<f.length;v++)if(r(f[v]))return!0;return!1}(e)}}function Nc(e,t){return e<t?-1:e>t?1:0}function rl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?Bc(e[1],e[2],"=="):r==="!="?Pl(Bc(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Bc(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(rl))):r==="all"?["all"].concat(e.slice(1).map(rl)):r==="none"?["all"].concat(e.slice(1).map(rl).map(Pl)):r==="in"?sf(e[1],e.slice(2)):r==="!in"?Pl(sf(e[1],e.slice(2))):r==="has"?Uc(e[1]):r==="!has"?Pl(Uc(e[1])):r!=="within"||e}function Bc(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function sf(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Nc)]]:["filter-in-small",e,["literal",t]]}}function Uc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Pl(e){return["!",e]}function Mo(e){return $l(Xt(e.value))?Nu(Dr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var f=r.value,v=r.key;if(la(f)!=="array")return[new Ne(v,f,"array expected, "+la(f)+" found")];var m,x=r.styleSpec,T=[];if(f.length<1)return[new Ne(v,f,"filter array must have at least 1 element")];switch(T=T.concat(Cl({key:v+"[0]",value:f[0],valueSpec:x.filter_operator,style:r.style,styleSpec:r.styleSpec})),Ur(f[0])){case"<":case"<=":case">":case">=":f.length>=2&&Ur(f[1])==="$type"&&T.push(new Ne(v,f,'"$type" cannot be use with operator "'+f[0]+'"'));case"==":case"!=":f.length!==3&&T.push(new Ne(v,f,'filter array for operator "'+f[0]+'" must have 3 elements'));case"in":case"!in":f.length>=2&&(m=la(f[1]))!=="string"&&T.push(new Ne(v+"[1]",f[1],"string expected, "+m+" found"));for(var D=2;D<f.length;D++)m=la(f[D]),Ur(f[1])==="$type"?T=T.concat(Cl({key:v+"["+D+"]",value:f[D],valueSpec:x.geometry_type,style:r.style,styleSpec:r.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&T.push(new Ne(v+"["+D+"]",f[D],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var N=1;N<f.length;N++)T=T.concat(t({key:v+"["+N+"]",value:f[N],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":m=la(f[1]),f.length!==2?T.push(new Ne(v,f,'filter array for "'+f[0]+'" operator must have 2 elements')):m!=="string"&&T.push(new Ne(v+"[1]",f[1],"string expected, "+m+" found"));break;case"within":m=la(f[1]),f.length!==2?T.push(new Ne(v,f,'filter array for "'+f[0]+'" operator must have 2 elements')):m!=="object"&&T.push(new Ne(v+"[1]",f[1],"object expected, "+m+" found"))}return T}(e)}function gc(e,t){var r=e.key,f=e.style,v=e.styleSpec,m=e.value,x=e.objectKey,T=v[t+"_"+e.layerType];if(!T)return[];var D=x.match(/^(.*)-transition$/);if(t==="paint"&&D&&T[D[1]]&&T[D[1]].transition)return ji({key:r,value:m,valueSpec:v.transition,style:f,styleSpec:v});var N,V=e.valueSpec||T[x];if(!V)return[new Ne(r,m,'unknown property "'+x+'"')];if(la(m)==="string"&&Vs(V)&&!V.tokens&&(N=/^{([^}]+)}$/.exec(m)))return[new Ne(r,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(N[1])+" }`.")];var ne=[];return e.layerType==="symbol"&&(x==="text-field"&&f&&!f.glyphs&&ne.push(new Ne(r,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Ll(Xt(m))&&Ur(m.type)==="identity"&&ne.push(new Ne(r,m,'"text-font" does not support identity functions'))),ne.concat(ji({key:e.key,value:m,valueSpec:V,style:f,styleSpec:v,expressionContext:"property",propertyType:t,propertyKey:x}))}function jc(e){return gc(e,"paint")}function nl(e){return gc(e,"layout")}function Zc(e){var t=[],r=e.value,f=e.key,v=e.style,m=e.styleSpec;r.type||r.ref||t.push(new Ne(f,r,'either "type" or "ref" is required'));var x,T=Ur(r.type),D=Ur(r.ref);if(r.id)for(var N=Ur(r.id),V=0;V<e.arrayIndex;V++){var ne=v.layers[V];Ur(ne.id)===N&&t.push(new Ne(f,r.id,'duplicate layer id "'+r.id+'", previously used at line '+ne.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(je){je in r&&t.push(new Ne(f,r[je],'"'+je+'" is prohibited for ref layers'))}),v.layers.forEach(function(je){Ur(je.id)===D&&(x=je)}),x?x.ref?t.push(new Ne(f,r.ref,"ref cannot reference another ref layer")):T=Ur(x.type):t.push(new Ne(f,r.ref,'ref layer "'+D+'" not found'));else if(T!=="background")if(r.source){var oe=v.sources&&v.sources[r.source],Se=oe&&Ur(oe.type);oe?Se==="vector"&&T==="raster"?t.push(new Ne(f,r.source,'layer "'+r.id+'" requires a raster source')):Se==="raster"&&T!=="raster"?t.push(new Ne(f,r.source,'layer "'+r.id+'" requires a vector source')):Se!=="vector"||r["source-layer"]?Se==="raster-dem"&&T!=="hillshade"?t.push(new Ne(f,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!r.paint||!r.paint["line-gradient"]||Se==="geojson"&&oe.lineMetrics||t.push(new Ne(f,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Ne(f,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Ne(f,r.source,'source "'+r.source+'" not found'))}else t.push(new Ne(f,r,'missing required property "source"'));return t=t.concat(tu({key:f,value:r,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ji({key:f+".type",value:r.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Mo,layout:function(Fe){return tu({layer:r,key:Fe.key,value:Fe.value,style:Fe.style,styleSpec:Fe.styleSpec,objectElementValidators:{"*":function(at){return nl(Dr({layerType:T},at))}}})},paint:function(Fe){return tu({layer:r,key:Fe.key,value:Fe.value,style:Fe.style,styleSpec:Fe.styleSpec,objectElementValidators:{"*":function(at){return jc(Dr({layerType:T},at))}}})}}}))}function Pu(e){var t=e.value,r=e.key,f=la(t);return f!=="string"?[new Ne(r,t,"string expected, "+f+" found")]:[]}var Aa={promoteId:function(t){var r=t.key,f=t.value;if(la(f)==="string")return Pu({key:r,value:f});var v=[];for(var m in f)v.push.apply(v,Pu({key:r+"."+m,value:f[m]}));return v}};function Jl(e){var t=e.value,r=e.key,f=e.styleSpec,v=e.style;if(!t.type)return[new Ne(r,t,'"type" is required')];var m,x=Ur(t.type);switch(x){case"vector":case"raster":case"raster-dem":return tu({key:r,value:t,valueSpec:f["source_"+x.replace("-","_")],style:e.style,styleSpec:f,objectElementValidators:Aa});case"geojson":if(m=tu({key:r,value:t,valueSpec:f.source_geojson,style:v,styleSpec:f,objectElementValidators:Aa}),t.cluster)for(var T in t.clusterProperties){var D=t.clusterProperties[T],N=D[0],V=typeof N=="string"?[N,["accumulated"],["get",T]]:N;m.push.apply(m,Nu({key:r+"."+T+".map",value:D[1],expressionContext:"cluster-map"})),m.push.apply(m,Nu({key:r+"."+T+".reduce",value:V,expressionContext:"cluster-reduce"}))}return m;case"video":return tu({key:r,value:t,valueSpec:f.source_video,style:v,styleSpec:f});case"image":return tu({key:r,value:t,valueSpec:f.source_image,style:v,styleSpec:f});case"canvas":return[new Ne(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Cl({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:v,styleSpec:f})}}function Bu(e){var t=e.value,r=e.styleSpec,f=r.light,v=e.style,m=[],x=la(t);if(t===void 0)return m;if(x!=="object")return m.concat([new Ne("light",t,"object expected, "+x+" found")]);for(var T in t){var D=T.match(/^(.*)-transition$/);m=m.concat(D&&f[D[1]]&&f[D[1]].transition?ji({key:T,value:t[T],valueSpec:r.transition,style:v,styleSpec:r}):f[T]?ji({key:T,value:t[T],valueSpec:f[T],style:v,styleSpec:r}):[new Ne(T,t[T],'unknown property "'+T+'"')])}return m}var il={"*":function(){return[]},array:Fc,boolean:function(t){var r=t.value,f=t.key,v=la(r);return v!=="boolean"?[new Ne(f,r,"boolean expected, "+v+" found")]:[]},number:zc,color:function(t){var r=t.key,f=t.value,v=la(f);return v!=="string"?[new Ne(r,f,"color expected, "+v+" found")]:Ri(f)===null?[new Ne(r,f,'color expected, "'+f+'" found')]:[]},constants:At,enum:Cl,filter:Mo,function:mc,layer:Zc,object:tu,source:Jl,light:Bu,string:Pu,formatted:function(t){return Pu(t).length===0?[]:Nu(t)},resolvedImage:function(t){return Pu(t).length===0?[]:Nu(t)}};function ji(e){var t=e.value,r=e.valueSpec,f=e.styleSpec;return r.expression&&Ll(Ur(t))?mc(e):r.expression&&Au(Xt(t))?Nu(e):r.type&&il[r.type]?il[r.type](e):tu(Dr({},e,{valueSpec:r.type?f[r.type]:r}))}function Ea(e){var t=e.value,r=e.key,f=Pu(e);return f.length||(t.indexOf("{fontstack}")===-1&&f.push(new Ne(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&f.push(new Ne(r,t,'"glyphs" url must include a "{range}" token'))),f}function Gs(e,t){t===void 0&&(t=se);var r=[];return r=r.concat(ji({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Ea,"*":function(){return[]}}})),e.constants&&(r=r.concat(At({key:"constants",value:e.constants,style:e,styleSpec:t}))),Ql(r)}function Ql(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function kl(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Ql(e.apply(this,t))}}Gs.source=kl(Jl),Gs.light=kl(Bu),Gs.layer=kl(Zc),Gs.filter=kl(Mo),Gs.paintProperty=kl(jc),Gs.layoutProperty=kl(nl);var ql=Gs,Sf=ql.light,Ff=ql.paintProperty,ec=ql.layoutProperty;function al(e,t){var r=!1;if(t&&t.length)for(var f=0,v=t;f<v.length;f+=1)e.fire(new Le(new Error(v[f].message))),r=!0;return r}var ol=Ka;function Ka(e,t,r){var f=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var v=new Int32Array(this.arrayBuffer);e=v[0],this.d=(t=v[1])+2*(r=v[2]);for(var m=0;m<this.d*this.d;m++){var x=v[3+m],T=v[3+m+1];f.push(x===T?null:v.subarray(x,T))}var D=v[3+f.length+1];this.keys=v.subarray(v[3+f.length],D),this.bboxes=v.subarray(D),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var N=0;N<this.d*this.d;N++)f.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var V=r/t*e;this.min=-V,this.max=e+V}Ka.prototype.insert=function(e,t,r,f,v){this._forEachCell(t,r,f,v,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(f),this.bboxes.push(v)},Ka.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ka.prototype._insertCell=function(e,t,r,f,v,m){this.cells[v].push(m)},Ka.prototype.query=function(e,t,r,f,v){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=r&&x<=f&&!v)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(e,t,r,f,this._queryCell,T,{},v),T},Ka.prototype._queryCell=function(e,t,r,f,v,m,x,T){var D=this.cells[v];if(D!==null)for(var N=this.keys,V=this.bboxes,ne=0;ne<D.length;ne++){var oe=D[ne];if(x[oe]===void 0){var Se=4*oe;(T?T(V[Se+0],V[Se+1],V[Se+2],V[Se+3]):e<=V[Se+2]&&t<=V[Se+3]&&r>=V[Se+0]&&f>=V[Se+1])?(x[oe]=!0,m.push(N[oe])):x[oe]=!1}}},Ka.prototype._forEachCell=function(e,t,r,f,v,m,x,T){for(var D=this._convertToCellCoord(e),N=this._convertToCellCoord(t),V=this._convertToCellCoord(r),ne=this._convertToCellCoord(f),oe=D;oe<=V;oe++)for(var Se=N;Se<=ne;Se++){var je=this.d*Se+oe;if((!T||T(this._convertFromCellCoord(oe),this._convertFromCellCoord(Se),this._convertFromCellCoord(oe+1),this._convertFromCellCoord(Se+1)))&&v.call(this,e,t,r,f,je,m,x,T))return}},Ka.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ka.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ka.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,f=0;f<this.cells.length;f++)r+=this.cells[f].length;var v=new Int32Array(t+r+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var T=e[x];v[3+x]=m,v.set(T,m),m+=T.length}return v[3+e.length]=m,v.set(this.keys,m),v[3+e.length+1]=m+=this.keys.length,v.set(this.bboxes,m),m+=this.bboxes.length,v.buffer};var xs=Q.ImageData,Fl=Q.ImageBitmap,io={};function En(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),io[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var Ps in En("Object",Object),ol.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},ol.deserialize=function(e){return new ol(e.buffer)},En("Grid",ol),En("Color",Zn),En("Error",Error),En("ResolvedImage",ha),En("StylePropertyFunction",eu),En("StyleExpression",Al,{omit:["_evaluator"]}),En("ZoomDependentExpression",el),En("ZoomConstantExpression",du),En("CompoundExpression",Pa,{omit:["_evaluate"]}),po)po[Ps]._classRegistryKey||En("Expression_"+Ps,po[Ps]);function tc(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Mu(e){return Fl&&e instanceof Fl}function ru(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(tc(e)||Mu(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof xs)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var f=[],v=0,m=e;v<m.length;v+=1)f.push(ru(m[v],t));return f}if(typeof e=="object"){var x=e.constructor,T=x._classRegistryKey;if(!T)throw new Error("can't serialize object of unregistered class");var D=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var N in e)if(e.hasOwnProperty(N)&&!(io[T].omit.indexOf(N)>=0)){var V=e[N];D[N]=io[T].shallow.indexOf(N)>=0?V:ru(V,t)}e instanceof Error&&(D.message=e.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return T!=="Object"&&(D.$name=T),D}throw new Error("can't serialize object of type "+typeof e)}function Hs(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||tc(e)||Mu(e)||ArrayBuffer.isView(e)||e instanceof xs)return e;if(Array.isArray(e))return e.map(Hs);if(typeof e=="object"){var t=e.$name||"Object",r=io[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var f=Object.create(r.prototype),v=0,m=Object.keys(e);v<m.length;v+=1){var x=m[v];if(x!=="$name"){var T=e[x];f[x]=io[t].shallow.indexOf(x)>=0?T:Hs(T)}}return f}throw new Error("can't deserialize object of type "+typeof e)}var sl=function(){this.first=!0};sl.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Qr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Ms(e){for(var t=0,r=e;t<r.length;t+=1)if(Iu(r[t].charCodeAt(0)))return!0;return!1}function Iu(e){return!(e!==746&&e!==747&&(e<4352||!(Qr["Bopomofo Extended"](e)||Qr.Bopomofo(e)||Qr["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Qr["CJK Compatibility Ideographs"](e)||Qr["CJK Compatibility"](e)||Qr["CJK Radicals Supplement"](e)||Qr["CJK Strokes"](e)||!(!Qr["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Qr["CJK Unified Ideographs Extension A"](e)||Qr["CJK Unified Ideographs"](e)||Qr["Enclosed CJK Letters and Months"](e)||Qr["Hangul Compatibility Jamo"](e)||Qr["Hangul Jamo Extended-A"](e)||Qr["Hangul Jamo Extended-B"](e)||Qr["Hangul Jamo"](e)||Qr["Hangul Syllables"](e)||Qr.Hiragana(e)||Qr["Ideographic Description Characters"](e)||Qr.Kanbun(e)||Qr["Kangxi Radicals"](e)||Qr["Katakana Phonetic Extensions"](e)||Qr.Katakana(e)&&e!==12540||!(!Qr["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Qr["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Qr["Unified Canadian Aboriginal Syllabics"](e)||Qr["Unified Canadian Aboriginal Syllabics Extended"](e)||Qr["Vertical Forms"](e)||Qr["Yijing Hexagram Symbols"](e)||Qr["Yi Syllables"](e)||Qr["Yi Radicals"](e))))}function Is(e){return!(Iu(e)||function(t){return!!(Qr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Qr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Qr["Letterlike Symbols"](t)||Qr["Number Forms"](t)||Qr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Qr["Control Pictures"](t)&&t!==9251||Qr["Optical Character Recognition"](t)||Qr["Enclosed Alphanumerics"](t)||Qr["Geometric Shapes"](t)||Qr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Qr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Qr["CJK Symbols and Punctuation"](t)||Qr.Katakana(t)||Qr["Private Use Area"](t)||Qr["CJK Compatibility Forms"](t)||Qr["Small Form Variants"](t)||Qr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function ls(e){return e>=1424&&e<=2303||Qr["Arabic Presentation Forms-A"](e)||Qr["Arabic Presentation Forms-B"](e)}function bs(e,t){return!(!t&&ls(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Qr.Khmer(e))}function yc(e){for(var t=0,r=e;t<r.length;t+=1)if(ls(r[t].charCodeAt(0)))return!0;return!1}var _c=null,Os="unavailable",Uu=null,vu=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Os="error"),_c&&_c(t)};function nu(){xc.fire(new ue("pluginStateChange",{pluginStatus:Os,pluginURL:Uu}))}var xc=new Me,rc=function(){return Os},iu=function(){if(Os!=="deferred"||!Uu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Os="loading",nu(),Uu&&Xi({url:Uu},function(t){t?vu(t):(Os="loaded",nu())})},Ls={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Os==="loaded"||Ls.applyArabicShaping!=null},isLoading:function(){return Os==="loading"},setState:function(t){Os=t.pluginStatus,Uu=t.pluginURL},isParsed:function(){return Ls.applyArabicShaping!=null&&Ls.processBidirectionalText!=null&&Ls.processStyledBidirectionalText!=null},getPluginURL:function(){return Uu}},Di=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sl,this.transition={})};Di.prototype.isSupportedScript=function(e){return function(t,r){for(var f=0,v=t;f<v.length;f+=1)if(!bs(v[f].charCodeAt(0),r))return!1;return!0}(e,Ls.isLoaded())},Di.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Di.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var Ws=function(t,r){this.property=t,this.value=r,this.expression=function(f,v){if(Ll(f))return new eu(f,v);if(Au(f)){var m=Kl(f,v);if(m.result==="error")throw new Error(m.value.map(function(T){return T.key+": "+T.message}).join(", "));return m.value}var x=f;return typeof f=="string"&&v.type==="color"&&(x=Zn.parse(f)),{kind:"constant",evaluate:function(){return x}}}(r===void 0?t.specification.default:r,t.specification)};Ws.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ws.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Uo=function(t){this.property=t,this.value=new Ws(t,void 0)};Uo.prototype.transitioned=function(e,t){return new ju(this.property,this.value,t,er({},e.transition,this.transition),e.now)},Uo.prototype.untransitioned=function(){return new ju(this.property,this.value,null,{},0)};var vo=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};vo.prototype.getValue=function(e){return Ge(this._values[e].value.value)},vo.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Uo(this._values[e].property)),this._values[e].value=new Ws(this._values[e].property,t===null?void 0:Ge(t))},vo.prototype.getTransition=function(e){return Ge(this._values[e].transition)},vo.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Uo(this._values[e].property)),this._values[e].transition=Ge(t)||void 0},vo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t],v=this.getValue(f);v!==void 0&&(e[f]=v);var m=this.getTransition(f);m!==void 0&&(e[f+"-transition"]=m)}return e},vo.prototype.transitioned=function(e,t){for(var r=new ul(this._properties),f=0,v=Object.keys(this._values);f<v.length;f+=1){var m=v[f];r._values[m]=this._values[m].transitioned(e,t._values[m])}return r},vo.prototype.untransitioned=function(){for(var e=new ul(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t];e._values[f]=this._values[f].untransitioned()}return e};var ju=function(t,r,f,v,m){this.property=t,this.value=r,this.begin=m+v.delay||0,this.end=this.begin+v.duration||0,t.specification.transition&&(v.delay||v.duration)&&(this.prior=f)};ju.prototype.possiblyEvaluate=function(e,t,r){var f=e.now||0,v=this.value.possiblyEvaluate(e,t,r),m=this.prior;if(m){if(f>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(f<this.begin)return m.possiblyEvaluate(e,t,r);var x=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,r),v,function(T){if(T<=0)return 0;if(T>=1)return 1;var D=T*T,N=D*T;return 4*(T<.5?N:3*(T-D)+N-.75)}(x))}return v};var ul=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};ul.prototype.possiblyEvaluate=function(e,t,r){for(var f=new zl(this._properties),v=0,m=Object.keys(this._values);v<m.length;v+=1){var x=m[v];f._values[x]=this._values[x].possiblyEvaluate(e,t,r)}return f},ul.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var mu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};mu.prototype.getValue=function(e){return Ge(this._values[e].value)},mu.prototype.setValue=function(e,t){this._values[e]=new Ws(this._values[e].property,t===null?void 0:Ge(t))},mu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t],v=this.getValue(f);v!==void 0&&(e[f]=v)}return e},mu.prototype.possiblyEvaluate=function(e,t,r){for(var f=new zl(this._properties),v=0,m=Object.keys(this._values);v<m.length;v+=1){var x=m[v];f._values[x]=this._values[x].possiblyEvaluate(e,t,r)}return f};var cs=function(t,r,f){this.property=t,this.value=r,this.parameters=f};cs.prototype.isConstant=function(){return this.value.kind==="constant"},cs.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},cs.prototype.evaluate=function(e,t,r,f){return this.property.evaluate(this.value,this.parameters,e,t,r,f)};var zl=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};zl.prototype.get=function(e){return this._values[e]};var Gn=function(t){this.specification=t};Gn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Gn.prototype.interpolate=function(e,t,r){var f=bu[this.specification.type];return f?f(e,t,r):e};var Mn=function(t,r){this.specification=t,this.overrides=r};Mn.prototype.possiblyEvaluate=function(e,t,r,f){return new cs(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,f)}:e.expression,t)},Mn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new cs(this,{kind:"constant",value:void 0},e.parameters);var f=bu[this.specification.type];return f?new cs(this,{kind:"constant",value:f(e.value.value,t.value.value,r)},e.parameters):e},Mn.prototype.evaluate=function(e,t,r,f,v,m){return e.kind==="constant"?e.value:e.evaluate(t,r,f,v,m)};var ll=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,f,v,m){if(r.value===void 0)return new cs(this,{kind:"constant",value:void 0},f);if(r.expression.kind==="constant"){var x=r.expression.evaluate(f,null,{},v,m),T=r.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,D=this._calculate(T,T,T,f);return new cs(this,{kind:"constant",value:D},f)}if(r.expression.kind==="camera"){var N=this._calculate(r.expression.evaluate({zoom:f.zoom-1}),r.expression.evaluate({zoom:f.zoom}),r.expression.evaluate({zoom:f.zoom+1}),f);return new cs(this,{kind:"constant",value:N},f)}return new cs(this,r.expression,f)},t.prototype.evaluate=function(r,f,v,m,x,T){if(r.kind==="source"){var D=r.evaluate(f,v,m,x,T);return this._calculate(D,D,D,f)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(f.zoom)-1},v,m),r.evaluate({zoom:Math.floor(f.zoom)},v,m),r.evaluate({zoom:Math.floor(f.zoom)+1},v,m),f):r.value},t.prototype._calculate=function(r,f,v,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:f}:{from:v,to:f}},t.prototype.interpolate=function(r){return r},t}(Mn),fs=function(t){this.specification=t};fs.prototype.possiblyEvaluate=function(e,t,r,f){if(e.value!==void 0){if(e.expression.kind==="constant"){var v=e.expression.evaluate(t,null,{},r,f);return this._calculate(v,v,v,t)}return this._calculate(e.expression.evaluate(new Di(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Di(Math.floor(t.zoom),t)),e.expression.evaluate(new Di(Math.floor(t.zoom+1),t)),t)}},fs.prototype._calculate=function(e,t,r,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},fs.prototype.interpolate=function(e){return e};var Io=function(t){this.specification=t};Io.prototype.possiblyEvaluate=function(e,t,r,f){return!!e.expression.evaluate(t,null,{},r,f)},Io.prototype.interpolate=function(){return!1};var jo=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var f=t[r];f.specification.overridable&&this.overridableProperties.push(r);var v=this.defaultPropertyValues[r]=new Ws(f,void 0),m=this.defaultTransitionablePropertyValues[r]=new Uo(f);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=v.possiblyEvaluate({})}};En("DataDrivenProperty",Mn),En("DataConstantProperty",Gn),En("CrossFadedDataDrivenProperty",ll),En("CrossFadedProperty",fs),En("ColorRampProperty",Io);var Zu=function(e){function t(r,f){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),f.layout&&(this._unevaluatedLayout=new mu(f.layout)),f.paint)){for(var v in this._transitionablePaint=new vo(f.paint),r.paint)this.setPaintProperty(v,r.paint[v],{validate:!1});for(var m in r.layout)this.setLayoutProperty(m,r.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new zl(f.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,f,v){v===void 0&&(v={}),f!=null&&this._validate(ec,"layers."+this.id+".layout."+r,r,f,v)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,f):this.visibility=f)},t.prototype.getPaintProperty=function(r){return Ft(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,f,v){if(v===void 0&&(v={}),f!=null&&this._validate(Ff,"layers."+this.id+".paint."+r,r,f,v))return!1;if(Ft(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),f||void 0),!1;var m=this._transitionablePaint._values[r],x=m.property.specification["property-type"]==="cross-faded-data-driven",T=m.value.isDataDriven(),D=m.value;this._transitionablePaint.setValue(r,f),this._handleSpecialPaintPropertyUpdate(r);var N=this._transitionablePaint._values[r].value;return N.isDataDriven()||T||x||this._handleOverridablePaintPropertyUpdate(r,D,N)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,f,v){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,f){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,f)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),St(r,function(f,v){return!(f===void 0||v==="layout"&&!Object.keys(f).length||v==="paint"&&!Object.keys(f).length)})},t.prototype._validate=function(r,f,v,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&al(this,r.call(ql,{key:f,layerType:this.type,objectKey:v,value:m,styleSpec:se,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var f=this.paint.get(r);if(f instanceof cs&&Vs(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1},t}(Me),gu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Nl=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Yi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ao(e,t){t===void 0&&(t=1);var r=0,f=0;return{members:e.map(function(v){var m=gu[v.type].BYTES_PER_ELEMENT,x=r=Vc(r,Math.max(t,m)),T=v.components||1;return f=Math.max(f,m),r+=m*T,{name:v.name,type:v.type,components:T,offset:x}}),size:Vc(r,Math.max(f,t)),alignment:t}}function Vc(e,t){return Math.ceil(e/t)*t}Yi.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Yi.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Yi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Yi.prototype.clear=function(){this.length=0},Yi.prototype.resize=function(e){this.reserve(e),this.length=e},Yi.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Yi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,f)},t.prototype.emplace=function(r,f,v){var m=2*r;return this.int16[m+0]=f,this.int16[m+1]=v,r},t}(Yi);cl.prototype.bytesPerElement=4,En("StructArrayLayout2i4",cl);var bc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,v,m)},t.prototype.emplace=function(r,f,v,m,x){var T=4*r;return this.int16[T+0]=f,this.int16[T+1]=v,this.int16[T+2]=m,this.int16[T+3]=x,r},t}(Yi);bc.prototype.bytesPerElement=8,En("StructArrayLayout4i8",bc);var Vu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x,T){var D=this.length;return this.resize(D+1),this.emplace(D,r,f,v,m,x,T)},t.prototype.emplace=function(r,f,v,m,x,T,D){var N=6*r;return this.int16[N+0]=f,this.int16[N+1]=v,this.int16[N+2]=m,this.int16[N+3]=x,this.int16[N+4]=T,this.int16[N+5]=D,r},t}(Yi);Vu.prototype.bytesPerElement=12,En("StructArrayLayout2i4i12",Vu);var Rs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x,T){var D=this.length;return this.resize(D+1),this.emplace(D,r,f,v,m,x,T)},t.prototype.emplace=function(r,f,v,m,x,T,D){var N=4*r,V=8*r;return this.int16[N+0]=f,this.int16[N+1]=v,this.uint8[V+4]=m,this.uint8[V+5]=x,this.uint8[V+6]=T,this.uint8[V+7]=D,r},t}(Yi);Rs.prototype.bytesPerElement=8,En("StructArrayLayout2i4ub8",Rs);var nc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,f)},t.prototype.emplace=function(r,f,v){var m=2*r;return this.float32[m+0]=f,this.float32[m+1]=v,r},t}(Yi);nc.prototype.bytesPerElement=8,En("StructArrayLayout2f8",nc);var hs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x,T,D,N,V,ne){var oe=this.length;return this.resize(oe+1),this.emplace(oe,r,f,v,m,x,T,D,N,V,ne)},t.prototype.emplace=function(r,f,v,m,x,T,D,N,V,ne,oe){var Se=10*r;return this.uint16[Se+0]=f,this.uint16[Se+1]=v,this.uint16[Se+2]=m,this.uint16[Se+3]=x,this.uint16[Se+4]=T,this.uint16[Se+5]=D,this.uint16[Se+6]=N,this.uint16[Se+7]=V,this.uint16[Se+8]=ne,this.uint16[Se+9]=oe,r},t}(Yi);hs.prototype.bytesPerElement=20,En("StructArrayLayout10ui20",hs);var Sc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x,T,D,N,V,ne,oe,Se){var je=this.length;return this.resize(je+1),this.emplace(je,r,f,v,m,x,T,D,N,V,ne,oe,Se)},t.prototype.emplace=function(r,f,v,m,x,T,D,N,V,ne,oe,Se,je){var Fe=12*r;return this.int16[Fe+0]=f,this.int16[Fe+1]=v,this.int16[Fe+2]=m,this.int16[Fe+3]=x,this.uint16[Fe+4]=T,this.uint16[Fe+5]=D,this.uint16[Fe+6]=N,this.uint16[Fe+7]=V,this.int16[Fe+8]=ne,this.int16[Fe+9]=oe,this.int16[Fe+10]=Se,this.int16[Fe+11]=je,r},t}(Yi);Sc.prototype.bytesPerElement=24,En("StructArrayLayout4i4ui4i24",Sc);var Bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v){var m=this.length;return this.resize(m+1),this.emplace(m,r,f,v)},t.prototype.emplace=function(r,f,v,m){var x=3*r;return this.float32[x+0]=f,this.float32[x+1]=v,this.float32[x+2]=m,r},t}(Yi);Bl.prototype.bytesPerElement=12,En("StructArrayLayout3f12",Bl);var ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.uint32[1*r+0]=f,r},t}(Yi);ic.prototype.bytesPerElement=4,En("StructArrayLayout1ul4",ic);var Oa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x,T,D,N,V){var ne=this.length;return this.resize(ne+1),this.emplace(ne,r,f,v,m,x,T,D,N,V)},t.prototype.emplace=function(r,f,v,m,x,T,D,N,V,ne){var oe=10*r,Se=5*r;return this.int16[oe+0]=f,this.int16[oe+1]=v,this.int16[oe+2]=m,this.int16[oe+3]=x,this.int16[oe+4]=T,this.int16[oe+5]=D,this.uint32[Se+3]=N,this.uint16[oe+8]=V,this.uint16[oe+9]=ne,r},t}(Yi);Oa.prototype.bytesPerElement=20,En("StructArrayLayout6i1ul2ui20",Oa);var ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x,T){var D=this.length;return this.resize(D+1),this.emplace(D,r,f,v,m,x,T)},t.prototype.emplace=function(r,f,v,m,x,T,D){var N=6*r;return this.int16[N+0]=f,this.int16[N+1]=v,this.int16[N+2]=m,this.int16[N+3]=x,this.int16[N+4]=T,this.int16[N+5]=D,r},t}(Yi);ac.prototype.bytesPerElement=12,En("StructArrayLayout2i2i2i12",ac);var fl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x){var T=this.length;return this.resize(T+1),this.emplace(T,r,f,v,m,x)},t.prototype.emplace=function(r,f,v,m,x,T){var D=4*r,N=8*r;return this.float32[D+0]=f,this.float32[D+1]=v,this.float32[D+2]=m,this.int16[N+6]=x,this.int16[N+7]=T,r},t}(Yi);fl.prototype.bytesPerElement=16,En("StructArrayLayout2f1f2i16",fl);var Ec=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,v,m)},t.prototype.emplace=function(r,f,v,m,x){var T=12*r,D=3*r;return this.uint8[T+0]=f,this.uint8[T+1]=v,this.float32[D+1]=m,this.float32[D+2]=x,r},t}(Yi);Ec.prototype.bytesPerElement=12,En("StructArrayLayout2ub2f12",Ec);var hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v){var m=this.length;return this.resize(m+1),this.emplace(m,r,f,v)},t.prototype.emplace=function(r,f,v,m){var x=3*r;return this.uint16[x+0]=f,this.uint16[x+1]=v,this.uint16[x+2]=m,r},t}(Yi);hl.prototype.bytesPerElement=6,En("StructArrayLayout3ui6",hl);var pl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x,T,D,N,V,ne,oe,Se,je,Fe,tt,at,Lt){var Wt=this.length;return this.resize(Wt+1),this.emplace(Wt,r,f,v,m,x,T,D,N,V,ne,oe,Se,je,Fe,tt,at,Lt)},t.prototype.emplace=function(r,f,v,m,x,T,D,N,V,ne,oe,Se,je,Fe,tt,at,Lt,Wt){var qt=24*r,Cr=12*r,vr=48*r;return this.int16[qt+0]=f,this.int16[qt+1]=v,this.uint16[qt+2]=m,this.uint16[qt+3]=x,this.uint32[Cr+2]=T,this.uint32[Cr+3]=D,this.uint32[Cr+4]=N,this.uint16[qt+10]=V,this.uint16[qt+11]=ne,this.uint16[qt+12]=oe,this.float32[Cr+7]=Se,this.float32[Cr+8]=je,this.uint8[vr+36]=Fe,this.uint8[vr+37]=tt,this.uint8[vr+38]=at,this.uint32[Cr+10]=Lt,this.int16[qt+22]=Wt,r},t}(Yi);pl.prototype.bytesPerElement=48,En("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",pl);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m,x,T,D,N,V,ne,oe,Se,je,Fe,tt,at,Lt,Wt,qt,Cr,vr,an,sn,Tn,Un,kn,Pn,ui){var Jn=this.length;return this.resize(Jn+1),this.emplace(Jn,r,f,v,m,x,T,D,N,V,ne,oe,Se,je,Fe,tt,at,Lt,Wt,qt,Cr,vr,an,sn,Tn,Un,kn,Pn,ui)},t.prototype.emplace=function(r,f,v,m,x,T,D,N,V,ne,oe,Se,je,Fe,tt,at,Lt,Wt,qt,Cr,vr,an,sn,Tn,Un,kn,Pn,ui,Jn){var Vn=34*r,Qi=17*r;return this.int16[Vn+0]=f,this.int16[Vn+1]=v,this.int16[Vn+2]=m,this.int16[Vn+3]=x,this.int16[Vn+4]=T,this.int16[Vn+5]=D,this.int16[Vn+6]=N,this.int16[Vn+7]=V,this.uint16[Vn+8]=ne,this.uint16[Vn+9]=oe,this.uint16[Vn+10]=Se,this.uint16[Vn+11]=je,this.uint16[Vn+12]=Fe,this.uint16[Vn+13]=tt,this.uint16[Vn+14]=at,this.uint16[Vn+15]=Lt,this.uint16[Vn+16]=Wt,this.uint16[Vn+17]=qt,this.uint16[Vn+18]=Cr,this.uint16[Vn+19]=vr,this.uint16[Vn+20]=an,this.uint16[Vn+21]=sn,this.uint16[Vn+22]=Tn,this.uint32[Qi+12]=Un,this.float32[Qi+13]=kn,this.float32[Qi+14]=Pn,this.float32[Qi+15]=ui,this.float32[Qi+16]=Jn,r},t}(Yi);Ul.prototype.bytesPerElement=68,En("StructArrayLayout8i15ui1ul4f68",Ul);var yu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.float32[1*r+0]=f,r},t}(Yi);yu.prototype.bytesPerElement=4,En("StructArrayLayout1f4",yu);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v){var m=this.length;return this.resize(m+1),this.emplace(m,r,f,v)},t.prototype.emplace=function(r,f,v,m){var x=3*r;return this.int16[x+0]=f,this.int16[x+1]=v,this.int16[x+2]=m,r},t}(Yi);au.prototype.bytesPerElement=6,En("StructArrayLayout3i6",au);var Gc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v){var m=this.length;return this.resize(m+1),this.emplace(m,r,f,v)},t.prototype.emplace=function(r,f,v,m){var x=4*r;return this.uint32[2*r+0]=f,this.uint16[x+2]=v,this.uint16[x+3]=m,r},t}(Yi);Gc.prototype.bytesPerElement=8,En("StructArrayLayout1ul2ui8",Gc);var wc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,f)},t.prototype.emplace=function(r,f,v){var m=2*r;return this.uint16[m+0]=f,this.uint16[m+1]=v,r},t}(Yi);wc.prototype.bytesPerElement=4,En("StructArrayLayout2ui4",wc);var uf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.uint16[1*r+0]=f,r},t}(Yi);uf.prototype.bytesPerElement=2,En("StructArrayLayout1ui2",uf);var Hc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,v,m){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,v,m)},t.prototype.emplace=function(r,f,v,m,x){var T=4*r;return this.float32[T+0]=f,this.float32[T+1]=v,this.float32[T+2]=m,this.float32[T+3]=x,r},t}(Yi);Hc.prototype.bytesPerElement=16,En("StructArrayLayout4f16",Hc);var c=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new ie(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Nl);c.prototype.size=20;var o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new c(this,r)},t}(Oa);En("CollisionBoxArray",o);var i=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(f){this._structArray.uint8[this._pos1+37]=f},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(f){this._structArray.uint8[this._pos1+38]=f},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(f){this._structArray.uint32[this._pos4+10]=f},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Nl);i.prototype.size=48;var h=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new i(this,r)},t}(pl);En("PlacedSymbolArray",h);var g=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(f){this._structArray.uint32[this._pos4+12]=f},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Nl);g.prototype.size=68;var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new g(this,r)},t}(Ul);En("SymbolInstanceArray",E);var C=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(yu);En("GlyphOffsetArray",C);var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(au);En("SymbolLineVertexArray",L);var Z=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Nl);Z.prototype.size=8;var q=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new Z(this,r)},t}(Gc);En("FeatureIndexArray",q);var de=ao([{name:"a_pos",components:2,type:"Int16"}],4).members,ge=function(t){t===void 0&&(t=[]),this.segments=t};function be(e,t){return 256*(e=Xe(Math.floor(e),0,255))+Xe(Math.floor(t),0,255)}ge.prototype.prepareSegment=function(e,t,r,f){var v=this.segments[this.segments.length-1];return e>ge.MAX_VERTEX_ARRAY_LENGTH&&Pe("Max vertices per segment is "+ge.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!v||v.vertexLength+e>ge.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==f)&&(v={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},f!==void 0&&(v.sortKey=f),this.segments.push(v)),v},ge.prototype.get=function(){return this.segments},ge.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var f in r.vaos)r.vaos[f].destroy()}},ge.simpleSegment=function(e,t,r,f){return new ge([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:f,vaos:{},sortKey:0}])},ge.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,En("SegmentVector",ge);var Ke=ao([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),He=H(function(e){e.exports=function(t,r){var f,v,m,x,T,D,N,V;for(v=t.length-(f=3&t.length),m=r,T=3432918353,D=461845907,V=0;V<v;)N=255&t.charCodeAt(V)|(255&t.charCodeAt(++V))<<8|(255&t.charCodeAt(++V))<<16|(255&t.charCodeAt(++V))<<24,++V,m=27492+(65535&(x=5*(65535&(m=(m^=N=(65535&(N=(N=(65535&N)*T+(((N>>>16)*T&65535)<<16)&4294967295)<<15|N>>>17))*D+(((N>>>16)*D&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(N=0,f){case 3:N^=(255&t.charCodeAt(V+2))<<16;case 2:N^=(255&t.charCodeAt(V+1))<<8;case 1:m^=N=(65535&(N=(N=(65535&(N^=255&t.charCodeAt(V)))*T+(((N>>>16)*T&65535)<<16)&4294967295)<<15|N>>>17))*D+(((N>>>16)*D&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),ut=H(function(e){e.exports=function(t,r){for(var f,v=t.length,m=r^v,x=0;v>=4;)f=1540483477*(65535&(f=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(f>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),v-=4,++x;switch(v){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),We=He,et=ut;We.murmur3=He,We.murmur2=et;var Pt=function(){this.ids=[],this.positions=[],this.indexed=!1};Pt.prototype.add=function(e,t,r,f){this.ids.push(_r(e)),this.positions.push(t,r,f)},Pt.prototype.getPositions=function(e){for(var t=_r(e),r=0,f=this.ids.length-1;r<f;){var v=r+f>>1;this.ids[v]>=t?f=v:r=v+1}for(var m=[];this.ids[r]===t;)m.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return m},Pt.serialize=function(e,t){var r=new Float64Array(e.ids),f=new Uint32Array(e.positions);return function v(m,x,T,D){for(;T<D;){for(var N=m[T+D>>1],V=T-1,ne=D+1;;){do V++;while(m[V]<N);do ne--;while(m[ne]>N);if(V>=ne)break;nr(m,V,ne),nr(x,3*V,3*ne),nr(x,3*V+1,3*ne+1),nr(x,3*V+2,3*ne+2)}ne-T<D-ne?(v(m,x,T,ne),T=ne+1):(v(m,x,ne+1,D),D=ne)}}(r,f,0,r.length-1),t&&t.push(r.buffer,f.buffer),{ids:r,positions:f}},Pt.deserialize=function(e){var t=new Pt;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var Mt=Math.pow(2,53)-1;function _r(e){var t=+e;return!isNaN(t)&&t<=Mt?t:We(String(e))}function nr(e,t,r){var f=e[t];e[t]=e[r],e[r]=f}En("FeaturePositionMap",Pt);var gr=function(t,r){this.gl=t.gl,this.location=r},Er=function(e){function t(r,f){e.call(this,r,f),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(gr),tn=function(e){function t(r,f){e.call(this,r,f),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(gr),Vr=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(gr),mn=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(gr),Sn=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(gr),Hn=function(e){function t(r,f){e.call(this,r,f),this.current=Zn.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(gr),ei=new Float32Array(16),Ei=function(e){function t(r,f){e.call(this,r,f),this.current=ei}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var f=1;f<16;f++)if(r[f]!==this.current[f]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(gr);function Ki(e){return[be(255*e.r,255*e.g),be(255*e.b,255*e.a)]}var bn=function(t,r,f){this.value=t,this.uniformNames=r.map(function(v){return"u_"+v}),this.type=f};bn.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},bn.prototype.getBinding=function(e,t,r){return this.type==="color"?new Hn(e,t):new tn(e,t)};var pi=function(t,r){this.uniformNames=r.map(function(f){return"u_"+f}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};pi.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},pi.prototype.setUniform=function(e,t,r,f){var v=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&e.set(v)},pi.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new Sn(e,t):new tn(e,t)};var bi=function(t,r,f,v){this.expression=t,this.type=f,this.maxValue=0,this.paintVertexAttributes=r.map(function(m){return{name:"a_"+m,type:"Float32",components:f==="color"?2:1,offset:0}}),this.paintVertexArray=new v};bi.prototype.populatePaintArray=function(e,t,r,f,v){var m=this.paintVertexArray.length,x=this.expression.evaluate(new Di(0),t,{},f,[],v);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},bi.prototype.updatePaintArray=function(e,t,r,f){var v=this.expression.evaluate({zoom:0},r,f);this._setPaintValue(e,t,v)},bi.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var f=Ki(r),v=e;v<t;v++)this.paintVertexArray.emplace(v,f[0],f[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},bi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},bi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Nn=function(t,r,f,v,m,x){this.expression=t,this.uniformNames=r.map(function(T){return"u_"+T+"_t"}),this.type=f,this.useIntegerZoom=v,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(function(T){return{name:"a_"+T,type:"Float32",components:f==="color"?4:2,offset:0}}),this.paintVertexArray=new x};Nn.prototype.populatePaintArray=function(e,t,r,f,v){var m=this.expression.evaluate(new Di(this.zoom),t,{},f,[],v),x=this.expression.evaluate(new Di(this.zoom+1),t,{},f,[],v),T=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(T,e,m,x)},Nn.prototype.updatePaintArray=function(e,t,r,f){var v=this.expression.evaluate({zoom:this.zoom},r,f),m=this.expression.evaluate({zoom:this.zoom+1},r,f);this._setPaintValue(e,t,v,m)},Nn.prototype._setPaintValue=function(e,t,r,f){if(this.type==="color")for(var v=Ki(r),m=Ki(f),x=e;x<t;x++)this.paintVertexArray.emplace(x,v[0],v[1],m[0],m[1]);else{for(var T=e;T<t;T++)this.paintVertexArray.emplace(T,r,f);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(f))}},Nn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Nn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Nn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,f=Xe(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(f)},Nn.prototype.getBinding=function(e,t,r){return new tn(e,t)};var yi=function(t,r,f,v,m,x){this.expression=t,this.type=r,this.useIntegerZoom=f,this.zoom=v,this.layerId=x,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m};yi.prototype.populatePaintArray=function(e,t,r){var f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(f,e,t.patterns&&t.patterns[this.layerId],r)},yi.prototype.updatePaintArray=function(e,t,r,f,v){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],v)},yi.prototype._setPaintValues=function(e,t,r,f){if(f&&r){var v=f[r.min],m=f[r.mid],x=f[r.max];if(v&&m&&x)for(var T=e;T<t;T++)this.zoomInPaintVertexArray.emplace(T,m.tl[0],m.tl[1],m.br[0],m.br[1],v.tl[0],v.tl[1],v.br[0],v.br[1],m.pixelRatio,v.pixelRatio),this.zoomOutPaintVertexArray.emplace(T,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},yi.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ke.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ke.members,this.expression.isStateDependent))},yi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Kn=function(t,r,f){this.binders={},this._buffers=[];var v=[];for(var m in t.paint._values)if(f(m)){var x=t.paint.get(m);if(x instanceof cs&&Vs(x.property.specification)){var T=Wi(m,t.type),D=x.value,N=x.property.specification.type,V=x.property.useIntegerZoom,ne=x.property.specification["property-type"],oe=ne==="cross-faded"||ne==="cross-faded-data-driven";if(D.kind==="constant")this.binders[m]=oe?new pi(D.value,T):new bn(D.value,T,N),v.push("/u_"+m);else if(D.kind==="source"||oe){var Se=mo(m,N,"source");this.binders[m]=oe?new yi(D,N,V,r,Se,t.id):new bi(D,T,N,Se),v.push("/a_"+m)}else{var je=mo(m,N,"composite");this.binders[m]=new Nn(D,T,N,V,r,je),v.push("/z_"+m)}}}this.cacheKey=v.sort().join("")};Kn.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof bi||t instanceof Nn?t.maxValue:0},Kn.prototype.populatePaintArrays=function(e,t,r,f,v){for(var m in this.binders){var x=this.binders[m];(x instanceof bi||x instanceof Nn||x instanceof yi)&&x.populatePaintArray(e,t,r,f,v)}},Kn.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var f=this.binders[r];f instanceof pi&&f.setConstantPatternPositions(e,t)}},Kn.prototype.updatePaintArrays=function(e,t,r,f,v){var m=!1;for(var x in e)for(var T=0,D=t.getPositions(x);T<D.length;T+=1){var N=D[T],V=r.feature(N.index);for(var ne in this.binders){var oe=this.binders[ne];if((oe instanceof bi||oe instanceof Nn||oe instanceof yi)&&oe.expression.isStateDependent===!0){var Se=f.paint.get(ne);oe.expression=Se.value,oe.updatePaintArray(N.start,N.end,V,e[x],v),m=!0}}}return m},Kn.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof bn||r instanceof pi)&&e.push.apply(e,r.uniformNames.map(function(f){return"#define HAS_UNIFORM_"+f}))}return e},Kn.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof bi||r instanceof Nn)for(var f=0;f<r.paintVertexAttributes.length;f++)e.push(r.paintVertexAttributes[f].name);else if(r instanceof yi)for(var v=0;v<Ke.members.length;v++)e.push(Ke.members[v].name)}return e},Kn.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof bn||r instanceof pi||r instanceof Nn)for(var f=0,v=r.uniformNames;f<v.length;f+=1)e.push(v[f])}return e},Kn.prototype.getPaintVertexBuffers=function(){return this._buffers},Kn.prototype.getUniforms=function(e,t){var r=[];for(var f in this.binders){var v=this.binders[f];if(v instanceof bn||v instanceof pi||v instanceof Nn)for(var m=0,x=v.uniformNames;m<x.length;m+=1){var T=x[m];if(t[T]){var D=v.getBinding(e,t[T],T);r.push({name:T,property:f,binding:D})}}}return r},Kn.prototype.setUniforms=function(e,t,r,f){for(var v=0,m=t;v<m.length;v+=1){var x=m[v],T=x.name,D=x.property;this.binders[D].setUniform(x.binding,f,r.get(D),T)}},Kn.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof yi){var f=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(r instanceof bi||r instanceof Nn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},Kn.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof bi||r instanceof Nn||r instanceof yi)&&r.upload(e)}this.updatePaintBuffers()},Kn.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof bi||t instanceof Nn||t instanceof yi)&&t.destroy()}};var Ci=function(t,r,f){f===void 0&&(f=function(){return!0}),this.programConfigurations={};for(var v=0,m=t;v<m.length;v+=1){var x=m[v];this.programConfigurations[x.id]=new Kn(x,r,f)}this.needsUpload=!1,this._featureMap=new Pt,this._bufferOffset=0};function Wi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function mo(e,t,r){var f={color:{source:nc,composite:Hc},number:{source:yu,composite:nc}},v=function(m){return{"line-pattern":{source:hs,composite:hs},"fill-pattern":{source:hs,composite:hs},"fill-extrusion-pattern":{source:hs,composite:hs}}[m]}(e);return v&&v[r]||f[t][r]}Ci.prototype.populatePaintArrays=function(e,t,r,f,v,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,f,v,m);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ci.prototype.updatePaintArrays=function(e,t,r,f){for(var v=0,m=r;v<m.length;v+=1){var x=m[v];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,f)||this.needsUpload}},Ci.prototype.get=function(e){return this.programConfigurations[e]},Ci.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ci.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},En("ConstantBinder",bn),En("CrossFadedConstantBinder",pi),En("SourceExpressionBinder",bi),En("CrossFadedCompositeBinder",yi),En("CompositeExpressionBinder",Nn),En("ProgramConfiguration",Kn,{omit:["_buffers"]}),En("ProgramConfigurationSet",Ci);var oo=Math.pow(2,14)-1,Oo=-oo-1;function La(e){for(var t=8192/e.extent,r=e.loadGeometry(),f=0;f<r.length;f++)for(var v=r[f],m=0;m<v.length;m++){var x=v[m],T=Math.round(x.x*t),D=Math.round(x.y*t);x.x=Xe(T,Oo,oo),x.y=Xe(D,Oo,oo),(T<x.x||T>x.x+1||D<x.y||D>x.y+1)&&Pe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function $a(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?La(e):[]}}function Ss(e,t,r,f,v){e.emplaceBack(2*t+(f+1)/2,2*r+(v+1)/2)}var Qo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new cl,this.indexArray=new hl,this.segments=new ge,this.programConfigurations=new Ci(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function dl(e,t){for(var r=0;r<e.length;r++)if(Ru(t,e[r]))return!0;for(var f=0;f<t.length;f++)if(Ru(e,t[f]))return!0;return!!vl(e,t)}function Ou(e,t,r){return!!Ru(e,t)||!!Lu(t,e,r)}function qo(e,t){if(e.length===1)return ml(t,e[0]);for(var r=0;r<t.length;r++)for(var f=t[r],v=0;v<f.length;v++)if(Ru(e,f[v]))return!0;for(var m=0;m<e.length;m++)if(ml(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(vl(e,t[x]))return!0;return!1}function Ds(e,t,r){if(e.length>1){if(vl(e,t))return!0;for(var f=0;f<t.length;f++)if(Lu(t[f],e,r))return!0}for(var v=0;v<e.length;v++)if(Lu(e[v],t,r))return!0;return!1}function vl(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var f=e[r],v=e[r+1],m=0;m<t.length-1;m++)if(oc(f,v,t[m],t[m+1]))return!0;return!1}function oc(e,t,r,f){return Te(e,r,f)!==Te(t,r,f)&&Te(e,t,r)!==Te(e,t,f)}function Lu(e,t,r){var f=r*r;if(t.length===1)return e.distSqr(t[0])<f;for(var v=1;v<t.length;v++)if(ou(e,t[v-1],t[v])<f)return!0;return!1}function ou(e,t,r){var f=t.distSqr(r);if(f===0)return e.distSqr(t);var v=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/f;return e.distSqr(v<0?t:v>1?r:r.sub(t)._mult(v)._add(t))}function ml(e,t){for(var r,f,v,m=!1,x=0;x<e.length;x++)for(var T=0,D=(r=e[x]).length-1;T<r.length;D=T++)(f=r[T]).y>t.y!=(v=r[D]).y>t.y&&t.x<(v.x-f.x)*(t.y-f.y)/(v.y-f.y)+f.x&&(m=!m);return m}function Ru(e,t){for(var r=!1,f=0,v=e.length-1;f<e.length;v=f++){var m=e[f],x=e[v];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(r=!r)}return r}function jl(e,t,r){var f=r[0],v=r[2];if(e.x<f.x&&t.x<f.x||e.x>v.x&&t.x>v.x||e.y<f.y&&t.y<f.y||e.y>v.y&&t.y>v.y)return!1;var m=Te(e,t,r[0]);return m!==Te(e,t,r[1])||m!==Te(e,t,r[2])||m!==Te(e,t,r[3])}function su(e,t,r){var f=t.paint.get(e).value;return f.kind==="constant"?f.value:r.programConfigurations.get(t.id).getMaxValue(e)}function so(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Du(e,t,r,f,v){if(!t[0]&&!t[1])return e;var m=ie.convert(t)._mult(v);r==="viewport"&&m._rotate(-f);for(var x=[],T=0;T<e.length;T++)x.push(e[T].sub(m));return x}Qo.prototype.populate=function(e,t,r){var f=this.layers[0],v=[],m=null;f.type==="circle"&&(m=f.layout.get("circle-sort-key"));for(var x=0,T=e;x<T.length;x+=1){var D=T[x],N=D.feature,V=D.id,ne=D.index,oe=D.sourceLayerIndex,Se=this.layers[0]._featureFilter.needGeometry,je=$a(N,Se);if(this.layers[0]._featureFilter.filter(new Di(this.zoom),je,r)){var Fe=m?m.evaluate(je,{},r):void 0,tt={id:V,properties:N.properties,type:N.type,sourceLayerIndex:oe,index:ne,geometry:Se?je.geometry:La(N),patterns:{},sortKey:Fe};v.push(tt)}}m&&v.sort(function(sn,Tn){return sn.sortKey-Tn.sortKey});for(var at=0,Lt=v;at<Lt.length;at+=1){var Wt=Lt[at],qt=Wt.geometry,Cr=Wt.index,vr=Wt.sourceLayerIndex,an=e[Cr].feature;this.addFeature(Wt,qt,Cr,r),t.featureIndex.insert(an,qt,Cr,vr,this.index)}},Qo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Qo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Qo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,de),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qo.prototype.addFeature=function(e,t,r,f){for(var v=0,m=t;v<m.length;v+=1)for(var x=0,T=m[v];x<T.length;x+=1){var D=T[x],N=D.x,V=D.y;if(!(N<0||N>=8192||V<0||V>=8192)){var ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),oe=ne.vertexLength;Ss(this.layoutVertexArray,N,V,-1,-1),Ss(this.layoutVertexArray,N,V,1,-1),Ss(this.layoutVertexArray,N,V,1,1),Ss(this.layoutVertexArray,N,V,-1,1),this.indexArray.emplaceBack(oe,oe+1,oe+2),this.indexArray.emplaceBack(oe,oe+3,oe+2),ne.vertexLength+=4,ne.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},f)},En("CircleBucket",Qo,{omit:["layers"]});var Zl=new jo({"circle-sort-key":new Mn(se.layout_circle["circle-sort-key"])}),ps={paint:new jo({"circle-radius":new Mn(se.paint_circle["circle-radius"]),"circle-color":new Mn(se.paint_circle["circle-color"]),"circle-blur":new Mn(se.paint_circle["circle-blur"]),"circle-opacity":new Mn(se.paint_circle["circle-opacity"]),"circle-translate":new Gn(se.paint_circle["circle-translate"]),"circle-translate-anchor":new Gn(se.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Gn(se.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Gn(se.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Mn(se.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Mn(se.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Mn(se.paint_circle["circle-stroke-opacity"])}),layout:Zl},go=typeof Float32Array!="undefined"?Float32Array:Array;function Lo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ro(e,t,r){var f=t[0],v=t[1],m=t[2],x=t[3],T=t[4],D=t[5],N=t[6],V=t[7],ne=t[8],oe=t[9],Se=t[10],je=t[11],Fe=t[12],tt=t[13],at=t[14],Lt=t[15],Wt=r[0],qt=r[1],Cr=r[2],vr=r[3];return e[0]=Wt*f+qt*T+Cr*ne+vr*Fe,e[1]=Wt*v+qt*D+Cr*oe+vr*tt,e[2]=Wt*m+qt*N+Cr*Se+vr*at,e[3]=Wt*x+qt*V+Cr*je+vr*Lt,e[4]=(Wt=r[4])*f+(qt=r[5])*T+(Cr=r[6])*ne+(vr=r[7])*Fe,e[5]=Wt*v+qt*D+Cr*oe+vr*tt,e[6]=Wt*m+qt*N+Cr*Se+vr*at,e[7]=Wt*x+qt*V+Cr*je+vr*Lt,e[8]=(Wt=r[8])*f+(qt=r[9])*T+(Cr=r[10])*ne+(vr=r[11])*Fe,e[9]=Wt*v+qt*D+Cr*oe+vr*tt,e[10]=Wt*m+qt*N+Cr*Se+vr*at,e[11]=Wt*x+qt*V+Cr*je+vr*Lt,e[12]=(Wt=r[12])*f+(qt=r[13])*T+(Cr=r[14])*ne+(vr=r[15])*Fe,e[13]=Wt*v+qt*D+Cr*oe+vr*tt,e[14]=Wt*m+qt*N+Cr*Se+vr*at,e[15]=Wt*x+qt*V+Cr*je+vr*Lt,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var Do,ko=Ro;function Xs(e,t,r){var f=t[0],v=t[1],m=t[2],x=t[3];return e[0]=r[0]*f+r[4]*v+r[8]*m+r[12]*x,e[1]=r[1]*f+r[5]*v+r[9]*m+r[13]*x,e[2]=r[2]*f+r[6]*v+r[10]*m+r[14]*x,e[3]=r[3]*f+r[7]*v+r[11]*m+r[15]*x,e}Do=new go(3),go!=Float32Array&&(Do[0]=0,Do[1]=0,Do[2]=0),function(){var e=new go(4);go!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Ml=(function(){var e=new go(2);go!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,ps)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Qo(r)},t.prototype.queryRadius=function(r){var f=r;return su("circle-radius",this,f)+su("circle-stroke-width",this,f)+so(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,f,v,m,x,T,D,N){for(var V=Du(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,D),ne=this.paint.get("circle-radius").evaluate(f,v)+this.paint.get("circle-stroke-width").evaluate(f,v),oe=this.paint.get("circle-pitch-alignment")==="map",Se=oe?V:function(an,sn){return an.map(function(Tn){return Vl(Tn,sn)})}(V,N),je=oe?ne*D:ne,Fe=0,tt=m;Fe<tt.length;Fe+=1)for(var at=0,Lt=tt[Fe];at<Lt.length;at+=1){var Wt=Lt[at],qt=oe?Wt:Vl(Wt,N),Cr=je,vr=Xs([],[Wt.x,Wt.y,0,1],N);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Cr*=vr[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Cr*=T.cameraToCenterDistance/vr[3]),Ou(Se,qt,Cr))return!0}return!1},t}(Zu));function Vl(e,t){var r=Xs([],[e.x,e.y,0,1],t);return new ie(r[0]/r[3],r[1]/r[3])}var Tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Qo);function Gu(e,t,r,f){var v=t.width,m=t.height;if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==v*m*r)throw new RangeError("mismatched image size")}else f=new Uint8Array(v*m*r);return e.width=v,e.height=m,e.data=f,e}function Wc(e,t,r){var f=t.width,v=t.height;if(f!==e.width||v!==e.height){var m=Gu({},{width:f,height:v},r);gl(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,f),height:Math.min(e.height,v)},r),e.width=f,e.height=v,e.data=m.data}}function gl(e,t,r,f,v,m){if(v.width===0||v.height===0)return t;if(v.width>e.width||v.height>e.height||r.x>e.width-v.width||r.y>e.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>t.width||v.height>t.height||f.x>t.width-v.width||f.y>t.height-v.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,T=t.data,D=0;D<v.height;D++)for(var N=((r.y+D)*e.width+r.x)*m,V=((f.y+D)*t.width+f.x)*m,ne=0;ne<v.width*m;ne++)T[V+ne]=x[N+ne];return t}En("HeatmapBucket",Tc,{omit:["layers"]});var Ys=function(t,r){Gu(this,t,1,r)};Ys.prototype.resize=function(e){Wc(this,e,1)},Ys.prototype.clone=function(){return new Ys({width:this.width,height:this.height},new Uint8Array(this.data))},Ys.copy=function(e,t,r,f,v){gl(e,t,r,f,v,1)};var Fo=function(t,r){Gu(this,t,4,r)};Fo.prototype.resize=function(e){Wc(this,e,4)},Fo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Fo.prototype.clone=function(){return new Fo({width:this.width,height:this.height},new Uint8Array(this.data))},Fo.copy=function(e,t,r,f,v){gl(e,t,r,f,v,4)},En("AlphaImage",Ys),En("RGBAImage",Fo);var lf={paint:new jo({"heatmap-radius":new Mn(se.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Mn(se.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Gn(se.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Io(se.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Gn(se.paint_heatmap["heatmap-opacity"])})};function nh(e){var t={},r=e.resolution||256,f=e.clips?e.clips.length:1,v=e.image||new Fo({width:r,height:f}),m=function(Fe,tt,at){t[e.evaluationKey]=at;var Lt=e.expression.evaluate(t);v.data[Fe+tt+0]=Math.floor(255*Lt.r/Lt.a),v.data[Fe+tt+1]=Math.floor(255*Lt.g/Lt.a),v.data[Fe+tt+2]=Math.floor(255*Lt.b/Lt.a),v.data[Fe+tt+3]=Math.floor(255*Lt.a)};if(e.clips)for(var x=0,T=0;x<f;++x,T+=4*r)for(var D=0,N=0;D<r;D++,N+=4){var V=D/(r-1),ne=e.clips[x];m(T,N,ne.start*(1-V)+ne.end*V)}else for(var oe=0,Se=0;oe<r;oe++,Se+=4)m(0,Se,oe/(r-1));return v}var sc=function(e){function t(r){e.call(this,r,lf),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Tc(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=nh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Zu),Ef={paint:new jo({"hillshade-illumination-direction":new Gn(se.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Gn(se.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Gn(se.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Gn(se.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Gn(se.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Gn(se.paint_hillshade["hillshade-accent-color"])})},ih=function(e){function t(r){e.call(this,r,Ef)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Zu),Kh=ao([{name:"a_pos",components:2,type:"Int16"}],4).members,uc=wf,ah=wf;function wf(e,t,r){r=r||2;var f,v,m,x,T,D,N,V=t&&t.length,ne=V?t[0]*r:e.length,oe=zf(e,0,ne,r,!0),Se=[];if(!oe||oe.next===oe.prev)return Se;if(V&&(oe=function(Fe,tt,at,Lt){var Wt,qt,Cr,vr=[];for(Wt=0,qt=tt.length;Wt<qt;Wt++)(Cr=zf(Fe,tt[Wt]*Lt,Wt<qt-1?tt[Wt+1]*Lt:Fe.length,Lt,!1))===Cr.next&&(Cr.steiner=!0),vr.push(Hr(Cr));for(vr.sort(it),Wt=0;Wt<vr.length;Wt++)Tt(vr[Wt],at),at=B(at,at.next);return at}(e,t,oe,r)),e.length>80*r){f=m=e[0],v=x=e[1];for(var je=r;je<ne;je+=r)(T=e[je])<f&&(f=T),(D=e[je+1])<v&&(v=D),T>m&&(m=T),D>x&&(x=D);N=(N=Math.max(m-f,x-v))!==0?1/N:0}return U(oe,Se,r,f,v,N),Se}function zf(e,t,r,f,v){var m,x;if(v===ra(e,t,r,f)>0)for(m=t;m<r;m+=f)x=yo(m,e[m],e[m+1],x);else for(m=r-f;m>=t;m-=f)x=yo(m,e[m],e[m+1],x);return x&&fi(x,x.next)&&(uo(x),x=x.next),x}function B(e,t){if(!e)return e;t||(t=e);var r,f=e;do if(r=!1,f.steiner||!fi(f,f.next)&&Cn(f.prev,f,f.next)!==0)f=f.next;else{if(uo(f),(f=t=f.prev)===f.next)break;r=!0}while(r||f!==t);return t}function U(e,t,r,f,v,m,x){if(e){!x&&m&&function(V,ne,oe,Se){var je=V;do je.z===null&&(je.z=fr(je.x,je.y,ne,oe,Se)),je.prevZ=je.prev,je.nextZ=je.next,je=je.next;while(je!==V);je.prevZ.nextZ=null,je.prevZ=null,function(Fe){var tt,at,Lt,Wt,qt,Cr,vr,an,sn=1;do{for(at=Fe,Fe=null,qt=null,Cr=0;at;){for(Cr++,Lt=at,vr=0,tt=0;tt<sn&&(vr++,Lt=Lt.nextZ);tt++);for(an=sn;vr>0||an>0&&Lt;)vr!==0&&(an===0||!Lt||at.z<=Lt.z)?(Wt=at,at=at.nextZ,vr--):(Wt=Lt,Lt=Lt.nextZ,an--),qt?qt.nextZ=Wt:Fe=Wt,Wt.prevZ=qt,qt=Wt;at=Lt}qt.nextZ=null,sn*=2}while(Cr>1)}(je)}(e,f,v,m);for(var T,D,N=e;e.prev!==e.next;)if(T=e.prev,D=e.next,m?R(e,f,v,m):M(e))t.push(T.i/r),t.push(e.i/r),t.push(D.i/r),uo(e),e=D.next,N=D.next;else if((e=D)===N){x?x===1?U(e=ee(B(e),t,r),t,r,f,v,m,2):x===2&&_e(e,t,r,f,v,m):U(B(e),t,r,f,v,m,1);break}}}function M(e){var t=e.prev,r=e,f=e.next;if(Cn(t,r,f)>=0)return!1;for(var v=e.next.next;v!==e.prev;){if(In(t.x,t.y,r.x,r.y,f.x,f.y,v.x,v.y)&&Cn(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function R(e,t,r,f){var v=e.prev,m=e,x=e.next;if(Cn(v,m,x)>=0)return!1;for(var T=v.x>m.x?v.x>x.x?v.x:x.x:m.x>x.x?m.x:x.x,D=v.y>m.y?v.y>x.y?v.y:x.y:m.y>x.y?m.y:x.y,N=fr(v.x<m.x?v.x<x.x?v.x:x.x:m.x<x.x?m.x:x.x,v.y<m.y?v.y<x.y?v.y:x.y:m.y<x.y?m.y:x.y,t,r,f),V=fr(T,D,t,r,f),ne=e.prevZ,oe=e.nextZ;ne&&ne.z>=N&&oe&&oe.z<=V;){if(ne!==e.prev&&ne!==e.next&&In(v.x,v.y,m.x,m.y,x.x,x.y,ne.x,ne.y)&&Cn(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,oe!==e.prev&&oe!==e.next&&In(v.x,v.y,m.x,m.y,x.x,x.y,oe.x,oe.y)&&Cn(oe.prev,oe,oe.next)>=0))return!1;oe=oe.nextZ}for(;ne&&ne.z>=N;){if(ne!==e.prev&&ne!==e.next&&In(v.x,v.y,m.x,m.y,x.x,x.y,ne.x,ne.y)&&Cn(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;oe&&oe.z<=V;){if(oe!==e.prev&&oe!==e.next&&In(v.x,v.y,m.x,m.y,x.x,x.y,oe.x,oe.y)&&Cn(oe.prev,oe,oe.next)>=0)return!1;oe=oe.nextZ}return!0}function ee(e,t,r){var f=e;do{var v=f.prev,m=f.next.next;!fi(v,m)&&gi(v,f,f.next,m)&&Ra(v,m)&&Ra(m,v)&&(t.push(v.i/r),t.push(f.i/r),t.push(m.i/r),uo(f),uo(f.next),f=e=m),f=f.next}while(f!==e);return B(f)}function _e(e,t,r,f,v,m){var x=e;do{for(var T=x.next.next;T!==x.prev;){if(x.i!==T.i&&Wn(x,T)){var D=wo(x,T);return x=B(x,x.next),D=B(D,D.next),U(x,t,r,f,v,m),void U(D,t,r,f,v,m)}T=T.next}x=x.next}while(x!==e)}function it(e,t){return e.x-t.x}function Tt(e,t){if(t=function(f,v){var m,x=v,T=f.x,D=f.y,N=-1/0;do{if(D<=x.y&&D>=x.next.y&&x.next.y!==x.y){var V=x.x+(D-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(V<=T&&V>N){if(N=V,V===T){if(D===x.y)return x;if(D===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==v);if(!m)return null;if(T===N)return m;var ne,oe=m,Se=m.x,je=m.y,Fe=1/0;x=m;do T>=x.x&&x.x>=Se&&T!==x.x&&In(D<je?T:N,D,Se,je,D<je?N:T,D,x.x,x.y)&&(ne=Math.abs(D-x.y)/(T-x.x),Ra(x,f)&&(ne<Fe||ne===Fe&&(x.x>m.x||x.x===m.x&&wt(m,x)))&&(m=x,Fe=ne)),x=x.next;while(x!==oe);return m}(e,t)){var r=wo(t,e);B(t,t.next),B(r,r.next)}}function wt(e,t){return Cn(e.prev,e,t.prev)<0&&Cn(t.next,e,e.next)<0}function fr(e,t,r,f,v){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*v)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-f)*v)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Hr(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function In(e,t,r,f,v,m,x,T){return(v-x)*(t-T)-(e-x)*(m-T)>=0&&(e-x)*(f-T)-(r-x)*(t-T)>=0&&(r-x)*(m-T)-(v-x)*(f-T)>=0}function Wn(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,f){var v=r;do{if(v.i!==r.i&&v.next.i!==r.i&&v.i!==f.i&&v.next.i!==f.i&&gi(v,v.next,r,f))return!0;v=v.next}while(v!==r);return!1}(e,t)&&(Ra(e,t)&&Ra(t,e)&&function(r,f){var v=r,m=!1,x=(r.x+f.x)/2,T=(r.y+f.y)/2;do v.y>T!=v.next.y>T&&v.next.y!==v.y&&x<(v.next.x-v.x)*(T-v.y)/(v.next.y-v.y)+v.x&&(m=!m),v=v.next;while(v!==r);return m}(e,t)&&(Cn(e.prev,e,t.prev)||Cn(e,t.prev,t))||fi(e,t)&&Cn(e.prev,e,e.next)>0&&Cn(t.prev,t,t.next)>0)}function Cn(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function fi(e,t){return e.x===t.x&&e.y===t.y}function gi(e,t,r,f){var v=Mi(Cn(e,t,r)),m=Mi(Cn(e,t,f)),x=Mi(Cn(r,f,e)),T=Mi(Cn(r,f,t));return v!==m&&x!==T||!(v!==0||!Ji(e,r,t))||!(m!==0||!Ji(e,f,t))||!(x!==0||!Ji(r,e,f))||!(T!==0||!Ji(r,t,f))}function Ji(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Mi(e){return e>0?1:e<0?-1:0}function Ra(e,t){return Cn(e.prev,e,e.next)<0?Cn(e,t,e.next)>=0&&Cn(e,e.prev,t)>=0:Cn(e,t,e.prev)<0||Cn(e,e.next,t)<0}function wo(e,t){var r=new Za(e.i,e.x,e.y),f=new Za(t.i,t.x,t.y),v=e.next,m=t.prev;return e.next=t,t.prev=e,r.next=v,v.prev=r,f.next=r,r.prev=f,m.next=f,f.prev=m,f}function yo(e,t,r,f){var v=new Za(e,t,r);return f?(v.next=f.next,v.prev=f,f.next.prev=v,f.next=v):(v.prev=v,v.next=v),v}function uo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Za(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ra(e,t,r,f){for(var v=0,m=t,x=r-f;m<r;m+=f)v+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return v}function Da(e,t,r,f,v){(function m(x,T,D,N,V){for(;N>D;){if(N-D>600){var ne=N-D+1,oe=T-D+1,Se=Math.log(ne),je=.5*Math.exp(2*Se/3),Fe=.5*Math.sqrt(Se*je*(ne-je)/ne)*(oe-ne/2<0?-1:1);m(x,T,Math.max(D,Math.floor(T-oe*je/ne+Fe)),Math.min(N,Math.floor(T+(ne-oe)*je/ne+Fe)),V)}var tt=x[T],at=D,Lt=N;for(lo(x,D,T),V(x[N],tt)>0&&lo(x,D,N);at<Lt;){for(lo(x,at,Lt),at++,Lt--;V(x[at],tt)<0;)at++;for(;V(x[Lt],tt)>0;)Lt--}V(x[D],tt)===0?lo(x,D,Lt):lo(x,++Lt,N),Lt<=T&&(D=Lt+1),T<=Lt&&(N=Lt-1)}})(e,t,r||0,f||e.length-1,v||To)}function lo(e,t,r){var f=e[t];e[t]=e[r],e[r]=f}function To(e,t){return e<t?-1:e>t?1:0}function co(e,t){var r=e.length;if(r<=1)return[e];for(var f,v,m=[],x=0;x<r;x++){var T=ze(e[x]);T!==0&&(e[x].area=Math.abs(T),v===void 0&&(v=T<0),v===T<0?(f&&m.push(f),f=[e[x]]):f.push(e[x]))}if(f&&m.push(f),t>1)for(var D=0;D<m.length;D++)m[D].length<=t||(Da(m[D],t,1,m[D].length-1,ks),m[D]=m[D].slice(0,t));return m}function ks(e,t){return t.area-e.area}function uu(e,t,r){for(var f=r.patternDependencies,v=!1,m=0,x=t;m<x.length;m+=1){var T=x[m].paint.get(e+"-pattern");T.isConstant()||(v=!0);var D=T.constantOr(null);D&&(v=!0,f[D.to]=!0,f[D.from]=!0)}return v}function Hu(e,t,r,f,v){for(var m=v.patternDependencies,x=0,T=t;x<T.length;x+=1){var D=T[x],N=D.paint.get(e+"-pattern").value;if(N.kind!=="constant"){var V=N.evaluate({zoom:f-1},r,{},v.availableImages),ne=N.evaluate({zoom:f},r,{},v.availableImages),oe=N.evaluate({zoom:f+1},r,{},v.availableImages);ne=ne&&ne.name?ne.name:ne,oe=oe&&oe.name?oe.name:oe,m[V=V&&V.name?V.name:V]=!0,m[ne]=!0,m[oe]=!0,r.patterns[D.id]={min:V,mid:ne,max:oe}}}return r}wf.deviation=function(e,t,r,f){var v=t&&t.length,m=Math.abs(ra(e,0,v?t[0]*r:e.length,r));if(v)for(var x=0,T=t.length;x<T;x++)m-=Math.abs(ra(e,t[x]*r,x<T-1?t[x+1]*r:e.length,r));var D=0;for(x=0;x<f.length;x+=3){var N=f[x]*r,V=f[x+1]*r,ne=f[x+2]*r;D+=Math.abs((e[N]-e[ne])*(e[V+1]-e[N+1])-(e[N]-e[V])*(e[ne+1]-e[N+1]))}return m===0&&D===0?0:Math.abs((D-m)/m)},wf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},f=0,v=0;v<e.length;v++){for(var m=0;m<e[v].length;m++)for(var x=0;x<t;x++)r.vertices.push(e[v][m][x]);v>0&&r.holes.push(f+=e[v-1].length)}return r},uc.default=ah;var ds=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new cl,this.indexArray=new hl,this.indexArray2=new wc,this.programConfigurations=new Ci(t.layers,t.zoom),this.segments=new ge,this.segments2=new ge,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};ds.prototype.populate=function(e,t,r){this.hasPattern=uu("fill",this.layers,t);for(var f=this.layers[0].layout.get("fill-sort-key"),v=[],m=0,x=e;m<x.length;m+=1){var T=x[m],D=T.feature,N=T.id,V=T.index,ne=T.sourceLayerIndex,oe=this.layers[0]._featureFilter.needGeometry,Se=$a(D,oe);if(this.layers[0]._featureFilter.filter(new Di(this.zoom),Se,r)){var je=f?f.evaluate(Se,{},r,t.availableImages):void 0,Fe={id:N,properties:D.properties,type:D.type,sourceLayerIndex:ne,index:V,geometry:oe?Se.geometry:La(D),patterns:{},sortKey:je};v.push(Fe)}}f&&v.sort(function(an,sn){return an.sortKey-sn.sortKey});for(var tt=0,at=v;tt<at.length;tt+=1){var Lt=at[tt],Wt=Lt.geometry,qt=Lt.index,Cr=Lt.sourceLayerIndex;if(this.hasPattern){var vr=Hu("fill",this.layers,Lt,this.zoom,t);this.patternFeatures.push(vr)}else this.addFeature(Lt,Wt,qt,r,{});t.featureIndex.insert(e[qt].feature,Wt,qt,Cr,this.index)}},ds.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ds.prototype.addFeatures=function(e,t,r){for(var f=0,v=this.patternFeatures;f<v.length;f+=1){var m=v[f];this.addFeature(m,m.geometry,m.index,t,r)}},ds.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ds.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ds.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Kh),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},ds.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ds.prototype.addFeature=function(e,t,r,f,v){for(var m=0,x=co(t,500);m<x.length;m+=1){for(var T=x[m],D=0,N=0,V=T;N<V.length;N+=1)D+=V[N].length;for(var ne=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),oe=ne.vertexLength,Se=[],je=[],Fe=0,tt=T;Fe<tt.length;Fe+=1){var at=tt[Fe];if(at.length!==0){at!==T[0]&&je.push(Se.length/2);var Lt=this.segments2.prepareSegment(at.length,this.layoutVertexArray,this.indexArray2),Wt=Lt.vertexLength;this.layoutVertexArray.emplaceBack(at[0].x,at[0].y),this.indexArray2.emplaceBack(Wt+at.length-1,Wt),Se.push(at[0].x),Se.push(at[0].y);for(var qt=1;qt<at.length;qt++)this.layoutVertexArray.emplaceBack(at[qt].x,at[qt].y),this.indexArray2.emplaceBack(Wt+qt-1,Wt+qt),Se.push(at[qt].x),Se.push(at[qt].y);Lt.vertexLength+=at.length,Lt.primitiveLength+=at.length}}for(var Cr=uc(Se,je),vr=0;vr<Cr.length;vr+=3)this.indexArray.emplaceBack(oe+Cr[vr],oe+Cr[vr+1],oe+Cr[vr+2]);ne.vertexLength+=D,ne.primitiveLength+=Cr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,v,f)},En("FillBucket",ds,{omit:["layers","patternFeatures"]});var Ac=new jo({"fill-sort-key":new Mn(se.layout_fill["fill-sort-key"])}),Tf={paint:new jo({"fill-antialias":new Gn(se.paint_fill["fill-antialias"]),"fill-opacity":new Mn(se.paint_fill["fill-opacity"]),"fill-color":new Mn(se.paint_fill["fill-color"]),"fill-outline-color":new Mn(se.paint_fill["fill-outline-color"]),"fill-translate":new Gn(se.paint_fill["fill-translate"]),"fill-translate-anchor":new Gn(se.paint_fill["fill-translate-anchor"]),"fill-pattern":new ll(se.paint_fill["fill-pattern"])}),layout:Ac},Ap=function(e){function t(r){e.call(this,r,Tf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,f){e.prototype.recalculate.call(this,r,f);var v=this.paint._values["fill-outline-color"];v.value.kind==="constant"&&v.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new ds(r)},t.prototype.queryRadius=function(){return so(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,f,v,m,x,T,D){return qo(Du(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,D),m)},t.prototype.isTileClipped=function(){return!0},t}(Zu),$h=ao([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Cc=cf;function cf(e,t,r,f,v){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=f,this._values=v,e.readFields(Jh,this,t)}function Jh(e,t,r){e==1?t.id=r.readVarint():e==2?function(f,v){for(var m=f.readVarint()+f.pos;f.pos<m;){var x=v._keys[f.readVarint()],T=v._values[f.readVarint()];v.properties[x]=T}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function Qh(e){for(var t,r,f=0,v=0,m=e.length,x=m-1;v<m;x=v++)f+=((r=e[x]).x-(t=e[v]).x)*(t.y+r.y);return f}cf.types=["Unknown","Point","LineString","Polygon"],cf.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,f=1,v=0,m=0,x=0,T=[];e.pos<r;){if(v<=0){var D=e.readVarint();f=7&D,v=D>>3}if(v--,f===1||f===2)m+=e.readSVarint(),x+=e.readSVarint(),f===1&&(t&&T.push(t),t=[]),t.push(new ie(m,x));else{if(f!==7)throw new Error("unknown command "+f);t&&t.push(t[0].clone())}}return t&&T.push(t),T},cf.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,f=0,v=0,m=0,x=1/0,T=-1/0,D=1/0,N=-1/0;e.pos<t;){if(f<=0){var V=e.readVarint();r=7&V,f=V>>3}if(f--,r===1||r===2)(v+=e.readSVarint())<x&&(x=v),v>T&&(T=v),(m+=e.readSVarint())<D&&(D=m),m>N&&(N=m);else if(r!==7)throw new Error("unknown command "+r)}return[x,D,T,N]},cf.prototype.toGeoJSON=function(e,t,r){var f,v,m=this.extent*Math.pow(2,r),x=this.extent*e,T=this.extent*t,D=this.loadGeometry(),N=cf.types[this.type];function V(Se){for(var je=0;je<Se.length;je++){var Fe=Se[je];Se[je]=[360*(Fe.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Fe.y+T)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var ne=[];for(f=0;f<D.length;f++)ne[f]=D[f][0];V(D=ne);break;case 2:for(f=0;f<D.length;f++)V(D[f]);break;case 3:for(D=function(Se){var je=Se.length;if(je<=1)return[Se];for(var Fe,tt,at=[],Lt=0;Lt<je;Lt++){var Wt=Qh(Se[Lt]);Wt!==0&&(tt===void 0&&(tt=Wt<0),tt===Wt<0?(Fe&&at.push(Fe),Fe=[Se[Lt]]):Fe.push(Se[Lt]))}return Fe&&at.push(Fe),at}(D),f=0;f<D.length;f++)for(v=0;v<D[f].length;v++)V(D[f][v])}D.length===1?D=D[0]:N="Multi"+N;var oe={type:"Feature",geometry:{type:N,coordinates:D},properties:this.properties};return"id"in this&&(oe.id=this.id),oe};var Th=Ah;function Ah(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Cp,this,t),this.length=this._features.length}function Cp(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(f){for(var v=null,m=f.readVarint()+f.pos;f.pos<m;){var x=f.readVarint()>>3;v=x===1?f.readString():x===2?f.readFloat():x===3?f.readDouble():x===4?f.readVarint64():x===5?f.readVarint():x===6?f.readSVarint():x===7?f.readBoolean():null}return v}(r))}function lc(e,t,r){if(e===3){var f=new Th(r,r.readVarint()+r.pos);f.length&&(t[f.name]=f)}}Ah.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Cc(this._pbf,t,this.extent,this._keys,this._values)};var ff={VectorTile:function(t,r){this.layers=t.readFields(lc,{},r)},VectorTileFeature:Cc,VectorTileLayer:Th},Af=ff.VectorTileFeature.types,cc=Math.pow(2,13);function Xc(e,t,r,f,v,m,x,T){e.emplaceBack(t,r,2*Math.floor(f*cc)+x,v*cc*2,m*cc*2,Math.round(T))}var Wu=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Vu,this.indexArray=new hl,this.programConfigurations=new Ci(t.layers,t.zoom),this.segments=new ge,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function Nf(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Wu.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=uu("fill-extrusion",this.layers,t);for(var f=0,v=e;f<v.length;f+=1){var m=v[f],x=m.feature,T=m.id,D=m.index,N=m.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,ne=$a(x,V);if(this.layers[0]._featureFilter.filter(new Di(this.zoom),ne,r)){var oe={id:T,sourceLayerIndex:N,index:D,geometry:V?ne.geometry:La(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Hu("fill-extrusion",this.layers,oe,this.zoom,t)):this.addFeature(oe,oe.geometry,D,r,{}),t.featureIndex.insert(x,oe.geometry,D,N,this.index,!0)}}},Wu.prototype.addFeatures=function(e,t,r){for(var f=0,v=this.features;f<v.length;f+=1){var m=v[f];this.addFeature(m,m.geometry,m.index,t,r)}},Wu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Wu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Wu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Wu.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$h),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Wu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Wu.prototype.addFeature=function(e,t,r,f,v){for(var m=0,x=co(t,500);m<x.length;m+=1){for(var T=x[m],D=0,N=0,V=T;N<V.length;N+=1)D+=V[N].length;for(var ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),oe=0,Se=T;oe<Se.length;oe+=1){var je=Se[oe];if(je.length!==0&&!((Qi=je).every(function(Si){return Si.x<0})||Qi.every(function(Si){return Si.x>8192})||Qi.every(function(Si){return Si.y<0})||Qi.every(function(Si){return Si.y>8192})))for(var Fe=0,tt=0;tt<je.length;tt++){var at=je[tt];if(tt>=1){var Lt=je[tt-1];if(!Nf(at,Lt)){ne.vertexLength+4>ge.MAX_VERTEX_ARRAY_LENGTH&&(ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Wt=at.sub(Lt)._perp()._unit(),qt=Lt.dist(at);Fe+qt>32768&&(Fe=0),Xc(this.layoutVertexArray,at.x,at.y,Wt.x,Wt.y,0,0,Fe),Xc(this.layoutVertexArray,at.x,at.y,Wt.x,Wt.y,0,1,Fe),Xc(this.layoutVertexArray,Lt.x,Lt.y,Wt.x,Wt.y,0,0,Fe+=qt),Xc(this.layoutVertexArray,Lt.x,Lt.y,Wt.x,Wt.y,0,1,Fe);var Cr=ne.vertexLength;this.indexArray.emplaceBack(Cr,Cr+2,Cr+1),this.indexArray.emplaceBack(Cr+1,Cr+2,Cr+3),ne.vertexLength+=4,ne.primitiveLength+=2}}}}if(ne.vertexLength+D>ge.MAX_VERTEX_ARRAY_LENGTH&&(ne=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray)),Af[e.type]==="Polygon"){for(var vr=[],an=[],sn=ne.vertexLength,Tn=0,Un=T;Tn<Un.length;Tn+=1){var kn=Un[Tn];if(kn.length!==0){kn!==T[0]&&an.push(vr.length/2);for(var Pn=0;Pn<kn.length;Pn++){var ui=kn[Pn];Xc(this.layoutVertexArray,ui.x,ui.y,0,0,1,1,0),vr.push(ui.x),vr.push(ui.y)}}}for(var Jn=uc(vr,an),Vn=0;Vn<Jn.length;Vn+=3)this.indexArray.emplaceBack(sn+Jn[Vn],sn+Jn[Vn+2],sn+Jn[Vn+1]);ne.primitiveLength+=Jn.length/3,ne.vertexLength+=D}}var Qi;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,v,f)},En("FillExtrusionBucket",Wu,{omit:["layers","features"]});var Ch={paint:new jo({"fill-extrusion-opacity":new Gn(se["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Mn(se["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Gn(se["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Gn(se["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ll(se["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Mn(se["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Mn(se["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Gn(se["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},_u=function(e){function t(r){e.call(this,r,Ch)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Wu(r)},t.prototype.queryRadius=function(){return so(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,f,v,m,x,T,D,N){var V=Du(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,D),ne=this.paint.get("fill-extrusion-height").evaluate(f,v),oe=this.paint.get("fill-extrusion-base").evaluate(f,v),Se=function(Fe,tt,at,Lt){for(var Wt=[],qt=0,Cr=Fe;qt<Cr.length;qt+=1){var vr=Cr[qt],an=[vr.x,vr.y,0,1];Xs(an,an,tt),Wt.push(new ie(an[0]/an[3],an[1]/an[3]))}return Wt}(V,N),je=function(Fe,tt,at,Lt){for(var Wt=[],qt=[],Cr=Lt[8]*tt,vr=Lt[9]*tt,an=Lt[10]*tt,sn=Lt[11]*tt,Tn=Lt[8]*at,Un=Lt[9]*at,kn=Lt[10]*at,Pn=Lt[11]*at,ui=0,Jn=Fe;ui<Jn.length;ui+=1){for(var Vn=[],Qi=[],Si=0,ga=Jn[ui];Si<ga.length;Si+=1){var li=ga[Si],aa=li.x,fo=li.y,Qa=Lt[0]*aa+Lt[4]*fo+Lt[12],_o=Lt[1]*aa+Lt[5]*fo+Lt[13],xo=Lt[2]*aa+Lt[6]*fo+Lt[14],Xo=Lt[3]*aa+Lt[7]*fo+Lt[15],lu=xo+an,gs=Xo+sn,cu=Qa+Tn,Bs=_o+Un,Us=xo+kn,Ts=Xo+Pn,Yo=new ie((Qa+Cr)/gs,(_o+vr)/gs);Yo.z=lu/gs,Vn.push(Yo);var ns=new ie(cu/Ts,Bs/Ts);ns.z=Us/Ts,Qi.push(ns)}Wt.push(Vn),qt.push(Qi)}return[Wt,qt]}(m,oe,ne,N);return function(Fe,tt,at){var Lt=1/0;qo(at,tt)&&(Lt=Zo(at,tt[0]));for(var Wt=0;Wt<tt.length;Wt++)for(var qt=tt[Wt],Cr=Fe[Wt],vr=0;vr<qt.length-1;vr++){var an=qt[vr],sn=[an,qt[vr+1],Cr[vr+1],Cr[vr],an];dl(at,sn)&&(Lt=Math.min(Lt,Zo(at,sn)))}return Lt!==1/0&&Lt}(je[0],je[1],Se)},t}(Zu);function yl(e,t){return e.x*t.x+e.y*t.y}function Zo(e,t){if(e.length===1){for(var r,f=0,v=t[f++];!r||v.equals(r);)if(!(r=t[f++]))return 1/0;for(;f<t.length;f++){var m=t[f],x=e[0],T=r.sub(v),D=m.sub(v),N=x.sub(v),V=yl(T,T),ne=yl(T,D),oe=yl(D,D),Se=yl(N,T),je=yl(N,D),Fe=V*oe-ne*ne,tt=(oe*Se-ne*je)/Fe,at=(V*je-ne*Se)/Fe,Lt=v.z*(1-tt-at)+r.z*tt+m.z*at;if(isFinite(Lt))return Lt}return 1/0}for(var Wt=1/0,qt=0,Cr=t;qt<Cr.length;qt+=1)Wt=Math.min(Wt,Cr[qt].z);return Wt}var Fs=ao([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Ph=ao([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,qh=ff.VectorTileFeature.types,ep=Math.cos(Math.PI/180*37.5),Mh=Math.pow(2,14)/.5,Ks=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(f){return f.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(f){r.gradients[f.id]={}}),this.layoutVertexArray=new Rs,this.layoutVertexArray2=new nc,this.indexArray=new hl,this.programConfigurations=new Ci(t.layers,t.zoom),this.segments=new ge,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(f){return f.isStateDependent()}).map(function(f){return f.id})};Ks.prototype.populate=function(e,t,r){this.hasPattern=uu("line",this.layers,t);for(var f=this.layers[0].layout.get("line-sort-key"),v=[],m=0,x=e;m<x.length;m+=1){var T=x[m],D=T.feature,N=T.id,V=T.index,ne=T.sourceLayerIndex,oe=this.layers[0]._featureFilter.needGeometry,Se=$a(D,oe);if(this.layers[0]._featureFilter.filter(new Di(this.zoom),Se,r)){var je=f?f.evaluate(Se,{},r):void 0,Fe={id:N,properties:D.properties,type:D.type,sourceLayerIndex:ne,index:V,geometry:oe?Se.geometry:La(D),patterns:{},sortKey:je};v.push(Fe)}}f&&v.sort(function(an,sn){return an.sortKey-sn.sortKey});for(var tt=0,at=v;tt<at.length;tt+=1){var Lt=at[tt],Wt=Lt.geometry,qt=Lt.index,Cr=Lt.sourceLayerIndex;if(this.hasPattern){var vr=Hu("line",this.layers,Lt,this.zoom,t);this.patternFeatures.push(vr)}else this.addFeature(Lt,Wt,qt,r,{});t.featureIndex.insert(e[qt].feature,Wt,qt,Cr,this.index)}},Ks.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ks.prototype.addFeatures=function(e,t,r){for(var f=0,v=this.patternFeatures;f<v.length;f+=1){var m=v[f];this.addFeature(m,m.geometry,m.index,t,r)}},Ks.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ks.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ks.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Ph)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Fs),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ks.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ks.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Ks.prototype.addFeature=function(e,t,r,f,v){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),T=m.get("line-cap"),D=m.get("line-miter-limit"),N=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var V=0,ne=t;V<ne.length;V+=1)this.addLine(ne[V],e,x,T,D,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,v,f)},Ks.prototype.addLine=function(e,t,r,f,v,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var T=qh[t.type]==="Polygon",D=e.length;D>=2&&e[D-1].equals(e[D-2]);)D--;for(var N=0;N<D-1&&e[N].equals(e[N+1]);)N++;if(!(D<(T?3:2))){r==="bevel"&&(v=1.05);var V,ne=this.overscaling<=16?122880/(512*this.overscaling):0,oe=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray),Se=void 0,je=void 0,Fe=void 0,tt=void 0;this.e1=this.e2=-1,T&&(tt=e[N].sub(V=e[D-2])._unit()._perp());for(var at=N;at<D;at++)if(!(je=at===D-1?T?e[N+1]:void 0:e[at+1])||!e[at].equals(je)){tt&&(Fe=tt),V&&(Se=V),V=e[at],tt=je?je.sub(V)._unit()._perp():Fe;var Lt=(Fe=Fe||tt).add(tt);Lt.x===0&&Lt.y===0||Lt._unit();var Wt=Fe.x*tt.x+Fe.y*tt.y,qt=Lt.x*tt.x+Lt.y*tt.y,Cr=qt!==0?1/qt:1/0,vr=2*Math.sqrt(2-2*qt),an=qt<ep&&Se&&je,sn=Fe.x*tt.y-Fe.y*tt.x>0;if(an&&at>N){var Tn=V.dist(Se);if(Tn>2*ne){var Un=V.sub(V.sub(Se)._mult(ne/Tn)._round());this.updateDistance(Se,Un),this.addCurrentVertex(Un,Fe,0,0,oe),Se=Un}}var kn=Se&&je,Pn=kn?r:T?"butt":f;if(kn&&Pn==="round"&&(Cr<m?Pn="miter":Cr<=2&&(Pn="fakeround")),Pn==="miter"&&Cr>v&&(Pn="bevel"),Pn==="bevel"&&(Cr>2&&(Pn="flipbevel"),Cr<v&&(Pn="miter")),Se&&this.updateDistance(Se,V),Pn==="miter")Lt._mult(Cr),this.addCurrentVertex(V,Lt,0,0,oe);else if(Pn==="flipbevel"){if(Cr>100)Lt=tt.mult(-1);else{var ui=Cr*Fe.add(tt).mag()/Fe.sub(tt).mag();Lt._perp()._mult(ui*(sn?-1:1))}this.addCurrentVertex(V,Lt,0,0,oe),this.addCurrentVertex(V,Lt.mult(-1),0,0,oe)}else if(Pn==="bevel"||Pn==="fakeround"){var Jn=-Math.sqrt(Cr*Cr-1),Vn=sn?Jn:0,Qi=sn?0:Jn;if(Se&&this.addCurrentVertex(V,Fe,Vn,Qi,oe),Pn==="fakeround")for(var Si=Math.round(180*vr/Math.PI/20),ga=1;ga<Si;ga++){var li=ga/Si;if(li!==.5){var aa=li-.5;li+=li*aa*(li-1)*((1.0904+Wt*(Wt*(3.55645-1.43519*Wt)-3.2452))*aa*aa+(.848013+Wt*(.215638*Wt-1.06021)))}var fo=tt.sub(Fe)._mult(li)._add(Fe)._unit()._mult(sn?-1:1);this.addHalfVertex(V,fo.x,fo.y,!1,sn,0,oe)}je&&this.addCurrentVertex(V,tt,-Vn,-Qi,oe)}else if(Pn==="butt")this.addCurrentVertex(V,Lt,0,0,oe);else if(Pn==="square"){var Qa=Se?1:-1;this.addCurrentVertex(V,Lt,Qa,Qa,oe)}else Pn==="round"&&(Se&&(this.addCurrentVertex(V,Fe,0,0,oe),this.addCurrentVertex(V,Fe,1,1,oe,!0)),je&&(this.addCurrentVertex(V,tt,-1,-1,oe,!0),this.addCurrentVertex(V,tt,0,0,oe)));if(an&&at<D-1){var _o=V.dist(je);if(_o>2*ne){var xo=V.add(je.sub(V)._mult(ne/_o)._round());this.updateDistance(V,xo),this.addCurrentVertex(xo,tt,0,0,oe),V=xo}}}}},Ks.prototype.addCurrentVertex=function(e,t,r,f,v,m){m===void 0&&(m=!1);var x=t.y*f-t.x,T=-t.y-t.x*f;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,m,!1,r,v),this.addHalfVertex(e,x,T,m,!0,-f,v),this.distance>Mh/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,f,v,m))},Ks.prototype.addHalfVertex=function(e,t,r,f,v,m,x){var T=.5*(this.lineClips?this.scaledDistance*(Mh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(f?1:0),(e.y<<1)+(v?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(m===0?0:m<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var D=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),x.primitiveLength++),v?this.e2=D:this.e1=D},Ks.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ks.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},En("LineBucket",Ks,{omit:["layers","patternFeatures"]});var tp=new jo({"line-cap":new Gn(se.layout_line["line-cap"]),"line-join":new Mn(se.layout_line["line-join"]),"line-miter-limit":new Gn(se.layout_line["line-miter-limit"]),"line-round-limit":new Gn(se.layout_line["line-round-limit"]),"line-sort-key":new Mn(se.layout_line["line-sort-key"])}),rp={paint:new jo({"line-opacity":new Mn(se.paint_line["line-opacity"]),"line-color":new Mn(se.paint_line["line-color"]),"line-translate":new Gn(se.paint_line["line-translate"]),"line-translate-anchor":new Gn(se.paint_line["line-translate-anchor"]),"line-width":new Mn(se.paint_line["line-width"]),"line-gap-width":new Mn(se.paint_line["line-gap-width"]),"line-offset":new Mn(se.paint_line["line-offset"]),"line-blur":new Mn(se.paint_line["line-blur"]),"line-dasharray":new fs(se.paint_line["line-dasharray"]),"line-pattern":new ll(se.paint_line["line-pattern"]),"line-gradient":new Io(se.paint_line["line-gradient"])}),layout:tp},Ih=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,f){return f=new Di(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),e.prototype.possiblyEvaluate.call(this,r,f)},t.prototype.evaluate=function(r,f,v,m){return f=er({},f,{zoom:Math.floor(f.zoom)}),e.prototype.evaluate.call(this,r,f,v,m)},t}(Mn))(rp.paint.properties["line-width"].specification);Ih.useIntegerZoom=!0;var np=function(e){function t(r){e.call(this,r,rp),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Wo,this.gradientVersion=(this.gradientVersion+1)%we)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,f){e.prototype.recalculate.call(this,r,f),this.paint._values["line-floorwidth"]=Ih.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Ks(r)},t.prototype.queryRadius=function(r){var f=r,v=Oh(su("line-width",this,f),su("line-gap-width",this,f)),m=su("line-offset",this,f);return v/2+Math.abs(m)+so(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,f,v,m,x,T,D){var N=Du(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,D),V=D/2*Oh(this.paint.get("line-width").evaluate(f,v),this.paint.get("line-gap-width").evaluate(f,v)),ne=this.paint.get("line-offset").evaluate(f,v);return ne&&(m=function(oe,Se){for(var je=[],Fe=new ie(0,0),tt=0;tt<oe.length;tt++){for(var at=oe[tt],Lt=[],Wt=0;Wt<at.length;Wt++){var qt=at[Wt],Cr=at[Wt+1],vr=Wt===0?Fe:qt.sub(at[Wt-1])._unit()._perp(),an=Wt===at.length-1?Fe:Cr.sub(qt)._unit()._perp(),sn=vr._add(an)._unit();sn._mult(1/(sn.x*an.x+sn.y*an.y)),Lt.push(sn._mult(Se)._add(qt))}je.push(Lt)}return je}(m,ne*D)),function(oe,Se,je){for(var Fe=0;Fe<Se.length;Fe++){var tt=Se[Fe];if(oe.length>=3){for(var at=0;at<tt.length;at++)if(Ru(oe,tt[at]))return!0}if(Ds(oe,tt,je))return!0}return!1}(N,m,V)},t.prototype.isTileClipped=function(){return!0},t}(Zu);function Oh(e,t){return t>0?t+2*e:e}var Bf=ao([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ip=ao([{name:"a_projected_pos",components:3,type:"Float32"}],4),hf=(ao([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ao([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),oh=(ao([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),ao([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Lh=ao([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Rh(e,t,r){return e.sections.forEach(function(f){f.text=function(v,m,x){var T=m.layout.get("text-transform").evaluate(x,{});return T==="uppercase"?v=v.toLocaleUpperCase():T==="lowercase"&&(v=v.toLocaleLowerCase()),Ls.applyArabicShaping&&(v=Ls.applyArabicShaping(v)),v}(f.text,t,r)}),e}ao([{name:"triangle",components:3,type:"Uint16"}]),ao([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ao([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ao([{type:"Float32",name:"offsetX"}]),ao([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var fc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},sh=function(t,r,f,v,m){var x,T,D=8*m-v-1,N=(1<<D)-1,V=N>>1,ne=-7,oe=f?m-1:0,Se=f?-1:1,je=t[r+oe];for(oe+=Se,x=je&(1<<-ne)-1,je>>=-ne,ne+=D;ne>0;x=256*x+t[r+oe],oe+=Se,ne-=8);for(T=x&(1<<-ne)-1,x>>=-ne,ne+=v;ne>0;T=256*T+t[r+oe],oe+=Se,ne-=8);if(x===0)x=1-V;else{if(x===N)return T?NaN:1/0*(je?-1:1);T+=Math.pow(2,v),x-=V}return(je?-1:1)*T*Math.pow(2,x-v)},J=function(t,r,f,v,m,x){var T,D,N,V=8*x-m-1,ne=(1<<V)-1,oe=ne>>1,Se=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,je=v?0:x-1,Fe=v?1:-1,tt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(D=isNaN(r)?1:0,T=ne):(T=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-T))<1&&(T--,N*=2),(r+=T+oe>=1?Se/N:Se*Math.pow(2,1-oe))*N>=2&&(T++,N/=2),T+oe>=ne?(D=0,T=ne):T+oe>=1?(D=(r*N-1)*Math.pow(2,m),T+=oe):(D=r*Math.pow(2,oe-1)*Math.pow(2,m),T=0));m>=8;t[f+je]=255&D,je+=Fe,D/=256,m-=8);for(T=T<<m|D,V+=m;V>0;t[f+je]=255&T,je+=Fe,T/=256,V-=8);t[f+je-Fe]|=128*tt},he=Ue;function Ue(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Ue.Varint=0,Ue.Fixed64=1,Ue.Bytes=2,Ue.Fixed32=5;var Vt=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function yr(e){return e.type===Ue.Bytes?e.readVarint()+e.pos:e.pos+1}function pr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function rr(e,t,r){var f=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(f);for(var v=r.pos-1;v>=e;v--)r.buf[v+f]=r.buf[v]}function kr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function rn(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Wr(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function $r(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function on(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function gn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function cn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function en(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function ir(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Jt(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function jr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function yn(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function br(e,t,r){e===1&&r.readMessage(Yn,t)}function Yn(e,t,r){if(e===3){var f=r.readMessage(Gr,{}),v=f.width,m=f.height,x=f.left,T=f.top,D=f.advance;t.push({id:f.id,bitmap:new Ys({width:v+6,height:m+6},f.bitmap),metrics:{width:v,height:m,left:x,top:T,advance:D}})}}function Gr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Br(e){for(var t=0,r=0,f=0,v=e;f<v.length;f+=1){var m=v[f];t+=m.w*m.h,r=Math.max(r,m.w)}e.sort(function(Fe,tt){return tt.h-Fe.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],T=0,D=0,N=0,V=e;N<V.length;N+=1)for(var ne=V[N],oe=x.length-1;oe>=0;oe--){var Se=x[oe];if(!(ne.w>Se.w||ne.h>Se.h)){if(ne.x=Se.x,ne.y=Se.y,D=Math.max(D,ne.y+ne.h),T=Math.max(T,ne.x+ne.w),ne.w===Se.w&&ne.h===Se.h){var je=x.pop();oe<x.length&&(x[oe]=je)}else ne.h===Se.h?(Se.x+=ne.w,Se.w-=ne.w):ne.w===Se.w?(Se.y+=ne.h,Se.h-=ne.h):(x.push({x:Se.x+ne.w,y:Se.y,w:Se.w-ne.w,h:ne.h}),Se.y+=ne.h,Se.h-=ne.h);break}}return{w:T,h:D,fill:t/(T*D)||0}}Ue.prototype={destroy:function(){this.buf=null},readFields:function(t,r,f){for(f=f||this.length;this.pos<f;){var v=this.readVarint(),m=v>>3,x=this.pos;this.type=7&v,t(m,r,this),this.pos===x&&this.skip(v)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=Jt(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=yn(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Jt(this.buf,this.pos)+4294967296*Jt(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Jt(this.buf,this.pos)+4294967296*yn(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=sh(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=sh(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,f,v=this.buf;return r=127&(f=v[this.pos++]),f<128?r:(r|=(127&(f=v[this.pos++]))<<7,f<128?r:(r|=(127&(f=v[this.pos++]))<<14,f<128?r:(r|=(127&(f=v[this.pos++]))<<21,f<128?r:function(m,x,T){var D,N,V=T.buf;if(D=(112&(N=V[T.pos++]))>>4,N<128||(D|=(127&(N=V[T.pos++]))<<3,N<128)||(D|=(127&(N=V[T.pos++]))<<10,N<128)||(D|=(127&(N=V[T.pos++]))<<17,N<128)||(D|=(127&(N=V[T.pos++]))<<24,N<128)||(D|=(1&(N=V[T.pos++]))<<31,N<128))return pr(m,D,x);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(f=v[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&Vt?function(f,v,m){return Vt.decode(f.subarray(v,m))}(this.buf,r,t):function(f,v,m){for(var x="",T=v;T<m;){var D,N,V,ne=f[T],oe=null,Se=ne>239?4:ne>223?3:ne>191?2:1;if(T+Se>m)break;Se===1?ne<128&&(oe=ne):Se===2?(192&(D=f[T+1]))==128&&(oe=(31&ne)<<6|63&D)<=127&&(oe=null):Se===3?(N=f[T+2],(192&(D=f[T+1]))==128&&(192&N)==128&&((oe=(15&ne)<<12|(63&D)<<6|63&N)<=2047||oe>=55296&&oe<=57343)&&(oe=null)):Se===4&&(N=f[T+2],V=f[T+3],(192&(D=f[T+1]))==128&&(192&N)==128&&(192&V)==128&&((oe=(15&ne)<<18|(63&D)<<12|(63&N)<<6|63&V)<=65535||oe>=1114112)&&(oe=null)),oe===null?(oe=65533,Se=1):oe>65535&&(oe-=65536,x+=String.fromCharCode(oe>>>10&1023|55296),oe=56320|1023&oe),x+=String.fromCharCode(oe),T+=Se}return x}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==Ue.Bytes)return t.push(this.readVarint(r));var f=yr(this);for(t=t||[];this.pos<f;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==Ue.Bytes)return t.push(this.readSVarint());var r=yr(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ue.Bytes)return t.push(this.readBoolean());var r=yr(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ue.Bytes)return t.push(this.readFloat());var r=yr(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ue.Bytes)return t.push(this.readDouble());var r=yr(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ue.Bytes)return t.push(this.readFixed32());var r=yr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ue.Bytes)return t.push(this.readSFixed32());var r=yr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ue.Bytes)return t.push(this.readFixed64());var r=yr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ue.Bytes)return t.push(this.readSFixed64());var r=yr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===Ue.Varint)for(;this.buf[this.pos++]>127;);else if(r===Ue.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Ue.Fixed32)this.pos+=4;else{if(r!==Ue.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var f=new Uint8Array(r);f.set(this.buf),this.buf=f,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),jr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),jr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),jr(this.buf,-1&t,this.pos),jr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),jr(this.buf,-1&t,this.pos),jr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,f){var v,m;if(r>=0?(v=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(v=~(-r%4294967296))?v=v+1|0:(v=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(x,T,D){D.buf[D.pos++]=127&x|128,x>>>=7,D.buf[D.pos++]=127&x|128,x>>>=7,D.buf[D.pos++]=127&x|128,x>>>=7,D.buf[D.pos++]=127&x|128,D.buf[D.pos]=127&(x>>>=7)}(v,0,f),function(x,T){var D=(7&x)<<4;T.buf[T.pos++]|=D|((x>>>=3)?128:0),x&&(T.buf[T.pos++]=127&x|((x>>>=7)?128:0),x&&(T.buf[T.pos++]=127&x|((x>>>=7)?128:0),x&&(T.buf[T.pos++]=127&x|((x>>>=7)?128:0),x&&(T.buf[T.pos++]=127&x|((x>>>=7)?128:0),x&&(T.buf[T.pos++]=127&x)))))}(m,f)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(v,m,x){for(var T,D,N=0;N<m.length;N++){if((T=m.charCodeAt(N))>55295&&T<57344){if(!D){T>56319||N+1===m.length?(v[x++]=239,v[x++]=191,v[x++]=189):D=T;continue}if(T<56320){v[x++]=239,v[x++]=191,v[x++]=189,D=T;continue}T=D-55296<<10|T-56320|65536,D=null}else D&&(v[x++]=239,v[x++]=191,v[x++]=189,D=null);T<128?v[x++]=T:(T<2048?v[x++]=T>>6|192:(T<65536?v[x++]=T>>12|224:(v[x++]=T>>18|240,v[x++]=T>>12&63|128),v[x++]=T>>6&63|128),v[x++]=63&T|128)}return x}(this.buf,t,this.pos);var f=this.pos-r;f>=128&&rr(r,f,this),this.pos=r-1,this.writeVarint(f),this.pos+=f},writeFloat:function(t){this.realloc(4),J(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),J(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var f=0;f<r;f++)this.buf[this.pos++]=t[f]},writeRawMessage:function(t,r){this.pos++;var f=this.pos;t(r,this);var v=this.pos-f;v>=128&&rr(f,v,this),this.pos=f-1,this.writeVarint(v),this.pos+=v},writeMessage:function(t,r,f){this.writeTag(t,Ue.Bytes),this.writeRawMessage(r,f)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,kr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,rn,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,on,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,Wr,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,$r,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,gn,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,cn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,en,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,ir,r)},writeBytesField:function(t,r){this.writeTag(t,Ue.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,Ue.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,Ue.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,Ue.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,Ue.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,Ue.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,Ue.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,Ue.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,Ue.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,Ue.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Fr=function(t,r){var f=r.pixelRatio,v=r.version,m=r.stretchX,x=r.stretchY,T=r.content;this.paddedRect=t,this.pixelRatio=f,this.stretchX=m,this.stretchY=x,this.content=T,this.version=v},Xr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Xr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Xr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Xr.tlbr.get=function(){return this.tl.concat(this.br)},Xr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Fr.prototype,Xr);var jn=function(t,r){var f={},v={};this.haveRenderCallbacks=[];var m=[];this.addImages(t,f,m),this.addImages(r,v,m);var x=Br(m),T=new Fo({width:x.w||1,height:x.h||1});for(var D in t){var N=t[D],V=f[D].paddedRect;Fo.copy(N.data,T,{x:0,y:0},{x:V.x+1,y:V.y+1},N.data)}for(var ne in r){var oe=r[ne],Se=v[ne].paddedRect,je=Se.x+1,Fe=Se.y+1,tt=oe.data.width,at=oe.data.height;Fo.copy(oe.data,T,{x:0,y:0},{x:je,y:Fe},oe.data),Fo.copy(oe.data,T,{x:0,y:at-1},{x:je,y:Fe-1},{width:tt,height:1}),Fo.copy(oe.data,T,{x:0,y:0},{x:je,y:Fe+at},{width:tt,height:1}),Fo.copy(oe.data,T,{x:tt-1,y:0},{x:je-1,y:Fe},{width:1,height:at}),Fo.copy(oe.data,T,{x:0,y:0},{x:je+tt,y:Fe},{width:1,height:at})}this.image=T,this.iconPositions=f,this.patternPositions=v};jn.prototype.addImages=function(e,t,r){for(var f in e){var v=e[f],m={x:0,y:0,w:v.data.width+2,h:v.data.height+2};r.push(m),t[f]=new Fr(m,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(f)}},jn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},jn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var f=e.tl;r.update(t.data,void 0,{x:f[0],y:f[1]})}},En("ImagePosition",Fr),En("ImageAtlas",jn);var qn={horizontal:1,vertical:2,horizontalOnly:3},ln=function(){this.scale=1,this.fontStack="",this.imageName=null};ln.forText=function(e,t){var r=new ln;return r.scale=e||1,r.fontStack=t,r},ln.forImage=function(e){var t=new ln;return t.imageName=e,t};var Nr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Rr(e,t,r,f,v,m,x,T,D,N,V,ne,oe,Se,je,Fe){var tt,at=Nr.fromFeature(e,v);ne===qn.vertical&&at.verticalizePunctuation();var Lt=Ls.processBidirectionalText,Wt=Ls.processStyledBidirectionalText;if(Lt&&at.sections.length===1){tt=[];for(var qt=0,Cr=Lt(at.toString(),ca(at,N,m,t,f,Se,je));qt<Cr.length;qt+=1){var vr=Cr[qt],an=new Nr;an.text=vr,an.sections=at.sections;for(var sn=0;sn<vr.length;sn++)an.sectionIndex.push(0);tt.push(an)}}else if(Wt){tt=[];for(var Tn=0,Un=Wt(at.text,at.sectionIndex,ca(at,N,m,t,f,Se,je));Tn<Un.length;Tn+=1){var kn=Un[Tn],Pn=new Nr;Pn.text=kn[0],Pn.sectionIndex=kn[1],Pn.sections=at.sections,tt.push(Pn)}}else tt=function(Vn,Qi){for(var Si=[],ga=Vn.text,li=0,aa=0,fo=Qi;aa<fo.length;aa+=1){var Qa=fo[aa];Si.push(Vn.substring(li,Qa)),li=Qa}return li<ga.length&&Si.push(Vn.substring(li,ga.length)),Si}(at,ca(at,N,m,t,f,Se,je));var ui=[],Jn={positionedLines:ui,text:at.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:ne,iconsInText:!1,verticalizable:!1};return function(Vn,Qi,Si,ga,li,aa,fo,Qa,_o,xo,Xo,lu){for(var gs=0,cu=-17,Bs=0,Us=0,Ts=Qa==="right"?1:Qa==="left"?0:.5,Yo=0,ns=0,fa=li;ns<fa.length;ns+=1){var na=fa[ns];na.trim();var Va=na.getMaxScale(),eo=24*(Va-1),xu={positionedGlyphs:[],lineOffset:0};Vn.positionedLines[Yo]=xu;var qa=xu.positionedGlyphs,Co=0;if(na.length()){for(var fu=0;fu<na.length();fu++){var ia=na.getSection(fu),Jc=na.getSectionIndex(fu),is=na.getCharCode(fu),Hl=0,bl=null,qs=null,pf=null,hc=24,Pc=!(_o===qn.horizontal||!Xo&&!Iu(is)||Xo&&(ri[is]||(Mf=is,Qr.Arabic(Mf)||Qr["Arabic Supplement"](Mf)||Qr["Arabic Extended-A"](Mf)||Qr["Arabic Presentation Forms-A"](Mf)||Qr["Arabic Presentation Forms-B"](Mf))));if(ia.imageName){var hh=ga[ia.imageName];if(!hh)continue;pf=ia.imageName,Vn.iconsInText=Vn.iconsInText||!0,qs=hh.paddedRect;var Qc=hh.displaySize;ia.scale=24*ia.scale/lu,Hl=eo+(24-Qc[1]*ia.scale),hc=(bl={width:Qc[0],height:Qc[1],left:1,top:-3,advance:Pc?Qc[1]:Qc[0]}).advance;var Pf=Pc?Qc[0]*ia.scale-24*Va:Qc[1]*ia.scale-24*Va;Pf>0&&Pf>Co&&(Co=Pf)}else{var Gf=Si[ia.fontStack],ph=Gf&&Gf[is];if(ph&&ph.rect)qs=ph.rect,bl=ph.metrics;else{var Hf=Qi[ia.fontStack],qc=Hf&&Hf[is];if(!qc)continue;bl=qc.metrics}Hl=24*(Va-ia.scale)}Pc?(Vn.verticalizable=!0,qa.push({glyph:is,imageName:pf,x:gs,y:cu+Hl,vertical:Pc,scale:ia.scale,fontStack:ia.fontStack,sectionIndex:Jc,metrics:bl,rect:qs}),gs+=hc*ia.scale+xo):(qa.push({glyph:is,imageName:pf,x:gs,y:cu+Hl,vertical:Pc,scale:ia.scale,fontStack:ia.fontStack,sectionIndex:Jc,metrics:bl,rect:qs}),gs+=bl.advance*ia.scale+xo)}qa.length!==0&&(Bs=Math.max(gs-xo,Bs),zs(qa,0,qa.length-1,Ts,Co)),gs=0;var up=aa*Va+Co;xu.lineOffset=Math.max(Co,eo),cu+=up,Us=Math.max(up,Us),++Yo}else cu+=aa,++Yo}var Mf,dh=cu- -17,lp=zo(fo),Wf=lp.horizontalAlign,If=lp.verticalAlign;(function(vh,kh,Fh,Xf,zh,cp,df,mh,gh){var Nh,Bh=(kh-Fh)*zh;Nh=cp!==df?-mh*Xf- -17:(-Xf*gh+.5)*df;for(var yh=0,Uh=vh;yh<Uh.length;yh+=1)for(var vf=0,Yf=Uh[yh].positionedGlyphs;vf<Yf.length;vf+=1){var _h=Yf[vf];_h.x+=Bh,_h.y+=Nh}})(Vn.positionedLines,Ts,Wf,If,Bs,Us,aa,dh,li.length),Vn.top+=-If*dh,Vn.bottom=Vn.top+dh,Vn.left+=-Wf*Bs,Vn.right=Vn.left+Bs}(Jn,t,r,f,tt,x,T,D,ne,N,oe,Fe),!function(Vn){for(var Qi=0,Si=Vn;Qi<Si.length;Qi+=1)if(Si[Qi].positionedGlyphs.length!==0)return!1;return!0}(ui)&&Jn}Nr.fromFeature=function(e,t){for(var r=new Nr,f=0;f<e.sections.length;f++){var v=e.sections[f];v.image?r.addImageSection(v):r.addTextSection(v,t)}return r},Nr.prototype.length=function(){return this.text.length},Nr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Nr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Nr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Nr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var f=e.charCodeAt(r+1)||null,v=e.charCodeAt(r-1)||null;t+=f&&Is(f)&&!fc[e[r+1]]||v&&Is(v)&&!fc[e[r-1]]||!fc[e[r]]?e[r]:fc[e[r]]}return t}(this.text)},Nr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&ri[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,f=this.text.length-1;f>=0&&f>=e&&ri[this.text.charCodeAt(f)];f--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Nr.prototype.substring=function(e,t){var r=new Nr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Nr.prototype.toString=function(){return this.text},Nr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Nr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(ln.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,f=0;f<e.text.length;++f)this.sectionIndex.push(r)},Nr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(ln.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Pe("Reached maximum number of images 6401")}else Pe("Can't add FormattedSection with an empty image.")},Nr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ri={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ni={};function Ln(e,t,r,f,v,m){if(t.imageName){var x=f[t.imageName];return x?x.displaySize[0]*t.scale*24/m+v:0}var T=r[t.fontStack],D=T&&T[e];return D?D.metrics.advance*t.scale+v:0}function Vi(e,t,r,f){var v=Math.pow(e-t,2);return f?e<t?v/2:2*v:v+Math.abs(r)*r}function wi(e,t,r){var f=0;return e===10&&(f-=1e4),r&&(f+=150),e!==40&&e!==65288||(f+=50),t!==41&&t!==65289||(f+=50),f}function Gi(e,t,r,f,v,m){for(var x=null,T=Vi(t,r,v,m),D=0,N=f;D<N.length;D+=1){var V=N[D],ne=Vi(t-V.x,r,v,m)+V.badness;ne<=T&&(x=V,T=ne)}return{index:e,x:t,priorBreak:x,badness:T}}function ca(e,t,r,f,v,m,x){if(m!=="point")return[];if(!e)return[];for(var T,D=[],N=function(tt,at,Lt,Wt,qt,Cr){for(var vr=0,an=0;an<tt.length();an++){var sn=tt.getSection(an);vr+=Ln(tt.getCharCode(an),sn,Wt,qt,at,Cr)}return vr/Math.max(1,Math.ceil(vr/Lt))}(e,t,r,f,v,x),V=e.text.indexOf("\u200B")>=0,ne=0,oe=0;oe<e.length();oe++){var Se=e.getSection(oe),je=e.getCharCode(oe);if(ri[je]||(ne+=Ln(je,Se,f,v,t,x)),oe<e.length()-1){var Fe=!((T=je)<11904||!(Qr["Bopomofo Extended"](T)||Qr.Bopomofo(T)||Qr["CJK Compatibility Forms"](T)||Qr["CJK Compatibility Ideographs"](T)||Qr["CJK Compatibility"](T)||Qr["CJK Radicals Supplement"](T)||Qr["CJK Strokes"](T)||Qr["CJK Symbols and Punctuation"](T)||Qr["CJK Unified Ideographs Extension A"](T)||Qr["CJK Unified Ideographs"](T)||Qr["Enclosed CJK Letters and Months"](T)||Qr["Halfwidth and Fullwidth Forms"](T)||Qr.Hiragana(T)||Qr["Ideographic Description Characters"](T)||Qr["Kangxi Radicals"](T)||Qr["Katakana Phonetic Extensions"](T)||Qr.Katakana(T)||Qr["Vertical Forms"](T)||Qr["Yi Radicals"](T)||Qr["Yi Syllables"](T)));(ni[je]||Fe||Se.imageName)&&D.push(Gi(oe+1,ne,N,D,wi(je,e.getCharCode(oe+1),Fe&&V),!1))}}return function tt(at){return at?tt(at.priorBreak).concat(at.index):[]}(Gi(e.length(),ne,N,D,0,!0))}function zo(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function zs(e,t,r,f,v){if(f||v)for(var m=e[r],x=(e[r].x+m.metrics.advance*m.scale)*f,T=t;T<=r;T++)e[T].x-=x,e[T].y+=v}function Hi(e,t,r,f,v,m){var x,T=e.image;if(T.content){var D=T.content,N=T.pixelRatio||1;x=[D[0]/N,D[1]/N,T.displaySize[0]-D[2]/N,T.displaySize[1]-D[3]/N]}var V,ne,oe,Se,je=t.left*m,Fe=t.right*m;r==="width"||r==="both"?(Se=v[0]+je-f[3],ne=v[0]+Fe+f[1]):ne=(Se=v[0]+(je+Fe-T.displaySize[0])/2)+T.displaySize[0];var tt=t.top*m,at=t.bottom*m;return r==="height"||r==="both"?(V=v[1]+tt-f[0],oe=v[1]+at+f[2]):oe=(V=v[1]+(tt+at-T.displaySize[1])/2)+T.displaySize[1],{image:T,top:V,right:ne,bottom:oe,left:Se,collisionPadding:x}}ni[10]=!0,ni[32]=!0,ni[38]=!0,ni[40]=!0,ni[41]=!0,ni[43]=!0,ni[45]=!0,ni[47]=!0,ni[173]=!0,ni[183]=!0,ni[8203]=!0,ni[8208]=!0,ni[8211]=!0,ni[8231]=!0;var No=function(e){function t(r,f,v,m){e.call(this,r,f),this.angle=v,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(ie);function Ja(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Di(e+1))};if(r.kind==="source")return{kind:"source"};for(var f=r.zoomStops,v=r.interpolationType,m=0;m<f.length&&f[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<f.length&&f[x]<e+1;)x++;x=Math.min(f.length-1,x);var T=f[m],D=f[x];return r.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:D,interpolationType:v}:{kind:"camera",minZoom:T,maxZoom:D,minSize:r.evaluate(new Di(T)),maxSize:r.evaluate(new Di(D)),interpolationType:v}}function es(e,t,r){var f=t.uSize,v=r.lowerSize;return e.kind==="source"?v/128:e.kind==="composite"?Ya(v/128,r.upperSize/128,t.uSizeT):f}function ts(e,t){var r=0,f=0;if(e.kind==="constant")f=e.layoutSize;else if(e.kind!=="source"){var v=e.interpolationType,m=v?Xe(ja.interpolationFactor(v,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?f=Ya(e.minSize,e.maxSize,m):r=m}return{uSizeT:r,uSize:f}}En("Anchor",No);var Es=Object.freeze({__proto__:null,getSizeData:Ja,evaluateSizeForFeature:es,evaluateSizeForZoom:ts,SIZE_PACK_FACTOR:128});function Ns(e,t,r,f,v){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,T=0;T>-r/2;){if(--x<0)return!1;T-=e[x].dist(m),m=e[x]}T+=e[x].dist(e[x+1]),x++;for(var D=[],N=0;T<r/2;){var V=e[x],ne=e[x+1];if(!ne)return!1;var oe=e[x-1].angleTo(V)-V.angleTo(ne);for(oe=Math.abs((oe+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:T,angleDelta:oe}),N+=oe;T-D[0].distance>f;)N-=D.shift().angleDelta;if(N>v)return!1;x++,T+=V.dist(ne)}return!0}function $s(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Bo(e,t,r){return e?.6*t*r:0}function Ii(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Js(e,t,r,f,v,m){for(var x=Bo(r,v,m),T=Ii(r,f)*m,D=0,N=$s(e)/2,V=0;V<e.length-1;V++){var ne=e[V],oe=e[V+1],Se=ne.dist(oe);if(D+Se>N){var je=(N-D)/Se,Fe=Ya(ne.x,oe.x,je),tt=Ya(ne.y,oe.y,je),at=new No(Fe,tt,oe.angleTo(ne),V);return at._round(),!x||Ns(e,at,T,x,t)?at:void 0}D+=Se}}function da(e,t,r,f,v,m,x,T,D){var N=Bo(f,m,x),V=Ii(f,v),ne=V*x,oe=e[0].x===0||e[0].x===D||e[0].y===0||e[0].y===D;return t-ne<t/4&&(t=ne+t/4),function Se(je,Fe,tt,at,Lt,Wt,qt,Cr,vr){for(var an=Wt/2,sn=$s(je),Tn=0,Un=Fe-tt,kn=[],Pn=0;Pn<je.length-1;Pn++){for(var ui=je[Pn],Jn=je[Pn+1],Vn=ui.dist(Jn),Qi=Jn.angleTo(ui);Un+tt<Tn+Vn;){var Si=((Un+=tt)-Tn)/Vn,ga=Ya(ui.x,Jn.x,Si),li=Ya(ui.y,Jn.y,Si);if(ga>=0&&ga<vr&&li>=0&&li<vr&&Un-an>=0&&Un+an<=sn){var aa=new No(ga,li,Qi,Pn);aa._round(),at&&!Ns(je,aa,Wt,at,Lt)||kn.push(aa)}}Tn+=Vn}return Cr||kn.length||qt||(kn=Se(je,Tn/2,tt,at,Lt,Wt,qt,!0,vr)),kn}(e,oe?t/2*T%t:(V/2+2*m)*x*T%t,t,N,r,ne,oe,!1,D)}function ii(e,t,r,f,v){for(var m=[],x=0;x<e.length;x++)for(var T=e[x],D=void 0,N=0;N<T.length-1;N++){var V=T[N],ne=T[N+1];V.x<t&&ne.x<t||(V.x<t?V=new ie(t,V.y+(t-V.x)/(ne.x-V.x)*(ne.y-V.y))._round():ne.x<t&&(ne=new ie(t,V.y+(t-V.x)/(ne.x-V.x)*(ne.y-V.y))._round()),V.y<r&&ne.y<r||(V.y<r?V=new ie(V.x+(r-V.y)/(ne.y-V.y)*(ne.x-V.x),r)._round():ne.y<r&&(ne=new ie(V.x+(r-V.y)/(ne.y-V.y)*(ne.x-V.x),r)._round()),V.x>=f&&ne.x>=f||(V.x>=f?V=new ie(f,V.y+(f-V.x)/(ne.x-V.x)*(ne.y-V.y))._round():ne.x>=f&&(ne=new ie(f,V.y+(f-V.x)/(ne.x-V.x)*(ne.y-V.y))._round()),V.y>=v&&ne.y>=v||(V.y>=v?V=new ie(V.x+(v-V.y)/(ne.y-V.y)*(ne.x-V.x),v)._round():ne.y>=v&&(ne=new ie(V.x+(v-V.y)/(ne.y-V.y)*(ne.x-V.x),v)._round()),D&&V.equals(D[D.length-1])||m.push(D=[V]),D.push(ne)))))}return m}function Oi(e,t,r,f){var v=[],m=e.image,x=m.pixelRatio,T=m.paddedRect.w-2,D=m.paddedRect.h-2,N=e.right-e.left,V=e.bottom-e.top,ne=m.stretchX||[[0,T]],oe=m.stretchY||[[0,D]],Se=function(li,aa){return li+aa[1]-aa[0]},je=ne.reduce(Se,0),Fe=oe.reduce(Se,0),tt=T-je,at=D-Fe,Lt=0,Wt=je,qt=0,Cr=Fe,vr=0,an=tt,sn=0,Tn=at;if(m.content&&f){var Un=m.content;Lt=qi(ne,0,Un[0]),qt=qi(oe,0,Un[1]),Wt=qi(ne,Un[0],Un[2]),Cr=qi(oe,Un[1],Un[3]),vr=Un[0]-Lt,sn=Un[1]-qt,an=Un[2]-Un[0]-Wt,Tn=Un[3]-Un[1]-Cr}var kn=function(li,aa,fo,Qa){var _o=Qs(li.stretch-Lt,Wt,N,e.left),xo=Gl(li.fixed-vr,an,li.stretch,je),Xo=Qs(aa.stretch-qt,Cr,V,e.top),lu=Gl(aa.fixed-sn,Tn,aa.stretch,Fe),gs=Qs(fo.stretch-Lt,Wt,N,e.left),cu=Gl(fo.fixed-vr,an,fo.stretch,je),Bs=Qs(Qa.stretch-qt,Cr,V,e.top),Us=Gl(Qa.fixed-sn,Tn,Qa.stretch,Fe),Ts=new ie(_o,Xo),Yo=new ie(gs,Xo),ns=new ie(gs,Bs),fa=new ie(_o,Bs),na=new ie(xo/x,lu/x),Va=new ie(cu/x,Us/x),eo=t*Math.PI/180;if(eo){var xu=Math.sin(eo),qa=Math.cos(eo),Co=[qa,-xu,xu,qa];Ts._matMult(Co),Yo._matMult(Co),fa._matMult(Co),ns._matMult(Co)}var fu=li.stretch+li.fixed,ia=aa.stretch+aa.fixed;return{tl:Ts,tr:Yo,bl:fa,br:ns,tex:{x:m.paddedRect.x+1+fu,y:m.paddedRect.y+1+ia,w:fo.stretch+fo.fixed-fu,h:Qa.stretch+Qa.fixed-ia},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:na,pixelOffsetBR:Va,minFontScaleX:an/x/N,minFontScaleY:Tn/x/V,isSDF:r}};if(f&&(m.stretchX||m.stretchY))for(var Pn=ws(ne,tt,je),ui=ws(oe,at,Fe),Jn=0;Jn<Pn.length-1;Jn++)for(var Vn=Pn[Jn],Qi=Pn[Jn+1],Si=0;Si<ui.length-1;Si++)v.push(kn(Vn,ui[Si],Qi,ui[Si+1]));else v.push(kn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:D+1}));return v}function qi(e,t,r){for(var f=0,v=0,m=e;v<m.length;v+=1){var x=m[v];f+=Math.max(t,Math.min(r,x[1]))-Math.max(t,Math.min(r,x[0]))}return f}function ws(e,t,r){for(var f=[{fixed:-1,stretch:0}],v=0,m=e;v<m.length;v+=1){var x=m[v],T=x[0],D=x[1],N=f[f.length-1];f.push({fixed:T-N.stretch,stretch:N.stretch}),f.push({fixed:T-N.stretch,stretch:N.stretch+(D-T)})}return f.push({fixed:t+1,stretch:r}),f}function Qs(e,t,r,f){return e/t*r+f}function Gl(e,t,r,f){return e-t*r/f}var Ve=function(t,r,f,v,m,x,T,D,N,V){if(this.boxStartIndex=t.length,N){var ne=x.top,oe=x.bottom,Se=x.collisionPadding;Se&&(ne-=Se[1],oe+=Se[3]);var je=oe-ne;je>0&&(je=Math.max(10,je),this.circleDiameter=je)}else{var Fe=x.top*T-D,tt=x.bottom*T+D,at=x.left*T-D,Lt=x.right*T+D,Wt=x.collisionPadding;if(Wt&&(at-=Wt[0]*T,Fe-=Wt[1]*T,Lt+=Wt[2]*T,tt+=Wt[3]*T),V){var qt=new ie(at,Fe),Cr=new ie(Lt,Fe),vr=new ie(at,tt),an=new ie(Lt,tt),sn=V*Math.PI/180;qt._rotate(sn),Cr._rotate(sn),vr._rotate(sn),an._rotate(sn),at=Math.min(qt.x,Cr.x,vr.x,an.x),Lt=Math.max(qt.x,Cr.x,vr.x,an.x),Fe=Math.min(qt.y,Cr.y,vr.y,an.y),tt=Math.max(qt.y,Cr.y,vr.y,an.y)}t.emplaceBack(r.x,r.y,at,Fe,Lt,tt,f,v,m)}this.boxEndIndex=t.length},ur=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=$t),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var f=(this.length>>1)-1;f>=0;f--)this._down(f)};function $t(e,t){return e<t?-1:e>t?1:0}function wn(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var f=1/0,v=1/0,m=-1/0,x=-1/0,T=e[0],D=0;D<T.length;D++){var N=T[D];(!D||N.x<f)&&(f=N.x),(!D||N.y<v)&&(v=N.y),(!D||N.x>m)&&(m=N.x),(!D||N.y>x)&&(x=N.y)}var V=Math.min(m-f,x-v),ne=V/2,oe=new ur([],zi);if(V===0)return new ie(f,v);for(var Se=f;Se<m;Se+=V)for(var je=v;je<x;je+=V)oe.push(new Oe(Se+ne,je+ne,ne,e));for(var Fe=function(Lt){for(var Wt=0,qt=0,Cr=0,vr=Lt[0],an=0,sn=vr.length,Tn=sn-1;an<sn;Tn=an++){var Un=vr[an],kn=vr[Tn],Pn=Un.x*kn.y-kn.x*Un.y;qt+=(Un.x+kn.x)*Pn,Cr+=(Un.y+kn.y)*Pn,Wt+=3*Pn}return new Oe(qt/Wt,Cr/Wt,0,Lt)}(e),tt=oe.length;oe.length;){var at=oe.pop();(at.d>Fe.d||!Fe.d)&&(Fe=at,r&&console.log("found best %d after %d probes",Math.round(1e4*at.d)/1e4,tt)),at.max-Fe.d<=t||(oe.push(new Oe(at.p.x-(ne=at.h/2),at.p.y-ne,ne,e)),oe.push(new Oe(at.p.x+ne,at.p.y-ne,ne,e)),oe.push(new Oe(at.p.x-ne,at.p.y+ne,ne,e)),oe.push(new Oe(at.p.x+ne,at.p.y+ne,ne,e)),tt+=4)}return r&&(console.log("num probes: "+tt),console.log("best distance: "+Fe.d)),Fe.p}function zi(e,t){return t.max-e.max}function Oe(e,t,r,f){this.p=new ie(e,t),this.h=r,this.d=function(v,m){for(var x=!1,T=1/0,D=0;D<m.length;D++)for(var N=m[D],V=0,ne=N.length,oe=ne-1;V<ne;oe=V++){var Se=N[V],je=N[oe];Se.y>v.y!=je.y>v.y&&v.x<(je.x-Se.x)*(v.y-Se.y)/(je.y-Se.y)+Se.x&&(x=!x),T=Math.min(T,ou(v,Se,je))}return(x?1:-1)*Math.sqrt(T)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}ur.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},ur.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},ur.prototype.peek=function(){return this.data[0]},ur.prototype._up=function(e){for(var t=this.data,r=this.compare,f=t[e];e>0;){var v=e-1>>1,m=t[v];if(r(f,m)>=0)break;t[e]=m,e=v}t[e]=f},ur.prototype._down=function(e){for(var t=this.data,r=this.compare,f=this.length>>1,v=t[e];e<f;){var m=1+(e<<1),x=t[m],T=m+1;if(T<this.length&&r(t[T],x)<0&&(m=T,x=t[T]),r(x,v)>=0)break;t[e]=x,e=m}t[e]=v};var xe=Number.POSITIVE_INFINITY;function ft(e,t){return t[1]!==xe?function(r,f,v){var m=0,x=0;switch(f=Math.abs(f),v=Math.abs(v),r){case"top-right":case"top-left":case"top":x=v-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-v}switch(r){case"top-right":case"bottom-right":case"right":m=-f;break;case"top-left":case"bottom-left":case"left":m=f}return[m,x]}(e,t[0],t[1]):function(r,f){var v=0,m=0;f<0&&(f=0);var x=f/Math.sqrt(2);switch(r){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-f;break;case"top":m=f-7}switch(r){case"top-right":case"bottom-right":v=-x;break;case"top-left":case"bottom-left":v=x;break;case"left":v=f;break;case"right":v=-f}return[v,m]}(e,t[0])}function zt(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function jt(e,t,r,f,v,m,x,T,D,N,V,ne,oe,Se,je){var Fe=function(qt,Cr,vr,an,sn,Tn,Un,kn){for(var Pn=an.layout.get("text-rotate").evaluate(Tn,{})*Math.PI/180,ui=[],Jn=0,Vn=Cr.positionedLines;Jn<Vn.length;Jn+=1)for(var Qi=Vn[Jn],Si=0,ga=Qi.positionedGlyphs;Si<ga.length;Si+=1){var li=ga[Si];if(li.rect){var aa=li.rect||{},fo=4,Qa=!0,_o=1,xo=0,Xo=(sn||kn)&&li.vertical,lu=li.metrics.advance*li.scale/2;if(kn&&Cr.verticalizable&&(xo=Qi.lineOffset/2-(li.imageName?-(24-li.metrics.width*li.scale)/2:24*(li.scale-1))),li.imageName){var gs=Un[li.imageName];Qa=gs.sdf,fo=1/(_o=gs.pixelRatio)}var cu=sn?[li.x+lu,li.y]:[0,0],Bs=sn?[0,0]:[li.x+lu+vr[0],li.y+vr[1]-xo],Us=[0,0];Xo&&(Us=Bs,Bs=[0,0]);var Ts=(li.metrics.left-fo)*li.scale-lu+Bs[0],Yo=(-li.metrics.top-fo)*li.scale+Bs[1],ns=Ts+aa.w*li.scale/_o,fa=Yo+aa.h*li.scale/_o,na=new ie(Ts,Yo),Va=new ie(ns,Yo),eo=new ie(Ts,fa),xu=new ie(ns,fa);if(Xo){var qa=new ie(-lu,lu- -17),Co=-Math.PI/2,fu=12-lu,ia=new ie(22-fu,-(li.imageName?fu:0)),Jc=new(Function.prototype.bind.apply(ie,[null].concat(Us)));na._rotateAround(Co,qa)._add(ia)._add(Jc),Va._rotateAround(Co,qa)._add(ia)._add(Jc),eo._rotateAround(Co,qa)._add(ia)._add(Jc),xu._rotateAround(Co,qa)._add(ia)._add(Jc)}if(Pn){var is=Math.sin(Pn),Hl=Math.cos(Pn),bl=[Hl,-is,is,Hl];na._matMult(bl),Va._matMult(bl),eo._matMult(bl),xu._matMult(bl)}var qs=new ie(0,0),pf=new ie(0,0);ui.push({tl:na,tr:Va,bl:eo,br:xu,tex:aa,writingMode:Cr.writingMode,glyphOffset:cu,sectionIndex:li.sectionIndex,isSDF:Qa,pixelOffsetTL:qs,pixelOffsetBR:pf,minFontScaleX:0,minFontScaleY:0})}}return ui}(0,r,T,v,m,x,f,e.allowVerticalPlacement),tt=e.textSizeData,at=null;tt.kind==="source"?(at=[128*v.layout.get("text-size").evaluate(x,{})])[0]>32640&&Pe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):tt.kind==="composite"&&((at=[128*Se.compositeTextSizes[0].evaluate(x,{},je),128*Se.compositeTextSizes[1].evaluate(x,{},je)])[0]>32640||at[1]>32640)&&Pe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Fe,at,T,m,x,N,t,D.lineStartIndex,D.lineLength,oe,je);for(var Lt=0,Wt=V;Lt<Wt.length;Lt+=1)ne[Wt[Lt]]=e.text.placedSymbolArray.length-1;return 4*Fe.length}function mt(e){for(var t in e)return e[t];return null}function ht(e,t,r,f){var v=e.compareText;if(t in v){for(var m=v[t],x=m.length-1;x>=0;x--)if(f.dist(m[x])<r)return!0}else v[t]=[];return v[t].push(f),!1}var It=ff.VectorTileFeature.types,De=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function st(e,t,r,f,v,m,x,T,D,N,V,ne,oe){var Se=T?Math.min(32640,Math.round(T[0])):0,je=T?Math.min(32640,Math.round(T[1])):0;e.emplaceBack(t,r,Math.round(32*f),Math.round(32*v),m,x,(Se<<1)+(D?1:0),je,16*N,16*V,256*ne,256*oe)}function Ae(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function kt(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(yc(r[t].text))return!0;return!1}var Gt=function(t){this.layoutVertexArray=new Sc,this.indexArray=new hl,this.programConfigurations=t,this.segments=new ge,this.dynamicLayoutVertexArray=new Bl,this.opacityVertexArray=new ic,this.placedSymbolArray=new h};Gt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Gt.prototype.upload=function(e,t,r,f){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Bf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ip.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,De,!0),this.opacityVertexBuffer.itemSize=1),(r||f)&&this.programConfigurations.upload(e))},Gt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},En("SymbolBuffers",Gt);var Ar=function(t,r,f){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new f,this.segments=new ge,this.collisionVertexArray=new Ec};Ar.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,hf.members,!0)},Ar.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},En("CollisionBuffers",Ar);var or=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(x){return x.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Lo([]),this.placementViewportMatrix=Lo([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ja(this.zoom,r["text-size"]),this.iconSizeData=Ja(this.zoom,r["icon-size"]);var f=this.layers[0].layout,v=f.get("symbol-sort-key"),m=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(function(x){return qn[x]})),this.stateDependentLayerIds=this.layers.filter(function(x){return x.isStateDependent()}).map(function(x){return x.id}),this.sourceID=t.sourceID};or.prototype.createArrays=function(){this.text=new Gt(new Ci(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Gt(new Ci(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new C,this.lineVertexArray=new L,this.symbolInstances=new E},or.prototype.calculateGlyphDependencies=function(e,t,r,f,v){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(r||f)&&v){var x=fc[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},or.prototype.populate=function(e,t,r){var f=this.layers[0],v=f.layout,m=v.get("text-font"),x=v.get("text-field"),T=v.get("icon-image"),D=(x.value.kind!=="constant"||x.value.value instanceof Fi&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),N=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,V=v.get("symbol-sort-key");if(this.features=[],D||N){for(var ne=t.iconDependencies,oe=t.glyphDependencies,Se=t.availableImages,je=new Di(this.zoom),Fe=0,tt=e;Fe<tt.length;Fe+=1){var at=tt[Fe],Lt=at.feature,Wt=at.id,qt=at.index,Cr=at.sourceLayerIndex,vr=f._featureFilter.needGeometry,an=$a(Lt,vr);if(f._featureFilter.filter(je,an,r)){vr||(an.geometry=La(Lt));var sn=void 0;if(D){var Tn=f.getValueAndResolveTokens("text-field",an,r,Se),Un=Fi.factory(Tn);kt(Un)&&(this.hasRTLText=!0),(!this.hasRTLText||rc()==="unavailable"||this.hasRTLText&&Ls.isParsed())&&(sn=Rh(Un,f,an))}var kn=void 0;if(N){var Pn=f.getValueAndResolveTokens("icon-image",an,r,Se);kn=Pn instanceof ha?Pn:ha.fromString(Pn)}if(sn||kn){var ui=this.sortFeaturesByKey?V.evaluate(an,{},r):void 0;if(this.features.push({id:Wt,text:sn,icon:kn,index:qt,sourceLayerIndex:Cr,geometry:an.geometry,properties:Lt.properties,type:It[Lt.type],sortKey:ui}),kn&&(ne[kn.name]=!0),sn){var Jn=m.evaluate(an,{},r).join(","),Vn=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(qn.vertical)>=0;for(var Qi=0,Si=sn.sections;Qi<Si.length;Qi+=1){var ga=Si[Qi];if(ga.image)ne[ga.image.name]=!0;else{var li=Ms(sn.toString()),aa=ga.fontStack||Jn,fo=oe[aa]=oe[aa]||{};this.calculateGlyphDependencies(ga.text,fo,Vn,this.allowVerticalPlacement,li)}}}}}}v.get("symbol-placement")==="line"&&(this.features=function(Qa){var _o={},xo={},Xo=[],lu=0;function gs(qa){Xo.push(Qa[qa]),lu++}function cu(qa,Co,fu){var ia=xo[qa];return delete xo[qa],xo[Co]=ia,Xo[ia].geometry[0].pop(),Xo[ia].geometry[0]=Xo[ia].geometry[0].concat(fu[0]),ia}function Bs(qa,Co,fu){var ia=_o[Co];return delete _o[Co],_o[qa]=ia,Xo[ia].geometry[0].shift(),Xo[ia].geometry[0]=fu[0].concat(Xo[ia].geometry[0]),ia}function Us(qa,Co,fu){var ia=fu?Co[0][Co[0].length-1]:Co[0][0];return qa+":"+ia.x+":"+ia.y}for(var Ts=0;Ts<Qa.length;Ts++){var Yo=Qa[Ts],ns=Yo.geometry,fa=Yo.text?Yo.text.toString():null;if(fa){var na=Us(fa,ns),Va=Us(fa,ns,!0);if(na in xo&&Va in _o&&xo[na]!==_o[Va]){var eo=Bs(na,Va,ns),xu=cu(na,Va,Xo[eo].geometry);delete _o[na],delete xo[Va],xo[Us(fa,Xo[xu].geometry,!0)]=xu,Xo[eo].geometry=null}else na in xo?cu(na,Va,ns):Va in _o?Bs(na,Va,ns):(gs(Ts),_o[na]=lu-1,xo[Va]=lu-1)}else gs(Ts)}return Xo.filter(function(qa){return qa.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Qa,_o){return Qa.sortKey-_o.sortKey})}},or.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},or.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},or.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},or.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},or.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},or.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},or.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var f=e.dist(t[e.segment+1]),v=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:f},x<t.length-1&&(f+=t[x+1].dist(t[x]));for(var T=e.segment||0;T>=0;T--)m[T]={x:t[T].x,y:t[T].y,tileUnitDistanceFromAnchor:v},T>0&&(v+=t[T-1].dist(t[T]));for(var D=0;D<t.length;D++){var N=m[D];this.lineVertexArray.emplaceBack(N.x,N.y,N.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},or.prototype.addSymbols=function(e,t,r,f,v,m,x,T,D,N,V,ne){for(var oe=e.indexArray,Se=e.layoutVertexArray,je=e.segments.prepareSegment(4*t.length,Se,oe,this.canOverlap?m.sortKey:void 0),Fe=this.glyphOffsetArray.length,tt=je.vertexLength,at=this.allowVerticalPlacement&&x===qn.vertical?Math.PI/2:0,Lt=m.text&&m.text.sections,Wt=0;Wt<t.length;Wt++){var qt=t[Wt],Cr=qt.tl,vr=qt.tr,an=qt.bl,sn=qt.br,Tn=qt.tex,Un=qt.pixelOffsetTL,kn=qt.pixelOffsetBR,Pn=qt.minFontScaleX,ui=qt.minFontScaleY,Jn=qt.glyphOffset,Vn=qt.isSDF,Qi=qt.sectionIndex,Si=je.vertexLength,ga=Jn[1];st(Se,T.x,T.y,Cr.x,ga+Cr.y,Tn.x,Tn.y,r,Vn,Un.x,Un.y,Pn,ui),st(Se,T.x,T.y,vr.x,ga+vr.y,Tn.x+Tn.w,Tn.y,r,Vn,kn.x,Un.y,Pn,ui),st(Se,T.x,T.y,an.x,ga+an.y,Tn.x,Tn.y+Tn.h,r,Vn,Un.x,kn.y,Pn,ui),st(Se,T.x,T.y,sn.x,ga+sn.y,Tn.x+Tn.w,Tn.y+Tn.h,r,Vn,kn.x,kn.y,Pn,ui),Ae(e.dynamicLayoutVertexArray,T,at),oe.emplaceBack(Si,Si+1,Si+2),oe.emplaceBack(Si+1,Si+2,Si+3),je.vertexLength+=4,je.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Jn[0]),Wt!==t.length-1&&Qi===t[Wt+1].sectionIndex||e.programConfigurations.populatePaintArrays(Se.length,m,m.index,{},ne,Lt&&Lt[Qi])}e.placedSymbolArray.emplaceBack(T.x,T.y,Fe,this.glyphOffsetArray.length-Fe,tt,D,N,T.segment,r?r[0]:0,r?r[1]:0,f[0],f[1],x,0,!1,0,V)},or.prototype._addCollisionDebugVertex=function(e,t,r,f,v,m){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,f,v,Math.round(m.x),Math.round(m.y))},or.prototype.addCollisionDebugVertices=function(e,t,r,f,v,m,x){var T=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),D=T.vertexLength,N=v.layoutVertexArray,V=v.collisionVertexArray,ne=x.anchorX,oe=x.anchorY;this._addCollisionDebugVertex(N,V,m,ne,oe,new ie(e,t)),this._addCollisionDebugVertex(N,V,m,ne,oe,new ie(r,t)),this._addCollisionDebugVertex(N,V,m,ne,oe,new ie(r,f)),this._addCollisionDebugVertex(N,V,m,ne,oe,new ie(e,f)),T.vertexLength+=4;var Se=v.indexArray;Se.emplaceBack(D,D+1),Se.emplaceBack(D+1,D+2),Se.emplaceBack(D+2,D+3),Se.emplaceBack(D+3,D),T.primitiveLength+=4},or.prototype.addDebugCollisionBoxes=function(e,t,r,f){for(var v=e;v<t;v++){var m=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,f?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,r)}},or.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ar(ac,oh.members,wc),this.iconCollisionBox=new Ar(ac,oh.members,wc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},or.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,f,v,m,x,T,D){for(var N={},V=t;V<r;V++){var ne=e.get(V);N.textBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},N.textFeatureIndex=ne.featureIndex;break}for(var oe=f;oe<v;oe++){var Se=e.get(oe);N.verticalTextBox={x1:Se.x1,y1:Se.y1,x2:Se.x2,y2:Se.y2,anchorPointX:Se.anchorPointX,anchorPointY:Se.anchorPointY},N.verticalTextFeatureIndex=Se.featureIndex;break}for(var je=m;je<x;je++){var Fe=e.get(je);N.iconBox={x1:Fe.x1,y1:Fe.y1,x2:Fe.x2,y2:Fe.y2,anchorPointX:Fe.anchorPointX,anchorPointY:Fe.anchorPointY},N.iconFeatureIndex=Fe.featureIndex;break}for(var tt=T;tt<D;tt++){var at=e.get(tt);N.verticalIconBox={x1:at.x1,y1:at.y1,x2:at.x2,y2:at.y2,anchorPointX:at.anchorPointX,anchorPointY:at.anchorPointY},N.verticalIconFeatureIndex=at.featureIndex;break}return N},or.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},or.prototype.hasTextData=function(){return this.text.segments.get().length>0},or.prototype.hasIconData=function(){return this.icon.segments.get().length>0},or.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},or.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},or.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},or.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),f=r.vertexStartIndex+4*r.numGlyphs,v=r.vertexStartIndex;v<f;v+=4)e.indexArray.emplaceBack(v,v+1,v+2),e.indexArray.emplaceBack(v+1,v+2,v+3)},or.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),f=[],v=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var T=this.symbolInstances.get(x);f.push(0|Math.round(t*T.anchorX+r*T.anchorY)),v.push(T.featureIndex)}return m.sort(function(D,N){return f[D]-f[N]||v[N]-v[D]}),m},or.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},or.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,f=this.symbolInstanceIndexes;r<f.length;r+=1){var v=this.symbolInstances.get(f[r]);this.featureSortOrder.push(v.featureIndex),[v.rightJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.leftJustifiedTextSymbolIndex].forEach(function(m,x,T){m>=0&&T.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),v.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,v.verticalPlacedTextSymbolIndex),v.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.placedIconSymbolIndex),v.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},En("SymbolBucket",or,{omit:["layers","collisionBoxArray","features","compareText"]}),or.MAX_GLYPHS=65535,or.addDynamicAttributes=Ae;var xr=new jo({"symbol-placement":new Gn(se.layout_symbol["symbol-placement"]),"symbol-spacing":new Gn(se.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Gn(se.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Mn(se.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Gn(se.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Gn(se.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Gn(se.layout_symbol["icon-ignore-placement"]),"icon-optional":new Gn(se.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Gn(se.layout_symbol["icon-rotation-alignment"]),"icon-size":new Mn(se.layout_symbol["icon-size"]),"icon-text-fit":new Gn(se.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Gn(se.layout_symbol["icon-text-fit-padding"]),"icon-image":new Mn(se.layout_symbol["icon-image"]),"icon-rotate":new Mn(se.layout_symbol["icon-rotate"]),"icon-padding":new Gn(se.layout_symbol["icon-padding"]),"icon-keep-upright":new Gn(se.layout_symbol["icon-keep-upright"]),"icon-offset":new Mn(se.layout_symbol["icon-offset"]),"icon-anchor":new Mn(se.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Gn(se.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Gn(se.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Gn(se.layout_symbol["text-rotation-alignment"]),"text-field":new Mn(se.layout_symbol["text-field"]),"text-font":new Mn(se.layout_symbol["text-font"]),"text-size":new Mn(se.layout_symbol["text-size"]),"text-max-width":new Mn(se.layout_symbol["text-max-width"]),"text-line-height":new Gn(se.layout_symbol["text-line-height"]),"text-letter-spacing":new Mn(se.layout_symbol["text-letter-spacing"]),"text-justify":new Mn(se.layout_symbol["text-justify"]),"text-radial-offset":new Mn(se.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Gn(se.layout_symbol["text-variable-anchor"]),"text-anchor":new Mn(se.layout_symbol["text-anchor"]),"text-max-angle":new Gn(se.layout_symbol["text-max-angle"]),"text-writing-mode":new Gn(se.layout_symbol["text-writing-mode"]),"text-rotate":new Mn(se.layout_symbol["text-rotate"]),"text-padding":new Gn(se.layout_symbol["text-padding"]),"text-keep-upright":new Gn(se.layout_symbol["text-keep-upright"]),"text-transform":new Mn(se.layout_symbol["text-transform"]),"text-offset":new Mn(se.layout_symbol["text-offset"]),"text-allow-overlap":new Gn(se.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Gn(se.layout_symbol["text-ignore-placement"]),"text-optional":new Gn(se.layout_symbol["text-optional"])}),Yr={paint:new jo({"icon-opacity":new Mn(se.paint_symbol["icon-opacity"]),"icon-color":new Mn(se.paint_symbol["icon-color"]),"icon-halo-color":new Mn(se.paint_symbol["icon-halo-color"]),"icon-halo-width":new Mn(se.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Mn(se.paint_symbol["icon-halo-blur"]),"icon-translate":new Gn(se.paint_symbol["icon-translate"]),"icon-translate-anchor":new Gn(se.paint_symbol["icon-translate-anchor"]),"text-opacity":new Mn(se.paint_symbol["text-opacity"]),"text-color":new Mn(se.paint_symbol["text-color"],{runtimeType:fn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Mn(se.paint_symbol["text-halo-color"]),"text-halo-width":new Mn(se.paint_symbol["text-halo-width"]),"text-halo-blur":new Mn(se.paint_symbol["text-halo-blur"]),"text-translate":new Gn(se.paint_symbol["text-translate"]),"text-translate-anchor":new Gn(se.paint_symbol["text-translate-anchor"])}),layout:xr},Bn=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:vn,this.defaultValue=t};Bn.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Bn.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Bn.prototype.outputDefined=function(){return!1},Bn.prototype.serialize=function(){return null},En("FormatSectionOverride",Bn,{omit:["defaultValue"]});var Ni=function(e){function t(r){e.call(this,r,Yr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,f){if(e.prototype.recalculate.call(this,r,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var v=this.layout.get("text-writing-mode");if(v){for(var m=[],x=0,T=v;x<T.length;x+=1){var D=T[x];m.indexOf(D)<0&&m.push(D)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,f,v,m){var x=this.layout.get(r).evaluate(f,{},v,m),T=this._unevaluatedLayout._values[r];return T.isDataDriven()||Au(T.value)||!x?x:function(D,N){return N.replace(/{([^{}]+)}/g,function(V,ne){return ne in D?String(D[ne]):""})}(f.properties,x)},t.prototype.createBucket=function(r){return new or(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,f=Yr.paint.overridableProperties;r<f.length;r+=1){var v=f[r];if(t.hasPaintOverride(this.layout,v)){var m,x=this.paint.get(v),T=new Bn(x),D=new Al(T,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new du("source",D):new el("composite",D,x.value.zoomStops,x.value._interpolationType),this.paint._values[v]=new cs(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,f,v){return!(!this.layout||f.isDataDriven()||v.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,f){var v=r.get("text-field"),m=Yr.paint.properties[f],x=!1,T=function(ne){for(var oe=0,Se=ne;oe<Se.length;oe+=1)if(m.overrides&&m.overrides.hasOverride(Se[oe]))return void(x=!0)};if(v.value.kind==="constant"&&v.value.value instanceof Fi)T(v.value.value.sections);else if(v.value.kind==="source"){var D=function V(ne){x||(ne instanceof Na&&mi(ne.value)===Li?T(ne.value.sections):ne instanceof Ua?T(ne.sections):ne.eachChild(V))},N=v.value;N._styleExpression&&D(N._styleExpression.expression)}return x},t}(Zu),Dn={paint:new jo({"background-color":new Gn(se.paint_background["background-color"]),"background-pattern":new fs(se.paint_background["background-pattern"]),"background-opacity":new Gn(se.paint_background["background-opacity"])})},ai=function(e){function t(r){e.call(this,r,Dn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Zu),Pi={paint:new jo({"raster-opacity":new Gn(se.paint_raster["raster-opacity"]),"raster-hue-rotate":new Gn(se.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Gn(se.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Gn(se.paint_raster["raster-brightness-max"]),"raster-saturation":new Gn(se.paint_raster["raster-saturation"]),"raster-contrast":new Gn(se.paint_raster["raster-contrast"]),"raster-resampling":new Gn(se.paint_raster["raster-resampling"]),"raster-fade-duration":new Gn(se.paint_raster["raster-fade-duration"])})},ea=function(e){function t(r){e.call(this,r,Pi)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Zu),Vo=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(Zu),ku={circle:Ml,heatmap:sc,hillshade:ih,fill:Ap,"fill-extrusion":_u,line:np,symbol:Ni,background:ai,raster:ea},uh=Q.HTMLImageElement,_l=Q.HTMLCanvasElement,lh=Q.HTMLVideoElement,xl=Q.ImageData,Uf=Q.ImageBitmap,jf=function(t,r,f,v){this.context=t,this.format=f,this.texture=t.gl.createTexture(),this.update(r,v)};jf.prototype.update=function(e,t,r){var f=e.width,v=e.height,m=!(this.size&&this.size[0]===f&&this.size[1]===v||r),x=this.context,T=x.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[f,v],e instanceof uh||e instanceof _l||e instanceof lh||e instanceof xl||Uf&&e instanceof Uf?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,f,v,0,this.format,T.UNSIGNED_BYTE,e.data);else{var D=r||{x:0,y:0},N=D.x,V=D.y;e instanceof uh||e instanceof _l||e instanceof lh||e instanceof xl||Uf&&e instanceof Uf?T.texSubImage2D(T.TEXTURE_2D,0,N,V,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,N,V,f,v,T.RGBA,T.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)},jf.prototype.bind=function(e,t,r){var f=this.context.gl;f.bindTexture(f.TEXTURE_2D,this.texture),r!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=f.LINEAR),e!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,t),this.wrap=t)},jf.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},jf.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ap=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};ap.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},ap.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Zf=function(t,r,f){this.target=t,this.parent=r,this.mapId=f,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Sr(["receive","process"],this),this.invoker=new ap(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=bt()?t:Q};function td(e,t,r){var f=2*Math.PI*6378137/256/Math.pow(2,r);return[e*f-2*Math.PI*6378137/2,t*f-2*Math.PI*6378137/2]}Zf.prototype.send=function(e,t,r,f,v){var m=this;v===void 0&&(v=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[x]=r);var T=Ee(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!r,targetMapId:f,mustQueue:v,sourceMapId:this.mapId,data:ru(t,T)},T),{cancel:function(){r&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:m.mapId})}}},Zf.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var f=this.cancelCallbacks[r];delete this.cancelCallbacks[r],f&&f()}else bt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},Zf.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Zf.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var f=this.callbacks[e];delete this.callbacks[e],f&&(t.error?f(Hs(t.error)):f(null,Hs(t.data)))}else{var v=!1,m=Ee(this.globalScope)?void 0:[],x=t.hasCallback?function(V,ne){v=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:V?ru(V):null,data:ru(ne,m)},m)}:function(V){v=!0},T=null,D=Hs(t.data);if(this.parent[t.type])T=this.parent[t.type](t.sourceMapId,D,x);else if(this.parent.getWorkerSource){var N=t.type.split(".");T=this.parent.getWorkerSource(t.sourceMapId,N[0],D.source)[N[1]](D,x)}else x(new Error("Could not find function "+t.type));!v&&T&&T.cancel&&(this.cancelCallbacks[e]=T.cancel)}},Zf.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var vs=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};vs.prototype.setNorthEast=function(e){return this._ne=e instanceof Ao?new Ao(e.lng,e.lat):Ao.convert(e),this},vs.prototype.setSouthWest=function(e){return this._sw=e instanceof Ao?new Ao(e.lng,e.lat):Ao.convert(e),this},vs.prototype.extend=function(e){var t,r,f=this._sw,v=this._ne;if(e instanceof Ao)t=e,r=e;else{if(!(e instanceof vs))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(vs.convert(e)):this.extend(Ao.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return f||v?(f.lng=Math.min(t.lng,f.lng),f.lat=Math.min(t.lat,f.lat),v.lng=Math.max(r.lng,v.lng),v.lat=Math.max(r.lat,v.lat)):(this._sw=new Ao(t.lng,t.lat),this._ne=new Ao(r.lng,r.lat)),this},vs.prototype.getCenter=function(){return new Ao((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},vs.prototype.getSouthWest=function(){return this._sw},vs.prototype.getNorthEast=function(){return this._ne},vs.prototype.getNorthWest=function(){return new Ao(this.getWest(),this.getNorth())},vs.prototype.getSouthEast=function(){return new Ao(this.getEast(),this.getSouth())},vs.prototype.getWest=function(){return this._sw.lng},vs.prototype.getSouth=function(){return this._sw.lat},vs.prototype.getEast=function(){return this._ne.lng},vs.prototype.getNorth=function(){return this._ne.lat},vs.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},vs.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},vs.prototype.isEmpty=function(){return!(this._sw&&this._ne)},vs.prototype.contains=function(e){var t=Ao.convert(e),r=t.lng,f=t.lat,v=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&v},vs.convert=function(e){return!e||e instanceof vs?e:new vs(e)};var Ao=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ao.prototype.wrap=function(){return new Ao(Ut(this.lng,-180,180),this.lat)},Ao.prototype.toArray=function(){return[this.lng,this.lat]},Ao.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ao.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,f=e.lat*t,v=Math.sin(r)*Math.sin(f)+Math.cos(r)*Math.cos(f)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(v,1))},Ao.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new vs(new Ao(this.lng-r,this.lat-t),new Ao(this.lng+r,this.lat+t))},Ao.convert=function(e){if(e instanceof Ao)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Ao(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Ao(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var rd=2*Math.PI*63710088e-1;function Pp(e){return rd*Math.cos(e*Math.PI/180)}function Mp(e){return(180+e)/360}function nd(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function id(e,t){return e/Pp(t)}function Ip(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Vf=function(t,r,f){f===void 0&&(f=0),this.x=+t,this.y=+r,this.z=+f};Vf.fromLngLat=function(e,t){t===void 0&&(t=0);var r=Ao.convert(e);return new Vf(Mp(r.lng),nd(r.lat),id(t,r.lat))},Vf.prototype.toLngLat=function(){return new Ao(360*this.x-180,Ip(this.y))},Vf.prototype.toAltitude=function(){return this.z*Pp(Ip(this.y))},Vf.prototype.meterInMercatorCoordinateUnits=function(){return 1/rd*(e=Ip(this.y),1/Math.cos(e*Math.PI/180));var e};var Cf=function(t,r,f){this.z=t,this.x=r,this.y=f,this.key=Dh(0,t,t,r,f)};Cf.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Cf.prototype.url=function(e,t){var r,f,v,m,x,T=(f=this.y,v=this.z,m=td(256*(r=this.x),256*(f=Math.pow(2,v)-f-1),v),x=td(256*(r+1),256*(f+1),v),m[0]+","+m[1]+","+x[0]+","+x[1]),D=function(N,V,ne){for(var oe,Se="",je=N;je>0;je--)Se+=(V&(oe=1<<je-1)?1:0)+(ne&oe?2:0);return Se}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",D).replace("{bbox-epsg-3857}",T)},Cf.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new ie(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Cf.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var op=function(t,r){this.wrap=t,this.canonical=r,this.key=Dh(t,r.z,r.z,r.x,r.y)},rs=function(t,r,f,v,m){this.overscaledZ=t,this.wrap=r,this.canonical=new Cf(f,+v,+m),this.key=Dh(r,t,f,v,m)};function Dh(e,t,r,f,v){(e*=2)<0&&(e=-1*e-1);var m=1<<r;return(m*m*e+m*v+f).toString(36)+r.toString(36)+t.toString(36)}rs.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},rs.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new rs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new rs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},rs.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?Dh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Dh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},rs.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},rs.prototype.children=function(e){if(this.overscaledZ>=e)return[new rs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,f=2*this.canonical.y;return[new rs(t,this.wrap,t,r,f),new rs(t,this.wrap,t,r+1,f),new rs(t,this.wrap,t,r,f+1),new rs(t,this.wrap,t,r+1,f+1)]},rs.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},rs.prototype.wrapped=function(){return new rs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},rs.prototype.unwrapTo=function(e){return new rs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},rs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},rs.prototype.toUnwrapped=function(){return new op(this.wrap,this.canonical)},rs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},rs.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Vf(e.x-this.wrap,e.y))},En("CanonicalTileID",Cf),En("OverscaledTileID",rs,{omit:["posMatrix"]});var Yc=function(t,r,f){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return Pe('"'+f+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var v=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=f||"mapbox";for(var m=0;m<v;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(v,m)]=this.data[this._idx(v-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,v)]=this.data[this._idx(m,v-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(v,-1)]=this.data[this._idx(v-1,0)],this.data[this._idx(-1,v)]=this.data[this._idx(0,v-1)],this.data[this._idx(v,v)]=this.data[this._idx(v-1,v-1)]};Yc.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),f=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[f],r[f+1],r[f+2])},Yc.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Yc.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Yc.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Yc.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Yc.prototype.getPixels=function(){return new Fo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Yc.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var f=t*this.dim,v=t*this.dim+this.dim,m=r*this.dim,x=r*this.dim+this.dim;switch(t){case-1:f=v-1;break;case 1:v=f+1}switch(r){case-1:m=x-1;break;case 1:x=m+1}for(var T=-t*this.dim,D=-r*this.dim,N=m;N<x;N++)for(var V=f;V<v;V++)this.data[this._idx(V,N)]=e.data[this._idx(V+T,N+D)]},En("DEMData",Yc);var sp=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var f=t[r];this._stringToNumber[f]=r,this._numberToString[r]=f}};sp.prototype.encode=function(e){return this._stringToNumber[e]},sp.prototype.decode=function(e){return this._numberToString[e]};var Op=function(t,r,f,v,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=f,t._y=v,this.properties=t.properties,this.id=m},ch={geometry:{configurable:!0}};ch.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ch.geometry.set=function(e){this._geometry=e},Op.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Op.prototype,ch);var fh=function(){this.state={},this.stateChanges={},this.deletedStates={}};fh.prototype.updateState=function(e,t,r){var f=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},er(this.stateChanges[e][f],r),this.deletedStates[e]===null)for(var v in this.deletedStates[e]={},this.state[e])v!==f&&(this.deletedStates[e][v]=null);else if(this.deletedStates[e]&&this.deletedStates[e][f]===null)for(var m in this.deletedStates[e][f]={},this.state[e][f])r[m]||(this.deletedStates[e][f][m]=null);else for(var x in r)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][x]===null&&delete this.deletedStates[e][f][x]},fh.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var f=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(r in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][r]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}},fh.prototype.getState=function(e,t){var r=String(t),f=er({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var v=this.deletedStates[e][t];if(v===null)return{};for(var m in v)delete f[m]}return f},fh.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},fh.prototype.coalesceChanges=function(e,t){var r={};for(var f in this.stateChanges){this.state[f]=this.state[f]||{};var v={};for(var m in this.stateChanges[f])this.state[f][m]||(this.state[f][m]={}),er(this.state[f][m],this.stateChanges[f][m]),v[m]=this.state[f][m];r[f]=v}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var T={};if(this.deletedStates[x]===null)for(var D in this.state[x])T[D]={},this.state[x][D]={};else for(var N in this.deletedStates[x]){if(this.deletedStates[x][N]===null)this.state[x][N]={};else for(var V=0,ne=Object.keys(this.deletedStates[x][N]);V<ne.length;V+=1)delete this.state[x][N][ne[V]];T[N]=this.state[x][N]}r[x]=r[x]||{},er(r[x],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var oe in e)e[oe].setFeatureState(r,t)};var Kc=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ol(8192,16,0),this.grid3D=new ol(8192,16,0),this.featureIndexArray=new q,this.promoteId=r};function kd(e,t,r,f,v){return Ht(e,function(m,x){var T=t instanceof zl?t.get(x):null;return T&&T.evaluate?T.evaluate(r,f,v):T})}function Fd(e){for(var t=1/0,r=1/0,f=-1/0,v=-1/0,m=0,x=e;m<x.length;m+=1){var T=x[m];t=Math.min(t,T.x),r=Math.min(r,T.y),f=Math.max(f,T.x),v=Math.max(v,T.y)}return{minX:t,minY:r,maxX:f,maxY:v}}function Lp(e,t){return t-e}Kc.prototype.insert=function(e,t,r,f,v,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,f,v);for(var T=m?this.grid3D:this.grid,D=0;D<t.length;D++){for(var N=t[D],V=[1/0,1/0,-1/0,-1/0],ne=0;ne<N.length;ne++){var oe=N[ne];V[0]=Math.min(V[0],oe.x),V[1]=Math.min(V[1],oe.y),V[2]=Math.max(V[2],oe.x),V[3]=Math.max(V[3],oe.y)}V[0]<8192&&V[1]<8192&&V[2]>=0&&V[3]>=0&&T.insert(x,V[0],V[1],V[2],V[3])}},Kc.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ff.VectorTile(new he(this.rawTileData)).layers,this.sourceLayerCoder=new sp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Kc.prototype.query=function(e,t,r,f){var v=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,T=Dl(m.filter),D=e.queryGeometry,N=e.queryPadding*x,V=Fd(D),ne=this.grid.query(V.minX-N,V.minY-N,V.maxX+N,V.maxY+N),oe=Fd(e.cameraQueryGeometry),Se=this.grid3D.query(oe.minX-N,oe.minY-N,oe.maxX+N,oe.maxY+N,function(qt,Cr,vr,an){return function(sn,Tn,Un,kn,Pn){for(var ui=0,Jn=sn;ui<Jn.length;ui+=1){var Vn=Jn[ui];if(Tn<=Vn.x&&Un<=Vn.y&&kn>=Vn.x&&Pn>=Vn.y)return!0}var Qi=[new ie(Tn,Un),new ie(Tn,Pn),new ie(kn,Pn),new ie(kn,Un)];if(sn.length>2){for(var Si=0,ga=Qi;Si<ga.length;Si+=1)if(Ru(sn,ga[Si]))return!0}for(var li=0;li<sn.length-1;li++)if(jl(sn[li],sn[li+1],Qi))return!0;return!1}(e.cameraQueryGeometry,qt-N,Cr-N,vr+N,an+N)}),je=0,Fe=Se;je<Fe.length;je+=1)ne.push(Fe[je]);ne.sort(Lp);for(var tt,at={},Lt=function(Cr){var vr=ne[Cr];if(vr!==tt){tt=vr;var an=v.featureIndexArray.get(vr),sn=null;v.loadMatchingFeature(at,an.bucketIndex,an.sourceLayerIndex,an.featureIndex,T,m.layers,m.availableImages,t,r,f,function(Tn,Un,kn){return sn||(sn=La(Tn)),Un.queryIntersectsFeature(D,Tn,kn,sn,v.z,e.transform,x,e.pixelPosMatrix)})}},Wt=0;Wt<ne.length;Wt++)Lt(Wt);return at},Kc.prototype.loadMatchingFeature=function(e,t,r,f,v,m,x,T,D,N,V){var ne=this.bucketLayerIDs[t];if(!m||function(sn,Tn){for(var Un=0;Un<sn.length;Un++)if(Tn.indexOf(sn[Un])>=0)return!0;return!1}(m,ne)){var oe=this.sourceLayerCoder.decode(r),Se=this.vtLayers[oe].feature(f);if(v.needGeometry){var je=$a(Se,!0);if(!v.filter(new Di(this.tileID.overscaledZ),je,this.tileID.canonical))return}else if(!v.filter(new Di(this.tileID.overscaledZ),Se))return;for(var Fe=this.getId(Se,oe),tt=0;tt<ne.length;tt++){var at=ne[tt];if(!(m&&m.indexOf(at)<0)){var Lt=T[at];if(Lt){var Wt={};Fe!==void 0&&N&&(Wt=N.getState(Lt.sourceLayer||"_geojsonTileLayer",Fe));var qt=er({},D[at]);qt.paint=kd(qt.paint,Lt.paint,Se,Wt,x),qt.layout=kd(qt.layout,Lt.layout,Se,Wt,x);var Cr=!V||V(Se,Lt,Wt);if(Cr){var vr=new Op(Se,this.z,this.x,this.y,Fe);vr.layer=qt;var an=e[at];an===void 0&&(an=e[at]=[]),an.push({featureIndex:f,feature:vr,intersectionZ:Cr})}}}}}},Kc.prototype.lookupSymbolFeatures=function(e,t,r,f,v,m,x,T){var D={};this.loadVTLayers();for(var N=Dl(v),V=0,ne=e;V<ne.length;V+=1)this.loadMatchingFeature(D,r,f,ne[V],N,m,x,T,t);return D},Kc.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var f=0,v=r[t];f<v.length;f+=1)if(e===v[f])return!0;return!1},Kc.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},En("FeatureIndex",Kc,{omit:["rawTileData","sourceLayerCoder"]});var ms=function(t,r){this.tileID=t,this.uid=lt(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ms.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<qr.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},ms.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},ms.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var f in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(N,V){var ne={};if(!V)return ne;for(var oe=function(){var tt=je[Se],at=tt.layerIds.map(function(qt){return V.getLayer(qt)}).filter(Boolean);if(at.length!==0){tt.layers=at,tt.stateDependentLayerIds&&(tt.stateDependentLayers=tt.stateDependentLayerIds.map(function(qt){return at.filter(function(Cr){return Cr.id===qt})[0]}));for(var Lt=0,Wt=at;Lt<Wt.length;Lt+=1)ne[Wt[Lt].id]=tt}},Se=0,je=N;Se<je.length;Se+=1)oe();return ne}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var v=this.buckets[f];if(v instanceof or){if(this.hasSymbolBuckets=!0,!r)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof or&&x.hasRTLText){this.hasRTLText=!0,Ls.isLoading()||Ls.isLoaded()||rc()!=="deferred"||iu();break}}for(var T in this.queryPadding=0,this.buckets){var D=this.buckets[T];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(T).queryRadius(D))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new o},ms.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ms.prototype.getBucket=function(e){return this.buckets[e.id]},ms.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var f=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new jf(e,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new jf(e,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)},ms.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},ms.prototype.queryRenderedFeatures=function(e,t,r,f,v,m,x,T,D,N){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:v,scale:m,tileSize:this.tileSize,pixelPosMatrix:N,transform:T,params:x,queryPadding:this.queryPadding*D},e,t,r):{}},ms.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var f=r.loadVTLayers(),v=t?t.sourceLayer:"",m=f._geojsonTileLayer||f[v];if(m)for(var x=Dl(t&&t.filter),T=this.tileID.canonical,D=T.z,N=T.x,V=T.y,ne={z:D,x:N,y:V},oe=0;oe<m.length;oe++){var Se=m.feature(oe);if(x.needGeometry){var je=$a(Se,!0);if(!x.filter(new Di(this.tileID.overscaledZ),je,this.tileID.canonical))continue}else if(!x.filter(new Di(this.tileID.overscaledZ),Se))continue;var Fe=r.getId(Se,v),tt=new Op(Se,D,N,V,Fe);tt.tile=ne,e.push(tt)}}},ms.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},ms.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ms.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=cr(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var f=Date.now(),v=!1;if(this.expirationTime>f)v=!1;else if(t)if(this.expirationTime<t)v=!0;else{var m=this.expirationTime-t;m?this.expirationTime=f+Math.max(m,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ms.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},ms.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var f in this.buckets)if(t.style.hasLayer(f)){var v=this.buckets[f],m=v.layers[0].sourceLayer||"_geojsonTileLayer",x=r[m],T=e[m];if(x&&T&&Object.keys(T).length!==0){v.update(T,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var D=t&&t.style&&t.style.getLayer(f);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(v)))}}}},ms.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},ms.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<qr.now()},ms.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ms.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=qr.now()+e},ms.prototype.setDependencies=function(e,t){for(var r={},f=0,v=t;f<v.length;f+=1)r[v[f]]=!0;this.dependencies[e]=r},ms.prototype.hasDependency=function(e,t){for(var r=0,f=e;r<f.length;r+=1){var v=this.dependencies[f[r]];if(v){for(var m=0,x=t;m<x.length;m+=1)if(v[x[m]])return!0}}return!1};var $c=Q.performance,Rp=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},$c.mark(this._marks.start)};Rp.prototype.finish=function(){$c.mark(this._marks.end);var e=$c.getEntriesByName(this._marks.measure);return e.length===0&&($c.measure(this._marks.measure,this._marks.start,this._marks.end),e=$c.getEntriesByName(this._marks.measure),$c.clearMarks(this._marks.start),$c.clearMarks(this._marks.end),$c.clearMeasures(this._marks.measure)),e},p.Actor=Zf,p.AlphaImage=Ys,p.CanonicalTileID=Cf,p.CollisionBoxArray=o,p.Color=Zn,p.DEMData=Yc,p.DataConstantProperty=Gn,p.DictionaryCoder=sp,p.EXTENT=8192,p.ErrorEvent=Le,p.EvaluationParameters=Di,p.Event=ue,p.Evented=Me,p.FeatureIndex=Kc,p.FillBucket=ds,p.FillExtrusionBucket=Wu,p.ImageAtlas=jn,p.ImagePosition=Fr,p.LineBucket=Ks,p.LngLat=Ao,p.LngLatBounds=vs,p.MercatorCoordinate=Vf,p.ONE_EM=24,p.OverscaledTileID=rs,p.Point=ie,p.Point$1=ie,p.Properties=jo,p.Protobuf=he,p.RGBAImage=Fo,p.RequestManager=Ct,p.RequestPerformance=Rp,p.ResourceType=ar,p.SegmentVector=ge,p.SourceFeatureState=fh,p.StructArrayLayout1ui2=uf,p.StructArrayLayout2f1f2i16=fl,p.StructArrayLayout2i4=cl,p.StructArrayLayout3ui6=hl,p.StructArrayLayout4i8=bc,p.SymbolBucket=or,p.Texture=jf,p.Tile=ms,p.Transitionable=vo,p.Uniform1f=tn,p.Uniform1i=Er,p.Uniform2f=Vr,p.Uniform3f=mn,p.Uniform4f=Sn,p.UniformColor=Hn,p.UniformMatrix4f=Ei,p.UnwrappedTileID=op,p.ValidationError=Ne,p.WritingMode=qn,p.ZoomHistory=sl,p.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},p.addDynamicAttributes=Ae,p.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var f=e.length,v=new Array(e.length),m=null;e.forEach(function(x,T){t(x,function(D,N){D&&(m=D),v[T]=N,--f==0&&r(m,v)})})},p.bezier=Ie,p.bindAll=Sr,p.browser=qr,p.cacheEntryPossiblyAdded=function(e){++Rt>dt&&(e.getActor().send("enforceCacheSizeLimit",yt),Rt=0)},p.clamp=Xe,p.clearTileCache=function(e){var t=Q.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},p.clipLine=ii,p.clone=function(e){var t=new go(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},p.clone$1=Ge,p.clone$2=function(e){var t=new go(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},p.collisionCircleLayout=Lh,p.config=tr,p.create=function(){var e=new go(16);return go!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},p.create$1=function(){var e=new go(9);return go!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},p.create$2=function(){var e=new go(4);return go!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},p.createCommonjsModule=H,p.createExpression=Cu,p.createLayout=ao,p.createStyleLayer=function(e){return e.type==="custom"?new Vo(e):new ku[e.type](e)},p.cross=function(e,t,r){var f=t[0],v=t[1],m=t[2],x=r[0],T=r[1],D=r[2];return e[0]=v*D-m*T,e[1]=m*x-f*D,e[2]=f*T-v*x,e},p.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var f=0;f<t.length;f++)if(!e(t[f],r[f]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(var v in t)if(!e(t[v],r[v]))return!1;return!0}return t===r},p.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},p.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},p.ease=Be,p.emitValidationErrors=al,p.endsWith=Ft,p.enforceCacheSizeLimit=function(e){lr(),Et&&Et.then(function(t){t.keys().then(function(r){for(var f=0;f<r.length-e;f++)t.delete(r[f])})})},p.evaluateSizeForFeature=es,p.evaluateSizeForZoom=ts,p.evaluateVariableOffset=ft,p.evented=xc,p.extend=er,p.featureFilter=Dl,p.filterObject=St,p.fromRotation=function(e,t){var r=Math.sin(t),f=Math.cos(t);return e[0]=f,e[1]=r,e[2]=0,e[3]=-r,e[4]=f,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.getAnchorAlignment=zo,p.getAnchorJustification=zt,p.getArrayBuffer=Xi,p.getImage=I,p.getJSON=function(e,t){return Ui(er(e,{type:"json"}),t)},p.getRTLTextPluginStatus=rc,p.getReferrer=xn,p.getVideo=function(e,t){var r,f,v=Q.document.createElement("video");v.muted=!0,v.onloadstart=function(){t(null,v)};for(var m=0;m<e.length;m++){var x=Q.document.createElement("source");r=e[m],f=void 0,(f=Q.document.createElement("a")).href=r,(f.protocol!==Q.document.location.protocol||f.host!==Q.document.location.host)&&(v.crossOrigin="Anonymous"),x.src=e[m],v.appendChild(x)}return{cancel:function(){}}},p.identity=Lo,p.invert=function(e,t){var r=t[0],f=t[1],v=t[2],m=t[3],x=t[4],T=t[5],D=t[6],N=t[7],V=t[8],ne=t[9],oe=t[10],Se=t[11],je=t[12],Fe=t[13],tt=t[14],at=t[15],Lt=r*T-f*x,Wt=r*D-v*x,qt=r*N-m*x,Cr=f*D-v*T,vr=f*N-m*T,an=v*N-m*D,sn=V*Fe-ne*je,Tn=V*tt-oe*je,Un=V*at-Se*je,kn=ne*tt-oe*Fe,Pn=ne*at-Se*Fe,ui=oe*at-Se*tt,Jn=Lt*ui-Wt*Pn+qt*kn+Cr*Un-vr*Tn+an*sn;return Jn?(e[0]=(T*ui-D*Pn+N*kn)*(Jn=1/Jn),e[1]=(v*Pn-f*ui-m*kn)*Jn,e[2]=(Fe*an-tt*vr+at*Cr)*Jn,e[3]=(oe*vr-ne*an-Se*Cr)*Jn,e[4]=(D*Un-x*ui-N*Tn)*Jn,e[5]=(r*ui-v*Un+m*Tn)*Jn,e[6]=(tt*qt-je*an-at*Wt)*Jn,e[7]=(V*an-oe*qt+Se*Wt)*Jn,e[8]=(x*Pn-T*Un+N*sn)*Jn,e[9]=(f*Un-r*Pn-m*sn)*Jn,e[10]=(je*vr-Fe*qt+at*Lt)*Jn,e[11]=(ne*qt-V*vr-Se*Lt)*Jn,e[12]=(T*Tn-x*kn-D*sn)*Jn,e[13]=(r*kn-f*Tn+v*sn)*Jn,e[14]=(Fe*Wt-je*Cr-tt*Lt)*Jn,e[15]=(V*Cr-ne*Wt+oe*Lt)*Jn,e):null},p.isChar=Qr,p.isMapboxURL=A,p.keysDifference=function(e,t){var r=[];for(var f in e)f in t||r.push(f);return r},p.makeRequest=Ui,p.mapObject=Ht,p.mercatorXfromLng=Mp,p.mercatorYfromLat=nd,p.mercatorZfromAltitude=id,p.mul=ko,p.multiply=Ro,p.mvt=ff,p.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},p.normalize=function(e,t){var r=t[0],f=t[1],v=t[2],m=r*r+f*f+v*v;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},p.number=Ya,p.offscreenCanvasSupported=sr,p.ortho=function(e,t,r,f,v,m,x){var T=1/(t-r),D=1/(f-v),N=1/(m-x);return e[0]=-2*T,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*D,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*N,e[11]=0,e[12]=(t+r)*T,e[13]=(v+f)*D,e[14]=(x+m)*N,e[15]=1,e},p.parseGlyphPBF=function(e){return new he(e).readFields(br,[])},p.pbf=he,p.performSymbolLayout=function(e,t,r,f,v,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var T=e.layers[0].layout,D=e.layers[0]._unevaluatedLayout._values,N={};if(e.textSizeData.kind==="composite"){var V=e.textSizeData,ne=V.maxZoom;N.compositeTextSizes=[D["text-size"].possiblyEvaluate(new Di(V.minZoom),x),D["text-size"].possiblyEvaluate(new Di(ne),x)]}if(e.iconSizeData.kind==="composite"){var oe=e.iconSizeData,Se=oe.maxZoom;N.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new Di(oe.minZoom),x),D["icon-size"].possiblyEvaluate(new Di(Se),x)]}N.layoutTextSize=D["text-size"].possiblyEvaluate(new Di(e.zoom+1),x),N.layoutIconSize=D["icon-size"].possiblyEvaluate(new Di(e.zoom+1),x),N.textMaxSize=D["text-size"].possiblyEvaluate(new Di(18));for(var je=24*T.get("text-line-height"),Fe=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point",tt=T.get("text-keep-upright"),at=T.get("text-size"),Lt=function(){var vr=qt[Wt],an=T.get("text-font").evaluate(vr,{},x).join(","),sn=at.evaluate(vr,{},x),Tn=N.layoutTextSize.evaluate(vr,{},x),Un=N.layoutIconSize.evaluate(vr,{},x),kn={horizontal:{},vertical:void 0},Pn=vr.text,ui=[0,0];if(Pn){var Jn=Pn.toString(),Vn=24*T.get("text-letter-spacing").evaluate(vr,{},x),Qi=function(fa){for(var na=0,Va=fa;na<Va.length;na+=1)if(eo=Va[na].charCodeAt(0),Qr.Arabic(eo)||Qr["Arabic Supplement"](eo)||Qr["Arabic Extended-A"](eo)||Qr["Arabic Presentation Forms-A"](eo)||Qr["Arabic Presentation Forms-B"](eo))return!1;var eo;return!0}(Jn)?Vn:0,Si=T.get("text-anchor").evaluate(vr,{},x),ga=T.get("text-variable-anchor");if(!ga){var li=T.get("text-radial-offset").evaluate(vr,{},x);ui=li?ft(Si,[24*li,xe]):T.get("text-offset").evaluate(vr,{},x).map(function(fa){return 24*fa})}var aa=Fe?"center":T.get("text-justify").evaluate(vr,{},x),fo=T.get("symbol-placement"),Qa=fo==="point"?24*T.get("text-max-width").evaluate(vr,{},x):0,_o=function(){e.allowVerticalPlacement&&Ms(Jn)&&(kn.vertical=Rr(Pn,t,r,v,an,Qa,je,Si,"left",Qi,ui,qn.vertical,!0,fo,Tn,sn))};if(!Fe&&ga){for(var xo=aa==="auto"?ga.map(function(fa){return zt(fa)}):[aa],Xo=!1,lu=0;lu<xo.length;lu++){var gs=xo[lu];if(!kn.horizontal[gs])if(Xo)kn.horizontal[gs]=kn.horizontal[0];else{var cu=Rr(Pn,t,r,v,an,Qa,je,"center",gs,Qi,ui,qn.horizontal,!1,fo,Tn,sn);cu&&(kn.horizontal[gs]=cu,Xo=cu.positionedLines.length===1)}}_o()}else{aa==="auto"&&(aa=zt(Si));var Bs=Rr(Pn,t,r,v,an,Qa,je,Si,aa,Qi,ui,qn.horizontal,!1,fo,Tn,sn);Bs&&(kn.horizontal[aa]=Bs),_o(),Ms(Jn)&&Fe&&tt&&(kn.vertical=Rr(Pn,t,r,v,an,Qa,je,Si,aa,Qi,ui,qn.vertical,!1,fo,Tn,sn))}}var Us=void 0,Ts=!1;if(vr.icon&&vr.icon.name){var Yo=f[vr.icon.name];Yo&&(Us=function(fa,na,Va){var eo=zo(Va),xu=na[0]-fa.displaySize[0]*eo.horizontalAlign,qa=na[1]-fa.displaySize[1]*eo.verticalAlign;return{image:fa,top:qa,bottom:qa+fa.displaySize[1],left:xu,right:xu+fa.displaySize[0]}}(v[vr.icon.name],T.get("icon-offset").evaluate(vr,{},x),T.get("icon-anchor").evaluate(vr,{},x)),Ts=Yo.sdf,e.sdfIcons===void 0?e.sdfIcons=Yo.sdf:e.sdfIcons!==Yo.sdf&&Pe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Yo.pixelRatio!==e.pixelRatio||T.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var ns=mt(kn.horizontal)||kn.vertical;e.iconsInText=!!ns&&ns.iconsInText,(ns||Us)&&function(fa,na,Va,eo,xu,qa,Co,fu,ia,Jc,is){var Hl=qa.textMaxSize.evaluate(na,{});Hl===void 0&&(Hl=Co);var bl,qs=fa.layers[0].layout,pf=qs.get("icon-offset").evaluate(na,{},is),hc=mt(Va.horizontal),Pc=Co/24,hh=fa.tilePixelRatio*Pc,Qc=fa.tilePixelRatio*Hl/24,Pf=fa.tilePixelRatio*fu,Gf=fa.tilePixelRatio*qs.get("symbol-spacing"),ph=qs.get("text-padding")*fa.tilePixelRatio,Hf=qs.get("icon-padding")*fa.tilePixelRatio,qc=qs.get("text-max-angle")/180*Math.PI,up=qs.get("text-rotation-alignment")==="map"&&qs.get("symbol-placement")!=="point",Mf=qs.get("icon-rotation-alignment")==="map"&&qs.get("symbol-placement")!=="point",dh=qs.get("symbol-placement"),lp=Gf/2,Wf=qs.get("icon-text-fit");eo&&Wf!=="none"&&(fa.allowVerticalPlacement&&Va.vertical&&(bl=Hi(eo,Va.vertical,Wf,qs.get("icon-text-fit-padding"),pf,Pc)),hc&&(eo=Hi(eo,hc,Wf,qs.get("icon-text-fit-padding"),pf,Pc)));var If=function(zd,xh){xh.x<0||xh.x>=8192||xh.y<0||xh.y>=8192||function(Ko,pc,od,mf,zp,sd,jh,ef,pp,Zh,bh,Np,dp,Bp,Sh,vp,mp,Xu,gp,Kf,Wl,Vh,ud,gf,yp){var Eh,Of,$f,Jf,dc,Lf=Ko.addToLineVertexArray(pc,od),Gh=0,ld=0,cd=0,Qf=0,Up=-1,jp=-1,Rf={},Nd=We(""),fd=0,hd=0;if(ef._unevaluatedLayout.getValue("text-radial-offset")===void 0?(fd=(Eh=ef.layout.get("text-offset").evaluate(Wl,{},gf).map(function(_d){return 24*_d}))[0],hd=Eh[1]):(fd=24*ef.layout.get("text-radial-offset").evaluate(Wl,{},gf),hd=xe),Ko.allowVerticalPlacement&&mf.vertical){var Bd=ef.layout.get("text-rotate").evaluate(Wl,{},gf)+90;Jf=new Ve(pp,pc,Zh,bh,Np,mf.vertical,dp,Bp,Sh,Bd),jh&&(dc=new Ve(pp,pc,Zh,bh,Np,jh,mp,Xu,Sh,Bd))}if(zp){var pd=ef.layout.get("icon-rotate").evaluate(Wl,{}),Ud=ef.layout.get("icon-text-fit")!=="none",Zp=Oi(zp,pd,ud,Ud),Hh=jh?Oi(jh,pd,ud,Ud):void 0;$f=new Ve(pp,pc,Zh,bh,Np,zp,mp,Xu,!1,pd),Gh=4*Zp.length;var jd=Ko.iconSizeData,wh=null;jd.kind==="source"?(wh=[128*ef.layout.get("icon-size").evaluate(Wl,{})])[0]>32640&&Pe(Ko.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):jd.kind==="composite"&&((wh=[128*Vh.compositeIconSizes[0].evaluate(Wl,{},gf),128*Vh.compositeIconSizes[1].evaluate(Wl,{},gf)])[0]>32640||wh[1]>32640)&&Pe(Ko.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ko.addSymbols(Ko.icon,Zp,wh,Kf,gp,Wl,!1,pc,Lf.lineStartIndex,Lf.lineLength,-1,gf),Up=Ko.icon.placedSymbolArray.length-1,Hh&&(ld=4*Hh.length,Ko.addSymbols(Ko.icon,Hh,wh,Kf,gp,Wl,qn.vertical,pc,Lf.lineStartIndex,Lf.lineLength,-1,gf),jp=Ko.icon.placedSymbolArray.length-1)}for(var dd in mf.horizontal){var Vp=mf.horizontal[dd];if(!Of){Nd=We(Vp.text);var vd=ef.layout.get("text-rotate").evaluate(Wl,{},gf);Of=new Ve(pp,pc,Zh,bh,Np,Vp,dp,Bp,Sh,vd)}var md=Vp.positionedLines.length===1;if(cd+=jt(Ko,pc,Vp,sd,ef,Sh,Wl,vp,Lf,mf.vertical?qn.horizontal:qn.horizontalOnly,md?Object.keys(mf.horizontal):[dd],Rf,Up,Vh,gf),md)break}mf.vertical&&(Qf+=jt(Ko,pc,mf.vertical,sd,ef,Sh,Wl,vp,Lf,qn.vertical,["vertical"],Rf,jp,Vh,gf));var nv=Of?Of.boxStartIndex:Ko.collisionBoxArray.length,gd=Of?Of.boxEndIndex:Ko.collisionBoxArray.length,Zd=Jf?Jf.boxStartIndex:Ko.collisionBoxArray.length,iv=Jf?Jf.boxEndIndex:Ko.collisionBoxArray.length,_p=$f?$f.boxStartIndex:Ko.collisionBoxArray.length,Vd=$f?$f.boxEndIndex:Ko.collisionBoxArray.length,av=dc?dc.boxStartIndex:Ko.collisionBoxArray.length,qf=dc?dc.boxEndIndex:Ko.collisionBoxArray.length,Mc=-1,eh=function(Df,xd){return Df&&Df.circleDiameter?Math.max(Df.circleDiameter,xd):xd};Mc=eh(Of,Mc),Mc=eh(Jf,Mc),Mc=eh($f,Mc);var yd=(Mc=eh(dc,Mc))>-1?1:0;yd&&(Mc*=yp/24),Ko.glyphOffsetArray.length>=or.MAX_GLYPHS&&Pe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Wl.sortKey!==void 0&&Ko.addToSortKeyRanges(Ko.symbolInstances.length,Wl.sortKey),Ko.symbolInstances.emplaceBack(pc.x,pc.y,Rf.right>=0?Rf.right:-1,Rf.center>=0?Rf.center:-1,Rf.left>=0?Rf.left:-1,Rf.vertical||-1,Up,jp,Nd,nv,gd,Zd,iv,_p,Vd,av,qf,Zh,cd,Qf,Gh,ld,yd,0,dp,fd,hd,Mc)}(fa,xh,zd,Va,eo,xu,bl,fa.layers[0],fa.collisionBoxArray,na.index,na.sourceLayerIndex,fa.index,hh,ph,up,ia,Pf,Hf,Mf,pf,na,qa,Jc,is,Co)};if(dh==="line")for(var vh=0,kh=ii(na.geometry,0,0,8192,8192);vh<kh.length;vh+=1)for(var Fh=kh[vh],Xf=0,zh=da(Fh,Gf,qc,Va.vertical||hc,eo,24,Qc,fa.overscaling,8192);Xf<zh.length;Xf+=1){var cp=zh[Xf];hc&&ht(fa,hc.text,lp,cp)||If(Fh,cp)}else if(dh==="line-center")for(var df=0,mh=na.geometry;df<mh.length;df+=1){var gh=mh[df];if(gh.length>1){var Nh=Js(gh,qc,Va.vertical||hc,eo,24,Qc);Nh&&If(gh,Nh)}}else if(na.type==="Polygon")for(var Bh=0,yh=co(na.geometry,0);Bh<yh.length;Bh+=1){var Uh=yh[Bh],vf=wn(Uh,16);If(Uh[0],new No(vf.x,vf.y,0))}else if(na.type==="LineString")for(var Yf=0,_h=na.geometry;Yf<_h.length;Yf+=1){var fp=_h[Yf];If(fp,new No(fp[0].x,fp[0].y,0))}else if(na.type==="Point")for(var hp=0,Dp=na.geometry;hp<Dp.length;hp+=1)for(var kp=0,ad=Dp[hp];kp<ad.length;kp+=1){var Fp=ad[kp];If([Fp],new No(Fp.x,Fp.y,0))}}(e,vr,kn,Us,f,N,Tn,Un,ui,Ts,x)},Wt=0,qt=e.features;Wt<qt.length;Wt+=1)Lt();m&&e.generateCollisionDebugBuffers()},p.perspective=function(e,t,r,f,v){var m,x=1/Math.tan(t/2);return e[0]=x/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,v!=null&&v!==1/0?(e[10]=(v+f)*(m=1/(f-v)),e[14]=2*v*f*m):(e[10]=-1,e[14]=-2*f),e},p.pick=function(e,t){for(var r={},f=0;f<t.length;f++){var v=t[f];v in e&&(r[v]=e[v])}return r},p.plugin=Ls,p.polygonIntersectsPolygon=dl,p.postMapLoadEvent=qe,p.postTurnstileEvent=Tr,p.potpack=Br,p.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],p.register=En,p.registerForPluginStateChange=function(e){return e({pluginStatus:Os,pluginURL:Uu}),xc.on("pluginStateChange",e),e},p.renderColorRamp=nh,p.rotate=function(e,t,r){var f=t[0],v=t[1],m=t[2],x=t[3],T=Math.sin(r),D=Math.cos(r);return e[0]=f*D+m*T,e[1]=v*D+x*T,e[2]=f*-T+m*D,e[3]=v*-T+x*D,e},p.rotateX=function(e,t,r){var f=Math.sin(r),v=Math.cos(r),m=t[4],x=t[5],T=t[6],D=t[7],N=t[8],V=t[9],ne=t[10],oe=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*v+N*f,e[5]=x*v+V*f,e[6]=T*v+ne*f,e[7]=D*v+oe*f,e[8]=N*v-m*f,e[9]=V*v-x*f,e[10]=ne*v-T*f,e[11]=oe*v-D*f,e},p.rotateZ=function(e,t,r){var f=Math.sin(r),v=Math.cos(r),m=t[0],x=t[1],T=t[2],D=t[3],N=t[4],V=t[5],ne=t[6],oe=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*v+N*f,e[1]=x*v+V*f,e[2]=T*v+ne*f,e[3]=D*v+oe*f,e[4]=N*v-m*f,e[5]=V*v-x*f,e[6]=ne*v-T*f,e[7]=oe*v-D*f,e},p.scale=function(e,t,r){var f=r[0],v=r[1],m=r[2];return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e[4]=t[4]*v,e[5]=t[5]*v,e[6]=t[6]*v,e[7]=t[7]*v,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},p.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},p.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},p.setCacheLimits=function(e,t){yt=e,dt=t},p.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Os==="deferred"||Os==="loading"||Os==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Uu=qr.resolveURL(e),Os="deferred",_c=t,nu(),r||iu()},p.sphericalToCartesian=function(e){var t=e[0],r=e[1],f=e[2];return r+=90,r*=Math.PI/180,f*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(f),y:t*Math.sin(r)*Math.sin(f),z:t*Math.cos(f)}},p.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},p.styleSpec=se,p.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},p.symbolSize=Es,p.transformMat3=function(e,t,r){var f=t[0],v=t[1],m=t[2];return e[0]=f*r[0]+v*r[3]+m*r[6],e[1]=f*r[1]+v*r[4]+m*r[7],e[2]=f*r[2]+v*r[5]+m*r[8],e},p.transformMat4=Xs,p.translate=function(e,t,r){var f,v,m,x,T,D,N,V,ne,oe,Se,je,Fe=r[0],tt=r[1],at=r[2];return t===e?(e[12]=t[0]*Fe+t[4]*tt+t[8]*at+t[12],e[13]=t[1]*Fe+t[5]*tt+t[9]*at+t[13],e[14]=t[2]*Fe+t[6]*tt+t[10]*at+t[14],e[15]=t[3]*Fe+t[7]*tt+t[11]*at+t[15]):(v=t[1],m=t[2],x=t[3],T=t[4],D=t[5],N=t[6],V=t[7],ne=t[8],oe=t[9],Se=t[10],je=t[11],e[0]=f=t[0],e[1]=v,e[2]=m,e[3]=x,e[4]=T,e[5]=D,e[6]=N,e[7]=V,e[8]=ne,e[9]=oe,e[10]=Se,e[11]=je,e[12]=f*Fe+T*tt+ne*at+t[12],e[13]=v*Fe+D*tt+oe*at+t[13],e[14]=m*Fe+N*tt+Se*at+t[14],e[15]=x*Fe+V*tt+je*at+t[15]),e},p.triggerPluginCompletionEvent=vu,p.uniqueId=lt,p.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},p.validateLight=Sf,p.validateStyle=ql,p.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},p.vectorTile=ff,p.version="1.13.1",p.warnOnce=Pe,p.webpSupported=ce,p.window=Q,p.wrap=Ut}),b(["./shared"],function(p){"use strict";function H(K){var I=typeof K;if(I==="number"||I==="boolean"||I==="string"||K==null)return JSON.stringify(K);if(Array.isArray(K)){for(var j="[",Y=0,ue=K;Y<ue.length;Y+=1)j+=H(ue[Y])+",";return j+"]"}for(var Le=Object.keys(K).sort(),Me="{",se=0;se<Le.length;se++)Me+=JSON.stringify(Le[se])+":"+H(K[Le[se]])+",";return Me+"}"}function S(K){for(var I="",j=0,Y=p.refProperties;j<Y.length;j+=1)I+="/"+H(K[Y[j]]);return I}var F=function(I){this.keyCache={},I&&this.replace(I)};F.prototype.replace=function(K){this._layerConfigs={},this._layers={},this.update(K,[])},F.prototype.update=function(K,I){for(var j=this,Y=0,ue=K;Y<ue.length;Y+=1){var Le=ue[Y];this._layerConfigs[Le.id]=Le;var Me=this._layers[Le.id]=p.createStyleLayer(Le);Me._featureFilter=p.featureFilter(Me.filter),this.keyCache[Le.id]&&delete this.keyCache[Le.id]}for(var se=0,Ne=I;se<Ne.length;se+=1){var At=Ne[se];delete this.keyCache[At],delete this._layerConfigs[At],delete this._layers[At]}this.familiesBySource={};for(var Dr=0,Ur=function(un,fn){for(var hi={},Jr=0;Jr<un.length;Jr++){var vi=fn&&fn[un[Jr].id]||S(un[Jr]);fn&&(fn[un[Jr].id]=vi);var Li=hi[vi];Li||(Li=hi[vi]=[]),Li.push(un[Jr])}var Qn=[];for(var xi in hi)Qn.push(hi[xi]);return Qn}(p.values(this._layerConfigs),this.keyCache);Dr<Ur.length;Dr+=1){var Xt=Ur[Dr].map(function(un){return j._layers[un.id]}),zr=Xt[0];if(zr.visibility!=="none"){var On=zr.source||"",vn=this.familiesBySource[On];vn||(vn=this.familiesBySource[On]={});var hr=zr.sourceLayer||"_geojsonTileLayer",pn=vn[hr];pn||(pn=vn[hr]=[]),pn.push(Xt)}}};var ie=function(I){var j={},Y=[];for(var ue in I){var Le=I[ue],Me=j[ue]={};for(var se in Le){var Ne=Le[+se];if(Ne&&Ne.bitmap.width!==0&&Ne.bitmap.height!==0){var At={x:0,y:0,w:Ne.bitmap.width+2,h:Ne.bitmap.height+2};Y.push(At),Me[se]={rect:At,metrics:Ne.metrics}}}}var Dr=p.potpack(Y),Ur=new p.AlphaImage({width:Dr.w||1,height:Dr.h||1});for(var Xt in I){var zr=I[Xt];for(var On in zr){var vn=zr[+On];if(vn&&vn.bitmap.width!==0&&vn.bitmap.height!==0){var hr=j[Xt][On].rect;p.AlphaImage.copy(vn.bitmap,Ur,{x:0,y:0},{x:hr.x+1,y:hr.y+1},vn.bitmap)}}}this.image=Ur,this.positions=j};p.register("GlyphAtlas",ie);var fe=function(I){this.tileID=new p.OverscaledTileID(I.tileID.overscaledZ,I.tileID.wrap,I.tileID.canonical.z,I.tileID.canonical.x,I.tileID.canonical.y),this.uid=I.uid,this.zoom=I.zoom,this.pixelRatio=I.pixelRatio,this.tileSize=I.tileSize,this.source=I.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=I.showCollisionBoxes,this.collectResourceTiming=!!I.collectResourceTiming,this.returnDependencies=!!I.returnDependencies,this.promoteId=I.promoteId};function Q(K,I,j){for(var Y=new p.EvaluationParameters(I),ue=0,Le=K;ue<Le.length;ue+=1)Le[ue].recalculate(Y,j)}function we(K,I){var j=p.getArrayBuffer(K.request,function(Y,ue,Le,Me){Y?I(Y):ue&&I(null,{vectorTile:new p.vectorTile.VectorTile(new p.pbf(ue)),rawData:ue,cacheControl:Le,expires:Me})});return function(){j.cancel(),I()}}fe.prototype.parse=function(K,I,j,Y,ue){var Le=this;this.status="parsing",this.data=K,this.collisionBoxArray=new p.CollisionBoxArray;var Me=new p.DictionaryCoder(Object.keys(K.layers).sort()),se=new p.FeatureIndex(this.tileID,this.promoteId);se.bucketLayerIDs=[];var Ne,At,Dr,Ur,Xt={},zr={featureIndex:se,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:j},On=I.familiesBySource[this.source];for(var vn in On){var hr=K.layers[vn];if(hr){hr.version===1&&p.warnOnce('Vector tile source "'+this.source+'" layer "'+vn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var pn=Me.encode(vn),un=[],fn=0;fn<hr.length;fn++){var hi=hr.feature(fn),Jr=se.getId(hi,vn);un.push({feature:hi,id:Jr,index:fn,sourceLayerIndex:pn})}for(var vi=0,Li=On[vn];vi<Li.length;vi+=1){var Qn=Li[vi],xi=Qn[0];xi.minzoom&&this.zoom<Math.floor(xi.minzoom)||xi.maxzoom&&this.zoom>=xi.maxzoom||xi.visibility!=="none"&&(Q(Qn,this.zoom,j),(Xt[xi.id]=xi.createBucket({index:se.bucketLayerIDs.length,layers:Qn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pn,sourceID:this.source})).populate(un,zr,this.tileID.canonical),se.bucketLayerIDs.push(Qn.map(function(Rn){return Rn.id})))}}}var Ti=p.mapObject(zr.glyphDependencies,function(Rn){return Object.keys(Rn).map(Number)});Object.keys(Ti).length?Y.send("getGlyphs",{uid:this.uid,stacks:Ti},function(Rn,Ri){Ne||(Ne=Rn,At=Ri,si.call(Le))}):At={};var bo=Object.keys(zr.iconDependencies);bo.length?Y.send("getImages",{icons:bo,source:this.source,tileID:this.tileID,type:"icons"},function(Rn,Ri){Ne||(Ne=Rn,Dr=Ri,si.call(Le))}):Dr={};var ki=Object.keys(zr.patternDependencies);function si(){if(Ne)return ue(Ne);if(At&&Dr&&Ur){var Rn=new ie(At),Ri=new p.ImageAtlas(Dr,Ur);for(var Zn in Xt){var za=Xt[Zn];za instanceof p.SymbolBucket?(Q(za.layers,this.zoom,j),p.performSymbolLayout(za,At,Rn.positions,Dr,Ri.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):za.hasPattern&&(za instanceof p.LineBucket||za instanceof p.FillBucket||za instanceof p.FillExtrusionBucket)&&(Q(za.layers,this.zoom,j),za.addFeatures(zr,this.tileID.canonical,Ri.patternPositions))}this.status="done",ue(null,{buckets:p.values(Xt).filter(function(ys){return!ys.isEmpty()}),featureIndex:se,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rn.image,imageAtlas:Ri,glyphMap:this.returnDependencies?At:null,iconMap:this.returnDependencies?Dr:null,glyphPositions:this.returnDependencies?Rn.positions:null})}}ki.length?Y.send("getImages",{icons:ki,source:this.source,tileID:this.tileID,type:"patterns"},function(Rn,Ri){Ne||(Ne=Rn,Ur=Ri,si.call(Le))}):Ur={},si.call(this)};var Ie=function(I,j,Y,ue){this.actor=I,this.layerIndex=j,this.availableImages=Y,this.loadVectorData=ue||we,this.loading={},this.loaded={}};Ie.prototype.loadTile=function(K,I){var j=this,Y=K.uid;this.loading||(this.loading={});var ue=!!(K&&K.request&&K.request.collectResourceTiming)&&new p.RequestPerformance(K.request),Le=this.loading[Y]=new fe(K);Le.abort=this.loadVectorData(K,function(Me,se){if(delete j.loading[Y],Me||!se)return Le.status="done",j.loaded[Y]=Le,I(Me);var Ne=se.rawData,At={};se.expires&&(At.expires=se.expires),se.cacheControl&&(At.cacheControl=se.cacheControl);var Dr={};if(ue){var Ur=ue.finish();Ur&&(Dr.resourceTiming=JSON.parse(JSON.stringify(Ur)))}Le.vectorTile=se.vectorTile,Le.parse(se.vectorTile,j.layerIndex,j.availableImages,j.actor,function(Xt,zr){if(Xt||!zr)return I(Xt);I(null,p.extend({rawTileData:Ne.slice(0)},zr,At,Dr))}),j.loaded=j.loaded||{},j.loaded[Y]=Le})},Ie.prototype.reloadTile=function(K,I){var j=this,Y=this.loaded,ue=K.uid,Le=this;if(Y&&Y[ue]){var Me=Y[ue];Me.showCollisionBoxes=K.showCollisionBoxes;var se=function(At,Dr){var Ur=Me.reloadCallback;Ur&&(delete Me.reloadCallback,Me.parse(Me.vectorTile,Le.layerIndex,j.availableImages,Le.actor,Ur)),I(At,Dr)};Me.status==="parsing"?Me.reloadCallback=se:Me.status==="done"&&(Me.vectorTile?Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,se):se())}},Ie.prototype.abortTile=function(K,I){var j=this.loading,Y=K.uid;j&&j[Y]&&j[Y].abort&&(j[Y].abort(),delete j[Y]),I()},Ie.prototype.removeTile=function(K,I){var j=this.loaded,Y=K.uid;j&&j[Y]&&delete j[Y],I()};var Be=p.window.ImageBitmap,Xe=function(){this.loaded={}};function Ut(K,I){if(K.length!==0){er(K[0],I);for(var j=1;j<K.length;j++)er(K[j],!I)}}function er(K,I){for(var j=0,Y=0,ue=K.length,Le=ue-1;Y<ue;Le=Y++)j+=(K[Y][0]-K[Le][0])*(K[Le][1]+K[Y][1]);j>=0!=!!I&&K.reverse()}Xe.prototype.loadTile=function(K,I){var j=K.uid,Y=K.encoding,ue=K.rawImageData,Le=Be&&ue instanceof Be?this.getImageData(ue):ue,Me=new p.DEMData(j,Le,Y);this.loaded=this.loaded||{},this.loaded[j]=Me,I(null,Me)},Xe.prototype.getImageData=function(K){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(K.width,K.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=K.width,this.offscreenCanvas.height=K.height,this.offscreenCanvasContext.drawImage(K,0,0,K.width,K.height);var I=this.offscreenCanvasContext.getImageData(-1,-1,K.width+2,K.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new p.RGBAImage({width:I.width,height:I.height},I.data)},Xe.prototype.removeTile=function(K){var I=this.loaded,j=K.uid;I&&I[j]&&delete I[j]};var Yt=p.vectorTile.VectorTileFeature.prototype.toGeoJSON,lt=function(I){this._feature=I,this.extent=p.EXTENT,this.type=I.type,this.properties=I.tags,"id"in I&&!isNaN(I.id)&&(this.id=parseInt(I.id,10))};lt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var K=[],I=0,j=this._feature.geometry;I<j.length;I+=1){var Y=j[I];K.push([new p.Point$1(Y[0],Y[1])])}return K}for(var ue=[],Le=0,Me=this._feature.geometry;Le<Me.length;Le+=1){for(var se=[],Ne=0,At=Me[Le];Ne<At.length;Ne+=1){var Dr=At[Ne];se.push(new p.Point$1(Dr[0],Dr[1]))}ue.push(se)}return ue},lt.prototype.toGeoJSON=function(K,I,j){return Yt.call(this,K,I,j)};var xt=function(I){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.EXTENT,this.length=I.length,this._features=I};xt.prototype.feature=function(K){return new lt(this._features[K])};var ct=p.vectorTile.VectorTileFeature,Sr=Ft;function Ft(K,I){this.options=I||{},this.features=K,this.length=K.length}function Ht(K,I){this.id=typeof K.id=="number"?K.id:void 0,this.type=K.type,this.rawGeometry=K.type===1?[K.geometry]:K.geometry,this.properties=K.tags,this.extent=I||4096}Ft.prototype.feature=function(K){return new Ht(this.features[K],this.options.extent)},Ht.prototype.loadGeometry=function(){var K=this.rawGeometry;this.geometry=[];for(var I=0;I<K.length;I++){for(var j=K[I],Y=[],ue=0;ue<j.length;ue++)Y.push(new p.Point$1(j[ue][0],j[ue][1]));this.geometry.push(Y)}return this.geometry},Ht.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var K=this.geometry,I=1/0,j=-1/0,Y=1/0,ue=-1/0,Le=0;Le<K.length;Le++)for(var Me=K[Le],se=0;se<Me.length;se++){var Ne=Me[se];I=Math.min(I,Ne.x),j=Math.max(j,Ne.x),Y=Math.min(Y,Ne.y),ue=Math.max(ue,Ne.y)}return[I,Y,j,ue]},Ht.prototype.toGeoJSON=ct.prototype.toGeoJSON;var St=vt,Ge=Sr;function vt(K){var I=new p.pbf;return function(j,Y){for(var ue in j.layers)Y.writeMessage(3,Pe,j.layers[ue])}(K,I),I.finish()}function Pe(K,I){var j;I.writeVarintField(15,K.version||1),I.writeStringField(1,K.name||""),I.writeVarintField(5,K.extent||4096);var Y={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<K.length;j++)Y.feature=K.feature(j),I.writeMessage(2,Te,Y);var ue=Y.keys;for(j=0;j<ue.length;j++)I.writeStringField(3,ue[j]);var Le=Y.values;for(j=0;j<Le.length;j++)I.writeMessage(4,Ee,Le[j])}function Te(K,I){var j=K.feature;j.id!==void 0&&I.writeVarintField(1,j.id),I.writeMessage(2,ze,K),I.writeVarintField(3,j.type),I.writeMessage(4,ae,j)}function ze(K,I){var j=K.feature,Y=K.keys,ue=K.values,Le=K.keycache,Me=K.valuecache;for(var se in j.properties){var Ne=Le[se];Ne===void 0&&(Y.push(se),Le[se]=Ne=Y.length-1),I.writeVarint(Ne);var At=j.properties[se],Dr=typeof At;Dr!=="string"&&Dr!=="boolean"&&Dr!=="number"&&(At=JSON.stringify(At));var Ur=Dr+":"+At,Xt=Me[Ur];Xt===void 0&&(ue.push(At),Me[Ur]=Xt=ue.length-1),I.writeVarint(Xt)}}function bt(K,I){return(I<<3)+(7&K)}function cr(K){return K<<1^K>>31}function ae(K,I){for(var j=K.loadGeometry(),Y=K.type,ue=0,Le=0,Me=j.length,se=0;se<Me;se++){var Ne=j[se],At=1;Y===1&&(At=Ne.length),I.writeVarint(bt(1,At));for(var Dr=Y===3?Ne.length-1:Ne.length,Ur=0;Ur<Dr;Ur++){Ur===1&&Y!==1&&I.writeVarint(bt(2,Dr-1));var Xt=Ne[Ur].x-ue,zr=Ne[Ur].y-Le;I.writeVarint(cr(Xt)),I.writeVarint(cr(zr)),ue+=Xt,Le+=zr}Y===3&&I.writeVarint(bt(7,1))}}function Ee(K,I){var j=typeof K;j==="string"?I.writeStringField(1,K):j==="boolean"?I.writeBooleanField(7,K):j==="number"&&(K%1!=0?I.writeDoubleField(3,K):K<0?I.writeSVarintField(6,K):I.writeVarintField(5,K))}function le(K,I,j,Y){re(K,j,Y),re(I,2*j,2*Y),re(I,2*j+1,2*Y+1)}function re(K,I,j){var Y=K[I];K[I]=K[j],K[j]=Y}function te(K,I,j,Y){var ue=K-j,Le=I-Y;return ue*ue+Le*Le}St.fromVectorTileJs=vt,St.fromGeojsonVt=function(K,I){I=I||{};var j={};for(var Y in K)j[Y]=new Sr(K[Y].features,I),j[Y].name=Y,j[Y].version=I.version,j[Y].extent=I.extent;return vt({layers:j})},St.GeoJSONWrapper=Ge;var ke=function(I){return I[0]},nt=function(I){return I[1]},Kt=function(I,j,Y,ue,Le){j===void 0&&(j=ke),Y===void 0&&(Y=nt),ue===void 0&&(ue=64),Le===void 0&&(Le=Float64Array),this.nodeSize=ue,this.points=I;for(var Me=I.length<65536?Uint16Array:Uint32Array,se=this.ids=new Me(I.length),Ne=this.coords=new Le(2*I.length),At=0;At<I.length;At++)se[At]=At,Ne[2*At]=j(I[At]),Ne[2*At+1]=Y(I[At]);(function Dr(Ur,Xt,zr,On,vn,hr){if(!(vn-On<=zr)){var pn=On+vn>>1;(function un(fn,hi,Jr,vi,Li,Qn){for(;Li>vi;){if(Li-vi>600){var xi=Li-vi+1,Ti=Jr-vi+1,bo=Math.log(xi),ki=.5*Math.exp(2*bo/3),si=.5*Math.sqrt(bo*ki*(xi-ki)/xi)*(Ti-xi/2<0?-1:1);un(fn,hi,Jr,Math.max(vi,Math.floor(Jr-Ti*ki/xi+si)),Math.min(Li,Math.floor(Jr+(xi-Ti)*ki/xi+si)),Qn)}var Rn=hi[2*Jr+Qn],Ri=vi,Zn=Li;for(le(fn,hi,vi,Jr),hi[2*Li+Qn]>Rn&&le(fn,hi,vi,Li);Ri<Zn;){for(le(fn,hi,Ri,Zn),Ri++,Zn--;hi[2*Ri+Qn]<Rn;)Ri++;for(;hi[2*Zn+Qn]>Rn;)Zn--}hi[2*vi+Qn]===Rn?le(fn,hi,vi,Zn):le(fn,hi,++Zn,Li),Zn<=Jr&&(vi=Zn+1),Jr<=Zn&&(Li=Zn-1)}})(Ur,Xt,pn,On,vn,hr%2),Dr(Ur,Xt,zr,On,pn-1,hr+1),Dr(Ur,Xt,zr,pn+1,vn,hr+1)}})(se,Ne,ue,0,se.length-1,0)};Kt.prototype.range=function(K,I,j,Y){return function(ue,Le,Me,se,Ne,At,Dr){for(var Ur,Xt,zr=[0,ue.length-1,0],On=[];zr.length;){var vn=zr.pop(),hr=zr.pop(),pn=zr.pop();if(hr-pn<=Dr)for(var un=pn;un<=hr;un++)Xt=Le[2*un+1],(Ur=Le[2*un])>=Me&&Ur<=Ne&&Xt>=se&&Xt<=At&&On.push(ue[un]);else{var fn=Math.floor((pn+hr)/2);Xt=Le[2*fn+1],(Ur=Le[2*fn])>=Me&&Ur<=Ne&&Xt>=se&&Xt<=At&&On.push(ue[fn]);var hi=(vn+1)%2;(vn===0?Me<=Ur:se<=Xt)&&(zr.push(pn),zr.push(fn-1),zr.push(hi)),(vn===0?Ne>=Ur:At>=Xt)&&(zr.push(fn+1),zr.push(hr),zr.push(hi))}}return On}(this.ids,this.coords,K,I,j,Y,this.nodeSize)},Kt.prototype.within=function(K,I,j){return function(Y,ue,Le,Me,se,Ne){for(var At=[0,Y.length-1,0],Dr=[],Ur=se*se;At.length;){var Xt=At.pop(),zr=At.pop(),On=At.pop();if(zr-On<=Ne)for(var vn=On;vn<=zr;vn++)te(ue[2*vn],ue[2*vn+1],Le,Me)<=Ur&&Dr.push(Y[vn]);else{var hr=Math.floor((On+zr)/2),pn=ue[2*hr],un=ue[2*hr+1];te(pn,un,Le,Me)<=Ur&&Dr.push(Y[hr]);var fn=(Xt+1)%2;(Xt===0?Le-se<=pn:Me-se<=un)&&(At.push(On),At.push(hr-1),At.push(fn)),(Xt===0?Le+se>=pn:Me+se>=un)&&(At.push(hr+1),At.push(zr),At.push(fn))}}return Dr}(this.ids,this.coords,K,I,j,this.nodeSize)};var Ir={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(I){return I}},Lr=function(I){this.options=Dt(Object.create(Ir),I),this.trees=new Array(this.options.maxZoom+1)};function qr(K,I,j,Y,ue){return{x:K,y:I,zoom:1/0,id:j,parentId:-1,numPoints:Y,properties:ue}}function tr(K,I){var j=K.geometry.coordinates,Y=j[1];return{x:Re(j[0]),y:Qe(Y),zoom:1/0,index:I,parentId:-1}}function ce(K){return{type:"Feature",id:K.id,properties:ye(K),geometry:{type:"Point",coordinates:[(Y=K.x,360*(Y-.5)),(I=K.y,j=(180-360*I)*Math.PI/180,360*Math.atan(Math.exp(j))/Math.PI-90)]}};var I,j,Y}function ye(K){var I=K.numPoints,j=I>=1e4?Math.round(I/1e3)+"k":I>=1e3?Math.round(I/100)/10+"k":I;return Dt(Dt({},K.properties),{cluster:!0,cluster_id:K.id,point_count:I,point_count_abbreviated:j})}function Re(K){return K/360+.5}function Qe(K){var I=Math.sin(K*Math.PI/180),j=.5-.25*Math.log((1+I)/(1-I))/Math.PI;return j<0?0:j>1?1:j}function Dt(K,I){for(var j in I)K[j]=I[j];return K}function Ct(K){return K.x}function A(K){return K.y}function z(K,I,j,Y,ue,Le){var Me=ue-j,se=Le-Y;if(Me!==0||se!==0){var Ne=((K-j)*Me+(I-Y)*se)/(Me*Me+se*se);Ne>1?(j=ue,Y=Le):Ne>0&&(j+=Me*Ne,Y+=se*Ne)}return(Me=K-j)*Me+(se=I-Y)*se}function ve(K,I,j,Y){var ue={id:K===void 0?null:K,type:I,geometry:j,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Le){var Me=Le.geometry,se=Le.type;if(se==="Point"||se==="MultiPoint"||se==="LineString")Ce(Le,Me);else if(se==="Polygon"||se==="MultiLineString")for(var Ne=0;Ne<Me.length;Ne++)Ce(Le,Me[Ne]);else if(se==="MultiPolygon")for(Ne=0;Ne<Me.length;Ne++)for(var At=0;At<Me[Ne].length;At++)Ce(Le,Me[Ne][At])}(ue),ue}function Ce(K,I){for(var j=0;j<I.length;j+=3)K.minX=Math.min(K.minX,I[j]),K.minY=Math.min(K.minY,I[j+1]),K.maxX=Math.max(K.maxX,I[j]),K.maxY=Math.max(K.maxY,I[j+1])}function $e(K,I,j,Y){if(I.geometry){var ue=I.geometry.coordinates,Le=I.geometry.type,Me=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2),se=[],Ne=I.id;if(j.promoteId?Ne=I.properties[j.promoteId]:j.generateId&&(Ne=Y||0),Le==="Point")ot(ue,se);else if(Le==="MultiPoint")for(var At=0;At<ue.length;At++)ot(ue[At],se);else if(Le==="LineString")Ot(ue,se,Me,!1);else if(Le==="MultiLineString"){if(j.lineMetrics){for(At=0;At<ue.length;At++)Ot(ue[At],se=[],Me,!1),K.push(ve(Ne,"LineString",se,I.properties));return}G(ue,se,Me,!1)}else if(Le==="Polygon")G(ue,se,Me,!0);else{if(Le!=="MultiPolygon"){if(Le==="GeometryCollection"){for(At=0;At<I.geometry.geometries.length;At++)$e(K,{id:Ne,geometry:I.geometry.geometries[At],properties:I.properties},j,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(At=0;At<ue.length;At++){var Dr=[];G(ue[At],Dr,Me,!0),se.push(Dr)}}K.push(ve(Ne,Le,se,I.properties))}}function ot(K,I){I.push(Et(K[0])),I.push(Bt(K[1])),I.push(0)}function Ot(K,I,j,Y){for(var ue,Le,Me=0,se=0;se<K.length;se++){var Ne=Et(K[se][0]),At=Bt(K[se][1]);I.push(Ne),I.push(At),I.push(0),se>0&&(Me+=Y?(ue*At-Ne*Le)/2:Math.sqrt(Math.pow(Ne-ue,2)+Math.pow(At-Le,2))),ue=Ne,Le=At}var Dr=I.length-3;I[2]=1,function Ur(Xt,zr,On,vn){for(var hr,pn=vn,un=On-zr>>1,fn=On-zr,hi=Xt[zr],Jr=Xt[zr+1],vi=Xt[On],Li=Xt[On+1],Qn=zr+3;Qn<On;Qn+=3){var xi=z(Xt[Qn],Xt[Qn+1],hi,Jr,vi,Li);if(xi>pn)hr=Qn,pn=xi;else if(xi===pn){var Ti=Math.abs(Qn-un);Ti<fn&&(hr=Qn,fn=Ti)}}pn>vn&&(hr-zr>3&&Ur(Xt,zr,hr,vn),Xt[hr+2]=pn,On-hr>3&&Ur(Xt,hr,On,vn))}(I,0,Dr,j),I[Dr+2]=1,I.size=Math.abs(Me),I.start=0,I.end=I.size}function G(K,I,j,Y){for(var ue=0;ue<K.length;ue++){var Le=[];Ot(K[ue],Le,j,Y),I.push(Le)}}function Et(K){return K/360+.5}function Bt(K){var I=Math.sin(K*Math.PI/180),j=.5-.25*Math.log((1+I)/(1-I))/Math.PI;return j<0?0:j>1?1:j}function dr(K,I,j,Y,ue,Le,Me,se){if(Y/=I,Le>=(j/=I)&&Me<Y)return K;if(Me<j||Le>=Y)return null;for(var Ne=[],At=0;At<K.length;At++){var Dr=K[At],Ur=Dr.geometry,Xt=Dr.type,zr=ue===0?Dr.minX:Dr.minY,On=ue===0?Dr.maxX:Dr.maxY;if(zr>=j&&On<Y)Ne.push(Dr);else if(!(On<j||zr>=Y)){var vn=[];if(Xt==="Point"||Xt==="MultiPoint")wr(Ur,vn,j,Y,ue);else if(Xt==="LineString")Tr(Ur,vn,j,Y,ue,!1,se.lineMetrics);else if(Xt==="MultiLineString")qe(Ur,vn,j,Y,ue,!1);else if(Xt==="Polygon")qe(Ur,vn,j,Y,ue,!0);else if(Xt==="MultiPolygon")for(var hr=0;hr<Ur.length;hr++){var pn=[];qe(Ur[hr],pn,j,Y,ue,!0),pn.length&&vn.push(pn)}if(vn.length){if(se.lineMetrics&&Xt==="LineString"){for(hr=0;hr<vn.length;hr++)Ne.push(ve(Dr.id,Xt,vn[hr],Dr.tags));continue}Xt!=="LineString"&&Xt!=="MultiLineString"||(vn.length===1?(Xt="LineString",vn=vn[0]):Xt="MultiLineString"),Xt!=="Point"&&Xt!=="MultiPoint"||(Xt=vn.length===3?"Point":"MultiPoint"),Ne.push(ve(Dr.id,Xt,vn,Dr.tags))}}}return Ne.length?Ne:null}function wr(K,I,j,Y,ue){for(var Le=0;Le<K.length;Le+=3){var Me=K[Le+ue];Me>=j&&Me<=Y&&(I.push(K[Le]),I.push(K[Le+1]),I.push(K[Le+2]))}}function Tr(K,I,j,Y,ue,Le,Me){for(var se,Ne,At=Or(K),Dr=ue===0?dt:lr,Ur=K.start,Xt=0;Xt<K.length-3;Xt+=3){var zr=K[Xt],On=K[Xt+1],vn=K[Xt+2],hr=K[Xt+3],pn=K[Xt+4],un=ue===0?zr:On,fn=ue===0?hr:pn,hi=!1;Me&&(se=Math.sqrt(Math.pow(zr-hr,2)+Math.pow(On-pn,2))),un<j?fn>j&&(Ne=Dr(At,zr,On,hr,pn,j),Me&&(At.start=Ur+se*Ne)):un>Y?fn<Y&&(Ne=Dr(At,zr,On,hr,pn,Y),Me&&(At.start=Ur+se*Ne)):yt(At,zr,On,vn),fn<j&&un>=j&&(Ne=Dr(At,zr,On,hr,pn,j),hi=!0),fn>Y&&un<=Y&&(Ne=Dr(At,zr,On,hr,pn,Y),hi=!0),!Le&&hi&&(Me&&(At.end=Ur+se*Ne),I.push(At),At=Or(K)),Me&&(Ur+=se)}var Jr=K.length-3;zr=K[Jr],On=K[Jr+1],vn=K[Jr+2],(un=ue===0?zr:On)>=j&&un<=Y&&yt(At,zr,On,vn),Jr=At.length-3,Le&&Jr>=3&&(At[Jr]!==At[0]||At[Jr+1]!==At[1])&&yt(At,At[0],At[1],At[2]),At.length&&I.push(At)}function Or(K){var I=[];return I.size=K.size,I.start=K.start,I.end=K.end,I}function qe(K,I,j,Y,ue,Le){for(var Me=0;Me<K.length;Me++)Tr(K[Me],I,j,Y,ue,Le,!1)}function yt(K,I,j,Y){K.push(I),K.push(j),K.push(Y)}function dt(K,I,j,Y,ue,Le){var Me=(Le-I)/(Y-I);return K.push(Le),K.push(j+(ue-j)*Me),K.push(1),Me}function lr(K,I,j,Y,ue,Le){var Me=(Le-j)/(ue-j);return K.push(I+(Y-I)*Me),K.push(Le),K.push(1),Me}function Kr(K,I){for(var j=[],Y=0;Y<K.length;Y++){var ue,Le=K[Y],Me=Le.type;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")ue=gt(Le.geometry,I);else if(Me==="MultiLineString"||Me==="Polygon"){ue=[];for(var se=0;se<Le.geometry.length;se++)ue.push(gt(Le.geometry[se],I))}else if(Me==="MultiPolygon")for(ue=[],se=0;se<Le.geometry.length;se++){for(var Ne=[],At=0;At<Le.geometry[se].length;At++)Ne.push(gt(Le.geometry[se][At],I));ue.push(Ne)}j.push(ve(Le.id,Me,ue,Le.tags))}return j}function gt(K,I){var j=[];j.size=K.size,K.start!==void 0&&(j.start=K.start,j.end=K.end);for(var Y=0;Y<K.length;Y+=3)j.push(K[Y]+I,K[Y+1],K[Y+2]);return j}function Rt(K,I){if(K.transformed)return K;var j,Y,ue,Le=1<<K.z,Me=K.x,se=K.y;for(j=0;j<K.features.length;j++){var Ne=K.features[j],At=Ne.geometry,Dr=Ne.type;if(Ne.geometry=[],Dr===1)for(Y=0;Y<At.length;Y+=2)Ne.geometry.push(sr(At[Y],At[Y+1],I,Le,Me,se));else for(Y=0;Y<At.length;Y++){var Ur=[];for(ue=0;ue<At[Y].length;ue+=2)Ur.push(sr(At[Y][ue],At[Y][ue+1],I,Le,Me,se));Ne.geometry.push(Ur)}}return K.transformed=!0,K}function sr(K,I,j,Y,ue,Le){return[Math.round(j*(K*Y-ue)),Math.round(j*(I*Y-Le))]}function ar(K,I,j,Y,ue){for(var Le=I===ue.maxZoom?0:ue.tolerance/((1<<I)*ue.extent),Me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:j,y:Y,z:I,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},se=0;se<K.length;se++){Me.numFeatures++,_n(Me,K[se],Le,ue);var Ne=K[se].minX,At=K[se].minY,Dr=K[se].maxX,Ur=K[se].maxY;Ne<Me.minX&&(Me.minX=Ne),At<Me.minY&&(Me.minY=At),Dr>Me.maxX&&(Me.maxX=Dr),Ur>Me.maxY&&(Me.maxY=Ur)}return Me}function _n(K,I,j,Y){var ue=I.geometry,Le=I.type,Me=[];if(Le==="Point"||Le==="MultiPoint")for(var se=0;se<ue.length;se+=3)Me.push(ue[se]),Me.push(ue[se+1]),K.numPoints++,K.numSimplified++;else if(Le==="LineString")xn(Me,ue,K,j,!1,!1);else if(Le==="MultiLineString"||Le==="Polygon")for(se=0;se<ue.length;se++)xn(Me,ue[se],K,j,Le==="Polygon",se===0);else if(Le==="MultiPolygon")for(var Ne=0;Ne<ue.length;Ne++){var At=ue[Ne];for(se=0;se<At.length;se++)xn(Me,At[se],K,j,!0,se===0)}if(Me.length){var Dr=I.tags||null;if(Le==="LineString"&&Y.lineMetrics){for(var Ur in Dr={},I.tags)Dr[Ur]=I.tags[Ur];Dr.mapbox_clip_start=ue.start/ue.size,Dr.mapbox_clip_end=ue.end/ue.size}var Xt={geometry:Me,type:Le==="Polygon"||Le==="MultiPolygon"?3:Le==="LineString"||Le==="MultiLineString"?2:1,tags:Dr};I.id!==null&&(Xt.id=I.id),K.features.push(Xt)}}function xn(K,I,j,Y,ue,Le){var Me=Y*Y;if(Y>0&&I.size<(ue?Me:Y))j.numPoints+=I.length/3;else{for(var se=[],Ne=0;Ne<I.length;Ne+=3)(Y===0||I[Ne+2]>Me)&&(j.numSimplified++,se.push(I[Ne]),se.push(I[Ne+1])),j.numPoints++;ue&&function(At,Dr){for(var Ur=0,Xt=0,zr=At.length,On=zr-2;Xt<zr;On=Xt,Xt+=2)Ur+=(At[Xt]-At[On])*(At[Xt+1]+At[On+1]);if(Ur>0===Dr)for(Xt=0,zr=At.length;Xt<zr/2;Xt+=2){var vn=At[Xt],hr=At[Xt+1];At[Xt]=At[zr-2-Xt],At[Xt+1]=At[zr-1-Xt],At[zr-2-Xt]=vn,At[zr-1-Xt]=hr}}(se,Le),K.push(se)}}function ci(K,I){var j=(I=this.options=function(ue,Le){for(var Me in Le)ue[Me]=Le[Me];return ue}(Object.create(this.options),I)).debug;if(j&&console.time("preprocess data"),I.maxZoom<0||I.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(I.promoteId&&I.generateId)throw new Error("promoteId and generateId cannot be used together.");var Y=function(ue,Le){var Me=[];if(ue.type==="FeatureCollection")for(var se=0;se<ue.features.length;se++)$e(Me,ue.features[se],Le,se);else $e(Me,ue.type==="Feature"?ue:{geometry:ue},Le);return Me}(K,I);this.tiles={},this.tileCoords=[],j&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",I.indexMaxZoom,I.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Y=function(ue,Le){var Me=Le.buffer/Le.extent,se=ue,Ne=dr(ue,1,-1-Me,Me,0,-1,2,Le),At=dr(ue,1,1-Me,2+Me,0,-1,2,Le);return(Ne||At)&&(se=dr(ue,1,-Me,1+Me,0,-1,2,Le)||[],Ne&&(se=Kr(Ne,1).concat(se)),At&&(se=se.concat(Kr(At,-1)))),se}(Y,I)).length&&this.splitTile(Y,0,0,0),j&&(Y.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function _i(K,I,j){return 32*((1<<K)*j+I)+K}function Ui(K,I){var j=K.tileID.canonical;if(!this._geoJSONIndex)return I(null,null);var Y=this._geoJSONIndex.getTile(j.z,j.x,j.y);if(!Y)return I(null,null);var ue=new xt(Y.features),Le=St(ue);Le.byteOffset===0&&Le.byteLength===Le.buffer.byteLength||(Le=new Uint8Array(Le)),I(null,{vectorTile:ue,rawData:Le.buffer})}Lr.prototype.load=function(K){var I=this.options,j=I.log,Y=I.minZoom,ue=I.maxZoom,Le=I.nodeSize;j&&console.time("total time");var Me="prepare "+K.length+" points";j&&console.time(Me),this.points=K;for(var se=[],Ne=0;Ne<K.length;Ne++)K[Ne].geometry&&se.push(tr(K[Ne],Ne));this.trees[ue+1]=new Kt(se,Ct,A,Le,Float32Array),j&&console.timeEnd(Me);for(var At=ue;At>=Y;At--){var Dr=+Date.now();se=this._cluster(se,At),this.trees[At]=new Kt(se,Ct,A,Le,Float32Array),j&&console.log("z%d: %d clusters in %dms",At,se.length,+Date.now()-Dr)}return j&&console.timeEnd("total time"),this},Lr.prototype.getClusters=function(K,I){var j=((K[0]+180)%360+360)%360-180,Y=Math.max(-90,Math.min(90,K[1])),ue=K[2]===180?180:((K[2]+180)%360+360)%360-180,Le=Math.max(-90,Math.min(90,K[3]));if(K[2]-K[0]>=360)j=-180,ue=180;else if(j>ue){var Me=this.getClusters([j,Y,180,Le],I),se=this.getClusters([-180,Y,ue,Le],I);return Me.concat(se)}for(var Ne=this.trees[this._limitZoom(I)],At=[],Dr=0,Ur=Ne.range(Re(j),Qe(Le),Re(ue),Qe(Y));Dr<Ur.length;Dr+=1){var Xt=Ne.points[Ur[Dr]];At.push(Xt.numPoints?ce(Xt):this.points[Xt.index])}return At},Lr.prototype.getChildren=function(K){var I=this._getOriginId(K),j=this._getOriginZoom(K),Y="No cluster with the specified id.",ue=this.trees[j];if(!ue)throw new Error(Y);var Le=ue.points[I];if(!Le)throw new Error(Y);for(var Me=this.options.radius/(this.options.extent*Math.pow(2,j-1)),se=[],Ne=0,At=ue.within(Le.x,Le.y,Me);Ne<At.length;Ne+=1){var Dr=ue.points[At[Ne]];Dr.parentId===K&&se.push(Dr.numPoints?ce(Dr):this.points[Dr.index])}if(se.length===0)throw new Error(Y);return se},Lr.prototype.getLeaves=function(K,I,j){var Y=[];return this._appendLeaves(Y,K,I=I||10,j=j||0,0),Y},Lr.prototype.getTile=function(K,I,j){var Y=this.trees[this._limitZoom(K)],ue=Math.pow(2,K),Le=this.options,Me=Le.radius/Le.extent,se=(j-Me)/ue,Ne=(j+1+Me)/ue,At={features:[]};return this._addTileFeatures(Y.range((I-Me)/ue,se,(I+1+Me)/ue,Ne),Y.points,I,j,ue,At),I===0&&this._addTileFeatures(Y.range(1-Me/ue,se,1,Ne),Y.points,ue,j,ue,At),I===ue-1&&this._addTileFeatures(Y.range(0,se,Me/ue,Ne),Y.points,-1,j,ue,At),At.features.length?At:null},Lr.prototype.getClusterExpansionZoom=function(K){for(var I=this._getOriginZoom(K)-1;I<=this.options.maxZoom;){var j=this.getChildren(K);if(I++,j.length!==1)break;K=j[0].properties.cluster_id}return I},Lr.prototype._appendLeaves=function(K,I,j,Y,ue){for(var Le=0,Me=this.getChildren(I);Le<Me.length;Le+=1){var se=Me[Le],Ne=se.properties;if(Ne&&Ne.cluster?ue+Ne.point_count<=Y?ue+=Ne.point_count:ue=this._appendLeaves(K,Ne.cluster_id,j,Y,ue):ue<Y?ue++:K.push(se),K.length===j)break}return ue},Lr.prototype._addTileFeatures=function(K,I,j,Y,ue,Le){for(var Me=0,se=K;Me<se.length;Me+=1){var Ne=I[se[Me]],At=Ne.numPoints,Dr={type:1,geometry:[[Math.round(this.options.extent*(Ne.x*ue-j)),Math.round(this.options.extent*(Ne.y*ue-Y))]],tags:At?ye(Ne):this.points[Ne.index].properties},Ur=void 0;At?Ur=Ne.id:this.options.generateId?Ur=Ne.index:this.points[Ne.index].id&&(Ur=this.points[Ne.index].id),Ur!==void 0&&(Dr.id=Ur),Le.features.push(Dr)}},Lr.prototype._limitZoom=function(K){return Math.max(this.options.minZoom,Math.min(+K,this.options.maxZoom+1))},Lr.prototype._cluster=function(K,I){for(var j=[],Y=this.options,ue=Y.reduce,Le=Y.minPoints,Me=Y.radius/(Y.extent*Math.pow(2,I)),se=0;se<K.length;se++){var Ne=K[se];if(!(Ne.zoom<=I)){Ne.zoom=I;for(var At=this.trees[I+1],Dr=At.within(Ne.x,Ne.y,Me),Ur=Ne.numPoints||1,Xt=Ur,zr=0,On=Dr;zr<On.length;zr+=1){var vn=At.points[On[zr]];vn.zoom>I&&(Xt+=vn.numPoints||1)}if(Xt>=Le){for(var hr=Ne.x*Ur,pn=Ne.y*Ur,un=ue&&Ur>1?this._map(Ne,!0):null,fn=(se<<5)+(I+1)+this.points.length,hi=0,Jr=Dr;hi<Jr.length;hi+=1){var vi=At.points[Jr[hi]];if(!(vi.zoom<=I)){vi.zoom=I;var Li=vi.numPoints||1;hr+=vi.x*Li,pn+=vi.y*Li,vi.parentId=fn,ue&&(un||(un=this._map(Ne,!0)),ue(un,this._map(vi)))}}Ne.parentId=fn,j.push(qr(hr/Xt,pn/Xt,fn,Xt,un))}else if(j.push(Ne),Xt>1)for(var Qn=0,xi=Dr;Qn<xi.length;Qn+=1){var Ti=At.points[xi[Qn]];Ti.zoom<=I||(Ti.zoom=I,j.push(Ti))}}}return j},Lr.prototype._getOriginId=function(K){return K-this.points.length>>5},Lr.prototype._getOriginZoom=function(K){return(K-this.points.length)%32},Lr.prototype._map=function(K,I){if(K.numPoints)return I?Dt({},K.properties):K.properties;var j=this.points[K.index].properties,Y=this.options.map(j);return I&&Y===j?Dt({},Y):Y},ci.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ci.prototype.splitTile=function(K,I,j,Y,ue,Le,Me){for(var se=[K,I,j,Y],Ne=this.options,At=Ne.debug;se.length;){Y=se.pop(),j=se.pop(),I=se.pop(),K=se.pop();var Dr=1<<I,Ur=_i(I,j,Y),Xt=this.tiles[Ur];if(!Xt&&(At>1&&console.time("creation"),Xt=this.tiles[Ur]=ar(K,I,j,Y,Ne),this.tileCoords.push({z:I,x:j,y:Y}),At)){At>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",I,j,Y,Xt.numFeatures,Xt.numPoints,Xt.numSimplified),console.timeEnd("creation"));var zr="z"+I;this.stats[zr]=(this.stats[zr]||0)+1,this.total++}if(Xt.source=K,ue){if(I===Ne.maxZoom||I===ue)continue;var On=1<<ue-I;if(j!==Math.floor(Le/On)||Y!==Math.floor(Me/On))continue}else if(I===Ne.indexMaxZoom||Xt.numPoints<=Ne.indexMaxPoints)continue;if(Xt.source=null,K.length!==0){At>1&&console.time("clipping");var vn,hr,pn,un,fn,hi,Jr=.5*Ne.buffer/Ne.extent,vi=.5-Jr,Li=.5+Jr,Qn=1+Jr;vn=hr=pn=un=null,fn=dr(K,Dr,j-Jr,j+Li,0,Xt.minX,Xt.maxX,Ne),hi=dr(K,Dr,j+vi,j+Qn,0,Xt.minX,Xt.maxX,Ne),K=null,fn&&(vn=dr(fn,Dr,Y-Jr,Y+Li,1,Xt.minY,Xt.maxY,Ne),hr=dr(fn,Dr,Y+vi,Y+Qn,1,Xt.minY,Xt.maxY,Ne),fn=null),hi&&(pn=dr(hi,Dr,Y-Jr,Y+Li,1,Xt.minY,Xt.maxY,Ne),un=dr(hi,Dr,Y+vi,Y+Qn,1,Xt.minY,Xt.maxY,Ne),hi=null),At>1&&console.timeEnd("clipping"),se.push(vn||[],I+1,2*j,2*Y),se.push(hr||[],I+1,2*j,2*Y+1),se.push(pn||[],I+1,2*j+1,2*Y),se.push(un||[],I+1,2*j+1,2*Y+1)}}},ci.prototype.getTile=function(K,I,j){var Y=this.options,ue=Y.extent,Le=Y.debug;if(K<0||K>24)return null;var Me=1<<K,se=_i(K,I=(I%Me+Me)%Me,j);if(this.tiles[se])return Rt(this.tiles[se],ue);Le>1&&console.log("drilling down to z%d-%d-%d",K,I,j);for(var Ne,At=K,Dr=I,Ur=j;!Ne&&At>0;)At--,Dr=Math.floor(Dr/2),Ur=Math.floor(Ur/2),Ne=this.tiles[_i(At,Dr,Ur)];return Ne&&Ne.source?(Le>1&&console.log("found parent tile z%d-%d-%d",At,Dr,Ur),Le>1&&console.time("drilling down"),this.splitTile(Ne.source,At,Dr,Ur,K,I,j),Le>1&&console.timeEnd("drilling down"),this.tiles[se]?Rt(this.tiles[se],ue):null):null};var Xi=function(K){function I(j,Y,ue,Le){K.call(this,j,Y,ue,Ui),Le&&(this.loadGeoJSON=Le)}return K&&(I.__proto__=K),(I.prototype=Object.create(K&&K.prototype)).constructor=I,I.prototype.loadData=function(j,Y){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Y,this._pendingLoadDataParams=j,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},I.prototype._loadData=function(){var j=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Y=this._pendingCallback,ue=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Le=!!(ue&&ue.request&&ue.request.collectResourceTiming)&&new p.RequestPerformance(ue.request);this.loadGeoJSON(ue,function(Me,se){if(Me||!se)return Y(Me);if(typeof se!="object")return Y(new Error("Input data given to '"+ue.source+"' is not a valid GeoJSON object."));(function Xt(zr,On){var vn,hr=zr&&zr.type;if(hr==="FeatureCollection")for(vn=0;vn<zr.features.length;vn++)Xt(zr.features[vn],On);else if(hr==="GeometryCollection")for(vn=0;vn<zr.geometries.length;vn++)Xt(zr.geometries[vn],On);else if(hr==="Feature")Xt(zr.geometry,On);else if(hr==="Polygon")Ut(zr.coordinates,On);else if(hr==="MultiPolygon")for(vn=0;vn<zr.coordinates.length;vn++)Ut(zr.coordinates[vn],On);return zr})(se,!0);try{if(ue.filter){var Ne=p.createExpression(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ne.result==="error")throw new Error(Ne.value.map(function(Xt){return Xt.key+": "+Xt.message}).join(", "));var At=se.features.filter(function(Xt){return Ne.value.evaluate({zoom:0},Xt)});se={type:"FeatureCollection",features:At}}j._geoJSONIndex=ue.cluster?new Lr(function(Xt){var zr=Xt.superclusterOptions,On=Xt.clusterProperties;if(!On||!zr)return zr;for(var vn={},hr={},pn={accumulated:null,zoom:0},un={properties:null},fn=Object.keys(On),hi=0,Jr=fn;hi<Jr.length;hi+=1){var vi=Jr[hi],Li=On[vi],Qn=Li[0],xi=p.createExpression(Li[1]),Ti=p.createExpression(typeof Qn=="string"?[Qn,["accumulated"],["get",vi]]:Qn);vn[vi]=xi.value,hr[vi]=Ti.value}return zr.map=function(bo){un.properties=bo;for(var ki={},si=0,Rn=fn;si<Rn.length;si+=1){var Ri=Rn[si];ki[Ri]=vn[Ri].evaluate(pn,un)}return ki},zr.reduce=function(bo,ki){un.properties=ki;for(var si=0,Rn=fn;si<Rn.length;si+=1){var Ri=Rn[si];pn.accumulated=bo[Ri],bo[Ri]=hr[Ri].evaluate(pn,un)}},zr}(ue)).load(se.features):function(Xt,zr){return new ci(Xt,zr)}(se,ue.geojsonVtOptions)}catch(Xt){return Y(Xt)}j.loaded={};var Dr={};if(Le){var Ur=Le.finish();Ur&&(Dr.resourceTiming={},Dr.resourceTiming[ue.source]=JSON.parse(JSON.stringify(Ur)))}Y(null,Dr)})}},I.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},I.prototype.reloadTile=function(j,Y){var ue=this.loaded;return ue&&ue[j.uid]?K.prototype.reloadTile.call(this,j,Y):this.loadTile(j,Y)},I.prototype.loadGeoJSON=function(j,Y){if(j.request)p.getJSON(j.request,Y);else{if(typeof j.data!="string")return Y(new Error("Input data given to '"+j.source+"' is not a valid GeoJSON object."));try{return Y(null,JSON.parse(j.data))}catch(ue){return Y(new Error("Input data given to '"+j.source+"' is not a valid GeoJSON object."))}}},I.prototype.removeSource=function(j,Y){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Y()},I.prototype.getClusterExpansionZoom=function(j,Y){try{Y(null,this._geoJSONIndex.getClusterExpansionZoom(j.clusterId))}catch(ue){Y(ue)}},I.prototype.getClusterChildren=function(j,Y){try{Y(null,this._geoJSONIndex.getChildren(j.clusterId))}catch(ue){Y(ue)}},I.prototype.getClusterLeaves=function(j,Y){try{Y(null,this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset))}catch(ue){Y(ue)}},I}(Ie),oi=function(I){var j=this;this.self=I,this.actor=new p.Actor(I,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ie,geojson:Xi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Y,ue){if(j.workerSourceTypes[Y])throw new Error('Worker source with name "'+Y+'" already registered.');j.workerSourceTypes[Y]=ue},this.self.registerRTLTextPlugin=function(Y){if(p.plugin.isParsed())throw new Error("RTL text plugin already registered.");p.plugin.applyArabicShaping=Y.applyArabicShaping,p.plugin.processBidirectionalText=Y.processBidirectionalText,p.plugin.processStyledBidirectionalText=Y.processStyledBidirectionalText}};return oi.prototype.setReferrer=function(K,I){this.referrer=I},oi.prototype.setImages=function(K,I,j){for(var Y in this.availableImages[K]=I,this.workerSources[K]){var ue=this.workerSources[K][Y];for(var Le in ue)ue[Le].availableImages=I}j()},oi.prototype.setLayers=function(K,I,j){this.getLayerIndex(K).replace(I),j()},oi.prototype.updateLayers=function(K,I,j){this.getLayerIndex(K).update(I.layers,I.removedIds),j()},oi.prototype.loadTile=function(K,I,j){this.getWorkerSource(K,I.type,I.source).loadTile(I,j)},oi.prototype.loadDEMTile=function(K,I,j){this.getDEMWorkerSource(K,I.source).loadTile(I,j)},oi.prototype.reloadTile=function(K,I,j){this.getWorkerSource(K,I.type,I.source).reloadTile(I,j)},oi.prototype.abortTile=function(K,I,j){this.getWorkerSource(K,I.type,I.source).abortTile(I,j)},oi.prototype.removeTile=function(K,I,j){this.getWorkerSource(K,I.type,I.source).removeTile(I,j)},oi.prototype.removeDEMTile=function(K,I){this.getDEMWorkerSource(K,I.source).removeTile(I)},oi.prototype.removeSource=function(K,I,j){if(this.workerSources[K]&&this.workerSources[K][I.type]&&this.workerSources[K][I.type][I.source]){var Y=this.workerSources[K][I.type][I.source];delete this.workerSources[K][I.type][I.source],Y.removeSource!==void 0?Y.removeSource(I,j):j()}},oi.prototype.loadWorkerSource=function(K,I,j){try{this.self.importScripts(I.url),j()}catch(Y){j(Y.toString())}},oi.prototype.syncRTLPluginState=function(K,I,j){try{p.plugin.setState(I);var Y=p.plugin.getPluginURL();if(p.plugin.isLoaded()&&!p.plugin.isParsed()&&Y!=null){this.self.importScripts(Y);var ue=p.plugin.isParsed();j(ue?void 0:new Error("RTL Text Plugin failed to import scripts from "+Y),ue)}}catch(Le){j(Le.toString())}},oi.prototype.getAvailableImages=function(K){var I=this.availableImages[K];return I||(I=[]),I},oi.prototype.getLayerIndex=function(K){var I=this.layerIndexes[K];return I||(I=this.layerIndexes[K]=new F),I},oi.prototype.getWorkerSource=function(K,I,j){var Y=this;return this.workerSources[K]||(this.workerSources[K]={}),this.workerSources[K][I]||(this.workerSources[K][I]={}),this.workerSources[K][I][j]||(this.workerSources[K][I][j]=new this.workerSourceTypes[I]({send:function(Le,Me,se){Y.actor.send(Le,Me,se,K)}},this.getLayerIndex(K),this.getAvailableImages(K))),this.workerSources[K][I][j]},oi.prototype.getDEMWorkerSource=function(K,I){return this.demWorkerSources[K]||(this.demWorkerSources[K]={}),this.demWorkerSources[K][I]||(this.demWorkerSources[K][I]=new Xe),this.demWorkerSources[K][I]},oi.prototype.enforceCacheSizeLimit=function(K,I){p.enforceCacheSizeLimit(I)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new oi(self)),oi}),b(["./shared"],function(p){"use strict";var H=p.createCommonjsModule(function(c){function o(g){return!i(g)}function i(g){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var C,L,Z=new Blob([""],{type:"text/javascript"}),q=URL.createObjectURL(Z);try{L=new Worker(q),C=!0}catch(de){C=!1}return L&&L.terminate(),URL.revokeObjectURL(q),C}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var C=document.createElement("canvas");C.width=C.height=1;var L=C.getContext("2d");if(!L)return!1;var Z=L.getImageData(0,0,1,1);return Z&&Z.width===C.width}()?(h[E=g&&g.failIfMajorPerformanceCaveat]===void 0&&(h[E]=function(C){var L=function(q){var de=document.createElement("canvas"),ge=Object.create(o.webGLContextAttributes);return ge.failIfMajorPerformanceCaveat=q,de.probablySupportsContext?de.probablySupportsContext("webgl",ge)||de.probablySupportsContext("experimental-webgl",ge):de.supportsContext?de.supportsContext("webgl",ge)||de.supportsContext("experimental-webgl",ge):de.getContext("webgl",ge)||de.getContext("experimental-webgl",ge)}(C);if(!L)return!1;var Z=L.createShader(L.VERTEX_SHADER);return!(!Z||L.isContextLost())&&(L.shaderSource(Z,"void main() {}"),L.compileShader(Z),L.getShaderParameter(Z,L.COMPILE_STATUS)===!0)}(E)),h[E]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var E}c.exports?c.exports=o:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=o,window.mapboxgl.notSupportedReason=i);var h={};o.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),S={create:function(o,i,h){var g=p.window.document.createElement(o);return i!==void 0&&(g.className=i),h&&h.appendChild(g),g},createNS:function(o,i){return p.window.document.createElementNS(o,i)}},F=p.window.document&&p.window.document.documentElement.style;function ie(c){if(!F)return c[0];for(var o=0;o<c.length;o++)if(c[o]in F)return c[o];return c[0]}var fe,Q=ie(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);S.disableDrag=function(){F&&Q&&(fe=F[Q],F[Q]="none")},S.enableDrag=function(){F&&Q&&(F[Q]=fe)};var we=ie(["transform","WebkitTransform"]);S.setTransform=function(c,o){c.style[we]=o};var Ie=!1;try{var Be=Object.defineProperty({},"passive",{get:function(){Ie=!0}});p.window.addEventListener("test",Be,Be),p.window.removeEventListener("test",Be,Be)}catch(c){Ie=!1}S.addEventListener=function(c,o,i,h){h===void 0&&(h={}),c.addEventListener(o,i,"passive"in h&&Ie?h:h.capture)},S.removeEventListener=function(c,o,i,h){h===void 0&&(h={}),c.removeEventListener(o,i,"passive"in h&&Ie?h:h.capture)};var Xe=function c(o){o.preventDefault(),o.stopPropagation(),p.window.removeEventListener("click",c,!0)};function Ut(c){var o=c.userImage;return!!(o&&o.render&&o.render())&&(c.data.replace(new Uint8Array(o.data.buffer)),!0)}S.suppressClick=function(){p.window.addEventListener("click",Xe,!0),p.window.setTimeout(function(){p.window.removeEventListener("click",Xe,!0)},0)},S.mousePos=function(c,o){var i=c.getBoundingClientRect();return new p.Point(o.clientX-i.left-c.clientLeft,o.clientY-i.top-c.clientTop)},S.touchPos=function(c,o){for(var i=c.getBoundingClientRect(),h=[],g=0;g<o.length;g++)h.push(new p.Point(o[g].clientX-i.left-c.clientLeft,o[g].clientY-i.top-c.clientTop));return h},S.mouseButton=function(c){return p.window.InstallTrigger!==void 0&&c.button===2&&c.ctrlKey&&p.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:c.button},S.remove=function(c){c.parentNode&&c.parentNode.removeChild(c)};var er=function(c){function o(){c.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new p.RGBAImage({width:1,height:1}),this.dirty=!0}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.isLoaded=function(){return this.loaded},o.prototype.setLoaded=function(i){if(this.loaded!==i&&(this.loaded=i,i)){for(var h=0,g=this.requestors;h<g.length;h+=1){var E=g[h];this._notify(E.ids,E.callback)}this.requestors=[]}},o.prototype.getImage=function(i){return this.images[i]},o.prototype.addImage=function(i,h){this._validate(i,h)&&(this.images[i]=h)},o.prototype._validate=function(i,h){var g=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new p.ErrorEvent(new Error('Image "'+i+'" has invalid "stretchX" value'))),g=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new p.ErrorEvent(new Error('Image "'+i+'" has invalid "stretchY" value'))),g=!1),this._validateContent(h.content,h)||(this.fire(new p.ErrorEvent(new Error('Image "'+i+'" has invalid "content" value'))),g=!1),g},o.prototype._validateStretch=function(i,h){if(!i)return!0;for(var g=0,E=0,C=i;E<C.length;E+=1){var L=C[E];if(L[0]<g||L[1]<L[0]||h<L[1])return!1;g=L[1]}return!0},o.prototype._validateContent=function(i,h){return!(i&&(i.length!==4||i[0]<0||h.data.width<i[0]||i[1]<0||h.data.height<i[1]||i[2]<0||h.data.width<i[2]||i[3]<0||h.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))},o.prototype.updateImage=function(i,h){h.version=this.images[i].version+1,this.images[i]=h,this.updatedImages[i]=!0},o.prototype.removeImage=function(i){var h=this.images[i];delete this.images[i],delete this.patterns[i],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()},o.prototype.listImages=function(){return Object.keys(this.images)},o.prototype.getImages=function(i,h){var g=!0;if(!this.isLoaded())for(var E=0,C=i;E<C.length;E+=1)this.images[C[E]]||(g=!1);this.isLoaded()||g?this._notify(i,h):this.requestors.push({ids:i,callback:h})},o.prototype._notify=function(i,h){for(var g={},E=0,C=i;E<C.length;E+=1){var L=C[E];this.images[L]||this.fire(new p.Event("styleimagemissing",{id:L}));var Z=this.images[L];Z?g[L]={data:Z.data.clone(),pixelRatio:Z.pixelRatio,sdf:Z.sdf,version:Z.version,stretchX:Z.stretchX,stretchY:Z.stretchY,content:Z.content,hasRenderCallback:Boolean(Z.userImage&&Z.userImage.render)}:p.warnOnce('Image "'+L+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}h(null,g)},o.prototype.getPixelSize=function(){var i=this.atlasImage;return{width:i.width,height:i.height}},o.prototype.getPattern=function(i){var h=this.patterns[i],g=this.getImage(i);if(!g)return null;if(h&&h.position.version===g.version)return h.position;if(h)h.position.version=g.version;else{var E={w:g.data.width+2,h:g.data.height+2,x:0,y:0},C=new p.ImagePosition(E,g);this.patterns[i]={bin:E,position:C}}return this._updatePatternAtlas(),this.patterns[i].position},o.prototype.bind=function(i){var h=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new p.Texture(i,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)},o.prototype._updatePatternAtlas=function(){var i=[];for(var h in this.patterns)i.push(this.patterns[h].bin);var g=p.potpack(i),E=g.w,C=g.h,L=this.atlasImage;for(var Z in L.resize({width:E||1,height:C||1}),this.patterns){var q=this.patterns[Z].bin,de=q.x+1,ge=q.y+1,be=this.images[Z].data,Ke=be.width,He=be.height;p.RGBAImage.copy(be,L,{x:0,y:0},{x:de,y:ge},{width:Ke,height:He}),p.RGBAImage.copy(be,L,{x:0,y:He-1},{x:de,y:ge-1},{width:Ke,height:1}),p.RGBAImage.copy(be,L,{x:0,y:0},{x:de,y:ge+He},{width:Ke,height:1}),p.RGBAImage.copy(be,L,{x:Ke-1,y:0},{x:de-1,y:ge},{width:1,height:He}),p.RGBAImage.copy(be,L,{x:0,y:0},{x:de+Ke,y:ge},{width:1,height:He})}this.dirty=!0},o.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},o.prototype.dispatchRenderCallbacks=function(i){for(var h=0,g=i;h<g.length;h+=1){var E=g[h];if(!this.callbackDispatchedThisFrame[E]){this.callbackDispatchedThisFrame[E]=!0;var C=this.images[E];Ut(C)&&this.updateImage(E,C)}}},o}(p.Evented),Yt=ct,lt=ct,xt=1e20;function ct(c,o,i,h,g,E){this.fontSize=c||24,this.buffer=o===void 0?3:o,this.cutoff=h||.25,this.fontFamily=g||"sans-serif",this.fontWeight=E||"normal",this.radius=i||8;var C=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=C,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.d=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Int16Array(C),this.middle=Math.round(C/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Sr(c,o,i,h,g,E,C){for(var L=0;L<o;L++){for(var Z=0;Z<i;Z++)h[Z]=c[Z*o+L];for(Ft(h,g,E,C,i),Z=0;Z<i;Z++)c[Z*o+L]=g[Z]}for(Z=0;Z<i;Z++){for(L=0;L<o;L++)h[L]=c[Z*o+L];for(Ft(h,g,E,C,o),L=0;L<o;L++)c[Z*o+L]=Math.sqrt(g[L])}}function Ft(c,o,i,h,g){i[0]=0,h[0]=-xt,h[1]=+xt;for(var E=1,C=0;E<g;E++){for(var L=(c[E]+E*E-(c[i[C]]+i[C]*i[C]))/(2*E-2*i[C]);L<=h[C];)C--,L=(c[E]+E*E-(c[i[C]]+i[C]*i[C]))/(2*E-2*i[C]);i[++C]=E,h[C]=L,h[C+1]=+xt}for(E=0,C=0;E<g;E++){for(;h[C+1]<E;)C++;o[E]=(E-i[C])*(E-i[C])+c[i[C]]}}ct.prototype.draw=function(c){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(c,this.buffer,this.middle);for(var o=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),h=0;h<this.size*this.size;h++){var g=o.data[4*h+3]/255;this.gridOuter[h]=g===1?0:g===0?xt:Math.pow(Math.max(0,.5-g),2),this.gridInner[h]=g===1?xt:g===0?0:Math.pow(Math.max(0,g-.5),2)}for(Sr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Sr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),h=0;h<this.size*this.size;h++)i[h]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[h]-this.gridInner[h])/this.radius+this.cutoff))));return i},Yt.default=lt;var Ht=function(o,i){this.requestManager=o,this.localIdeographFontFamily=i,this.entries={}};Ht.prototype.setURL=function(c){this.url=c},Ht.prototype.getGlyphs=function(c,o){var i=this,h=[];for(var g in c)for(var E=0,C=c[g];E<C.length;E+=1)h.push({stack:g,id:C[E]});p.asyncAll(h,function(L,Z){var q=L.stack,de=L.id,ge=i.entries[q];ge||(ge=i.entries[q]={glyphs:{},requests:{},ranges:{}});var be=ge.glyphs[de];if(be===void 0){if(be=i._tinySDF(ge,q,de))return ge.glyphs[de]=be,void Z(null,{stack:q,id:de,glyph:be});var Ke=Math.floor(de/256);if(256*Ke>65535)Z(new Error("glyphs > 65535 not supported"));else if(ge.ranges[Ke])Z(null,{stack:q,id:de,glyph:be});else{var He=ge.requests[Ke];He||(He=ge.requests[Ke]=[],Ht.loadGlyphRange(q,Ke,i.url,i.requestManager,function(ut,We){if(We){for(var et in We)i._doesCharSupportLocalGlyph(+et)||(ge.glyphs[+et]=We[+et]);ge.ranges[Ke]=!0}for(var Pt=0,Mt=He;Pt<Mt.length;Pt+=1)(0,Mt[Pt])(ut,We);delete ge.requests[Ke]})),He.push(function(ut,We){ut?Z(ut):We&&Z(null,{stack:q,id:de,glyph:We[de]||null})})}}else Z(null,{stack:q,id:de,glyph:be})},function(L,Z){if(L)o(L);else if(Z){for(var q={},de=0,ge=Z;de<ge.length;de+=1){var be=ge[de],Ke=be.stack,He=be.id,ut=be.glyph;(q[Ke]||(q[Ke]={}))[He]=ut&&{id:ut.id,bitmap:ut.bitmap.clone(),metrics:ut.metrics}}o(null,q)}})},Ht.prototype._doesCharSupportLocalGlyph=function(c){return!!this.localIdeographFontFamily&&(p.isChar["CJK Unified Ideographs"](c)||p.isChar["Hangul Syllables"](c)||p.isChar.Hiragana(c)||p.isChar.Katakana(c))},Ht.prototype._tinySDF=function(c,o,i){var h=this.localIdeographFontFamily;if(h&&this._doesCharSupportLocalGlyph(i)){var g=c.tinySDF;if(!g){var E="400";/bold/i.test(o)?E="900":/medium/i.test(o)?E="500":/light/i.test(o)&&(E="200"),g=c.tinySDF=new Ht.TinySDF(24,3,8,.25,h,E)}return{id:i,bitmap:new p.AlphaImage({width:30,height:30},g.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ht.loadGlyphRange=function(c,o,i,h,g){var E=256*o,C=E+255,L=h.transformRequest(h.normalizeGlyphsURL(i).replace("{fontstack}",c).replace("{range}",E+"-"+C),p.ResourceType.Glyphs);p.getArrayBuffer(L,function(Z,q){if(Z)g(Z);else if(q){for(var de={},ge=0,be=p.parseGlyphPBF(q);ge<be.length;ge+=1){var Ke=be[ge];de[Ke.id]=Ke}g(null,de)}})},Ht.TinySDF=Yt;var St=function(){this.specification=p.styleSpec.light.position};St.prototype.possiblyEvaluate=function(c,o){return p.sphericalToCartesian(c.expression.evaluate(o))},St.prototype.interpolate=function(c,o,i){return{x:p.number(c.x,o.x,i),y:p.number(c.y,o.y,i),z:p.number(c.z,o.z,i)}};var Ge=new p.Properties({anchor:new p.DataConstantProperty(p.styleSpec.light.anchor),position:new St,color:new p.DataConstantProperty(p.styleSpec.light.color),intensity:new p.DataConstantProperty(p.styleSpec.light.intensity)}),vt=function(c){function o(i){c.call(this),this._transitionable=new p.Transitionable(Ge),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getLight=function(){return this._transitionable.serialize()},o.prototype.setLight=function(i,h){if(h===void 0&&(h={}),!this._validate(p.validateLight,i,h))for(var g in i){var E=i[g];p.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-"-transition".length),E):this._transitionable.setValue(g,E)}},o.prototype.updateTransitions=function(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)},o.prototype.hasTransition=function(){return this._transitioning.hasTransition()},o.prototype.recalculate=function(i){this.properties=this._transitioning.possiblyEvaluate(i)},o.prototype._validate=function(i,h,g){return(!g||g.validate!==!1)&&p.emitValidationErrors(this,i.call(p.validateStyle,p.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:p.styleSpec})))},o}(p.Evented),Pe=function(o,i){this.width=o,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Pe.prototype.getDash=function(c,o){var i=c.join(",")+String(o);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(c,o)),this.dashEntry[i]},Pe.prototype.getDashRanges=function(c,o,i){var h=[],g=c.length%2==1?-c[c.length-1]*i:0,E=c[0]*i,C=!0;h.push({left:g,right:E,isDash:C,zeroLength:c[0]===0});for(var L=c[0],Z=1;Z<c.length;Z++){var q=c[Z];h.push({left:g=L*i,right:E=(L+=q)*i,isDash:C=!C,zeroLength:q===0})}return h},Pe.prototype.addRoundDash=function(c,o,i){for(var h=o/2,g=-i;g<=i;g++)for(var E=this.width*(this.nextRow+i+g),C=0,L=c[C],Z=0;Z<this.width;Z++){Z/L.right>1&&(L=c[++C]);var q=Math.abs(Z-L.left),de=Math.abs(Z-L.right),ge=Math.min(q,de),be=void 0,Ke=g/i*(h+1);if(L.isDash){var He=h-Math.abs(Ke);be=Math.sqrt(ge*ge+He*He)}else be=h-Math.sqrt(ge*ge+Ke*Ke);this.data[E+Z]=Math.max(0,Math.min(255,be+128))}},Pe.prototype.addRegularDash=function(c){for(var o=c.length-1;o>=0;--o){var i=c[o],h=c[o+1];i.zeroLength?c.splice(o,1):h&&h.isDash===i.isDash&&(h.left=i.left,c.splice(o,1))}var g=c[0],E=c[c.length-1];g.isDash===E.isDash&&(g.left=E.left-this.width,E.right=g.right+this.width);for(var C=this.width*this.nextRow,L=0,Z=c[L],q=0;q<this.width;q++){q/Z.right>1&&(Z=c[++L]);var de=Math.abs(q-Z.left),ge=Math.abs(q-Z.right),be=Math.min(de,ge);this.data[C+q]=Math.max(0,Math.min(255,(Z.isDash?be:-be)+128))}},Pe.prototype.addDash=function(c,o){var i=o?7:0,h=2*i+1;if(this.nextRow+h>this.height)return p.warnOnce("LineAtlas out of space"),null;for(var g=0,E=0;E<c.length;E++)g+=c[E];if(g!==0){var C=this.width/g,L=this.getDashRanges(c,this.width,C);o?this.addRoundDash(L,C,i):this.addRegularDash(L)}var Z={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:g};return this.nextRow+=h,this.dirty=!0,Z},Pe.prototype.bind=function(c){var o=c.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))};var Te=function c(o,i){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p.uniqueId();for(var h=this.workerPool.acquire(this.id),g=0;g<h.length;g++){var E=new c.Actor(h[g],i,this.id);E.name="Worker "+g,this.actors.push(E)}};function ze(c,o,i){var h=function(E,C){if(E)return i(E);if(C){var L=p.pick(p.extend(C,c),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(L.vectorLayers=C.vector_layers,L.vectorLayerIds=L.vectorLayers.map(function(Z){return Z.id})),L.tiles=o.canonicalizeTileset(L,c.url),i(null,L)}};return c.url?p.getJSON(o.transformRequest(o.normalizeSourceURL(c.url),p.ResourceType.Source),h):p.browser.frame(function(){return h(null,c)})}Te.prototype.broadcast=function(c,o,i){p.asyncAll(this.actors,function(h,g){h.send(c,o,g)},i=i||function(){})},Te.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Te.prototype.remove=function(){this.actors.forEach(function(c){c.remove()}),this.actors=[],this.workerPool.release(this.id)},Te.Actor=p.Actor;var bt=function(o,i,h){this.bounds=p.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=i||0,this.maxzoom=h||24};bt.prototype.validateBounds=function(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]},bt.prototype.contains=function(c){var o=Math.pow(2,c.z),i=Math.floor(p.mercatorXfromLng(this.bounds.getWest())*o),h=Math.floor(p.mercatorYfromLat(this.bounds.getNorth())*o),g=Math.ceil(p.mercatorXfromLng(this.bounds.getEast())*o),E=Math.ceil(p.mercatorYfromLat(this.bounds.getSouth())*o);return c.x>=i&&c.x<g&&c.y>=h&&c.y<E};var cr=function(c){function o(i,h,g,E){if(c.call(this),this.id=i,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,p.extend(this,p.pick(h,["url","scheme","tileSize","promoteId"])),this._options=p.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(E)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ze(this._options,this.map._requestManager,function(h,g){i._tileJSONRequest=null,i._loaded=!0,h?i.fire(new p.ErrorEvent(h)):g&&(p.extend(i,g),g.bounds&&(i.tileBounds=new bt(g.bounds,i.minzoom,i.maxzoom)),p.postTurnstileEvent(g.tiles,i.map._requestManager._customAccessToken),p.postMapLoadEvent(g.tiles,i.map._getMapId(),i.map._requestManager._skuToken,i.map._requestManager._customAccessToken),i.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.hasTile=function(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setSourceProperty=function(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},o.prototype.setTiles=function(i){var h=this;return this.setSourceProperty(function(){h._options.tiles=i}),this},o.prototype.setUrl=function(i){var h=this;return this.setSourceProperty(function(){h.url=i,h._options.url=i}),this},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return p.extend({},this._options)},o.prototype.loadTile=function(i,h){var g=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),E={request:this.map._requestManager.transformRequest(g,p.ResourceType.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:p.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function C(L,Z){return delete i.request,i.aborted?h(null):L&&L.status!==404?h(L):(Z&&Z.resourceTiming&&(i.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&i.setExpiryData(Z),i.loadVectorData(Z,this.map.painter),p.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}E.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired"?i.state==="loading"?i.reloadCallback=h:i.request=i.actor.send("reloadTile",E,C.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",E,C.bind(this)))},o.prototype.abortTile=function(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)},o.prototype.unloadTile=function(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)},o.prototype.hasTransition=function(){return!1},o}(p.Evented),ae=function(c){function o(i,h,g,E){c.call(this),this.id=i,this.dispatcher=g,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=p.extend({type:"raster"},h),p.extend(this,p.pick(h,["url","scheme","tileSize"]))}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ze(this._options,this.map._requestManager,function(h,g){i._tileJSONRequest=null,i._loaded=!0,h?i.fire(new p.ErrorEvent(h)):g&&(p.extend(i,g),g.bounds&&(i.tileBounds=new bt(g.bounds,i.minzoom,i.maxzoom)),p.postTurnstileEvent(g.tiles),p.postMapLoadEvent(g.tiles,i.map._getMapId(),i.map._requestManager._skuToken),i.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return p.extend({},this._options)},o.prototype.hasTile=function(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)},o.prototype.loadTile=function(i,h){var g=this,E=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);i.request=p.getImage(this.map._requestManager.transformRequest(E,p.ResourceType.Tile),function(C,L){if(delete i.request,i.aborted)i.state="unloaded",h(null);else if(C)i.state="errored",h(C);else if(L){g.map._refreshExpiredTiles&&i.setExpiryData(L),delete L.cacheControl,delete L.expires;var Z=g.map.painter.context,q=Z.gl;i.texture=g.map.painter.getTileTexture(L.width),i.texture?i.texture.update(L,{useMipmap:!0}):(i.texture=new p.Texture(Z,L,q.RGBA,{useMipmap:!0}),i.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),Z.extTextureFilterAnisotropic&&q.texParameterf(q.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax)),i.state="loaded",p.cacheEntryPossiblyAdded(g.dispatcher),h(null)}})},o.prototype.abortTile=function(i,h){i.request&&(i.request.cancel(),delete i.request),h()},o.prototype.unloadTile=function(i,h){i.texture&&this.map.painter.saveTileTexture(i.texture),h()},o.prototype.hasTransition=function(){return!1},o}(p.Evented),Ee=function(c){function o(i,h,g,E){c.call(this,i,h,g,E),this.type="raster-dem",this.maxzoom=22,this._options=p.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},o.prototype.loadTile=function(i,h){var g=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function E(C,L){C&&(i.state="errored",h(C)),L&&(i.dem=L,i.needsHillshadePrepare=!0,i.state="loaded",h(null))}i.request=p.getImage(this.map._requestManager.transformRequest(g,p.ResourceType.Tile),function(C,L){if(delete i.request,i.aborted)i.state="unloaded",h(null);else if(C)i.state="errored",h(C);else if(L){this.map._refreshExpiredTiles&&i.setExpiryData(L),delete L.cacheControl,delete L.expires;var Z=p.window.ImageBitmap&&L instanceof p.window.ImageBitmap&&p.offscreenCanvasSupported()?L:p.browser.getImageData(L,1),q={uid:i.uid,coord:i.tileID,source:this.id,rawImageData:Z,encoding:this.encoding};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",q,E.bind(this)))}}.bind(this)),i.neighboringTiles=this._getNeighboringTiles(i.tileID)},o.prototype._getNeighboringTiles=function(i){var h=i.canonical,g=Math.pow(2,h.z),E=(h.x-1+g)%g,C=h.x===0?i.wrap-1:i.wrap,L=(h.x+1+g)%g,Z=h.x+1===g?i.wrap+1:i.wrap,q={};return q[new p.OverscaledTileID(i.overscaledZ,C,h.z,E,h.y).key]={backfilled:!1},q[new p.OverscaledTileID(i.overscaledZ,Z,h.z,L,h.y).key]={backfilled:!1},h.y>0&&(q[new p.OverscaledTileID(i.overscaledZ,C,h.z,E,h.y-1).key]={backfilled:!1},q[new p.OverscaledTileID(i.overscaledZ,i.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},q[new p.OverscaledTileID(i.overscaledZ,Z,h.z,L,h.y-1).key]={backfilled:!1}),h.y+1<g&&(q[new p.OverscaledTileID(i.overscaledZ,C,h.z,E,h.y+1).key]={backfilled:!1},q[new p.OverscaledTileID(i.overscaledZ,i.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},q[new p.OverscaledTileID(i.overscaledZ,Z,h.z,L,h.y+1).key]={backfilled:!1}),q},o.prototype.unloadTile=function(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})},o}(ae),le=function(c){function o(i,h,g,E){c.call(this),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(E),this._data=h.data,this._options=p.extend({},h),this._collectResourceTiming=h.collectResourceTiming,this._resourceTiming=[],h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;var C=p.EXTENT/this.tileSize;this.workerOptions=p.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*C,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*C,extent:p.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?Math.min(h.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:p.EXTENT,radius:(h.clusterRadius||50)*C,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.load=function(){var i=this;this.fire(new p.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(h){if(h)i.fire(new p.ErrorEvent(h));else{var g={dataType:"source",sourceDataType:"metadata"};i._collectResourceTiming&&i._resourceTiming&&i._resourceTiming.length>0&&(g.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new p.Event("data",g))}})},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setData=function(i){var h=this;return this._data=i,this.fire(new p.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)h.fire(new p.ErrorEvent(g));else{var E={dataType:"source",sourceDataType:"content"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(E.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new p.Event("data",E))}}),this},o.prototype.getClusterExpansionZoom=function(i,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},h),this},o.prototype.getClusterChildren=function(i,h){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},h),this},o.prototype.getClusterLeaves=function(i,h,g,E){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:h,offset:g},E),this},o.prototype._updateWorkerData=function(i){var h=this;this._loaded=!1;var g=p.extend({},this.workerOptions),E=this._data;typeof E=="string"?(g.request=this.map._requestManager.transformRequest(p.browser.resolveURL(E),p.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(E),this.actor.send(this.type+".loadData",g,function(C,L){h._removed||L&&L.abandoned||(h._loaded=!0,L&&L.resourceTiming&&L.resourceTiming[h.id]&&(h._resourceTiming=L.resourceTiming[h.id].slice(0)),h.actor.send(h.type+".coalesce",{source:g.source},null),i(C))})},o.prototype.loaded=function(){return this._loaded},o.prototype.loadTile=function(i,h){var g=this,E=i.actor?"reloadTile":"loadTile";i.actor=this.actor,i.request=this.actor.send(E,{type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:p.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(C,L){return delete i.request,i.unloadVectorData(),i.aborted?h(null):C?h(C):(i.loadVectorData(L,g.map.painter,E==="reloadTile"),h(null))})},o.prototype.abortTile=function(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0},o.prototype.unloadTile=function(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})},o.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},o.prototype.serialize=function(){return p.extend({},this._options,{type:this.type,data:this._data})},o.prototype.hasTransition=function(){return!1},o}(p.Evented),re=p.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),te=function(c){function o(i,h,g,E){c.call(this),this.id=i,this.dispatcher=g,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=h}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.load=function(i,h){var g=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this.url=this.options.url,p.getImage(this.map._requestManager.transformRequest(this.url,p.ResourceType.Image),function(E,C){g._loaded=!0,E?g.fire(new p.ErrorEvent(E)):C&&(g.image=C,i&&(g.coordinates=i),h&&h(),g._finishLoading())})},o.prototype.loaded=function(){return this._loaded},o.prototype.updateImage=function(i){var h=this;return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,function(){h.texture=null}),this):this},o.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})))},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setCoordinates=function(i){var h=this;this.coordinates=i;var g=i.map(p.MercatorCoordinate.fromLngLat);this.tileID=function(C){for(var L=1/0,Z=1/0,q=-1/0,de=-1/0,ge=0,be=C;ge<be.length;ge+=1){var Ke=be[ge];L=Math.min(L,Ke.x),Z=Math.min(Z,Ke.y),q=Math.max(q,Ke.x),de=Math.max(de,Ke.y)}var He=Math.max(q-L,de-Z),ut=Math.max(0,Math.floor(-Math.log(He)/Math.LN2)),We=Math.pow(2,ut);return new p.CanonicalTileID(ut,Math.floor((L+q)/2*We),Math.floor((Z+de)/2*We))}(g),this.minzoom=this.maxzoom=this.tileID.z;var E=g.map(function(C){return h.tileID.getTilePoint(C)._round()});return this._boundsArray=new p.StructArrayLayout4i8,this._boundsArray.emplaceBack(E[0].x,E[0].y,0,0),this._boundsArray.emplaceBack(E[1].x,E[1].y,p.EXTENT,0),this._boundsArray.emplaceBack(E[3].x,E[3].y,0,p.EXTENT),this._boundsArray.emplaceBack(E[2].x,E[2].y,p.EXTENT,p.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})),this},o.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var i=this.map.painter.context,h=i.gl;for(var g in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,re.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new p.Texture(i,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this.tiles){var E=this.tiles[g];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}},o.prototype.loadTile=function(i,h){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},h(null)):(i.state="errored",h(null))},o.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return!1},o}(p.Evented),ke=function(c){function o(i,h,g,E){c.call(this,i,h,g,E),this.roundZoom=!0,this.type="video",this.options=h}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1;var h=this.options;this.urls=[];for(var g=0,E=h.urls;g<E.length;g+=1)this.urls.push(this.map._requestManager.transformRequest(E[g],p.ResourceType.Source).url);p.getVideo(this.urls,function(C,L){i._loaded=!0,C?i.fire(new p.ErrorEvent(C)):L&&(i.video=L,i.video.loop=!0,i.video.addEventListener("playing",function(){i.map.triggerRepaint()}),i.map&&i.video.play(),i._finishLoading())})},o.prototype.pause=function(){this.video&&this.video.pause()},o.prototype.play=function(){this.video&&this.video.play()},o.prototype.seek=function(i){if(this.video){var h=this.video.seekable;i<h.start(0)||i>h.end(0)?this.fire(new p.ErrorEvent(new p.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+h.start(0)+" and "+h.end(0)+"-second mark."))):this.video.currentTime=i}},o.prototype.getVideo=function(){return this.video},o.prototype.onAdd=function(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},o.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var i=this.map.painter.context,h=i.gl;for(var g in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,re.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new p.Texture(i,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this.tiles){var E=this.tiles[g];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this.video&&!this.video.paused},o}(te),nt=function(c){function o(i,h,g,E){c.call(this,i,h,g,E),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(function(C){return!Array.isArray(C)||C.length!==2||C.some(function(L){return typeof L!="number"})})||this.fire(new p.ErrorEvent(new p.ValidationError("sources."+i,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new p.ErrorEvent(new p.ValidationError("sources."+i,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new p.ErrorEvent(new p.ValidationError("sources."+i,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof p.window.HTMLCanvasElement||this.fire(new p.ErrorEvent(new p.ValidationError("sources."+i,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new p.ErrorEvent(new p.ValidationError("sources."+i,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof p.window.HTMLCanvasElement?this.options.canvas:p.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new p.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},o.prototype.getCanvas=function(){return this.canvas},o.prototype.onAdd=function(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()},o.prototype.onRemove=function(){this.pause()},o.prototype.prepare=function(){var i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var h=this.map.painter.context,g=h.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,re.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new p.Texture(h,this.canvas,g.RGBA,{premultiply:!0}),this.tiles){var C=this.tiles[E];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this._playing},o.prototype._hasInvalidDimensions=function(){for(var i=0,h=[this.canvas.width,this.canvas.height];i<h.length;i+=1){var g=h[i];if(isNaN(g)||g<=0)return!0}return!1},o}(te),Kt={vector:cr,raster:ae,"raster-dem":Ee,geojson:le,video:ke,image:te,canvas:nt};function Ir(c,o){var i=p.identity([]);return p.translate(i,i,[1,1,0]),p.scale(i,i,[.5*c.width,.5*c.height,1]),p.multiply(i,i,c.calculatePosMatrix(o.toUnwrapped()))}function Lr(c,o,i,h,g,E){var C=function(ut,We,et){if(ut)for(var Pt=0,Mt=ut;Pt<Mt.length;Pt+=1){var _r=We[Mt[Pt]];if(_r&&_r.source===et&&_r.type==="fill-extrusion")return!0}else for(var nr in We){var gr=We[nr];if(gr.source===et&&gr.type==="fill-extrusion")return!0}return!1}(g&&g.layers,o,c.id),L=E.maxPitchScaleFactor(),Z=c.tilesIn(h,L,C);Z.sort(qr);for(var q=[],de=0,ge=Z;de<ge.length;de+=1){var be=ge[de];q.push({wrappedTileID:be.tileID.wrapped().key,queryResults:be.tile.queryRenderedFeatures(o,i,c._state,be.queryGeometry,be.cameraQueryGeometry,be.scale,g,E,L,Ir(c.transform,be.tileID))})}var Ke=function(ut){for(var We={},et={},Pt=0,Mt=ut;Pt<Mt.length;Pt+=1){var _r=Mt[Pt],nr=_r.queryResults,gr=_r.wrappedTileID,Er=et[gr]=et[gr]||{};for(var tn in nr)for(var Vr=nr[tn],mn=Er[tn]=Er[tn]||{},Sn=We[tn]=We[tn]||[],Hn=0,ei=Vr;Hn<ei.length;Hn+=1){var Ei=ei[Hn];mn[Ei.featureIndex]||(mn[Ei.featureIndex]=!0,Sn.push(Ei))}}return We}(q);for(var He in Ke)Ke[He].forEach(function(ut){var We=ut.feature,et=c.getFeatureState(We.layer["source-layer"],We.id);We.source=We.layer.source,We.layer["source-layer"]&&(We.sourceLayer=We.layer["source-layer"]),We.state=et});return Ke}function qr(c,o){var i=c.tileID,h=o.tileID;return i.overscaledZ-h.overscaledZ||i.canonical.y-h.canonical.y||i.wrap-h.wrap||i.canonical.x-h.canonical.x}var tr=function(o,i){this.max=o,this.onRemove=i,this.reset()};tr.prototype.reset=function(){for(var c in this.data)for(var o=0,i=this.data[c];o<i.length;o+=1){var h=i[o];h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value)}return this.data={},this.order=[],this},tr.prototype.add=function(c,o,i){var h=this,g=c.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);var E={value:o,timeout:void 0};if(i!==void 0&&(E.timeout=setTimeout(function(){h.remove(c,E)},i)),this.data[g].push(E),this.order.push(g),this.order.length>this.max){var C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this},tr.prototype.has=function(c){return c.wrapped().key in this.data},tr.prototype.getAndRemove=function(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null},tr.prototype._getAndRemoveByKey=function(c){var o=this.data[c].shift();return o.timeout&&clearTimeout(o.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),o.value},tr.prototype.getByKey=function(c){var o=this.data[c];return o?o[0].value:null},tr.prototype.get=function(c){return this.has(c)?this.data[c.wrapped().key][0].value:null},tr.prototype.remove=function(c,o){if(!this.has(c))return this;var i=c.wrapped().key,h=o===void 0?0:this.data[i].indexOf(o),g=this.data[i][h];return this.data[i].splice(h,1),g.timeout&&clearTimeout(g.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(g.value),this.order.splice(this.order.indexOf(i),1),this},tr.prototype.setMaxSize=function(c){for(this.max=c;this.order.length>this.max;){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this},tr.prototype.filter=function(c){var o=[];for(var i in this.data)for(var h=0,g=this.data[i];h<g.length;h+=1){var E=g[h];c(E.value)||o.push(E)}for(var C=0,L=o;C<L.length;C+=1){var Z=L[C];this.remove(Z.value.tileID,Z)}};var ce=function(o,i,h){this.context=o;var g=o.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(h),this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer};ce.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ce.prototype.updateData=function(c){var o=this.context.gl;this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)},ce.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ye={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Re=function(o,i,h,g){this.length=i.length,this.attributes=h,this.itemSize=i.bytesPerElement,this.dynamicDraw=g,this.context=o;var E=o.gl;this.buffer=E.createBuffer(),o.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer};Re.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Re.prototype.updateData=function(c){var o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,c.arrayBuffer)},Re.prototype.enableAttributes=function(c,o){for(var i=0;i<this.attributes.length;i++){var h=o.attributes[this.attributes[i].name];h!==void 0&&c.enableVertexAttribArray(h)}},Re.prototype.setVertexAttribPointers=function(c,o,i){for(var h=0;h<this.attributes.length;h++){var g=this.attributes[h],E=o.attributes[g.name];E!==void 0&&c.vertexAttribPointer(E,g.components,c[ye[g.type]],!1,this.itemSize,g.offset+this.itemSize*(i||0))}},Re.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Qe=function(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Qe.prototype.get=function(){return this.current},Qe.prototype.set=function(c){},Qe.prototype.getDefault=function(){return this.default},Qe.prototype.setDefault=function(){this.set(this.default)};var Dt=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return p.Color.transparent},o.prototype.set=function(i){var h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)},o}(Qe),Ct=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return 1},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)},o}(Qe),A=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return 0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)},o}(Qe),z=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return[!0,!0,!0,!0]},o.prototype.set=function(i){var h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)},o}(Qe),ve=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return!0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)},o}(Qe),Ce=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return 255},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)},o}(Qe),$e=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},o.prototype.set=function(i){var h=this.current;(i.func!==h.func||i.ref!==h.ref||i.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)},o}(Qe),ot=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]},o.prototype.set=function(i){var h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)},o}(Qe),Ot=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;i?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=i,this.dirty=!1}},o}(Qe),G=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return[0,1]},o.prototype.set=function(i){var h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)},o}(Qe),Et=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;i?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=i,this.dirty=!1}},o}(Qe),Bt=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.LESS},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)},o}(Qe),dr=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;i?h.enable(h.BLEND):h.disable(h.BLEND),this.current=i,this.dirty=!1}},o}(Qe),wr=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[i.ONE,i.ZERO]},o.prototype.set=function(i){var h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)},o}(Qe),Tr=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return p.Color.transparent},o.prototype.set=function(i){var h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)},o}(Qe),Or=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.FUNC_ADD},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)},o}(Qe),qe=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;i?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=i,this.dirty=!1}},o}(Qe),yt=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.BACK},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)},o}(Qe),dt=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.CCW},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)},o}(Qe),lr=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)},o}(Qe),Kr=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.TEXTURE0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)},o}(Qe),gt=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]},o.prototype.set=function(i){var h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)},o}(Qe),Rt=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,i),this.current=i,this.dirty=!1}},o}(Qe),sr=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,i),this.current=i,this.dirty=!1}},o}(Qe),ar=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;h.bindTexture(h.TEXTURE_2D,i),this.current=i,this.dirty=!1}},o}(Qe),_n=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}},o}(Qe),xn=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){var h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1},o}(Qe),ci=function(c){function o(i){c.call(this,i),this.vao=i.extVertexArrayObject}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)},o}(Qe),_i=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return 4},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}},o}(Qe),Ui=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}},o}(Qe),Xi=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}},o}(Qe),oi=function(c){function o(i,h){c.call(this,i),this.context=i,this.parent=h}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o}(Qe),K=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.setDirty=function(){this.dirty=!0},o.prototype.set=function(i){if(i!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}},o}(oi),I=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.set=function(i){if(i!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,i),this.current=i,this.dirty=!1}},o}(oi),j=function(o,i,h,g){this.context=o,this.width=i,this.height=h;var E=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new K(o,E),g&&(this.depthAttachment=new I(o,E))};j.prototype.destroy=function(){var c=this.context.gl,o=this.colorAttachment.get();if(o&&c.deleteTexture(o),this.depthAttachment){var i=this.depthAttachment.get();i&&c.deleteRenderbuffer(i)}c.deleteFramebuffer(this.framebuffer)};var Y=function(o,i,h){this.func=o,this.mask=i,this.range=h};Y.ReadOnly=!1,Y.ReadWrite=!0,Y.disabled=new Y(519,Y.ReadOnly,[0,1]);var ue=function(o,i,h,g,E,C){this.test=o,this.ref=i,this.mask=h,this.fail=g,this.depthFail=E,this.pass=C};ue.disabled=new ue({func:519,mask:0},0,0,7680,7680,7680);var Le=function(o,i,h){this.blendFunction=o,this.blendColor=i,this.mask=h};Le.disabled=new Le(Le.Replace=[1,0],p.Color.transparent,[!1,!1,!1,!1]),Le.unblended=new Le(Le.Replace,p.Color.transparent,[!0,!0,!0,!0]),Le.alphaBlended=new Le([1,771],p.Color.transparent,[!0,!0,!0,!0]);var Me=function(o,i,h){this.enable=o,this.mode=i,this.frontFace=h};Me.disabled=new Me(!1,1029,2305),Me.backCCW=new Me(!0,1029,2305);var se=function(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Dt(this),this.clearDepth=new Ct(this),this.clearStencil=new A(this),this.colorMask=new z(this),this.depthMask=new ve(this),this.stencilMask=new Ce(this),this.stencilFunc=new $e(this),this.stencilOp=new ot(this),this.stencilTest=new Ot(this),this.depthRange=new G(this),this.depthTest=new Et(this),this.depthFunc=new Bt(this),this.blend=new dr(this),this.blendFunc=new wr(this),this.blendColor=new Tr(this),this.blendEquation=new Or(this),this.cullFace=new qe(this),this.cullFaceSide=new yt(this),this.frontFace=new dt(this),this.program=new lr(this),this.activeTexture=new Kr(this),this.viewport=new gt(this),this.bindFramebuffer=new Rt(this),this.bindRenderbuffer=new sr(this),this.bindTexture=new ar(this),this.bindVertexBuffer=new _n(this),this.bindElementBuffer=new xn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ci(this),this.pixelStoreUnpack=new _i(this),this.pixelStoreUnpackPremultiplyAlpha=new Ui(this),this.pixelStoreUnpackFlipY=new Xi(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)};se.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},se.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},se.prototype.createIndexBuffer=function(c,o){return new ce(this,c,o)},se.prototype.createVertexBuffer=function(c,o,i){return new Re(this,c,o,i)},se.prototype.createRenderbuffer=function(c,o,i){var h=this.gl,g=h.createRenderbuffer();return this.bindRenderbuffer.set(g),h.renderbufferStorage(h.RENDERBUFFER,c,o,i),this.bindRenderbuffer.set(null),g},se.prototype.createFramebuffer=function(c,o,i){return new j(this,c,o,i)},se.prototype.clear=function(c){var o=c.color,i=c.depth,h=this.gl,g=0;o&&(g|=h.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(g|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),h.clear(g)},se.prototype.setCullFace=function(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))},se.prototype.setDepthMode=function(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)},se.prototype.setStencilMode=function(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)},se.prototype.setColorMode=function(c){p.deepEqual(c.blendFunction,Le.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)},se.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ne=function(c){function o(i,h,g){var E=this;c.call(this),this.id=i,this.dispatcher=g,this.on("data",function(C){C.dataType==="source"&&C.sourceDataType==="metadata"&&(E._sourceLoaded=!0),E._sourceLoaded&&!E._paused&&C.dataType==="source"&&C.sourceDataType==="content"&&(E.reload(),E.transform&&E.update(E.transform))}),this.on("error",function(){E._sourceErrored=!0}),this._source=function(C,L,Z,q){var de=new Kt[L.type](C,L,Z,q);if(de.id!==C)throw new Error("Expected Source id to be "+C+" instead of "+de.id);return p.bindAll(["load","abort","unload","serialize","prepare"],de),de}(i,h,g,this),this._tiles={},this._cache=new tr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new p.SourceFeatureState}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.onAdd=function(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(i)},o.prototype.onRemove=function(i){this._source&&this._source.onRemove&&this._source.onRemove(i)},o.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var i in this._tiles){var h=this._tiles[i];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0},o.prototype.getSource=function(){return this._source},o.prototype.pause=function(){this._paused=!0},o.prototype.resume=function(){if(this._paused){var i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}},o.prototype._loadTile=function(i,h){return this._source.loadTile(i,h)},o.prototype._unloadTile=function(i){if(this._source.unloadTile)return this._source.unloadTile(i,function(){})},o.prototype._abortTile=function(i){if(this._source.abortTile)return this._source.abortTile(i,function(){})},o.prototype.serialize=function(){return this._source.serialize()},o.prototype.prepare=function(i){for(var h in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var g=this._tiles[h];g.upload(i),g.prepare(this.map.style.imageManager)}},o.prototype.getIds=function(){return p.values(this._tiles).map(function(i){return i.tileID}).sort(At).map(function(i){return i.key})},o.prototype.getRenderableIds=function(i){var h=this,g=[];for(var E in this._tiles)this._isIdRenderable(E,i)&&g.push(this._tiles[E]);return i?g.sort(function(C,L){var Z=C.tileID,q=L.tileID,de=new p.Point(Z.canonical.x,Z.canonical.y)._rotate(h.transform.angle),ge=new p.Point(q.canonical.x,q.canonical.y)._rotate(h.transform.angle);return Z.overscaledZ-q.overscaledZ||ge.y-de.y||ge.x-de.x}).map(function(C){return C.tileID.key}):g.map(function(C){return C.tileID}).sort(At).map(function(C){return C.key})},o.prototype.hasRenderableParent=function(i){var h=this.findLoadedParent(i,0);return!!h&&this._isIdRenderable(h.tileID.key)},o.prototype._isIdRenderable=function(i,h){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(h||!this._tiles[i].holdingForFade())},o.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var i in this._cache.reset(),this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")},o.prototype._reloadTile=function(i,h){var g=this._tiles[i];g&&(g.state!=="loading"&&(g.state=h),this._loadTile(g,this._tileLoaded.bind(this,g,i,h)))},o.prototype._tileLoaded=function(i,h,g,E){if(E)return i.state="errored",void(E.status!==404?this._source.fire(new p.ErrorEvent(E,{tile:i})):this.update(this.transform));i.timeAdded=p.browser.now(),g==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(h,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new p.Event("data",{dataType:"source",tile:i,coord:i.tileID}))},o.prototype._backfillDEM=function(i){for(var h=this.getRenderableIds(),g=0;g<h.length;g++){var E=h[g];if(i.neighboringTiles&&i.neighboringTiles[E]){var C=this.getTileByID(E);L(i,C),L(C,i)}}function L(Z,q){Z.needsHillshadePrepare=!0;var de=q.tileID.canonical.x-Z.tileID.canonical.x,ge=q.tileID.canonical.y-Z.tileID.canonical.y,be=Math.pow(2,Z.tileID.canonical.z),Ke=q.tileID.key;de===0&&ge===0||Math.abs(ge)>1||(Math.abs(de)>1&&(Math.abs(de+be)===1?de+=be:Math.abs(de-be)===1&&(de-=be)),q.dem&&Z.dem&&(Z.dem.backfillBorder(q.dem,de,ge),Z.neighboringTiles&&Z.neighboringTiles[Ke]&&(Z.neighboringTiles[Ke].backfilled=!0)))}},o.prototype.getTile=function(i){return this.getTileByID(i.key)},o.prototype.getTileByID=function(i){return this._tiles[i]},o.prototype._retainLoadedChildren=function(i,h,g,E){for(var C in this._tiles){var L=this._tiles[C];if(!(E[C]||!L.hasData()||L.tileID.overscaledZ<=h||L.tileID.overscaledZ>g)){for(var Z=L.tileID;L&&L.tileID.overscaledZ>h+1;){var q=L.tileID.scaledTo(L.tileID.overscaledZ-1);(L=this._tiles[q.key])&&L.hasData()&&(Z=q)}for(var de=Z;de.overscaledZ>h;)if(i[(de=de.scaledTo(de.overscaledZ-1)).key]){E[Z.key]=Z;break}}}},o.prototype.findLoadedParent=function(i,h){if(i.key in this._loadedParentTiles){var g=this._loadedParentTiles[i.key];return g&&g.tileID.overscaledZ>=h?g:null}for(var E=i.overscaledZ-1;E>=h;E--){var C=i.scaledTo(E),L=this._getLoadedTile(C);if(L)return L}},o.prototype._getLoadedTile=function(i){var h=this._tiles[i.key];return h&&h.hasData()?h:this._cache.getByKey(i.wrapped().key)},o.prototype.updateCacheSize=function(i){var h=Math.ceil(i.width/this._source.tileSize)+1,g=Math.ceil(i.height/this._source.tileSize)+1,E=Math.floor(h*g*5),C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(C)},o.prototype.handleWrapJump=function(i){var h=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,h){var g={};for(var E in this._tiles){var C=this._tiles[E];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+h),g[C.tileID.key]=C}for(var L in this._tiles=g,this._timers)clearTimeout(this._timers[L]),delete this._timers[L];for(var Z in this._tiles)this._setTileReloadTimer(Z,this._tiles[Z])}},o.prototype.update=function(i){var h=this;if(this.transform=i,this._sourceLoaded&&!this._paused){var g;this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?g=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Er){return new p.OverscaledTileID(Er.canonical.z,Er.wrap,Er.canonical.z,Er.canonical.x,Er.canonical.y)}):(g=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(g=g.filter(function(Er){return h._source.hasTile(Er)}))):g=[];var E=i.coveringZoomLevel(this._source),C=Math.max(E-o.maxOverzooming,this._source.minzoom),L=Math.max(E+o.maxUnderzooming,this._source.minzoom),Z=this._updateRetainedTiles(g,E);if(Dr(this._source.type)){for(var q={},de={},ge=0,be=Object.keys(Z);ge<be.length;ge+=1){var Ke=be[ge],He=Z[Ke],ut=this._tiles[Ke];if(ut&&!(ut.fadeEndTime&&ut.fadeEndTime<=p.browser.now())){var We=this.findLoadedParent(He,C);We&&(this._addTile(We.tileID),q[We.tileID.key]=We.tileID),de[Ke]=He}}for(var et in this._retainLoadedChildren(de,E,L,Z),q)Z[et]||(this._coveredTiles[et]=!0,Z[et]=q[et])}for(var Pt in Z)this._tiles[Pt].clearFadeHold();for(var Mt=0,_r=p.keysDifference(this._tiles,Z);Mt<_r.length;Mt+=1){var nr=_r[Mt],gr=this._tiles[nr];gr.hasSymbolBuckets&&!gr.holdingForFade()?gr.setHoldDuration(this.map._fadeDuration):gr.hasSymbolBuckets&&!gr.symbolFadeFinished()||this._removeTile(nr)}this._updateLoadedParentTileCache()}},o.prototype.releaseSymbolFadeTiles=function(){for(var i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)},o.prototype._updateRetainedTiles=function(i,h){for(var g={},E={},C=Math.max(h-o.maxOverzooming,this._source.minzoom),L=Math.max(h+o.maxUnderzooming,this._source.minzoom),Z={},q=0,de=i;q<de.length;q+=1){var ge=de[q],be=this._addTile(ge);g[ge.key]=ge,be.hasData()||h<this._source.maxzoom&&(Z[ge.key]=ge)}this._retainLoadedChildren(Z,h,L,g);for(var Ke=0,He=i;Ke<He.length;Ke+=1){var ut=He[Ke],We=this._tiles[ut.key];if(!We.hasData()){if(h+1>this._source.maxzoom){var et=ut.children(this._source.maxzoom)[0],Pt=this.getTile(et);if(Pt&&Pt.hasData()){g[et.key]=et;continue}}else{var Mt=ut.children(this._source.maxzoom);if(g[Mt[0].key]&&g[Mt[1].key]&&g[Mt[2].key]&&g[Mt[3].key])continue}for(var _r=We.wasRequested(),nr=ut.overscaledZ-1;nr>=C;--nr){var gr=ut.scaledTo(nr);if(E[gr.key]||(E[gr.key]=!0,!(We=this.getTile(gr))&&_r&&(We=this._addTile(gr)),We&&(g[gr.key]=gr,_r=We.wasRequested(),We.hasData())))break}}}return g},o.prototype._updateLoadedParentTileCache=function(){for(var i in this._loadedParentTiles={},this._tiles){for(var h=[],g=void 0,E=this._tiles[i].tileID;E.overscaledZ>0;){if(E.key in this._loadedParentTiles){g=this._loadedParentTiles[E.key];break}h.push(E.key);var C=E.scaledTo(E.overscaledZ-1);if(g=this._getLoadedTile(C))break;E=C}for(var L=0,Z=h;L<Z.length;L+=1)this._loadedParentTiles[Z[L]]=g}},o.prototype._addTile=function(i){var h=this._tiles[i.key];if(h)return h;(h=this._cache.getAndRemove(i))&&(this._setTileReloadTimer(i.key,h),h.tileID=i,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,h)));var g=Boolean(h);return g||(h=new p.Tile(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(h,this._tileLoaded.bind(this,h,i.key,h.state))),h?(h.uses++,this._tiles[i.key]=h,g||this._source.fire(new p.Event("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h):null},o.prototype._setTileReloadTimer=function(i,h){var g=this;i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);var E=h.getExpiryTimeout();E&&(this._timers[i]=setTimeout(function(){g._reloadTile(i,"expired"),delete g._timers[i]},E))},o.prototype._removeTile=function(i){var h=this._tiles[i];h&&(h.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))},o.prototype.clearTiles=function(){for(var i in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(i);this._cache.reset()},o.prototype.tilesIn=function(i,h,g){var E=this,C=[],L=this.transform;if(!L)return C;for(var Z=g?L.getCameraQueryGeometry(i):i,q=i.map(function(nr){return L.pointCoordinate(nr)}),de=Z.map(function(nr){return L.pointCoordinate(nr)}),ge=this.getIds(),be=1/0,Ke=1/0,He=-1/0,ut=-1/0,We=0,et=de;We<et.length;We+=1){var Pt=et[We];be=Math.min(be,Pt.x),Ke=Math.min(Ke,Pt.y),He=Math.max(He,Pt.x),ut=Math.max(ut,Pt.y)}for(var Mt=function(gr){var Er=E._tiles[ge[gr]];if(!Er.holdingForFade()){var tn=Er.tileID,Vr=Math.pow(2,L.zoom-Er.tileID.overscaledZ),mn=h*Er.queryPadding*p.EXTENT/Er.tileSize/Vr,Sn=[tn.getTilePoint(new p.MercatorCoordinate(be,Ke)),tn.getTilePoint(new p.MercatorCoordinate(He,ut))];if(Sn[0].x-mn<p.EXTENT&&Sn[0].y-mn<p.EXTENT&&Sn[1].x+mn>=0&&Sn[1].y+mn>=0){var Hn=q.map(function(Ei){return tn.getTilePoint(Ei)}),ei=de.map(function(Ei){return tn.getTilePoint(Ei)});C.push({tile:Er,tileID:tn,queryGeometry:Hn,cameraQueryGeometry:ei,scale:Vr})}}},_r=0;_r<ge.length;_r++)Mt(_r);return C},o.prototype.getVisibleCoordinates=function(i){for(var h=this,g=this.getRenderableIds(i).map(function(Z){return h._tiles[Z].tileID}),E=0,C=g;E<C.length;E+=1){var L=C[E];L.posMatrix=this.transform.calculatePosMatrix(L.toUnwrapped())}return g},o.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Dr(this._source.type))for(var i in this._tiles){var h=this._tiles[i];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=p.browser.now())return!0}return!1},o.prototype.setFeatureState=function(i,h,g){this._state.updateState(i=i||"_geojsonTileLayer",h,g)},o.prototype.removeFeatureState=function(i,h,g){this._state.removeFeatureState(i=i||"_geojsonTileLayer",h,g)},o.prototype.getFeatureState=function(i,h){return this._state.getState(i=i||"_geojsonTileLayer",h)},o.prototype.setDependencies=function(i,h,g){var E=this._tiles[i];E&&E.setDependencies(h,g)},o.prototype.reloadTilesForDependencies=function(i,h){for(var g in this._tiles)this._tiles[g].hasDependency(i,h)&&this._reloadTile(g,"reloading");this._cache.filter(function(E){return!E.hasDependency(i,h)})},o}(p.Evented);function At(c,o){var i=Math.abs(2*c.wrap)-+(c.wrap<0),h=Math.abs(2*o.wrap)-+(o.wrap<0);return c.overscaledZ-o.overscaledZ||h-i||o.canonical.y-c.canonical.y||o.canonical.x-c.canonical.x}function Dr(c){return c==="raster"||c==="image"||c==="video"}function Ur(){return new p.window.Worker(Hc.workerUrl)}Ne.maxOverzooming=10,Ne.maxUnderzooming=3;var Xt="mapboxgl_preloaded_worker_pool",zr=function(){this.active={}};zr.prototype.acquire=function(c){if(!this.workers)for(this.workers=[];this.workers.length<zr.workerCount;)this.workers.push(new Ur);return this.active[c]=!0,this.workers.slice()},zr.prototype.release=function(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(function(o){o.terminate()}),this.workers=null)},zr.prototype.isPreloaded=function(){return!!this.active[Xt]},zr.prototype.numActive=function(){return Object.keys(this.active).length};var On,vn=Math.floor(p.browser.hardwareConcurrency/2);function hr(){return On||(On=new zr),On}function pn(c,o){var i={};for(var h in c)h!=="ref"&&(i[h]=c[h]);return p.refProperties.forEach(function(g){g in o&&(i[g]=o[g])}),i}function un(c){c=c.slice();for(var o=Object.create(null),i=0;i<c.length;i++)o[c[i].id]=c[i];for(var h=0;h<c.length;h++)"ref"in c[h]&&(c[h]=pn(c[h],o[c[h].ref]));return c}zr.workerCount=Math.max(Math.min(vn,6),1);var fn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function hi(c,o,i){i.push({command:fn.addSource,args:[c,o[c]]})}function Jr(c,o,i){o.push({command:fn.removeSource,args:[c]}),i[c]=!0}function vi(c,o,i,h){Jr(c,i,h),hi(c,o,i)}function Li(c,o,i){var h;for(h in c[i])if(c[i].hasOwnProperty(h)&&h!=="data"&&!p.deepEqual(c[i][h],o[i][h]))return!1;for(h in o[i])if(o[i].hasOwnProperty(h)&&h!=="data"&&!p.deepEqual(c[i][h],o[i][h]))return!1;return!0}function Qn(c,o,i,h,g,E){var C;for(C in o=o||{},c=c||{})c.hasOwnProperty(C)&&(p.deepEqual(c[C],o[C])||i.push({command:E,args:[h,C,o[C],g]}));for(C in o)o.hasOwnProperty(C)&&!c.hasOwnProperty(C)&&(p.deepEqual(c[C],o[C])||i.push({command:E,args:[h,C,o[C],g]}))}function xi(c){return c.id}function Ti(c,o){return c[o.id]=o,c}var bo=function(o,i){this.reset(o,i)};bo.prototype.reset=function(c,o){this.points=c||[],this._distances=[0];for(var i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding},bo.prototype.lerp=function(c){if(this.points.length===1)return this.points[0];c=p.clamp(c,0,1);for(var o=1,i=this._distances[o],h=c*this.paddedLength+this.padding;i<h&&o<this._distances.length;)i=this._distances[++o];var g=o-1,E=this._distances[g],C=i-E,L=C>0?(h-E)/C:0;return this.points[g].mult(1-L).add(this.points[o].mult(L))};var ki=function(o,i,h){var g=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(o/h),this.yCellCount=Math.ceil(i/h);for(var C=0;C<this.xCellCount*this.yCellCount;C++)g.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=i,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0};function si(c,o,i,h,g){var E=p.create();return o?(p.scale(E,E,[1/g,1/g,1]),i||p.rotateZ(E,E,h.angle)):p.multiply(E,h.labelPlaneMatrix,c),E}function Rn(c,o,i,h,g){if(o){var E=p.clone(c);return p.scale(E,E,[g,g,1]),i||p.rotateZ(E,E,-h.angle),E}return h.glCoordMatrix}function Ri(c,o){var i=[c.x,c.y,0,1];Ba(i,i,o);var h=i[3];return{point:new p.Point(i[0]/h,i[1]/h),signedDistanceFromCamera:h}}function Zn(c,o){return .5+c/o*.5}function za(c,o){var i=c[0]/c[3],h=c[1]/c[3];return i>=-o[0]&&i<=o[0]&&h>=-o[1]&&h<=o[1]}function ys(c,o,i,h,g,E,C,L){var Z=h?c.textSizeData:c.iconSizeData,q=p.evaluateSizeForZoom(Z,i.transform.zoom),de=[256/i.width*2+1,256/i.height*2+1],ge=h?c.text.dynamicLayoutVertexArray:c.icon.dynamicLayoutVertexArray;ge.clear();for(var be=c.lineVertexArray,Ke=h?c.text.placedSymbolArray:c.icon.placedSymbolArray,He=i.transform.width/i.transform.height,ut=!1,We=0;We<Ke.length;We++){var et=Ke.get(We);if(et.hidden||et.writingMode===p.WritingMode.vertical&&!ut)Na(et.numGlyphs,ge);else{ut=!1;var Pt=[et.anchorX,et.anchorY,0,1];if(p.transformMat4(Pt,Pt,o),za(Pt,de)){var Mt=Zn(i.transform.cameraToCenterDistance,Pt[3]),_r=p.evaluateSizeForFeature(Z,q,et),nr=C?_r/Mt:_r*Mt,gr=new p.Point(et.anchorX,et.anchorY),Er=Ri(gr,g).point,tn={},Vr=Sl(et,nr,!1,L,o,g,E,c.glyphOffsetArray,be,ge,Er,gr,tn,He);ut=Vr.useVertical,(Vr.notEnoughRoom||ut||Vr.needsFlipping&&Sl(et,nr,!0,L,o,g,E,c.glyphOffsetArray,be,ge,Er,gr,tn,He).notEnoughRoom)&&Na(et.numGlyphs,ge)}else Na(et.numGlyphs,ge)}}h?c.text.dynamicLayoutVertexBuffer.updateData(ge):c.icon.dynamicLayoutVertexBuffer.updateData(ge)}function Fi(c,o,i,h,g,E,C,L,Z,q,de){var ge=L.glyphStartIndex+L.numGlyphs,be=L.lineStartIndex,Ke=L.lineStartIndex+L.lineLength,He=o.getoffsetX(L.glyphStartIndex),ut=o.getoffsetX(ge-1),We=mi(c*He,i,h,g,E,C,L.segment,be,Ke,Z,q,de);if(!We)return null;var et=mi(c*ut,i,h,g,E,C,L.segment,be,Ke,Z,q,de);return et?{first:We,last:et}:null}function ha(c,o,i,h){return c===p.WritingMode.horizontal&&Math.abs(i.y-o.y)>Math.abs(i.x-o.x)*h?{useVertical:!0}:(c===p.WritingMode.vertical?o.y<i.y:o.x>i.x)?{needsFlipping:!0}:null}function Sl(c,o,i,h,g,E,C,L,Z,q,de,ge,be,Ke){var He,ut=o/24,We=c.lineOffsetX*ut,et=c.lineOffsetY*ut;if(c.numGlyphs>1){var Pt=c.glyphStartIndex+c.numGlyphs,Mt=c.lineStartIndex,_r=c.lineStartIndex+c.lineLength,nr=Fi(ut,L,We,et,i,de,ge,c,Z,E,be);if(!nr)return{notEnoughRoom:!0};var gr=Ri(nr.first.point,C).point,Er=Ri(nr.last.point,C).point;if(h&&!i){var tn=ha(c.writingMode,gr,Er,Ke);if(tn)return tn}He=[nr.first];for(var Vr=c.glyphStartIndex+1;Vr<Pt-1;Vr++)He.push(mi(ut*L.getoffsetX(Vr),We,et,i,de,ge,c.segment,Mt,_r,Z,E,be));He.push(nr.last)}else{if(h&&!i){var mn=Ri(ge,g).point,Sn=c.lineStartIndex+c.segment+1,Hn=new p.Point(Z.getx(Sn),Z.gety(Sn)),ei=Ri(Hn,g),Ei=ei.signedDistanceFromCamera>0?ei.point:Ga(ge,Hn,mn,1,g),Ki=ha(c.writingMode,mn,Ei,Ke);if(Ki)return Ki}var bn=mi(ut*L.getoffsetX(c.glyphStartIndex),We,et,i,de,ge,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,Z,E,be);if(!bn)return{notEnoughRoom:!0};He=[bn]}for(var pi=0,bi=He;pi<bi.length;pi+=1){var Nn=bi[pi];p.addDynamicAttributes(q,Nn.point,Nn.angle)}return{}}function Ga(c,o,i,h,g){var E=Ri(c.add(c.sub(o)._unit()),g).point,C=i.sub(E);return i.add(C._mult(h/C.mag()))}function mi(c,o,i,h,g,E,C,L,Z,q,de,ge){var be=h?c-o:c+o,Ke=be>0?1:-1,He=0;h&&(Ke*=-1,He=Math.PI),Ke<0&&(He+=Math.PI);for(var ut=Ke>0?L+C:L+C+1,We=g,et=g,Pt=0,Mt=0,_r=Math.abs(be),nr=[];Pt+Mt<=_r;){if((ut+=Ke)<L||ut>=Z)return null;if(et=We,nr.push(We),(We=ge[ut])===void 0){var gr=new p.Point(q.getx(ut),q.gety(ut)),Er=Ri(gr,de);if(Er.signedDistanceFromCamera>0)We=ge[ut]=Er.point;else{var tn=ut-Ke;We=Ga(Pt===0?E:new p.Point(q.getx(tn),q.gety(tn)),gr,et,_r-Pt+1,de)}}Pt+=Mt,Mt=et.dist(We)}var Vr=(_r-Pt)/Mt,mn=We.sub(et),Sn=mn.mult(Vr)._add(et);Sn._add(mn._unit()._perp()._mult(i*Ke));var Hn=He+Math.atan2(We.y-et.y,We.x-et.x);return nr.push(Sn),{point:Sn,angle:Hn,path:nr}}ki.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ki.prototype.insert=function(c,o,i,h,g){this._forEachCell(o,i,h,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(o),this.bboxes.push(i),this.bboxes.push(h),this.bboxes.push(g)},ki.prototype.insertCircle=function(c,o,i,h){this._forEachCell(o-h,i-h,o+h,i+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(o),this.circles.push(i),this.circles.push(h)},ki.prototype._insertBoxCell=function(c,o,i,h,g,E){this.boxCells[g].push(E)},ki.prototype._insertCircleCell=function(c,o,i,h,g,E){this.circleCells[g].push(E)},ki.prototype._query=function(c,o,i,h,g,E){if(i<0||c>this.width||h<0||o>this.height)return!g&&[];var C=[];if(c<=0&&o<=0&&this.width<=i&&this.height<=h){if(g)return!0;for(var L=0;L<this.boxKeys.length;L++)C.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(var Z=0;Z<this.circleKeys.length;Z++){var q=this.circles[3*Z],de=this.circles[3*Z+1],ge=this.circles[3*Z+2];C.push({key:this.circleKeys[Z],x1:q-ge,y1:de-ge,x2:q+ge,y2:de+ge})}return E?C.filter(E):C}return this._forEachCell(c,o,i,h,this._queryCell,C,{hitTest:g,seenUids:{box:{},circle:{}}},E),g?C.length>0:C},ki.prototype._queryCircle=function(c,o,i,h,g){var E=c-i,C=c+i,L=o-i,Z=o+i;if(C<0||E>this.width||Z<0||L>this.height)return!h&&[];var q=[];return this._forEachCell(E,L,C,Z,this._queryCellCircle,q,{hitTest:h,circle:{x:c,y:o,radius:i},seenUids:{box:{},circle:{}}},g),h?q.length>0:q},ki.prototype.query=function(c,o,i,h,g){return this._query(c,o,i,h,!1,g)},ki.prototype.hitTest=function(c,o,i,h,g){return this._query(c,o,i,h,!0,g)},ki.prototype.hitTestCircle=function(c,o,i,h){return this._queryCircle(c,o,i,!0,h)},ki.prototype._queryCell=function(c,o,i,h,g,E,C,L){var Z=C.seenUids,q=this.boxCells[g];if(q!==null)for(var de=this.bboxes,ge=0,be=q;ge<be.length;ge+=1){var Ke=be[ge];if(!Z.box[Ke]){Z.box[Ke]=!0;var He=4*Ke;if(c<=de[He+2]&&o<=de[He+3]&&i>=de[He+0]&&h>=de[He+1]&&(!L||L(this.boxKeys[Ke]))){if(C.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[Ke],x1:de[He],y1:de[He+1],x2:de[He+2],y2:de[He+3]})}}}var ut=this.circleCells[g];if(ut!==null)for(var We=this.circles,et=0,Pt=ut;et<Pt.length;et+=1){var Mt=Pt[et];if(!Z.circle[Mt]){Z.circle[Mt]=!0;var _r=3*Mt;if(this._circleAndRectCollide(We[_r],We[_r+1],We[_r+2],c,o,i,h)&&(!L||L(this.circleKeys[Mt]))){if(C.hitTest)return E.push(!0),!0;var nr=We[_r],gr=We[_r+1],Er=We[_r+2];E.push({key:this.circleKeys[Mt],x1:nr-Er,y1:gr-Er,x2:nr+Er,y2:gr+Er})}}}},ki.prototype._queryCellCircle=function(c,o,i,h,g,E,C,L){var Z=C.circle,q=C.seenUids,de=this.boxCells[g];if(de!==null)for(var ge=this.bboxes,be=0,Ke=de;be<Ke.length;be+=1){var He=Ke[be];if(!q.box[He]){q.box[He]=!0;var ut=4*He;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,ge[ut+0],ge[ut+1],ge[ut+2],ge[ut+3])&&(!L||L(this.boxKeys[He])))return E.push(!0),!0}}var We=this.circleCells[g];if(We!==null)for(var et=this.circles,Pt=0,Mt=We;Pt<Mt.length;Pt+=1){var _r=Mt[Pt];if(!q.circle[_r]){q.circle[_r]=!0;var nr=3*_r;if(this._circlesCollide(et[nr],et[nr+1],et[nr+2],Z.x,Z.y,Z.radius)&&(!L||L(this.circleKeys[_r])))return E.push(!0),!0}}},ki.prototype._forEachCell=function(c,o,i,h,g,E,C,L){for(var Z=this._convertToXCellCoord(c),q=this._convertToYCellCoord(o),de=this._convertToXCellCoord(i),ge=this._convertToYCellCoord(h),be=Z;be<=de;be++)for(var Ke=q;Ke<=ge;Ke++)if(g.call(this,c,o,i,h,this.xCellCount*Ke+be,E,C,L))return},ki.prototype._convertToXCellCoord=function(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))},ki.prototype._convertToYCellCoord=function(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))},ki.prototype._circlesCollide=function(c,o,i,h,g,E){var C=h-c,L=g-o,Z=i+E;return Z*Z>C*C+L*L},ki.prototype._circleAndRectCollide=function(c,o,i,h,g,E,C){var L=(E-h)/2,Z=Math.abs(c-(h+L));if(Z>L+i)return!1;var q=(C-g)/2,de=Math.abs(o-(g+q));if(de>q+i)return!1;if(Z<=L||de<=q)return!0;var ge=Z-L,be=de-q;return ge*ge+be*be<=i*i};var ro=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Na(c,o){for(var i=0;i<c;i++){var h=o.length;o.resize(h+4),o.float32.set(ro,3*h)}}function Ba(c,o,i){var h=o[0],g=o[1];return c[0]=i[0]*h+i[4]*g+i[12],c[1]=i[1]*h+i[5]*g+i[13],c[3]=i[3]*h+i[7]*g+i[15],c}var Go=function(o,i,h){i===void 0&&(i=new ki(o.width+200,o.height+200,25)),h===void 0&&(h=new ki(o.width+200,o.height+200,25)),this.transform=o,this.grid=i,this.ignoredGrid=h,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+100,this.screenBottomBoundary=o.height+100,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200};function ta(c,o,i){return o*(p.EXTENT/(c.tileSize*Math.pow(2,i-c.tileID.overscaledZ)))}Go.prototype.placeCollisionBox=function(c,o,i,h,g){var E=this.projectAndGetPerspectiveRatio(h,c.anchorPointX,c.anchorPointY),C=i*E.perspectiveRatio,L=c.x1*C+E.point.x,Z=c.y1*C+E.point.y,q=c.x2*C+E.point.x,de=c.y2*C+E.point.y;return!this.isInsideGrid(L,Z,q,de)||!o&&this.grid.hitTest(L,Z,q,de,g)?{box:[],offscreen:!1}:{box:[L,Z,q,de],offscreen:this.isOffscreen(L,Z,q,de)}},Go.prototype.placeCollisionCircles=function(c,o,i,h,g,E,C,L,Z,q,de,ge,be){var Ke=[],He=new p.Point(o.anchorX,o.anchorY),ut=Ri(He,E),We=Zn(this.transform.cameraToCenterDistance,ut.signedDistanceFromCamera),et=(q?g/We:g*We)/p.ONE_EM,Pt=Ri(He,C).point,Mt=Fi(et,h,o.lineOffsetX*et,o.lineOffsetY*et,!1,Pt,He,o,i,C,{}),_r=!1,nr=!1,gr=!0;if(Mt){for(var Er=.5*ge*We+be,tn=new p.Point(-100,-100),Vr=new p.Point(this.screenRightBoundary,this.screenBottomBoundary),mn=new bo,Sn=Mt.first,Hn=Mt.last,ei=[],Ei=Sn.path.length-1;Ei>=1;Ei--)ei.push(Sn.path[Ei]);for(var Ki=1;Ki<Hn.path.length;Ki++)ei.push(Hn.path[Ki]);var bn=2.5*Er;if(L){var pi=ei.map(function(Ds){return Ri(Ds,L)});ei=pi.some(function(Ds){return Ds.signedDistanceFromCamera<=0})?[]:pi.map(function(Ds){return Ds.point})}var bi=[];if(ei.length>0){for(var Nn=ei[0].clone(),yi=ei[0].clone(),Kn=1;Kn<ei.length;Kn++)Nn.x=Math.min(Nn.x,ei[Kn].x),Nn.y=Math.min(Nn.y,ei[Kn].y),yi.x=Math.max(yi.x,ei[Kn].x),yi.y=Math.max(yi.y,ei[Kn].y);bi=Nn.x>=tn.x&&yi.x<=Vr.x&&Nn.y>=tn.y&&yi.y<=Vr.y?[ei]:yi.x<tn.x||Nn.x>Vr.x||yi.y<tn.y||Nn.y>Vr.y?[]:p.clipLine([ei],tn.x,tn.y,Vr.x,Vr.y)}for(var Ci=0,Wi=bi;Ci<Wi.length;Ci+=1){var mo;mn.reset(Wi[Ci],.25*Er),mo=mn.length<=.5*Er?1:Math.ceil(mn.paddedLength/bn)+1;for(var oo=0;oo<mo;oo++){var Oo=oo/Math.max(mo-1,1),La=mn.lerp(Oo),$a=La.x+100,Ss=La.y+100;Ke.push($a,Ss,Er,0);var Qo=$a-Er,dl=Ss-Er,Ou=$a+Er,qo=Ss+Er;if(gr=gr&&this.isOffscreen(Qo,dl,Ou,qo),nr=nr||this.isInsideGrid(Qo,dl,Ou,qo),!c&&this.grid.hitTestCircle($a,Ss,Er,de)&&(_r=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:_r}}}}return{circles:!Z&&_r||!nr?[]:Ke,offscreen:gr,collisionDetected:_r}},Go.prototype.queryRenderedSymbols=function(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var o=[],i=1/0,h=1/0,g=-1/0,E=-1/0,C=0,L=c;C<L.length;C+=1){var Z=L[C],q=new p.Point(Z.x+100,Z.y+100);i=Math.min(i,q.x),h=Math.min(h,q.y),g=Math.max(g,q.x),E=Math.max(E,q.y),o.push(q)}for(var de={},ge={},be=0,Ke=this.grid.query(i,h,g,E).concat(this.ignoredGrid.query(i,h,g,E));be<Ke.length;be+=1){var He=Ke[be],ut=He.key;if(de[ut.bucketInstanceId]===void 0&&(de[ut.bucketInstanceId]={}),!de[ut.bucketInstanceId][ut.featureIndex]){var We=[new p.Point(He.x1,He.y1),new p.Point(He.x2,He.y1),new p.Point(He.x2,He.y2),new p.Point(He.x1,He.y2)];p.polygonIntersectsPolygon(o,We)&&(de[ut.bucketInstanceId][ut.featureIndex]=!0,ge[ut.bucketInstanceId]===void 0&&(ge[ut.bucketInstanceId]=[]),ge[ut.bucketInstanceId].push(ut.featureIndex))}}return ge},Go.prototype.insertCollisionBox=function(c,o,i,h,g){(o?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:h,collisionGroupID:g},c[0],c[1],c[2],c[3])},Go.prototype.insertCollisionCircles=function(c,o,i,h,g){for(var E=o?this.ignoredGrid:this.grid,C={bucketInstanceId:i,featureIndex:h,collisionGroupID:g},L=0;L<c.length;L+=4)E.insertCircle(C,c[L],c[L+1],c[L+2])},Go.prototype.projectAndGetPerspectiveRatio=function(c,o,i){var h=[o,i,0,1];return Ba(h,h,c),{point:new p.Point((h[0]/h[3]+1)/2*this.transform.width+100,(-h[1]/h[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/h[3]*.5}},Go.prototype.isOffscreen=function(c,o,i,h){return i<100||c>=this.screenRightBoundary||h<100||o>this.screenBottomBoundary},Go.prototype.isInsideGrid=function(c,o,i,h){return i>=0&&c<this.gridRightBoundary&&h>=0&&o<this.gridBottomBoundary},Go.prototype.getViewportMatrix=function(){var c=p.identity([]);return p.translate(c,c,[-100,-100,0]),c};var Ua=function(o,i,h,g){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?i:-i))):g&&h?1:0,this.placed=h};Ua.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var xa=function(o,i,h,g,E){this.text=new Ua(o?o.text:null,i,h,E),this.icon=new Ua(o?o.icon:null,i,g,E)};xa.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var os=function(o,i,h){this.text=o,this.icon=i,this.skipFade=h},$o=function(){this.invProjMatrix=p.create(),this.viewportMatrix=p.create(),this.circles=[]},El=function(o,i,h,g,E){this.bucketInstanceId=o,this.featureIndex=i,this.sourceLayerIndex=h,this.bucketIndex=g,this.tileID=E},Jo=function(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}};function Pa(c,o,i,h,g){var E=p.getAnchorAlignment(c),C=-(E.horizontalAlign-.5)*o,L=-(E.verticalAlign-.5)*i,Z=p.evaluateVariableOffset(c,h);return new p.Point(C+Z[0]*g,L+Z[1]*g)}function Ha(c,o,i,h,g,E){var C=c.x1,L=c.x2,Z=c.y1,q=c.y2,de=c.anchorPointX,ge=c.anchorPointY,be=new p.Point(o,i);return h&&be._rotate(g?E:-E),{x1:C+be.x,y1:Z+be.y,x2:L+be.x,y2:q+be.y,anchorPointX:de,anchorPointY:ge}}Jo.prototype.get=function(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){var o=++this.maxGroupID;this.collisionGroups[c]={ID:o,predicate:function(h){return h.collisionGroupID===o}}}return this.collisionGroups[c]};var pa=function(o,i,h,g){this.transform=o.clone(),this.collisionIndex=new Go(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new Jo(h),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function rt(c,o,i,h,g){c.emplaceBack(o?1:0,i?1:0,h||0,g||0),c.emplaceBack(o?1:0,i?1:0,h||0,g||0),c.emplaceBack(o?1:0,i?1:0,h||0,g||0),c.emplaceBack(o?1:0,i?1:0,h||0,g||0)}pa.prototype.getBucketParts=function(c,o,i,h){var g=i.getBucket(o),E=i.latestFeatureIndex;if(g&&E&&o.id===g.layerIds[0]){var C=i.collisionBoxArray,L=g.layers[0].layout,Z=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),q=i.tileSize/p.EXTENT,de=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),ge=L.get("text-pitch-alignment")==="map",be=L.get("text-rotation-alignment")==="map",Ke=ta(i,1,this.transform.zoom),He=si(de,ge,be,this.transform,Ke),ut=null;if(ge){var We=Rn(de,ge,be,this.transform,Ke);ut=p.multiply([],this.transform.labelPlaneMatrix,We)}this.retainedQueryData[g.bucketInstanceId]=new El(g.bucketInstanceId,E,g.sourceLayerIndex,g.index,i.tileID);var et={bucket:g,layout:L,posMatrix:de,textLabelPlaneMatrix:He,labelToScreenMatrix:ut,scale:Z,textPixelRatio:q,holdingForFade:i.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:p.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(h)for(var Pt=0,Mt=g.sortKeyRanges;Pt<Mt.length;Pt+=1){var _r=Mt[Pt];c.push({sortKey:_r.sortKey,symbolInstanceStart:_r.symbolInstanceStart,symbolInstanceEnd:_r.symbolInstanceEnd,parameters:et})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:et})}},pa.prototype.attemptAnchorPlacement=function(c,o,i,h,g,E,C,L,Z,q,de,ge,be,Ke,He){var ut,We=[ge.textOffset0,ge.textOffset1],et=Pa(c,i,h,We,g),Pt=this.collisionIndex.placeCollisionBox(Ha(o,et.x,et.y,E,C,this.transform.angle),de,L,Z,q.predicate);if(!He||this.collisionIndex.placeCollisionBox(Ha(He,et.x,et.y,E,C,this.transform.angle),de,L,Z,q.predicate).box.length!==0)return Pt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[ge.crossTileID]&&this.prevPlacement.placements[ge.crossTileID]&&this.prevPlacement.placements[ge.crossTileID].text&&(ut=this.prevPlacement.variableOffsets[ge.crossTileID].anchor),this.variableOffsets[ge.crossTileID]={textOffset:We,width:i,height:h,anchor:c,textBoxScale:g,prevAnchor:ut},this.markUsedJustification(be,c,ge,Ke),be.allowVerticalPlacement&&(this.markUsedOrientation(be,Ke,ge),this.placedOrientations[ge.crossTileID]=Ke),{shift:et,placedGlyphBoxes:Pt}):void 0},pa.prototype.placeLayerBucketPart=function(c,o,i){var h=this,g=c.parameters,E=g.bucket,C=g.layout,L=g.posMatrix,Z=g.textLabelPlaneMatrix,q=g.labelToScreenMatrix,de=g.textPixelRatio,ge=g.holdingForFade,be=g.collisionBoxArray,Ke=g.partiallyEvaluatedTextSize,He=g.collisionGroup,ut=C.get("text-optional"),We=C.get("icon-optional"),et=C.get("text-allow-overlap"),Pt=C.get("icon-allow-overlap"),Mt=C.get("text-rotation-alignment")==="map",_r=C.get("text-pitch-alignment")==="map",nr=C.get("icon-text-fit")!=="none",gr=C.get("symbol-z-order")==="viewport-y",Er=et&&(Pt||!E.hasIconData()||We),tn=Pt&&(et||!E.hasTextData()||ut);!E.collisionArrays&&be&&E.deserializeCollisionBoxes(be);var Vr=function(bn,pi){if(!o[bn.crossTileID])if(ge)h.placements[bn.crossTileID]=new os(!1,!1,!1);else{var bi,Nn=!1,yi=!1,Kn=!0,Ci=null,Wi={box:null,offscreen:null},mo={box:null,offscreen:null},oo=null,Oo=null,La=0,$a=0,Ss=0;pi.textFeatureIndex?La=pi.textFeatureIndex:bn.useRuntimeCollisionCircles&&(La=bn.featureIndex),pi.verticalTextFeatureIndex&&($a=pi.verticalTextFeatureIndex);var Qo=pi.textBox;if(Qo){var dl=function(Ro){var Do=p.WritingMode.horizontal;if(E.allowVerticalPlacement&&!Ro&&h.prevPlacement){var ko=h.prevPlacement.placedOrientations[bn.crossTileID];ko&&(h.placedOrientations[bn.crossTileID]=ko,h.markUsedOrientation(E,Do=ko,bn))}return Do},Ou=function(Ro,Do){if(E.allowVerticalPlacement&&bn.numVerticalGlyphVertices>0&&pi.verticalTextBox)for(var ko=0,Xs=E.writingModes;ko<Xs.length&&(Xs[ko]===p.WritingMode.vertical?(Wi=Do(),mo=Wi):Wi=Ro(),!(Wi&&Wi.box&&Wi.box.length));ko+=1);else Wi=Ro()};if(C.get("text-variable-anchor")){var qo=C.get("text-variable-anchor");if(h.prevPlacement&&h.prevPlacement.variableOffsets[bn.crossTileID]){var Ds=h.prevPlacement.variableOffsets[bn.crossTileID];qo.indexOf(Ds.anchor)>0&&(qo=qo.filter(function(Lo){return Lo!==Ds.anchor})).unshift(Ds.anchor)}var vl=function(Ro,Do,ko){for(var Xs=Ro.x2-Ro.x1,Ml=Ro.y2-Ro.y1,Vl=bn.textBoxScale,Tc=nr&&!Pt?Do:null,Gu={box:[],offscreen:!1},Wc=et?2*qo.length:qo.length,gl=0;gl<Wc;++gl){var Ys=h.attemptAnchorPlacement(qo[gl%qo.length],Ro,Xs,Ml,Vl,Mt,_r,de,L,He,gl>=qo.length,bn,E,ko,Tc);if(Ys&&(Gu=Ys.placedGlyphBoxes)&&Gu.box&&Gu.box.length){Nn=!0,Ci=Ys.shift;break}}return Gu};Ou(function(){return vl(Qo,pi.iconBox,p.WritingMode.horizontal)},function(){var Lo=pi.verticalTextBox;return E.allowVerticalPlacement&&!(Wi&&Wi.box&&Wi.box.length)&&bn.numVerticalGlyphVertices>0&&Lo?vl(Lo,pi.verticalIconBox,p.WritingMode.vertical):{box:null,offscreen:null}}),Wi&&(Nn=Wi.box,Kn=Wi.offscreen);var oc=dl(Wi&&Wi.box);if(!Nn&&h.prevPlacement){var Lu=h.prevPlacement.variableOffsets[bn.crossTileID];Lu&&(h.variableOffsets[bn.crossTileID]=Lu,h.markUsedJustification(E,Lu.anchor,bn,oc))}}else{var ou=function(Ro,Do){var ko=h.collisionIndex.placeCollisionBox(Ro,et,de,L,He.predicate);return ko&&ko.box&&ko.box.length&&(h.markUsedOrientation(E,Do,bn),h.placedOrientations[bn.crossTileID]=Do),ko};Ou(function(){return ou(Qo,p.WritingMode.horizontal)},function(){var Lo=pi.verticalTextBox;return E.allowVerticalPlacement&&bn.numVerticalGlyphVertices>0&&Lo?ou(Lo,p.WritingMode.vertical):{box:null,offscreen:null}}),dl(Wi&&Wi.box&&Wi.box.length)}}if(Nn=(bi=Wi)&&bi.box&&bi.box.length>0,Kn=bi&&bi.offscreen,bn.useRuntimeCollisionCircles){var ml=E.text.placedSymbolArray.get(bn.centerJustifiedTextSymbolIndex),Ru=p.evaluateSizeForFeature(E.textSizeData,Ke,ml),jl=C.get("text-padding");oo=h.collisionIndex.placeCollisionCircles(et,ml,E.lineVertexArray,E.glyphOffsetArray,Ru,L,Z,q,i,_r,He.predicate,bn.collisionCircleDiameter,jl),Nn=et||oo.circles.length>0&&!oo.collisionDetected,Kn=Kn&&oo.offscreen}if(pi.iconFeatureIndex&&(Ss=pi.iconFeatureIndex),pi.iconBox){var su=function(Ro){var Do=nr&&Ci?Ha(Ro,Ci.x,Ci.y,Mt,_r,h.transform.angle):Ro;return h.collisionIndex.placeCollisionBox(Do,Pt,de,L,He.predicate)};yi=mo&&mo.box&&mo.box.length&&pi.verticalIconBox?(Oo=su(pi.verticalIconBox)).box.length>0:(Oo=su(pi.iconBox)).box.length>0,Kn=Kn&&Oo.offscreen}var so=ut||bn.numHorizontalGlyphVertices===0&&bn.numVerticalGlyphVertices===0,Du=We||bn.numIconVertices===0;if(so||Du?Du?so||(yi=yi&&Nn):Nn=yi&&Nn:yi=Nn=yi&&Nn,Nn&&bi&&bi.box&&h.collisionIndex.insertCollisionBox(bi.box,C.get("text-ignore-placement"),E.bucketInstanceId,mo&&mo.box&&$a?$a:La,He.ID),yi&&Oo&&h.collisionIndex.insertCollisionBox(Oo.box,C.get("icon-ignore-placement"),E.bucketInstanceId,Ss,He.ID),oo&&(Nn&&h.collisionIndex.insertCollisionCircles(oo.circles,C.get("text-ignore-placement"),E.bucketInstanceId,La,He.ID),i)){var Zl=E.bucketInstanceId,ps=h.collisionCircleArrays[Zl];ps===void 0&&(ps=h.collisionCircleArrays[Zl]=new $o);for(var go=0;go<oo.circles.length;go+=4)ps.circles.push(oo.circles[go+0]),ps.circles.push(oo.circles[go+1]),ps.circles.push(oo.circles[go+2]),ps.circles.push(oo.collisionDetected?1:0)}h.placements[bn.crossTileID]=new os(Nn||Er,yi||tn,Kn||E.justReloaded),o[bn.crossTileID]=!0}};if(gr)for(var mn=E.getSortedSymbolIndexes(this.transform.angle),Sn=mn.length-1;Sn>=0;--Sn){var Hn=mn[Sn];Vr(E.symbolInstances.get(Hn),E.collisionArrays[Hn])}else for(var ei=c.symbolInstanceStart;ei<c.symbolInstanceEnd;ei++)Vr(E.symbolInstances.get(ei),E.collisionArrays[ei]);if(i&&E.bucketInstanceId in this.collisionCircleArrays){var Ei=this.collisionCircleArrays[E.bucketInstanceId];p.invert(Ei.invProjMatrix,L),Ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1},pa.prototype.markUsedJustification=function(c,o,i,h){var g;g=h===p.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[p.getAnchorJustification(o)];for(var E=0,C=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];E<C.length;E+=1){var L=C[E];L>=0&&(c.text.placedSymbolArray.get(L).crossTileID=g>=0&&L!==g?0:i.crossTileID)}},pa.prototype.markUsedOrientation=function(c,o,i){for(var h=o===p.WritingMode.horizontal||o===p.WritingMode.horizontalOnly?o:0,g=o===p.WritingMode.vertical?o:0,E=0,C=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];E<C.length;E+=1)c.text.placedSymbolArray.get(C[E]).placedOrientation=h;i.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=g)},pa.prototype.commit=function(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;var o=this.prevPlacement,i=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;var h=o?o.symbolFadeChange(c):1,g=o?o.opacities:{},E=o?o.variableOffsets:{},C=o?o.placedOrientations:{};for(var L in this.placements){var Z=this.placements[L],q=g[L];q?(this.opacities[L]=new xa(q,h,Z.text,Z.icon),i=i||Z.text!==q.text.placed||Z.icon!==q.icon.placed):(this.opacities[L]=new xa(null,h,Z.text,Z.icon,Z.skipFade),i=i||Z.text||Z.icon)}for(var de in g){var ge=g[de];if(!this.opacities[de]){var be=new xa(ge,h,!1,!1);be.isHidden()||(this.opacities[de]=be,i=i||ge.text.placed||ge.icon.placed)}}for(var Ke in E)this.variableOffsets[Ke]||!this.opacities[Ke]||this.opacities[Ke].isHidden()||(this.variableOffsets[Ke]=E[Ke]);for(var He in C)this.placedOrientations[He]||!this.opacities[He]||this.opacities[He].isHidden()||(this.placedOrientations[He]=C[He]);i?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:c)},pa.prototype.updateLayerOpacities=function(c,o){for(var i={},h=0,g=o;h<g.length;h+=1){var E=g[h],C=E.getBucket(c);C&&E.latestFeatureIndex&&c.id===C.layerIds[0]&&this.updateBucketOpacities(C,i,E.collisionBoxArray)}},pa.prototype.updateBucketOpacities=function(c,o,i){var h=this;c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();var g=c.layers[0].layout,E=new xa(null,0,!1,!1,!0),C=g.get("text-allow-overlap"),L=g.get("icon-allow-overlap"),Z=g.get("text-variable-anchor"),q=g.get("text-rotation-alignment")==="map",de=g.get("text-pitch-alignment")==="map",ge=g.get("icon-text-fit")!=="none",be=new xa(null,0,C&&(L||!c.hasIconData()||g.get("icon-optional")),L&&(C||!c.hasTextData()||g.get("text-optional")),!0);!c.collisionArrays&&i&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(i);for(var Ke=function(Pt,Mt,_r){for(var nr=0;nr<Mt/4;nr++)Pt.opacityVertexArray.emplaceBack(_r)},He=function(Pt){var Mt=c.symbolInstances.get(Pt),_r=Mt.numHorizontalGlyphVertices,nr=Mt.numVerticalGlyphVertices,gr=Mt.crossTileID,Er=h.opacities[gr];o[gr]?Er=E:Er||(h.opacities[gr]=Er=be),o[gr]=!0;var tn=Mt.numIconVertices>0,Vr=h.placedOrientations[Mt.crossTileID],mn=Vr===p.WritingMode.vertical,Sn=Vr===p.WritingMode.horizontal||Vr===p.WritingMode.horizontalOnly;if(_r>0||nr>0){var Hn=Ma(Er.text);Ke(c.text,_r,mn?va:Hn),Ke(c.text,nr,Sn?va:Hn);var ei=Er.text.isHidden();[Mt.rightJustifiedTextSymbolIndex,Mt.centerJustifiedTextSymbolIndex,Mt.leftJustifiedTextSymbolIndex].forEach(function(Wi){Wi>=0&&(c.text.placedSymbolArray.get(Wi).hidden=ei||mn?1:0)}),Mt.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(Mt.verticalPlacedTextSymbolIndex).hidden=ei||Sn?1:0);var Ei=h.variableOffsets[Mt.crossTileID];Ei&&h.markUsedJustification(c,Ei.anchor,Mt,Vr);var Ki=h.placedOrientations[Mt.crossTileID];Ki&&(h.markUsedJustification(c,"left",Mt,Ki),h.markUsedOrientation(c,Ki,Mt))}if(tn){var bn=Ma(Er.icon),pi=!(ge&&Mt.verticalPlacedIconSymbolIndex&&mn);Mt.placedIconSymbolIndex>=0&&(Ke(c.icon,Mt.numIconVertices,pi?bn:va),c.icon.placedSymbolArray.get(Mt.placedIconSymbolIndex).hidden=Er.icon.isHidden()),Mt.verticalPlacedIconSymbolIndex>=0&&(Ke(c.icon,Mt.numVerticalIconVertices,pi?va:bn),c.icon.placedSymbolArray.get(Mt.verticalPlacedIconSymbolIndex).hidden=Er.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){var bi=c.collisionArrays[Pt];if(bi){var Nn=new p.Point(0,0);if(bi.textBox||bi.verticalTextBox){var yi=!0;if(Z){var Kn=h.variableOffsets[gr];Kn?(Nn=Pa(Kn.anchor,Kn.width,Kn.height,Kn.textOffset,Kn.textBoxScale),q&&Nn._rotate(de?h.transform.angle:-h.transform.angle)):yi=!1}bi.textBox&&rt(c.textCollisionBox.collisionVertexArray,Er.text.placed,!yi||mn,Nn.x,Nn.y),bi.verticalTextBox&&rt(c.textCollisionBox.collisionVertexArray,Er.text.placed,!yi||Sn,Nn.x,Nn.y)}var Ci=Boolean(!Sn&&bi.verticalIconBox);bi.iconBox&&rt(c.iconCollisionBox.collisionVertexArray,Er.icon.placed,Ci,ge?Nn.x:0,ge?Nn.y:0),bi.verticalIconBox&&rt(c.iconCollisionBox.collisionVertexArray,Er.icon.placed,!Ci,ge?Nn.x:0,ge?Nn.y:0)}}},ut=0;ut<c.symbolInstances.length;ut++)He(ut);if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){var We=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=We.invProjMatrix,c.placementViewportMatrix=We.viewportMatrix,c.collisionCircleArray=We.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}},pa.prototype.symbolFadeChange=function(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},pa.prototype.zoomAdjustment=function(c){return Math.max(0,(this.transform.zoom-c)/1.5)},pa.prototype.hasTransitions=function(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration},pa.prototype.stillRecent=function(c,o){var i=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*i>c},pa.prototype.setStale=function(){this.stale=!0};var pe=Math.pow(2,25),Ye=Math.pow(2,24),Qt=Math.pow(2,17),Zr=Math.pow(2,16),nn=Math.pow(2,9),Ai=Math.pow(2,8),ya=Math.pow(2,1);function Ma(c){if(c.opacity===0&&!c.placed)return 0;if(c.opacity===1&&c.placed)return 4294967295;var o=c.placed?1:0,i=Math.floor(127*c.opacity);return i*pe+o*Ye+i*Qt+o*Zr+i*nn+o*Ai+i*ya+o}var va=0,Ia=function(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ia.prototype.continuePlacement=function(c,o,i,h,g){for(var E=this._bucketParts;this._currentTileIndex<c.length;)if(o.getBucketParts(E,h,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort(function(C,L){return C.sortKey-L.sortKey}));this._currentPartIndex<E.length;)if(o.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,g())return!0;return!1};var Fu=function(o,i,h,g,E,C,L){this.placement=new pa(o,E,C,L),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=g,this._done=!1};Fu.prototype.isDone=function(){return this._done},Fu.prototype.continuePlacement=function(c,o,i){for(var h=this,g=p.browser.now(),E=function(){var q=p.browser.now()-g;return!h._forceFullPlacement&&q>2};this._currentPlacementIndex>=0;){var C=o[c[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=L)&&(!C.maxzoom||C.maxzoom>L)){if(this._inProgressLayer||(this._inProgressLayer=new Ia(C)),this._inProgressLayer.continuePlacement(i[C.source],this.placement,this._showCollisionBoxes,C,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Fu.prototype.commit=function(c){return this.placement.commit(c),this.placement};var $u=512/p.EXTENT/2,wl=function(o,i,h){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(var g=0;g<i.length;g++){var E=i.get(g),C=E.key;this.indexedSymbolInstances[C]||(this.indexedSymbolInstances[C]=[]),this.indexedSymbolInstances[C].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,o)})}};wl.prototype.getScaledCoordinates=function(c,o){var i=$u/Math.pow(2,o.canonical.z-this.tileID.canonical.z);return{x:Math.floor((o.canonical.x*p.EXTENT+c.anchorX)*i),y:Math.floor((o.canonical.y*p.EXTENT+c.anchorY)*i)}},wl.prototype.findMatches=function(c,o,i){for(var h=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z),g=0;g<c.length;g++){var E=c.get(g);if(!E.crossTileID){var C=this.indexedSymbolInstances[E.key];if(C)for(var L=this.getScaledCoordinates(E,o),Z=0,q=C;Z<q.length;Z+=1){var de=q[Z];if(Math.abs(de.coord.x-L.x)<=h&&Math.abs(de.coord.y-L.y)<=h&&!i[de.crossTileID]){i[de.crossTileID]=!0,E.crossTileID=de.crossTileID;break}}}}};var Po=function(){this.maxCrossTileID=0};Po.prototype.generate=function(){return++this.maxCrossTileID};var ba=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ba.prototype.handleWrapJump=function(c){var o=Math.round((c-this.lng)/360);if(o!==0)for(var i in this.indexes){var h=this.indexes[i],g={};for(var E in h){var C=h[E];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+o),g[C.tileID.key]=C}this.indexes[i]=g}this.lng=c},ba.prototype.addBucket=function(c,o,i){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(var h=0;h<o.symbolInstances.length;h++)o.symbolInstances.get(h).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});var g=this.usedCrossTileIDs[c.overscaledZ];for(var E in this.indexes){var C=this.indexes[E];if(Number(E)>c.overscaledZ)for(var L in C){var Z=C[L];Z.tileID.isChildOf(c)&&Z.findMatches(o.symbolInstances,c,g)}else{var q=C[c.scaledTo(Number(E)).key];q&&q.findMatches(o.symbolInstances,c,g)}}for(var de=0;de<o.symbolInstances.length;de++){var ge=o.symbolInstances.get(de);ge.crossTileID||(ge.crossTileID=i.generate(),g[ge.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new wl(c,o.symbolInstances,o.bucketInstanceId),!0},ba.prototype.removeBucketCrossTileIDs=function(c,o){for(var i in o.indexedSymbolInstances)for(var h=0,g=o.indexedSymbolInstances[i];h<g.length;h+=1)delete this.usedCrossTileIDs[c][g[h].crossTileID]},ba.prototype.removeStaleBuckets=function(c){var o=!1;for(var i in this.indexes){var h=this.indexes[i];for(var g in h)c[h[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,h[g]),delete h[g],o=!0)}return o};var $n=function(){this.layerIndexes={},this.crossTileIDs=new Po,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};$n.prototype.addLayer=function(c,o,i){var h=this.layerIndexes[c.id];h===void 0&&(h=this.layerIndexes[c.id]=new ba);var g=!1,E={};h.handleWrapJump(i);for(var C=0,L=o;C<L.length;C+=1){var Z=L[C],q=Z.getBucket(c);q&&c.id===q.layerIds[0]&&(q.bucketInstanceId||(q.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(Z.tileID,q,this.crossTileIDs)&&(g=!0),E[q.bucketInstanceId]=!0)}return h.removeStaleBuckets(E)&&(g=!0),g},$n.prototype.pruneUnusedLayers=function(c){var o={};for(var i in c.forEach(function(h){o[h]=!0}),this.layerIndexes)o[i]||delete this.layerIndexes[i]};var js=function(o,i){return p.emitValidationErrors(o,i&&i.filter(function(h){return h.identifier!=="source.canvas"}))},Ho=p.pick(fn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Wa=p.pick(fn,["setCenter","setZoom","setBearing","setPitch"]),Xa=function(){var c={},o=p.styleSpec.$version;for(var i in p.styleSpec.$root){var h,g=p.styleSpec.$root[i];g.required&&(h=i==="version"?o:g.type==="array"?[]:{})!=null&&(c[i]=h)}return c}(),Wo=function(c){function o(i,h){var g=this;h===void 0&&(h={}),c.call(this),this.map=i,this.dispatcher=new Te(hr(),this),this.imageManager=new er,this.imageManager.setEventedParent(this),this.glyphManager=new Ht(i._requestManager,h.localIdeographFontFamily),this.lineAtlas=new Pe(256,512),this.crossTileSymbolIndex=new $n,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new p.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",p.getReferrer());var E=this;this._rtlTextPluginCallback=o.registerForPluginStateChange(function(C){E.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},function(L,Z){if(p.triggerPluginCompletionEvent(L),Z&&Z.every(function(de){return de}))for(var q in E.sourceCaches)E.sourceCaches[q].reload()})}),this.on("data",function(C){if(C.dataType==="source"&&C.sourceDataType==="metadata"){var L=g.sourceCaches[C.sourceId];if(L){var Z=L.getSource();if(Z&&Z.vectorLayerIds)for(var q in g._layers){var de=g._layers[q];de.source===Z.id&&g._validateLayer(de)}}}})}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.loadURL=function(i,h){var g=this;h===void 0&&(h={}),this.fire(new p.Event("dataloading",{dataType:"style"}));var E=typeof h.validate=="boolean"?h.validate:!p.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,h.accessToken);var C=this.map._requestManager.transformRequest(i,p.ResourceType.Style);this._request=p.getJSON(C,function(L,Z){g._request=null,L?g.fire(new p.ErrorEvent(L)):Z&&g._load(Z,E)})},o.prototype.loadJSON=function(i,h){var g=this;h===void 0&&(h={}),this.fire(new p.Event("dataloading",{dataType:"style"})),this._request=p.browser.frame(function(){g._request=null,g._load(i,h.validate!==!1)})},o.prototype.loadEmpty=function(){this.fire(new p.Event("dataloading",{dataType:"style"})),this._load(Xa,!1)},o.prototype._load=function(i,h){if(!h||!js(this,p.validateStyle(i))){for(var g in this._loaded=!0,this.stylesheet=i,i.sources)this.addSource(g,i.sources[g],{validate:!1});i.sprite?this._loadSprite(i.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(i.glyphs);var E=un(this.stylesheet.layers);this._order=E.map(function(q){return q.id}),this._layers={},this._serializedLayers={};for(var C=0,L=E;C<L.length;C+=1){var Z=L[C];(Z=p.createStyleLayer(Z)).setEventedParent(this,{layer:{id:Z.id}}),this._layers[Z.id]=Z,this._serializedLayers[Z.id]=Z.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new vt(this.stylesheet.light),this.fire(new p.Event("data",{dataType:"style"})),this.fire(new p.Event("style.load"))}},o.prototype._loadSprite=function(i){var h=this;this._spriteRequest=function(g,E,C){var L,Z,q,de=p.browser.devicePixelRatio>1?"@2x":"",ge=p.getJSON(E.transformRequest(E.normalizeSpriteURL(g,de,".json"),p.ResourceType.SpriteJSON),function(He,ut){ge=null,q||(q=He,L=ut,Ke())}),be=p.getImage(E.transformRequest(E.normalizeSpriteURL(g,de,".png"),p.ResourceType.SpriteImage),function(He,ut){be=null,q||(q=He,Z=ut,Ke())});function Ke(){if(q)C(q);else if(L&&Z){var He=p.browser.getImageData(Z),ut={};for(var We in L){var et=L[We],Pt=et.width,Mt=et.height,_r=et.x,nr=et.y,gr=et.sdf,Er=et.pixelRatio,tn=et.stretchX,Vr=et.stretchY,mn=et.content,Sn=new p.RGBAImage({width:Pt,height:Mt});p.RGBAImage.copy(He,Sn,{x:_r,y:nr},{x:0,y:0},{width:Pt,height:Mt}),ut[We]={data:Sn,pixelRatio:Er,sdf:gr,stretchX:tn,stretchY:Vr,content:mn}}C(null,ut)}}return{cancel:function(){ge&&(ge.cancel(),ge=null),be&&(be.cancel(),be=null)}}}(i,this.map._requestManager,function(g,E){if(h._spriteRequest=null,g)h.fire(new p.ErrorEvent(g));else if(E)for(var C in E)h.imageManager.addImage(C,E[C]);h.imageManager.setLoaded(!0),h._availableImages=h.imageManager.listImages(),h.dispatcher.broadcast("setImages",h._availableImages),h.fire(new p.Event("data",{dataType:"style"}))})},o.prototype._validateLayer=function(i){var h=this.sourceCaches[i.source];if(h){var g=i.sourceLayer;if(g){var E=h.getSource();(E.type==="geojson"||E.vectorLayerIds&&E.vectorLayerIds.indexOf(g)===-1)&&this.fire(new p.ErrorEvent(new Error('Source layer "'+g+'" does not exist on source "'+E.id+'" as specified by style layer "'+i.id+'"')))}}},o.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()},o.prototype._serializeLayers=function(i){for(var h=[],g=0,E=i;g<E.length;g+=1){var C=this._layers[E[g]];C.type!=="custom"&&h.push(C.serialize())}return h},o.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(var h in this._layers)if(this._layers[h].hasTransition())return!0;return!1},o.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},o.prototype.update=function(i){if(this._loaded){var h=this._changed;if(this._changed){var g=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);for(var C in(g.length||E.length)&&this._updateWorkerLayers(g,E),this._updatedSources){var L=this._updatedSources[C];L==="reload"?this._reloadSource(C):L==="clear"&&this._clearSource(C)}for(var Z in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Z].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}var q={};for(var de in this.sourceCaches){var ge=this.sourceCaches[de];q[de]=ge.used,ge.used=!1}for(var be=0,Ke=this._order;be<Ke.length;be+=1){var He=this._layers[Ke[be]];He.recalculate(i,this._availableImages),!He.isHidden(i.zoom)&&He.source&&(this.sourceCaches[He.source].used=!0)}for(var ut in q){var We=this.sourceCaches[ut];q[ut]!==We.used&&We.fire(new p.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ut}))}this.light.recalculate(i),this.z=i.zoom,h&&this.fire(new p.Event("data",{dataType:"style"}))}},o.prototype._updateTilesForChangedImages=function(){var i=Object.keys(this._changedImages);if(i.length){for(var h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}},o.prototype._updateWorkerLayers=function(i,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:h})},o.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},o.prototype.setState=function(i){var h=this;if(this._checkLoaded(),js(this,p.validateStyle(i)))return!1;(i=p.clone$1(i)).layers=un(i.layers);var g=function(C,L){if(!C)return[{command:fn.setStyle,args:[L]}];var Z=[];try{if(!p.deepEqual(C.version,L.version))return[{command:fn.setStyle,args:[L]}];p.deepEqual(C.center,L.center)||Z.push({command:fn.setCenter,args:[L.center]}),p.deepEqual(C.zoom,L.zoom)||Z.push({command:fn.setZoom,args:[L.zoom]}),p.deepEqual(C.bearing,L.bearing)||Z.push({command:fn.setBearing,args:[L.bearing]}),p.deepEqual(C.pitch,L.pitch)||Z.push({command:fn.setPitch,args:[L.pitch]}),p.deepEqual(C.sprite,L.sprite)||Z.push({command:fn.setSprite,args:[L.sprite]}),p.deepEqual(C.glyphs,L.glyphs)||Z.push({command:fn.setGlyphs,args:[L.glyphs]}),p.deepEqual(C.transition,L.transition)||Z.push({command:fn.setTransition,args:[L.transition]}),p.deepEqual(C.light,L.light)||Z.push({command:fn.setLight,args:[L.light]});var q={},de=[];(function(be,Ke,He,ut){var We;for(We in Ke=Ke||{},be=be||{})be.hasOwnProperty(We)&&(Ke.hasOwnProperty(We)||Jr(We,He,ut));for(We in Ke)Ke.hasOwnProperty(We)&&(be.hasOwnProperty(We)?p.deepEqual(be[We],Ke[We])||(be[We].type==="geojson"&&Ke[We].type==="geojson"&&Li(be,Ke,We)?He.push({command:fn.setGeoJSONSourceData,args:[We,Ke[We].data]}):vi(We,Ke,He,ut)):hi(We,Ke,He))})(C.sources,L.sources,de,q);var ge=[];C.layers&&C.layers.forEach(function(be){q[be.source]?Z.push({command:fn.removeLayer,args:[be.id]}):ge.push(be)}),Z=Z.concat(de),function(be,Ke,He){Ke=Ke||[];var ut,We,et,Pt,Mt,_r,nr,gr=(be=be||[]).map(xi),Er=Ke.map(xi),tn=be.reduce(Ti,{}),Vr=Ke.reduce(Ti,{}),mn=gr.slice(),Sn=Object.create(null);for(ut=0,We=0;ut<gr.length;ut++)Vr.hasOwnProperty(et=gr[ut])?We++:(He.push({command:fn.removeLayer,args:[et]}),mn.splice(mn.indexOf(et,We),1));for(ut=0,We=0;ut<Er.length;ut++)mn[mn.length-1-ut]!==(et=Er[Er.length-1-ut])&&(tn.hasOwnProperty(et)?(He.push({command:fn.removeLayer,args:[et]}),mn.splice(mn.lastIndexOf(et,mn.length-We),1)):We++,He.push({command:fn.addLayer,args:[Vr[et],_r=mn[mn.length-ut]]}),mn.splice(mn.length-ut,0,et),Sn[et]=!0);for(ut=0;ut<Er.length;ut++)if(Pt=tn[et=Er[ut]],Mt=Vr[et],!Sn[et]&&!p.deepEqual(Pt,Mt))if(p.deepEqual(Pt.source,Mt.source)&&p.deepEqual(Pt["source-layer"],Mt["source-layer"])&&p.deepEqual(Pt.type,Mt.type)){for(nr in Qn(Pt.layout,Mt.layout,He,et,null,fn.setLayoutProperty),Qn(Pt.paint,Mt.paint,He,et,null,fn.setPaintProperty),p.deepEqual(Pt.filter,Mt.filter)||He.push({command:fn.setFilter,args:[et,Mt.filter]}),p.deepEqual(Pt.minzoom,Mt.minzoom)&&p.deepEqual(Pt.maxzoom,Mt.maxzoom)||He.push({command:fn.setLayerZoomRange,args:[et,Mt.minzoom,Mt.maxzoom]}),Pt)Pt.hasOwnProperty(nr)&&nr!=="layout"&&nr!=="paint"&&nr!=="filter"&&nr!=="metadata"&&nr!=="minzoom"&&nr!=="maxzoom"&&(nr.indexOf("paint.")===0?Qn(Pt[nr],Mt[nr],He,et,nr.slice(6),fn.setPaintProperty):p.deepEqual(Pt[nr],Mt[nr])||He.push({command:fn.setLayerProperty,args:[et,nr,Mt[nr]]}));for(nr in Mt)Mt.hasOwnProperty(nr)&&!Pt.hasOwnProperty(nr)&&nr!=="layout"&&nr!=="paint"&&nr!=="filter"&&nr!=="metadata"&&nr!=="minzoom"&&nr!=="maxzoom"&&(nr.indexOf("paint.")===0?Qn(Pt[nr],Mt[nr],He,et,nr.slice(6),fn.setPaintProperty):p.deepEqual(Pt[nr],Mt[nr])||He.push({command:fn.setLayerProperty,args:[et,nr,Mt[nr]]}))}else He.push({command:fn.removeLayer,args:[et]}),_r=mn[mn.lastIndexOf(et)+1],He.push({command:fn.addLayer,args:[Mt,_r]})}(ge,L.layers,Z)}catch(be){console.warn("Unable to compute style diff:",be),Z=[{command:fn.setStyle,args:[L]}]}return Z}(this.serialize(),i).filter(function(C){return!(C.command in Wa)});if(g.length===0)return!1;var E=g.filter(function(C){return!(C.command in Ho)});if(E.length>0)throw new Error("Unimplemented: "+E.map(function(C){return C.command}).join(", ")+".");return g.forEach(function(C){C.command!=="setTransition"&&h[C.command].apply(h,C.args)}),this.stylesheet=i,!0},o.prototype.addImage=function(i,h){if(this.getImage(i))return this.fire(new p.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(i,h),this._afterImageUpdated(i)},o.prototype.updateImage=function(i,h){this.imageManager.updateImage(i,h)},o.prototype.getImage=function(i){return this.imageManager.getImage(i)},o.prototype.removeImage=function(i){if(!this.getImage(i))return this.fire(new p.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(i),this._afterImageUpdated(i)},o.prototype._afterImageUpdated=function(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new p.Event("data",{dataType:"style"}))},o.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},o.prototype.addSource=function(i,h,g){var E=this;if(g===void 0&&(g={}),this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(h).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(p.validateStyle.source,"sources."+i,h,null,g))){this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);var C=this.sourceCaches[i]=new Ne(i,h,this.dispatcher);C.style=this,C.setEventedParent(this,function(){return{isSourceLoaded:E.loaded(),source:C.serialize(),sourceId:i}}),C.onAdd(this.map),this._changed=!0}},o.prototype.removeSource=function(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(var h in this._layers)if(this._layers[h].source===i)return this.fire(new p.ErrorEvent(new Error('Source "'+i+'" cannot be removed while layer "'+h+'" is using it.')));var g=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],g.fire(new p.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),g.setEventedParent(null),g.clearTiles(),g.onRemove&&g.onRemove(this.map),this._changed=!0},o.prototype.setGeoJSONSourceData=function(i,h){this._checkLoaded(),this.sourceCaches[i].getSource().setData(h),this._changed=!0},o.prototype.getSource=function(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()},o.prototype.addLayer=function(i,h,g){g===void 0&&(g={}),this._checkLoaded();var E=i.id;if(this.getLayer(E))this.fire(new p.ErrorEvent(new Error('Layer with id "'+E+'" already exists on this map')));else{var C;if(i.type==="custom"){if(js(this,p.validateCustomStyleLayer(i)))return;C=p.createStyleLayer(i)}else{if(typeof i.source=="object"&&(this.addSource(E,i.source),i=p.clone$1(i),i=p.extend(i,{source:E})),this._validate(p.validateStyle.layer,"layers."+E,i,{arrayIndex:-1},g))return;C=p.createStyleLayer(i),this._validateLayer(C),C.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[C.id]=C.serialize()}var L=h?this._order.indexOf(h):this._order.length;if(h&&L===-1)this.fire(new p.ErrorEvent(new Error('Layer with id "'+h+'" does not exist on this map.')));else{if(this._order.splice(L,0,E),this._layerOrderChanged=!0,this._layers[E]=C,this._removedLayers[E]&&C.source&&C.type!=="custom"){var Z=this._removedLayers[E];delete this._removedLayers[E],Z.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",this.sourceCaches[C.source].pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map)}}},o.prototype.moveLayer=function(i,h){if(this._checkLoaded(),this._changed=!0,this._layers[i]){if(i!==h){var g=this._order.indexOf(i);this._order.splice(g,1);var E=h?this._order.indexOf(h):this._order.length;h&&E===-1?this.fire(new p.ErrorEvent(new Error('Layer with id "'+h+'" does not exist on this map.'))):(this._order.splice(E,0,i),this._layerOrderChanged=!0)}}else this.fire(new p.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be moved.")))},o.prototype.removeLayer=function(i){this._checkLoaded();var h=this._layers[i];if(h){h.setEventedParent(null);var g=this._order.indexOf(i);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=h,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],h.onRemove&&h.onRemove(this.map)}else this.fire(new p.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be removed.")))},o.prototype.getLayer=function(i){return this._layers[i]},o.prototype.hasLayer=function(i){return i in this._layers},o.prototype.setLayerZoomRange=function(i,h,g){this._checkLoaded();var E=this.getLayer(i);E?E.minzoom===h&&E.maxzoom===g||(h!=null&&(E.minzoom=h),g!=null&&(E.maxzoom=g),this._updateLayer(E)):this.fire(new p.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot have zoom extent.")))},o.prototype.setFilter=function(i,h,g){g===void 0&&(g={}),this._checkLoaded();var E=this.getLayer(i);if(E){if(!p.deepEqual(E.filter,h))return h==null?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(p.validateStyle.filter,"layers."+E.id+".filter",h,null,g)||(E.filter=p.clone$1(h),this._updateLayer(E)))}else this.fire(new p.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be filtered.")))},o.prototype.getFilter=function(i){return p.clone$1(this.getLayer(i).filter)},o.prototype.setLayoutProperty=function(i,h,g,E){E===void 0&&(E={}),this._checkLoaded();var C=this.getLayer(i);C?p.deepEqual(C.getLayoutProperty(h),g)||(C.setLayoutProperty(h,g,E),this._updateLayer(C)):this.fire(new p.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getLayoutProperty=function(i,h){var g=this.getLayer(i);if(g)return g.getLayoutProperty(h);this.fire(new p.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style.")))},o.prototype.setPaintProperty=function(i,h,g,E){E===void 0&&(E={}),this._checkLoaded();var C=this.getLayer(i);C?p.deepEqual(C.getPaintProperty(h),g)||(C.setPaintProperty(h,g,E)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new p.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getPaintProperty=function(i,h){return this.getLayer(i).getPaintProperty(h)},o.prototype.setFeatureState=function(i,h){this._checkLoaded();var g=i.source,E=i.sourceLayer,C=this.sourceCaches[g];if(C!==void 0){var L=C.getSource().type;L==="geojson"&&E?this.fire(new p.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):L!=="vector"||E?(i.id===void 0&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),C.setFeatureState(E,i.id,h)):this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},o.prototype.removeFeatureState=function(i,h){this._checkLoaded();var g=i.source,E=this.sourceCaches[g];if(E!==void 0){var C=E.getSource().type,L=C==="vector"?i.sourceLayer:void 0;C!=="vector"||L?h&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new p.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):E.removeFeatureState(L,i.id,h):this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},o.prototype.getFeatureState=function(i){this._checkLoaded();var h=i.source,g=i.sourceLayer,E=this.sourceCaches[h];if(E!==void 0){if(E.getSource().type!=="vector"||g)return i.id===void 0&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),E.getFeatureState(g,i.id);this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+h+"' does not exist in the map's style.")))},o.prototype.getTransition=function(){return p.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},o.prototype.serialize=function(){return p.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:p.mapObject(this.sourceCaches,function(i){return i.serialize()}),layers:this._serializeLayers(this._order)},function(i){return i!==void 0})},o.prototype._updateLayer=function(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._changed=!0},o.prototype._flattenAndSortRenderedFeatures=function(i){for(var h=this,g=function(Vr){return h._layers[Vr].type==="fill-extrusion"},E={},C=[],L=this._order.length-1;L>=0;L--){var Z=this._order[L];if(g(Z)){E[Z]=L;for(var q=0,de=i;q<de.length;q+=1){var ge=de[q][Z];if(ge)for(var be=0,Ke=ge;be<Ke.length;be+=1)C.push(Ke[be])}}}C.sort(function(tn,Vr){return Vr.intersectionZ-tn.intersectionZ});for(var He=[],ut=this._order.length-1;ut>=0;ut--){var We=this._order[ut];if(g(We))for(var et=C.length-1;et>=0;et--){var Pt=C[et].feature;if(E[Pt.layer.id]<ut)break;He.push(Pt),C.pop()}else for(var Mt=0,_r=i;Mt<_r.length;Mt+=1){var nr=_r[Mt][We];if(nr)for(var gr=0,Er=nr;gr<Er.length;gr+=1)He.push(Er[gr].feature)}}return He},o.prototype.queryRenderedFeatures=function(i,h,g){h&&h.filter&&this._validate(p.validateStyle.filter,"queryRenderedFeatures.filter",h.filter,null,h);var E={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new p.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var C=0,L=h.layers;C<L.length;C+=1){var Z=L[C],q=this._layers[Z];if(!q)return this.fire(new p.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be queried for features."))),[];E[q.source]=!0}}var de=[];for(var ge in h.availableImages=this._availableImages,this.sourceCaches)h.layers&&!E[ge]||de.push(Lr(this.sourceCaches[ge],this._layers,this._serializedLayers,i,h,g));return this.placement&&de.push(function(be,Ke,He,ut,We,et,Pt){for(var Mt={},_r=et.queryRenderedSymbols(ut),nr=[],gr=0,Er=Object.keys(_r).map(Number);gr<Er.length;gr+=1)nr.push(Pt[Er[gr]]);nr.sort(qr);for(var tn=function(){var Ei=mn[Vr],Ki=Ei.featureIndex.lookupSymbolFeatures(_r[Ei.bucketInstanceId],Ke,Ei.bucketIndex,Ei.sourceLayerIndex,We.filter,We.layers,We.availableImages,be);for(var bn in Ki){var pi=Mt[bn]=Mt[bn]||[],bi=Ki[bn];bi.sort(function(Kn,Ci){var Wi=Ei.featureSortOrder;if(Wi){var mo=Wi.indexOf(Kn.featureIndex);return Wi.indexOf(Ci.featureIndex)-mo}return Ci.featureIndex-Kn.featureIndex});for(var Nn=0,yi=bi;Nn<yi.length;Nn+=1)pi.push(yi[Nn])}},Vr=0,mn=nr;Vr<mn.length;Vr+=1)tn();var Sn=function(Ei){Mt[Ei].forEach(function(Ki){var bn=Ki.feature,pi=He[be[Ei].source].getFeatureState(bn.layer["source-layer"],bn.id);bn.source=bn.layer.source,bn.layer["source-layer"]&&(bn.sourceLayer=bn.layer["source-layer"]),bn.state=pi})};for(var Hn in Mt)Sn(Hn);return Mt}(this._layers,this._serializedLayers,this.sourceCaches,i,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(de)},o.prototype.querySourceFeatures=function(i,h){h&&h.filter&&this._validate(p.validateStyle.filter,"querySourceFeatures.filter",h.filter,null,h);var g=this.sourceCaches[i];return g?function(E,C){for(var L=E.getRenderableIds().map(function(Ke){return E.getTileByID(Ke)}),Z=[],q={},de=0;de<L.length;de++){var ge=L[de],be=ge.tileID.canonical.key;q[be]||(q[be]=!0,ge.querySourceFeatures(Z,C))}return Z}(g,h):[]},o.prototype.addSourceType=function(i,h,g){return o.getSourceType(i)?g(new Error('A source type called "'+i+'" already exists.')):(o.setSourceType(i,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:h.workerSourceURL},g):g(null,null))},o.prototype.getLight=function(){return this.light.getLight()},o.prototype.setLight=function(i,h){h===void 0&&(h={}),this._checkLoaded();var g=this.light.getLight(),E=!1;for(var C in i)if(!p.deepEqual(i[C],g[C])){E=!0;break}if(E){var L={now:p.browser.now(),transition:p.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,h),this.light.updateTransitions(L)}},o.prototype._validate=function(i,h,g,E,C){return C===void 0&&(C={}),(!C||C.validate!==!1)&&js(this,i.call(p.validateStyle,p.extend({key:h,style:this.serialize(),value:g,styleSpec:p.styleSpec},E)))},o.prototype._remove=function(){for(var i in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),p.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[i].setEventedParent(null);for(var h in this.sourceCaches)this.sourceCaches[h].clearTiles(),this.sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},o.prototype._clearSource=function(i){this.sourceCaches[i].clearTiles()},o.prototype._reloadSource=function(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()},o.prototype._updateSources=function(i){for(var h in this.sourceCaches)this.sourceCaches[h].update(i)},o.prototype._generateCollisionBoxes=function(){for(var i in this.sourceCaches)this._reloadSource(i)},o.prototype._updatePlacement=function(i,h,g,E,C){C===void 0&&(C=!1);for(var L=!1,Z=!1,q={},de=0,ge=this._order;de<ge.length;de+=1){var be=this._layers[ge[de]];if(be.type==="symbol"){if(!q[be.source]){var Ke=this.sourceCaches[be.source];q[be.source]=Ke.getRenderableIds(!0).map(function(Pt){return Ke.getTileByID(Pt)}).sort(function(Pt,Mt){return Mt.tileID.overscaledZ-Pt.tileID.overscaledZ||(Pt.tileID.isLessThan(Mt.tileID)?-1:1)})}var He=this.crossTileSymbolIndex.addLayer(be,q[be.source],i.center.lng);L=L||He}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((C=C||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(p.browser.now(),i.zoom))&&(this.pauseablePlacement=new Fu(i,this._order,C,h,g,E,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(p.browser.now()),Z=!0),L&&this.pauseablePlacement.placement.setStale()),Z||L)for(var ut=0,We=this._order;ut<We.length;ut+=1){var et=this._layers[We[ut]];et.type==="symbol"&&this.placement.updateLayerOpacities(et,q[et.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(p.browser.now())},o.prototype._releaseSymbolFadeTiles=function(){for(var i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()},o.prototype.getImages=function(i,h,g){this.imageManager.getImages(h.icons,g),this._updateTilesForChangedImages();var E=this.sourceCaches[h.source];E&&E.setDependencies(h.tileID.key,h.type,h.icons)},o.prototype.getGlyphs=function(i,h,g){this.glyphManager.getGlyphs(h.stacks,g)},o.prototype.getResource=function(i,h,g){return p.makeRequest(h,g)},o}(p.Evented);Wo.getSourceType=function(c){return Kt[c]},Wo.setSourceType=function(c,o){Kt[c]=o},Wo.registerForPluginStateChange=p.registerForPluginStateChange;var Ya=p.createLayout([{name:"a_pos",type:"Int16",components:2}]),bu=ma(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Il=ma(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),So=ma(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ze=ma(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Nt=ma("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),mr=ma(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),zn=ma(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),oa=ma("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Sa=ma("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),wa=ma("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),sa=ma(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ta=ma(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ss=ma(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),As=ma(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),ja=ma(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Xl=ma(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Su=ma(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),us=ma(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ol=ma(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_s=ma(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Eu=ma(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),wu=ma(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Tl=ma(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Zs=ma(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),tf=ma(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Lc=ma(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ma(c,o){var i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=o.match(/attribute ([\w]+) ([\w]+)/g),g=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),C=E?E.concat(g):g,L={};return{fragmentSource:c=c.replace(i,function(Z,q,de,ge,be){return L[be]=!0,q==="define"?`
#ifndef HAS_UNIFORM_u_`+be+`
varying `+de+" "+ge+" "+be+`;
#else
uniform `+de+" "+ge+" u_"+be+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+be+`
    `+de+" "+ge+" "+be+" = u_"+be+`;
#endif
`}),vertexSource:o=o.replace(i,function(Z,q,de,ge,be){var Ke=ge==="float"?"vec2":"vec4",He=be.match(/color/)?"color":Ke;return L[be]?q==="define"?`
#ifndef HAS_UNIFORM_u_`+be+`
uniform lowp float u_`+be+`_t;
attribute `+de+" "+Ke+" a_"+be+`;
varying `+de+" "+ge+" "+be+`;
#else
uniform `+de+" "+ge+" u_"+be+`;
#endif
`:He==="vec4"?`
#ifndef HAS_UNIFORM_u_`+be+`
    `+be+" = a_"+be+`;
#else
    `+de+" "+ge+" "+be+" = u_"+be+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+be+`
    `+be+" = unpack_mix_"+He+"(a_"+be+", u_"+be+`_t);
#else
    `+de+" "+ge+" "+be+" = u_"+be+`;
#endif
`:q==="define"?`
#ifndef HAS_UNIFORM_u_`+be+`
uniform lowp float u_`+be+`_t;
attribute `+de+" "+Ke+" a_"+be+`;
#else
uniform `+de+" "+ge+" u_"+be+`;
#endif
`:He==="vec4"?`
#ifndef HAS_UNIFORM_u_`+be+`
    `+de+" "+ge+" "+be+" = a_"+be+`;
#else
    `+de+" "+ge+" "+be+" = u_"+be+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+be+`
    `+de+" "+ge+" "+be+" = unpack_mix_"+He+"(a_"+be+", u_"+be+`_t);
#else
    `+de+" "+ge+" "+be+" = u_"+be+`;
#endif
`}),staticAttributes:h,staticUniforms:C}}var zu=Object.freeze({__proto__:null,prelude:bu,background:Il,backgroundPattern:So,circle:Ze,clippingMask:Nt,heatmap:mr,heatmapTexture:zn,collisionBox:oa,collisionCircle:Sa,debug:wa,fill:sa,fillOutline:Ta,fillOutlinePattern:ss,fillPattern:As,fillExtrusion:ja,fillExtrusionPattern:Xl,hillshadePrepare:Su,hillshade:us,line:Ol,lineGradient:_s,linePattern:Eu,lineSDF:wu,raster:Tl,symbolIcon:Zs,symbolSDF:tf,symbolTextAndIcon:Lc}),rf=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function bf(c){for(var o=[],i=0;i<c.length;i++)if(c[i]!==null){var h=c[i].split(" ");o.push(h.pop())}return o}rf.prototype.bind=function(c,o,i,h,g,E,C,L){this.context=c;for(var Z=this.boundPaintVertexBuffers.length!==h.length,q=0;!Z&&q<h.length;q++)this.boundPaintVertexBuffers[q]!==h[q]&&(Z=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===o&&this.boundLayoutVertexBuffer===i&&!Z&&this.boundIndexBuffer===g&&this.boundVertexOffset===E&&this.boundDynamicVertexBuffer===C&&this.boundDynamicVertexBuffer2===L?(c.bindVertexArrayOES.set(this.vao),C&&C.bind(),g&&g.dynamicDraw&&g.bind(),L&&L.bind()):this.freshBind(o,i,h,g,E,C,L)},rf.prototype.freshBind=function(c,o,i,h,g,E,C){var L,Z=c.numAttributes,q=this.context,de=q.gl;if(q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=q.extVertexArrayObject.createVertexArrayOES(),q.bindVertexArrayOES.set(this.vao),L=0,this.boundProgram=c,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=h,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=C;else{L=q.currentNumAttributes||0;for(var ge=Z;ge<L;ge++)de.disableVertexAttribArray(ge)}o.enableAttributes(de,c);for(var be=0,Ke=i;be<Ke.length;be+=1)Ke[be].enableAttributes(de,c);E&&E.enableAttributes(de,c),C&&C.enableAttributes(de,c),o.bind(),o.setVertexAttribPointers(de,c,g);for(var He=0,ut=i;He<ut.length;He+=1){var We=ut[He];We.bind(),We.setVertexAttribPointers(de,c,g)}E&&(E.bind(),E.setVertexAttribPointers(de,c,g)),h&&h.bind(),C&&(C.bind(),C.setVertexAttribPointers(de,c,g)),q.currentNumAttributes=Z},rf.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var rh=function(o,i,h,g,E,C){var L=o.gl;this.program=L.createProgram();for(var Z=bf(h.staticAttributes),q=g?g.getBinderAttributes():[],de=Z.concat(q),ge=h.staticUniforms?bf(h.staticUniforms):[],be=g?g.getBinderUniforms():[],Ke=[],He=0,ut=ge.concat(be);He<ut.length;He+=1){var We=ut[He];Ke.indexOf(We)<0&&Ke.push(We)}var et=g?g.defines():[];C&&et.push("#define OVERDRAW_INSPECTOR;");var Pt=et.concat(bu.fragmentSource,h.fragmentSource).join(`
`),Mt=et.concat(bu.vertexSource,h.vertexSource).join(`
`),_r=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(_r,Pt),L.compileShader(_r),L.attachShader(this.program,_r);var nr=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(nr,Mt),L.compileShader(nr),L.attachShader(this.program,nr),this.attributes={};var gr={};this.numAttributes=de.length;for(var Er=0;Er<this.numAttributes;Er++)de[Er]&&(L.bindAttribLocation(this.program,Er,de[Er]),this.attributes[de[Er]]=Er);L.linkProgram(this.program),L.deleteShader(nr),L.deleteShader(_r);for(var tn=0;tn<Ke.length;tn++){var Vr=Ke[tn];if(Vr&&!gr[Vr]){var mn=L.getUniformLocation(this.program,Vr);mn&&(gr[Vr]=mn)}}this.fixedUniforms=E(o,gr),this.binderUniforms=g?g.getUniforms(o,gr):[]}}};function kf(c,o,i){var h=1/ta(i,1,o.transform.tileZoom),g=Math.pow(2,i.tileID.overscaledZ),E=i.tileSize*Math.pow(2,o.transform.tileZoom)/g,C=E*(i.tileID.canonical.x+i.tileID.wrap*g),L=E*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[h,c.fromScale,c.toScale],u_fade:c.t,u_pixel_coord_upper:[C>>16,L>>16],u_pixel_coord_lower:[65535&C,65535&L]}}rh.prototype.draw=function(c,o,i,h,g,E,C,L,Z,q,de,ge,be,Ke,He,ut){var We,et=c.gl;if(!this.failedToCreate){for(var Pt in c.program.set(this.program),c.setDepthMode(i),c.setStencilMode(h),c.setColorMode(g),c.setCullFace(E),this.fixedUniforms)this.fixedUniforms[Pt].set(C[Pt]);Ke&&Ke.setUniforms(c,this.binderUniforms,ge,{zoom:be});for(var Mt=(We={},We[et.LINES]=2,We[et.TRIANGLES]=3,We[et.LINE_STRIP]=1,We)[o],_r=0,nr=de.get();_r<nr.length;_r+=1){var gr=nr[_r],Er=gr.vaos||(gr.vaos={});(Er[L]||(Er[L]=new rf)).bind(c,this,Z,Ke?Ke.getPaintVertexBuffers():[],q,gr.vertexOffset,He,ut),et.drawElements(o,gr.primitiveLength*Mt,et.UNSIGNED_SHORT,gr.primitiveOffset*Mt*2)}}};var no=function(o,i,h,g){var E=i.style.light,C=E.properties.get("position"),L=[C.x,C.y,C.z],Z=p.create$1();E.properties.get("anchor")==="viewport"&&p.fromRotation(Z,-i.transform.angle),p.transformMat3(L,L,Z);var q=E.properties.get("color");return{u_matrix:o,u_lightpos:L,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[q.r,q.g,q.b],u_vertical_gradient:+h,u_opacity:g}},Yl=function(o,i,h,g,E,C,L){return p.extend(no(o,i,h,g),kf(C,i,L),{u_height_factor:-Math.pow(2,E.overscaledZ)/L.tileSize/8})},hu=function(o){return{u_matrix:o}},po=function(o,i,h,g){return p.extend(hu(o),kf(h,i,g))},nf=function(o,i){return{u_matrix:o,u_world:i}},Cs=function(o,i,h,g,E){return p.extend(po(o,i,h,g),{u_world:E})},Ju=function(o,i,h,g){var E,C,L=o.transform;if(g.paint.get("circle-pitch-alignment")==="map"){var Z=ta(h,1,L.zoom);E=!0,C=[Z,Z]}else E=!1,C=L.pixelsToGLUnits;return{u_camera_to_center_distance:L.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:o.translatePosMatrix(i.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:p.browser.devicePixelRatio,u_extrude_scale:C}},Qu=function(o,i,h){var g=ta(h,1,i.zoom),E=Math.pow(2,i.zoom-h.tileID.overscaledZ),C=h.tileID.overscaleFactor();return{u_matrix:o,u_camera_to_center_distance:i.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[i.pixelsToGLUnits[0]/(g*E),i.pixelsToGLUnits[1]/(g*E)],u_overscale_factor:C}},Rc=function(o,i,h){return{u_matrix:o,u_inv_matrix:i,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}},Tu=function(o,i,h){return h===void 0&&(h=1),{u_matrix:o,u_color:i,u_overlay:0,u_overlay_scale:h}},Vs=function(o){return{u_matrix:o}},af=function(o,i,h,g){return{u_matrix:o,u_extrude_scale:ta(i,1,h),u_intensity:g}},Eo=function(o,i,h){var g=o.transform;return{u_matrix:qu(o,i,h),u_ratio:1/ta(i,1,g.zoom),u_device_pixel_ratio:p.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},la=function(o,i,h,g){return p.extend(Eo(o,i,h),{u_image:0,u_image_height:g})},Ll=function(o,i,h,g){var E=o.transform,C=pu(i,E);return{u_matrix:qu(o,i,h),u_texsize:i.imageAtlasTexture.size,u_ratio:1/ta(i,1,E.zoom),u_device_pixel_ratio:p.browser.devicePixelRatio,u_image:0,u_scale:[C,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},of=function(o,i,h,g,E){var C=o.lineAtlas,L=pu(i,o.transform),Z=h.layout.get("line-cap")==="round",q=C.getDash(g.from,Z),de=C.getDash(g.to,Z),ge=q.width*E.fromScale,be=de.width*E.toScale;return p.extend(Eo(o,i,h),{u_patternscale_a:[L/ge,-q.height/2],u_patternscale_b:[L/be,-de.height/2],u_sdfgamma:C.width/(256*Math.min(ge,be)*p.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:q.y,u_tex_y_b:de.y,u_mix:E.t})};function pu(c,o){return 1/ta(c,1,o.tileZoom)}function qu(c,o,i){return c.translatePosMatrix(o.tileID.posMatrix,o,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}var Dc=function(o,i,h,g,E){return{u_matrix:o,u_tl_parent:i,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(L=E.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(C=E.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:kc(E.paint.get("raster-hue-rotate"))};var C,L};function kc(c){c*=Math.PI/180;var o=Math.sin(c),i=Math.cos(c);return[(2*i+1)/3,(-Math.sqrt(3)*o-i+1)/3,(Math.sqrt(3)*o-i+1)/3]}var Rl,Al=function(o,i,h,g,E,C,L,Z,q,de){var ge=E.transform;return{u_is_size_zoom_constant:+(o==="constant"||o==="source"),u_is_size_feature_constant:+(o==="constant"||o==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:ge.cameraToCenterDistance,u_pitch:ge.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:ge.width/ge.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:L,u_coord_matrix:Z,u_is_text:+q,u_pitch_with_map:+g,u_texsize:de,u_texture:0}},Au=function(o,i,h,g,E,C,L,Z,q,de,ge){var be=E.transform;return p.extend(Al(o,i,h,g,E,C,L,Z,q,de),{u_gamma_scale:g?Math.cos(be._pitch)*be.cameraToCenterDistance:1,u_device_pixel_ratio:p.browser.devicePixelRatio,u_is_halo:+ge})},Cu=function(o,i,h,g,E,C,L,Z,q,de){return p.extend(Au(o,i,h,g,E,C,L,Z,!0,q,!0),{u_texsize_icon:de,u_texture_icon:1})},du=function(o,i,h){return{u_matrix:o,u_opacity:i,u_color:h}},el=function(o,i,h,g,E,C){return p.extend(function(L,Z,q,de){var ge=q.imageManager.getPattern(L.from.toString()),be=q.imageManager.getPattern(L.to.toString()),Ke=q.imageManager.getPixelSize(),He=Ke.width,ut=Ke.height,We=Math.pow(2,de.tileID.overscaledZ),et=de.tileSize*Math.pow(2,q.transform.tileZoom)/We,Pt=et*(de.tileID.canonical.x+de.tileID.wrap*We),Mt=et*de.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ge.tl,u_pattern_br_a:ge.br,u_pattern_tl_b:be.tl,u_pattern_br_b:be.br,u_texsize:[He,ut],u_mix:Z.t,u_pattern_size_a:ge.displaySize,u_pattern_size_b:be.displaySize,u_scale_a:Z.fromScale,u_scale_b:Z.toScale,u_tile_units_to_pixels:1/ta(de,1,q.transform.tileZoom),u_pixel_coord_upper:[Pt>>16,Mt>>16],u_pixel_coord_lower:[65535&Pt,65535&Mt]}}(g,C,h,E),{u_matrix:o,u_opacity:i})},Kl={fillExtrusion:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_lightpos:new p.Uniform3f(o,i.u_lightpos),u_lightintensity:new p.Uniform1f(o,i.u_lightintensity),u_lightcolor:new p.Uniform3f(o,i.u_lightcolor),u_vertical_gradient:new p.Uniform1f(o,i.u_vertical_gradient),u_opacity:new p.Uniform1f(o,i.u_opacity)}},fillExtrusionPattern:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_lightpos:new p.Uniform3f(o,i.u_lightpos),u_lightintensity:new p.Uniform1f(o,i.u_lightintensity),u_lightcolor:new p.Uniform3f(o,i.u_lightcolor),u_vertical_gradient:new p.Uniform1f(o,i.u_vertical_gradient),u_height_factor:new p.Uniform1f(o,i.u_height_factor),u_image:new p.Uniform1i(o,i.u_image),u_texsize:new p.Uniform2f(o,i.u_texsize),u_pixel_coord_upper:new p.Uniform2f(o,i.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(o,i.u_pixel_coord_lower),u_scale:new p.Uniform3f(o,i.u_scale),u_fade:new p.Uniform1f(o,i.u_fade),u_opacity:new p.Uniform1f(o,i.u_opacity)}},fill:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix)}},fillPattern:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_image:new p.Uniform1i(o,i.u_image),u_texsize:new p.Uniform2f(o,i.u_texsize),u_pixel_coord_upper:new p.Uniform2f(o,i.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(o,i.u_pixel_coord_lower),u_scale:new p.Uniform3f(o,i.u_scale),u_fade:new p.Uniform1f(o,i.u_fade)}},fillOutline:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_world:new p.Uniform2f(o,i.u_world)}},fillOutlinePattern:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_world:new p.Uniform2f(o,i.u_world),u_image:new p.Uniform1i(o,i.u_image),u_texsize:new p.Uniform2f(o,i.u_texsize),u_pixel_coord_upper:new p.Uniform2f(o,i.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(o,i.u_pixel_coord_lower),u_scale:new p.Uniform3f(o,i.u_scale),u_fade:new p.Uniform1f(o,i.u_fade)}},circle:function(o,i){return{u_camera_to_center_distance:new p.Uniform1f(o,i.u_camera_to_center_distance),u_scale_with_map:new p.Uniform1i(o,i.u_scale_with_map),u_pitch_with_map:new p.Uniform1i(o,i.u_pitch_with_map),u_extrude_scale:new p.Uniform2f(o,i.u_extrude_scale),u_device_pixel_ratio:new p.Uniform1f(o,i.u_device_pixel_ratio),u_matrix:new p.UniformMatrix4f(o,i.u_matrix)}},collisionBox:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_camera_to_center_distance:new p.Uniform1f(o,i.u_camera_to_center_distance),u_pixels_to_tile_units:new p.Uniform1f(o,i.u_pixels_to_tile_units),u_extrude_scale:new p.Uniform2f(o,i.u_extrude_scale),u_overscale_factor:new p.Uniform1f(o,i.u_overscale_factor)}},collisionCircle:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_inv_matrix:new p.UniformMatrix4f(o,i.u_inv_matrix),u_camera_to_center_distance:new p.Uniform1f(o,i.u_camera_to_center_distance),u_viewport_size:new p.Uniform2f(o,i.u_viewport_size)}},debug:function(o,i){return{u_color:new p.UniformColor(o,i.u_color),u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_overlay:new p.Uniform1i(o,i.u_overlay),u_overlay_scale:new p.Uniform1f(o,i.u_overlay_scale)}},clippingMask:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix)}},heatmap:function(o,i){return{u_extrude_scale:new p.Uniform1f(o,i.u_extrude_scale),u_intensity:new p.Uniform1f(o,i.u_intensity),u_matrix:new p.UniformMatrix4f(o,i.u_matrix)}},heatmapTexture:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_world:new p.Uniform2f(o,i.u_world),u_image:new p.Uniform1i(o,i.u_image),u_color_ramp:new p.Uniform1i(o,i.u_color_ramp),u_opacity:new p.Uniform1f(o,i.u_opacity)}},hillshade:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_image:new p.Uniform1i(o,i.u_image),u_latrange:new p.Uniform2f(o,i.u_latrange),u_light:new p.Uniform2f(o,i.u_light),u_shadow:new p.UniformColor(o,i.u_shadow),u_highlight:new p.UniformColor(o,i.u_highlight),u_accent:new p.UniformColor(o,i.u_accent)}},hillshadePrepare:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_image:new p.Uniform1i(o,i.u_image),u_dimension:new p.Uniform2f(o,i.u_dimension),u_zoom:new p.Uniform1f(o,i.u_zoom),u_unpack:new p.Uniform4f(o,i.u_unpack)}},line:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_ratio:new p.Uniform1f(o,i.u_ratio),u_device_pixel_ratio:new p.Uniform1f(o,i.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(o,i.u_units_to_pixels)}},lineGradient:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_ratio:new p.Uniform1f(o,i.u_ratio),u_device_pixel_ratio:new p.Uniform1f(o,i.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(o,i.u_units_to_pixels),u_image:new p.Uniform1i(o,i.u_image),u_image_height:new p.Uniform1f(o,i.u_image_height)}},linePattern:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_texsize:new p.Uniform2f(o,i.u_texsize),u_ratio:new p.Uniform1f(o,i.u_ratio),u_device_pixel_ratio:new p.Uniform1f(o,i.u_device_pixel_ratio),u_image:new p.Uniform1i(o,i.u_image),u_units_to_pixels:new p.Uniform2f(o,i.u_units_to_pixels),u_scale:new p.Uniform3f(o,i.u_scale),u_fade:new p.Uniform1f(o,i.u_fade)}},lineSDF:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_ratio:new p.Uniform1f(o,i.u_ratio),u_device_pixel_ratio:new p.Uniform1f(o,i.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(o,i.u_units_to_pixels),u_patternscale_a:new p.Uniform2f(o,i.u_patternscale_a),u_patternscale_b:new p.Uniform2f(o,i.u_patternscale_b),u_sdfgamma:new p.Uniform1f(o,i.u_sdfgamma),u_image:new p.Uniform1i(o,i.u_image),u_tex_y_a:new p.Uniform1f(o,i.u_tex_y_a),u_tex_y_b:new p.Uniform1f(o,i.u_tex_y_b),u_mix:new p.Uniform1f(o,i.u_mix)}},raster:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_tl_parent:new p.Uniform2f(o,i.u_tl_parent),u_scale_parent:new p.Uniform1f(o,i.u_scale_parent),u_buffer_scale:new p.Uniform1f(o,i.u_buffer_scale),u_fade_t:new p.Uniform1f(o,i.u_fade_t),u_opacity:new p.Uniform1f(o,i.u_opacity),u_image0:new p.Uniform1i(o,i.u_image0),u_image1:new p.Uniform1i(o,i.u_image1),u_brightness_low:new p.Uniform1f(o,i.u_brightness_low),u_brightness_high:new p.Uniform1f(o,i.u_brightness_high),u_saturation_factor:new p.Uniform1f(o,i.u_saturation_factor),u_contrast_factor:new p.Uniform1f(o,i.u_contrast_factor),u_spin_weights:new p.Uniform3f(o,i.u_spin_weights)}},symbolIcon:function(o,i){return{u_is_size_zoom_constant:new p.Uniform1i(o,i.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(o,i.u_is_size_feature_constant),u_size_t:new p.Uniform1f(o,i.u_size_t),u_size:new p.Uniform1f(o,i.u_size),u_camera_to_center_distance:new p.Uniform1f(o,i.u_camera_to_center_distance),u_pitch:new p.Uniform1f(o,i.u_pitch),u_rotate_symbol:new p.Uniform1i(o,i.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(o,i.u_aspect_ratio),u_fade_change:new p.Uniform1f(o,i.u_fade_change),u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(o,i.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(o,i.u_coord_matrix),u_is_text:new p.Uniform1i(o,i.u_is_text),u_pitch_with_map:new p.Uniform1i(o,i.u_pitch_with_map),u_texsize:new p.Uniform2f(o,i.u_texsize),u_texture:new p.Uniform1i(o,i.u_texture)}},symbolSDF:function(o,i){return{u_is_size_zoom_constant:new p.Uniform1i(o,i.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(o,i.u_is_size_feature_constant),u_size_t:new p.Uniform1f(o,i.u_size_t),u_size:new p.Uniform1f(o,i.u_size),u_camera_to_center_distance:new p.Uniform1f(o,i.u_camera_to_center_distance),u_pitch:new p.Uniform1f(o,i.u_pitch),u_rotate_symbol:new p.Uniform1i(o,i.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(o,i.u_aspect_ratio),u_fade_change:new p.Uniform1f(o,i.u_fade_change),u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(o,i.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(o,i.u_coord_matrix),u_is_text:new p.Uniform1i(o,i.u_is_text),u_pitch_with_map:new p.Uniform1i(o,i.u_pitch_with_map),u_texsize:new p.Uniform2f(o,i.u_texsize),u_texture:new p.Uniform1i(o,i.u_texture),u_gamma_scale:new p.Uniform1f(o,i.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(o,i.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(o,i.u_is_halo)}},symbolTextAndIcon:function(o,i){return{u_is_size_zoom_constant:new p.Uniform1i(o,i.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(o,i.u_is_size_feature_constant),u_size_t:new p.Uniform1f(o,i.u_size_t),u_size:new p.Uniform1f(o,i.u_size),u_camera_to_center_distance:new p.Uniform1f(o,i.u_camera_to_center_distance),u_pitch:new p.Uniform1f(o,i.u_pitch),u_rotate_symbol:new p.Uniform1i(o,i.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(o,i.u_aspect_ratio),u_fade_change:new p.Uniform1f(o,i.u_fade_change),u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(o,i.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(o,i.u_coord_matrix),u_is_text:new p.Uniform1i(o,i.u_is_text),u_pitch_with_map:new p.Uniform1i(o,i.u_pitch_with_map),u_texsize:new p.Uniform2f(o,i.u_texsize),u_texsize_icon:new p.Uniform2f(o,i.u_texsize_icon),u_texture:new p.Uniform1i(o,i.u_texture),u_texture_icon:new p.Uniform1i(o,i.u_texture_icon),u_gamma_scale:new p.Uniform1f(o,i.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(o,i.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(o,i.u_is_halo)}},background:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_opacity:new p.Uniform1f(o,i.u_opacity),u_color:new p.UniformColor(o,i.u_color)}},backgroundPattern:function(o,i){return{u_matrix:new p.UniformMatrix4f(o,i.u_matrix),u_opacity:new p.Uniform1f(o,i.u_opacity),u_image:new p.Uniform1i(o,i.u_image),u_pattern_tl_a:new p.Uniform2f(o,i.u_pattern_tl_a),u_pattern_br_a:new p.Uniform2f(o,i.u_pattern_br_a),u_pattern_tl_b:new p.Uniform2f(o,i.u_pattern_tl_b),u_pattern_br_b:new p.Uniform2f(o,i.u_pattern_br_b),u_texsize:new p.Uniform2f(o,i.u_texsize),u_mix:new p.Uniform1f(o,i.u_mix),u_pattern_size_a:new p.Uniform2f(o,i.u_pattern_size_a),u_pattern_size_b:new p.Uniform2f(o,i.u_pattern_size_b),u_scale_a:new p.Uniform1f(o,i.u_scale_a),u_scale_b:new p.Uniform1f(o,i.u_scale_b),u_pixel_coord_upper:new p.Uniform2f(o,i.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(o,i.u_pixel_coord_lower),u_tile_units_to_pixels:new p.Uniform1f(o,i.u_tile_units_to_pixels)}}};function eu(c,o,i,h,g,E,C){for(var L=c.context,Z=L.gl,q=c.useProgram("collisionBox"),de=[],ge=0,be=0,Ke=0;Ke<h.length;Ke++){var He=h[Ke],ut=o.getTile(He),We=ut.getBucket(i);if(We){var et=He.posMatrix;g[0]===0&&g[1]===0||(et=c.translatePosMatrix(He.posMatrix,ut,g,E));var Pt=C?We.textCollisionBox:We.iconCollisionBox,Mt=We.collisionCircleArray;if(Mt.length>0){var _r=p.create(),nr=et;p.mul(_r,We.placementInvProjMatrix,c.transform.glCoordMatrix),p.mul(_r,_r,We.placementViewportMatrix),de.push({circleArray:Mt,circleOffset:be,transform:nr,invTransform:_r}),be=ge+=Mt.length/4}Pt&&q.draw(L,Z.LINES,Y.disabled,ue.disabled,c.colorModeForRenderPass(),Me.disabled,Qu(et,c.transform,ut),i.id,Pt.layoutVertexBuffer,Pt.indexBuffer,Pt.segments,null,c.transform.zoom,null,null,Pt.collisionVertexBuffer)}}if(C&&de.length){var gr=c.useProgram("collisionCircle"),Er=new p.StructArrayLayout2f1f2i16;Er.resize(4*ge),Er._trim();for(var tn=0,Vr=0,mn=de;Vr<mn.length;Vr+=1)for(var Sn=mn[Vr],Hn=0;Hn<Sn.circleArray.length/4;Hn++){var ei=4*Hn,Ei=Sn.circleArray[ei+0],Ki=Sn.circleArray[ei+1],bn=Sn.circleArray[ei+2],pi=Sn.circleArray[ei+3];Er.emplace(tn++,Ei,Ki,bn,pi,0),Er.emplace(tn++,Ei,Ki,bn,pi,1),Er.emplace(tn++,Ei,Ki,bn,pi,2),Er.emplace(tn++,Ei,Ki,bn,pi,3)}(!Rl||Rl.length<2*ge)&&(Rl=function(mo){var oo=2*mo,Oo=new p.StructArrayLayout3ui6;Oo.resize(oo),Oo._trim();for(var La=0;La<oo;La++){var $a=6*La;Oo.uint16[$a+0]=4*La+0,Oo.uint16[$a+1]=4*La+1,Oo.uint16[$a+2]=4*La+2,Oo.uint16[$a+3]=4*La+2,Oo.uint16[$a+4]=4*La+3,Oo.uint16[$a+5]=4*La+0}return Oo}(ge));for(var bi=L.createIndexBuffer(Rl,!0),Nn=L.createVertexBuffer(Er,p.collisionCircleLayout.members,!0),yi=0,Kn=de;yi<Kn.length;yi+=1){var Ci=Kn[yi],Wi=Rc(Ci.transform,Ci.invTransform,c.transform);gr.draw(L,Z.TRIANGLES,Y.disabled,ue.disabled,c.colorModeForRenderPass(),Me.disabled,Wi,i.id,Nn,bi,p.SegmentVector.simpleSegment(0,2*Ci.circleOffset,Ci.circleArray.length,Ci.circleArray.length/2),null,c.transform.zoom,null,null,null)}Nn.destroy(),bi.destroy()}}var tu=p.identity(new Float32Array(16));function Fc(c,o,i,h,g,E){var C=p.getAnchorAlignment(c),L=-(C.horizontalAlign-.5)*o,Z=-(C.verticalAlign-.5)*i,q=p.evaluateVariableOffset(c,h);return new p.Point((L/g+q[0])*E,(Z/g+q[1])*E)}function zc(c,o,i,h,g,E,C,L,Z,q,de){var ge=c.text.placedSymbolArray,be=c.text.dynamicLayoutVertexArray,Ke=c.icon.dynamicLayoutVertexArray,He={};be.clear();for(var ut=0;ut<ge.length;ut++){var We=ge.get(ut),et=We.hidden||!We.crossTileID||c.allowVerticalPlacement&&!We.placedOrientation?null:h[We.crossTileID];if(et){var Pt=new p.Point(We.anchorX,We.anchorY),Mt=Ri(Pt,i?L:C),_r=Zn(E.cameraToCenterDistance,Mt.signedDistanceFromCamera),nr=g.evaluateSizeForFeature(c.textSizeData,q,We)*_r/p.ONE_EM;i&&(nr*=c.tilePixelRatio/Z);for(var gr=Fc(et.anchor,et.width,et.height,et.textOffset,et.textBoxScale,nr),Er=i?Ri(Pt.add(gr),C).point:Mt.point.add(o?gr.rotate(-E.angle):gr),tn=c.allowVerticalPlacement&&We.placedOrientation===p.WritingMode.vertical?Math.PI/2:0,Vr=0;Vr<We.numGlyphs;Vr++)p.addDynamicAttributes(be,Er,tn);de&&We.associatedIconIndex>=0&&(He[We.associatedIconIndex]={shiftedAnchor:Er,angle:tn})}else Na(We.numGlyphs,be)}if(de){Ke.clear();for(var mn=c.icon.placedSymbolArray,Sn=0;Sn<mn.length;Sn++){var Hn=mn.get(Sn);if(Hn.hidden)Na(Hn.numGlyphs,Ke);else{var ei=He[Sn];if(ei)for(var Ei=0;Ei<Hn.numGlyphs;Ei++)p.addDynamicAttributes(Ke,ei.shiftedAnchor,ei.angle);else Na(Hn.numGlyphs,Ke)}}c.icon.dynamicLayoutVertexBuffer.updateData(Ke)}c.text.dynamicLayoutVertexBuffer.updateData(be)}function mc(c,o,i){return i.iconsInText&&o?"symbolTextAndIcon":c?"symbolSDF":"symbolIcon"}function Nu(c,o,i,h,g,E,C,L,Z,q,de,ge){for(var be=c.context,Ke=be.gl,He=c.transform,ut=L==="map",We=Z==="map",et=ut&&i.layout.get("symbol-placement")!=="point",Pt=ut&&!We&&!et,Mt=i.layout.get("symbol-sort-key").constantOr(1)!==void 0,_r=!1,nr=c.depthModeForSublayer(0,Y.ReadOnly),gr=i.layout.get("text-variable-anchor"),Er=[],tn=0,Vr=h;tn<Vr.length;tn+=1){var mn=Vr[tn],Sn=o.getTile(mn),Hn=Sn.getBucket(i);if(Hn){var ei=g?Hn.text:Hn.icon;if(ei&&ei.segments.get().length){var Ei=ei.programConfigurations.get(i.id),Ki=g||Hn.sdfIcons,bn=g?Hn.textSizeData:Hn.iconSizeData,pi=We||He.pitch!==0,bi=c.useProgram(mc(Ki,g,Hn),Ei),Nn=p.evaluateSizeForZoom(bn,He.zoom),yi=void 0,Kn=[0,0],Ci=void 0,Wi=void 0,mo=null,oo=void 0;if(g)Ci=Sn.glyphAtlasTexture,Wi=Ke.LINEAR,yi=Sn.glyphAtlasTexture.size,Hn.iconsInText&&(Kn=Sn.imageAtlasTexture.size,mo=Sn.imageAtlasTexture,oo=pi||c.options.rotating||c.options.zooming||bn.kind==="composite"||bn.kind==="camera"?Ke.LINEAR:Ke.NEAREST);else{var Oo=i.layout.get("icon-size").constantOr(0)!==1||Hn.iconsNeedLinear;Ci=Sn.imageAtlasTexture,Wi=Ki||c.options.rotating||c.options.zooming||Oo||pi?Ke.LINEAR:Ke.NEAREST,yi=Sn.imageAtlasTexture.size}var La=ta(Sn,1,c.transform.zoom),$a=si(mn.posMatrix,We,ut,c.transform,La),Ss=Rn(mn.posMatrix,We,ut,c.transform,La),Qo=gr&&Hn.hasTextData(),dl=i.layout.get("icon-text-fit")!=="none"&&Qo&&Hn.hasIconData();et&&ys(Hn,mn.posMatrix,c,g,$a,Ss,We,q);var Ou=c.translatePosMatrix(mn.posMatrix,Sn,E,C),qo=et||g&&gr||dl?tu:$a,Ds=c.translatePosMatrix(Ss,Sn,E,C,!0),vl=Ki&&i.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0,oc={program:bi,buffers:ei,uniformValues:Ki?Hn.iconsInText?Cu(bn.kind,Nn,Pt,We,c,Ou,qo,Ds,yi,Kn):Au(bn.kind,Nn,Pt,We,c,Ou,qo,Ds,g,yi,!0):Al(bn.kind,Nn,Pt,We,c,Ou,qo,Ds,g,yi),atlasTexture:Ci,atlasTextureIcon:mo,atlasInterpolation:Wi,atlasInterpolationIcon:oo,isSDF:Ki,hasHalo:vl};if(Mt&&Hn.canOverlap){_r=!0;for(var Lu=0,ou=ei.segments.get();Lu<ou.length;Lu+=1){var ml=ou[Lu];Er.push({segments:new p.SegmentVector([ml]),sortKey:ml.sortKey,state:oc})}}else Er.push({segments:ei.segments,sortKey:0,state:oc})}}}_r&&Er.sort(function(Zl,ps){return Zl.sortKey-ps.sortKey});for(var Ru=0,jl=Er;Ru<jl.length;Ru+=1){var su=jl[Ru],so=su.state;if(be.activeTexture.set(Ke.TEXTURE0),so.atlasTexture.bind(so.atlasInterpolation,Ke.CLAMP_TO_EDGE),so.atlasTextureIcon&&(be.activeTexture.set(Ke.TEXTURE1),so.atlasTextureIcon&&so.atlasTextureIcon.bind(so.atlasInterpolationIcon,Ke.CLAMP_TO_EDGE)),so.isSDF){var Du=so.uniformValues;so.hasHalo&&(Du.u_is_halo=1,Cl(so.buffers,su.segments,i,c,so.program,nr,de,ge,Du)),Du.u_is_halo=0}Cl(so.buffers,su.segments,i,c,so.program,nr,de,ge,so.uniformValues)}}function Cl(c,o,i,h,g,E,C,L,Z){var q=h.context;g.draw(q,q.gl.TRIANGLES,E,C,L,Me.disabled,Z,i.id,c.layoutVertexBuffer,c.indexBuffer,o,i.paint,h.transform.zoom,c.programConfigurations.get(i.id),c.dynamicLayoutVertexBuffer,c.opacityVertexBuffer)}function $l(c,o,i,h,g,E,C){var L,Z,q,de,ge,be=c.context.gl,Ke=i.paint.get("fill-pattern"),He=Ke&&Ke.constantOr(1),ut=i.getCrossfadeParameters();C?(Z=He&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",L=be.LINES):(Z=He?"fillPattern":"fill",L=be.TRIANGLES);for(var We=0,et=h;We<et.length;We+=1){var Pt=et[We],Mt=o.getTile(Pt);if(!He||Mt.patternsLoaded()){var _r=Mt.getBucket(i);if(_r){var nr=_r.programConfigurations.get(i.id),gr=c.useProgram(Z,nr);He&&(c.context.activeTexture.set(be.TEXTURE0),Mt.imageAtlasTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE),nr.updatePaintBuffers(ut));var Er=Ke.constantOr(null);if(Er&&Mt.imageAtlas){var tn=Mt.imageAtlas,Vr=tn.patternPositions[Er.to.toString()],mn=tn.patternPositions[Er.from.toString()];Vr&&mn&&nr.setConstantPatternPositions(Vr,mn)}var Sn=c.translatePosMatrix(Pt.posMatrix,Mt,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(C){de=_r.indexBuffer2,ge=_r.segments2;var Hn=[be.drawingBufferWidth,be.drawingBufferHeight];q=Z==="fillOutlinePattern"&&He?Cs(Sn,c,ut,Mt,Hn):nf(Sn,Hn)}else de=_r.indexBuffer,ge=_r.segments,q=He?po(Sn,c,ut,Mt):hu(Sn);gr.draw(c.context,L,g,c.stencilModeForClipping(Pt),E,Me.disabled,q,i.id,_r.layoutVertexBuffer,de,ge,i.paint,c.transform.zoom,nr)}}}}function tl(c,o,i,h,g,E,C){for(var L=c.context,Z=L.gl,q=i.paint.get("fill-extrusion-pattern"),de=q.constantOr(1),ge=i.getCrossfadeParameters(),be=i.paint.get("fill-extrusion-opacity"),Ke=0,He=h;Ke<He.length;Ke+=1){var ut=He[Ke],We=o.getTile(ut),et=We.getBucket(i);if(et){var Pt=et.programConfigurations.get(i.id),Mt=c.useProgram(de?"fillExtrusionPattern":"fillExtrusion",Pt);de&&(c.context.activeTexture.set(Z.TEXTURE0),We.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Pt.updatePaintBuffers(ge));var _r=q.constantOr(null);if(_r&&We.imageAtlas){var nr=We.imageAtlas,gr=nr.patternPositions[_r.to.toString()],Er=nr.patternPositions[_r.from.toString()];gr&&Er&&Pt.setConstantPatternPositions(gr,Er)}var tn=c.translatePosMatrix(ut.posMatrix,We,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Vr=i.paint.get("fill-extrusion-vertical-gradient"),mn=de?Yl(tn,c,Vr,be,ut,ge,We):no(tn,c,Vr,be);Mt.draw(L,L.gl.TRIANGLES,g,E,C,Me.backCCW,mn,i.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,i.paint,c.transform.zoom,Pt)}}}function Dl(c,o,i,h,g,E){var C=c.context,L=C.gl,Z=o.fbo;if(Z){var q=c.useProgram("hillshade");C.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,Z.colorAttachment.get());var de=function(ge,be,Ke){var He=Ke.paint.get("hillshade-shadow-color"),ut=Ke.paint.get("hillshade-highlight-color"),We=Ke.paint.get("hillshade-accent-color"),et=Ke.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ke.paint.get("hillshade-illumination-anchor")==="viewport"&&(et-=ge.transform.angle);var Pt,Mt,_r,nr=!ge.options.moving;return{u_matrix:ge.transform.calculatePosMatrix(be.tileID.toUnwrapped(),nr),u_image:0,u_latrange:(Pt=be.tileID,Mt=Math.pow(2,Pt.canonical.z),_r=Pt.canonical.y,[new p.MercatorCoordinate(0,_r/Mt).toLngLat().lat,new p.MercatorCoordinate(0,(_r+1)/Mt).toLngLat().lat]),u_light:[Ke.paint.get("hillshade-exaggeration"),et],u_shadow:He,u_highlight:ut,u_accent:We}}(c,o,i);q.draw(C,L.TRIANGLES,h,g,E,Me.disabled,de,i.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}}function Nc(c,o,i,h,g,E){var C=c.context,L=C.gl,Z=o.dem;if(Z&&Z.data){var q=Z.dim,de=Z.stride,ge=Z.getPixels();if(C.activeTexture.set(L.TEXTURE1),C.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||c.getTileTexture(de),o.demTexture){var be=o.demTexture;be.update(ge,{premultiply:!1}),be.bind(L.NEAREST,L.CLAMP_TO_EDGE)}else o.demTexture=new p.Texture(C,ge,L.RGBA,{premultiply:!1}),o.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE);C.activeTexture.set(L.TEXTURE0);var Ke=o.fbo;if(!Ke){var He=new p.Texture(C,{width:q,height:q,data:null},L.RGBA);He.bind(L.LINEAR,L.CLAMP_TO_EDGE),(Ke=o.fbo=C.createFramebuffer(q,q,!0)).colorAttachment.set(He.texture)}C.bindFramebuffer.set(Ke.framebuffer),C.viewport.set([0,0,q,q]),c.useProgram("hillshadePrepare").draw(C,L.TRIANGLES,h,g,E,Me.disabled,function(ut,We){var et=We.stride,Pt=p.create();return p.ortho(Pt,0,p.EXTENT,-p.EXTENT,0,0,1),p.translate(Pt,Pt,[0,-p.EXTENT,0]),{u_matrix:Pt,u_image:1,u_dimension:[et,et],u_zoom:ut.overscaledZ,u_unpack:We.getUnpackVector()}}(o.tileID,Z),i.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function rl(c,o,i,h,g){var E=h.paint.get("raster-fade-duration");if(E>0){var C=p.browser.now(),L=(C-c.timeAdded)/E,Z=o?(C-o.timeAdded)/E:-1,q=i.getSource(),de=g.coveringZoomLevel({tileSize:q.tileSize,roundZoom:q.roundZoom}),ge=!o||Math.abs(o.tileID.overscaledZ-de)>Math.abs(c.tileID.overscaledZ-de),be=ge&&c.refreshedUponExpiration?1:p.clamp(ge?L:1-Z,0,1);return c.refreshedUponExpiration&&L>=1&&(c.refreshedUponExpiration=!1),o?{opacity:1,mix:1-be}:{opacity:be,mix:0}}return{opacity:1,mix:0}}var Bc=new p.Color(1,0,0,1),sf=new p.Color(0,1,0,1),Uc=new p.Color(0,0,1,1),Pl=new p.Color(1,0,1,1),Mo=new p.Color(0,1,1,1);function gc(c,o,i,h){nl(c,0,o+i/2,c.transform.width,i,h)}function jc(c,o,i,h){nl(c,o-i/2,0,i,c.transform.height,h)}function nl(c,o,i,h,g,E){var C=c.context,L=C.gl;L.enable(L.SCISSOR_TEST),L.scissor(o*p.browser.devicePixelRatio,i*p.browser.devicePixelRatio,h*p.browser.devicePixelRatio,g*p.browser.devicePixelRatio),C.clear({color:E}),L.disable(L.SCISSOR_TEST)}function Zc(c,o,i){var h=c.context,g=h.gl,E=i.posMatrix,C=c.useProgram("debug"),L=Y.disabled,Z=ue.disabled,q=c.colorModeForRenderPass();h.activeTexture.set(g.TEXTURE0),c.emptyTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),C.draw(h,g.LINE_STRIP,L,Z,q,Me.disabled,Tu(E,p.Color.red),"$debug",c.debugBuffer,c.tileBorderIndexBuffer,c.debugSegments);var de=o.getTileByID(i.key).latestRawTileData,ge=Math.floor((de&&de.byteLength||0)/1024),be=o.getTile(i).tileSize,Ke=512/Math.min(be,512)*(i.overscaledZ/c.transform.zoom)*.5,He=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(He+=" => "+i.overscaledZ),function(ut,We){ut.initDebugOverlayCanvas();var et=ut.debugOverlayCanvas,Pt=ut.context.gl,Mt=ut.debugOverlayCanvas.getContext("2d");Mt.clearRect(0,0,et.width,et.height),Mt.shadowColor="white",Mt.shadowBlur=2,Mt.lineWidth=1.5,Mt.strokeStyle="white",Mt.textBaseline="top",Mt.font="bold 36px Open Sans, sans-serif",Mt.fillText(We,5,5),Mt.strokeText(We,5,5),ut.debugOverlayTexture.update(et),ut.debugOverlayTexture.bind(Pt.LINEAR,Pt.CLAMP_TO_EDGE)}(c,He+" "+ge+"kb"),C.draw(h,g.TRIANGLES,L,Z,Le.alphaBlended,Me.disabled,Tu(E,p.Color.transparent,Ke),"$debug",c.debugBuffer,c.quadTriangleIndexBuffer,c.debugSegments)}var Pu={symbol:function(o,i,h,g,E){if(o.renderPass==="translucent"){var C=ue.disabled,L=o.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(Z,q,de,ge,be,Ke,He){for(var ut=q.transform,We=be==="map",et=Ke==="map",Pt=0,Mt=Z;Pt<Mt.length;Pt+=1){var _r=Mt[Pt],nr=ge.getTile(_r),gr=nr.getBucket(de);if(gr&&gr.text&&gr.text.segments.get().length){var Er=p.evaluateSizeForZoom(gr.textSizeData,ut.zoom),tn=ta(nr,1,q.transform.zoom),Vr=si(_r.posMatrix,et,We,q.transform,tn),mn=de.layout.get("icon-text-fit")!=="none"&&gr.hasIconData();if(Er){var Sn=Math.pow(2,ut.zoom-nr.tileID.overscaledZ);zc(gr,We,et,He,p.symbolSize,ut,Vr,_r.posMatrix,Sn,Er,mn)}}}}(g,o,h,i,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),E),h.paint.get("icon-opacity").constantOr(1)!==0&&Nu(o,i,h,g,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),C,L),h.paint.get("text-opacity").constantOr(1)!==0&&Nu(o,i,h,g,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),C,L),i.map.showCollisionBoxes&&(eu(o,i,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),eu(o,i,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))}},circle:function(o,i,h,g){if(o.renderPass==="translucent"){var E=h.paint.get("circle-opacity"),C=h.paint.get("circle-stroke-width"),L=h.paint.get("circle-stroke-opacity"),Z=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(E.constantOr(1)!==0||C.constantOr(1)!==0&&L.constantOr(1)!==0){for(var q=o.context,de=q.gl,ge=o.depthModeForSublayer(0,Y.ReadOnly),be=ue.disabled,Ke=o.colorModeForRenderPass(),He=[],ut=0;ut<g.length;ut++){var We=g[ut],et=i.getTile(We),Pt=et.getBucket(h);if(Pt){var Mt=Pt.programConfigurations.get(h.id),_r={programConfiguration:Mt,program:o.useProgram("circle",Mt),layoutVertexBuffer:Pt.layoutVertexBuffer,indexBuffer:Pt.indexBuffer,uniformValues:Ju(o,We,et,h)};if(Z)for(var nr=0,gr=Pt.segments.get();nr<gr.length;nr+=1){var Er=gr[nr];He.push({segments:new p.SegmentVector([Er]),sortKey:Er.sortKey,state:_r})}else He.push({segments:Pt.segments,sortKey:0,state:_r})}}Z&&He.sort(function(Hn,ei){return Hn.sortKey-ei.sortKey});for(var tn=0,Vr=He;tn<Vr.length;tn+=1){var mn=Vr[tn],Sn=mn.state;Sn.program.draw(q,de.TRIANGLES,ge,be,Ke,Me.disabled,Sn.uniformValues,h.id,Sn.layoutVertexBuffer,Sn.indexBuffer,mn.segments,h.paint,o.transform.zoom,Sn.programConfiguration)}}}},heatmap:function(o,i,h,g){if(h.paint.get("heatmap-opacity")!==0)if(o.renderPass==="offscreen"){var E=o.context,C=E.gl,L=ue.disabled,Z=new Le([C.ONE,C.ONE],p.Color.transparent,[!0,!0,!0,!0]);(function(He,ut,We){var et=He.gl;He.activeTexture.set(et.TEXTURE1),He.viewport.set([0,0,ut.width/4,ut.height/4]);var Pt=We.heatmapFbo;if(Pt)et.bindTexture(et.TEXTURE_2D,Pt.colorAttachment.get()),He.bindFramebuffer.set(Pt.framebuffer);else{var Mt=et.createTexture();et.bindTexture(et.TEXTURE_2D,Mt),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_WRAP_S,et.CLAMP_TO_EDGE),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_WRAP_T,et.CLAMP_TO_EDGE),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_MIN_FILTER,et.LINEAR),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_MAG_FILTER,et.LINEAR),Pt=We.heatmapFbo=He.createFramebuffer(ut.width/4,ut.height/4,!1),function(_r,nr,gr,Er){var tn=_r.gl;tn.texImage2D(tn.TEXTURE_2D,0,tn.RGBA,nr.width/4,nr.height/4,0,tn.RGBA,_r.extRenderToTextureHalfFloat?_r.extTextureHalfFloat.HALF_FLOAT_OES:tn.UNSIGNED_BYTE,null),Er.colorAttachment.set(gr)}(He,ut,Mt,Pt)}})(E,o,h),E.clear({color:p.Color.transparent});for(var q=0;q<g.length;q++){var de=g[q];if(!i.hasRenderableParent(de)){var ge=i.getTile(de),be=ge.getBucket(h);if(be){var Ke=be.programConfigurations.get(h.id);o.useProgram("heatmap",Ke).draw(E,C.TRIANGLES,Y.disabled,L,Z,Me.disabled,af(de.posMatrix,ge,o.transform.zoom,h.paint.get("heatmap-intensity")),h.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,h.paint,o.transform.zoom,Ke)}}}E.viewport.set([0,0,o.width,o.height])}else o.renderPass==="translucent"&&(o.context.setColorMode(o.colorModeForRenderPass()),function(He,ut){var We=He.context,et=We.gl,Pt=ut.heatmapFbo;if(Pt){We.activeTexture.set(et.TEXTURE0),et.bindTexture(et.TEXTURE_2D,Pt.colorAttachment.get()),We.activeTexture.set(et.TEXTURE1);var Mt=ut.colorRampTexture;Mt||(Mt=ut.colorRampTexture=new p.Texture(We,ut.colorRamp,et.RGBA)),Mt.bind(et.LINEAR,et.CLAMP_TO_EDGE),He.useProgram("heatmapTexture").draw(We,et.TRIANGLES,Y.disabled,ue.disabled,He.colorModeForRenderPass(),Me.disabled,function(_r,nr,gr,Er){var tn=p.create();p.ortho(tn,0,_r.width,_r.height,0,0,1);var Vr=_r.context.gl;return{u_matrix:tn,u_world:[Vr.drawingBufferWidth,Vr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:nr.paint.get("heatmap-opacity")}}(He,ut),ut.id,He.viewportBuffer,He.quadTriangleIndexBuffer,He.viewportSegments,ut.paint,He.transform.zoom)}}(o,h))},line:function(o,i,h,g){if(o.renderPass==="translucent"){var E=h.paint.get("line-opacity"),C=h.paint.get("line-width");if(E.constantOr(1)!==0&&C.constantOr(1)!==0)for(var L=o.depthModeForSublayer(0,Y.ReadOnly),Z=o.colorModeForRenderPass(),q=h.paint.get("line-dasharray"),de=h.paint.get("line-pattern"),ge=de.constantOr(1),be=h.paint.get("line-gradient"),Ke=h.getCrossfadeParameters(),He=ge?"linePattern":q?"lineSDF":be?"lineGradient":"line",ut=o.context,We=ut.gl,et=!0,Pt=0,Mt=g;Pt<Mt.length;Pt+=1){var _r=Mt[Pt],nr=i.getTile(_r);if(!ge||nr.patternsLoaded()){var gr=nr.getBucket(h);if(gr){var Er=gr.programConfigurations.get(h.id),tn=o.context.program.get(),Vr=o.useProgram(He,Er),mn=et||Vr.program!==tn,Sn=de.constantOr(null);if(Sn&&nr.imageAtlas){var Hn=nr.imageAtlas,ei=Hn.patternPositions[Sn.to.toString()],Ei=Hn.patternPositions[Sn.from.toString()];ei&&Ei&&Er.setConstantPatternPositions(ei,Ei)}var Ki=ge?Ll(o,nr,h,Ke):q?of(o,nr,h,q,Ke):be?la(o,nr,h,gr.lineClipsArray.length):Eo(o,nr,h);if(ge)ut.activeTexture.set(We.TEXTURE0),nr.imageAtlasTexture.bind(We.LINEAR,We.CLAMP_TO_EDGE),Er.updatePaintBuffers(Ke);else if(q&&(mn||o.lineAtlas.dirty))ut.activeTexture.set(We.TEXTURE0),o.lineAtlas.bind(ut);else if(be){var bn=gr.gradients[h.id],pi=bn.texture;if(h.gradientVersion!==bn.version){var bi=256;if(h.stepInterpolant){var Nn=i.getSource().maxzoom,yi=_r.canonical.z===Nn?Math.ceil(1<<o.transform.maxZoom-_r.canonical.z):1;bi=p.clamp(p.nextPowerOfTwo(gr.maxLineLength/p.EXTENT*1024*yi),256,ut.maxTextureSize)}bn.gradient=p.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:bi,image:bn.gradient||void 0,clips:gr.lineClipsArray}),bn.texture?bn.texture.update(bn.gradient):bn.texture=new p.Texture(ut,bn.gradient,We.RGBA),bn.version=h.gradientVersion,pi=bn.texture}ut.activeTexture.set(We.TEXTURE0),pi.bind(h.stepInterpolant?We.NEAREST:We.LINEAR,We.CLAMP_TO_EDGE)}Vr.draw(ut,We.TRIANGLES,L,o.stencilModeForClipping(_r),Z,Me.disabled,Ki,h.id,gr.layoutVertexBuffer,gr.indexBuffer,gr.segments,h.paint,o.transform.zoom,Er,gr.layoutVertexBuffer2),et=!1}}}}},fill:function(o,i,h,g){var E=h.paint.get("fill-color"),C=h.paint.get("fill-opacity");if(C.constantOr(1)!==0){var L=o.colorModeForRenderPass(),Z=h.paint.get("fill-pattern"),q=o.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&E.constantOr(p.Color.transparent).a===1&&C.constantOr(0)===1?"opaque":"translucent";if(o.renderPass===q){var de=o.depthModeForSublayer(1,o.renderPass==="opaque"?Y.ReadWrite:Y.ReadOnly);$l(o,i,h,g,de,L,!1)}if(o.renderPass==="translucent"&&h.paint.get("fill-antialias")){var ge=o.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,Y.ReadOnly);$l(o,i,h,g,ge,L,!0)}}},"fill-extrusion":function(o,i,h,g){var E=h.paint.get("fill-extrusion-opacity");if(E!==0&&o.renderPass==="translucent"){var C=new Y(o.context.gl.LEQUAL,Y.ReadWrite,o.depthRangeFor3D);if(E!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))tl(o,i,h,g,C,ue.disabled,Le.disabled),tl(o,i,h,g,C,o.stencilModeFor3D(),o.colorModeForRenderPass());else{var L=o.colorModeForRenderPass();tl(o,i,h,g,C,ue.disabled,L)}}},hillshade:function(o,i,h,g){if(o.renderPass==="offscreen"||o.renderPass==="translucent"){for(var E=o.context,C=o.depthModeForSublayer(0,Y.ReadOnly),L=o.colorModeForRenderPass(),Z=o.renderPass==="translucent"?o.stencilConfigForOverlap(g):[{},g],q=Z[0],de=0,ge=Z[1];de<ge.length;de+=1){var be=ge[de],Ke=i.getTile(be);Ke.needsHillshadePrepare&&o.renderPass==="offscreen"?Nc(o,Ke,h,C,ue.disabled,L):o.renderPass==="translucent"&&Dl(o,Ke,h,C,q[be.overscaledZ],L)}E.viewport.set([0,0,o.width,o.height])}},raster:function(o,i,h,g){if(o.renderPass==="translucent"&&h.paint.get("raster-opacity")!==0&&g.length)for(var E=o.context,C=E.gl,L=i.getSource(),Z=o.useProgram("raster"),q=o.colorModeForRenderPass(),de=L instanceof te?[{},g]:o.stencilConfigForOverlap(g),ge=de[0],be=de[1],Ke=be[be.length-1].overscaledZ,He=!o.options.moving,ut=0,We=be;ut<We.length;ut+=1){var et=We[ut],Pt=o.depthModeForSublayer(et.overscaledZ-Ke,h.paint.get("raster-opacity")===1?Y.ReadWrite:Y.ReadOnly,C.LESS),Mt=i.getTile(et),_r=o.transform.calculatePosMatrix(et.toUnwrapped(),He);Mt.registerFadeDuration(h.paint.get("raster-fade-duration"));var nr=i.findLoadedParent(et,0),gr=rl(Mt,nr,i,h,o.transform),Er=void 0,tn=void 0,Vr=h.paint.get("raster-resampling")==="nearest"?C.NEAREST:C.LINEAR;E.activeTexture.set(C.TEXTURE0),Mt.texture.bind(Vr,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(C.TEXTURE1),nr?(nr.texture.bind(Vr,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),Er=Math.pow(2,nr.tileID.overscaledZ-Mt.tileID.overscaledZ),tn=[Mt.tileID.canonical.x*Er%1,Mt.tileID.canonical.y*Er%1]):Mt.texture.bind(Vr,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST);var mn=Dc(_r,tn||[0,0],Er||1,gr,h);L instanceof te?Z.draw(E,C.TRIANGLES,Pt,ue.disabled,q,Me.disabled,mn,h.id,L.boundsBuffer,o.quadTriangleIndexBuffer,L.boundsSegments):Z.draw(E,C.TRIANGLES,Pt,ge[et.overscaledZ],q,Me.disabled,mn,h.id,o.rasterBoundsBuffer,o.quadTriangleIndexBuffer,o.rasterBoundsSegments)}},background:function(o,i,h){var g=h.paint.get("background-color"),E=h.paint.get("background-opacity");if(E!==0){var C=o.context,L=C.gl,Z=o.transform,q=Z.tileSize,de=h.paint.get("background-pattern");if(!o.isPatternMissing(de)){var ge=!de&&g.a===1&&E===1&&o.opaquePassEnabledForLayer()?"opaque":"translucent";if(o.renderPass===ge){var be=ue.disabled,Ke=o.depthModeForSublayer(0,ge==="opaque"?Y.ReadWrite:Y.ReadOnly),He=o.colorModeForRenderPass(),ut=o.useProgram(de?"backgroundPattern":"background"),We=Z.coveringTiles({tileSize:q});de&&(C.activeTexture.set(L.TEXTURE0),o.imageManager.bind(o.context));for(var et=h.getCrossfadeParameters(),Pt=0,Mt=We;Pt<Mt.length;Pt+=1){var _r=Mt[Pt],nr=o.transform.calculatePosMatrix(_r.toUnwrapped()),gr=de?el(nr,E,o,de,{tileID:_r,tileSize:q},et):du(nr,E,g);ut.draw(C,L.TRIANGLES,Ke,be,He,Me.disabled,gr,h.id,o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments)}}}}},debug:function(o,i,h){for(var g=0;g<h.length;g++)Zc(o,i,h[g])},custom:function(o,i,h){var g=o.context,E=h.implementation;if(o.renderPass==="offscreen"){var C=E.prerender;C&&(o.setCustomLayerDefaults(),g.setColorMode(o.colorModeForRenderPass()),C.call(E,g.gl,o.transform.customLayerMatrix()),g.setDirty(),o.setBaseState())}else if(o.renderPass==="translucent"){o.setCustomLayerDefaults(),g.setColorMode(o.colorModeForRenderPass()),g.setStencilMode(ue.disabled);var L=E.renderingMode==="3d"?new Y(o.context.gl.LEQUAL,Y.ReadWrite,o.depthRangeFor3D):o.depthModeForSublayer(0,Y.ReadOnly);g.setDepthMode(L),E.render(g.gl,o.transform.customLayerMatrix()),g.setDirty(),o.setBaseState(),g.bindFramebuffer.set(null)}}},Aa=function(o,i){this.context=new se(o),this.transform=i,this._tileTextures={},this.setup(),this.numSublayers=Ne.maxUnderzooming+Ne.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new $n,this.gpuTimers={}};Aa.prototype.resize=function(c,o){if(this.width=c*p.browser.devicePixelRatio,this.height=o*p.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,h=this.style._order;i<h.length;i+=1)this.style._layers[h[i]].resize()},Aa.prototype.setup=function(){var c=this.context,o=new p.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(p.EXTENT,0),o.emplaceBack(0,p.EXTENT),o.emplaceBack(p.EXTENT,p.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(o,Ya.members),this.tileExtentSegments=p.SegmentVector.simpleSegment(0,0,4,2);var i=new p.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(p.EXTENT,0),i.emplaceBack(0,p.EXTENT),i.emplaceBack(p.EXTENT,p.EXTENT),this.debugBuffer=c.createVertexBuffer(i,Ya.members),this.debugSegments=p.SegmentVector.simpleSegment(0,0,4,5);var h=new p.StructArrayLayout4i8;h.emplaceBack(0,0,0,0),h.emplaceBack(p.EXTENT,0,p.EXTENT,0),h.emplaceBack(0,p.EXTENT,0,p.EXTENT),h.emplaceBack(p.EXTENT,p.EXTENT,p.EXTENT,p.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(h,re.members),this.rasterBoundsSegments=p.SegmentVector.simpleSegment(0,0,4,2);var g=new p.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(g,Ya.members),this.viewportSegments=p.SegmentVector.simpleSegment(0,0,4,2);var E=new p.StructArrayLayout1ui2;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(E);var C=new p.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(C),this.emptyTexture=new p.Texture(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);var L=this.context.gl;this.stencilClearMode=new ue({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO)},Aa.prototype.clearStencil=function(){var c=this.context,o=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=p.create();p.ortho(i,0,this.width,this.height,0,0,1),p.scale(i,i,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,o.TRIANGLES,Y.disabled,this.stencilClearMode,Le.disabled,Me.disabled,Vs(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Aa.prototype._renderTileClippingMasks=function(c,o){if(this.currentStencilSource!==c.source&&c.isTileClipped()&&o&&o.length){this.currentStencilSource=c.source;var i=this.context,h=i.gl;this.nextStencilID+o.length>256&&this.clearStencil(),i.setColorMode(Le.disabled),i.setDepthMode(Y.disabled);var g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var E=0,C=o;E<C.length;E+=1){var L=C[E],Z=this._tileClippingMaskIDs[L.key]=this.nextStencilID++;g.draw(i,h.TRIANGLES,Y.disabled,new ue({func:h.ALWAYS,mask:0},Z,255,h.KEEP,h.KEEP,h.REPLACE),Le.disabled,Me.disabled,Vs(L.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Aa.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var c=this.nextStencilID++,o=this.context.gl;return new ue({func:o.NOTEQUAL,mask:255},c,255,o.KEEP,o.KEEP,o.REPLACE)},Aa.prototype.stencilModeForClipping=function(c){var o=this.context.gl;return new ue({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,o.KEEP,o.KEEP,o.REPLACE)},Aa.prototype.stencilConfigForOverlap=function(c){var o,i=this.context.gl,h=c.sort(function(Z,q){return q.overscaledZ-Z.overscaledZ}),g=h[h.length-1].overscaledZ,E=h[0].overscaledZ-g+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();for(var C={},L=0;L<E;L++)C[L+g]=new ue({func:i.GEQUAL,mask:255},L+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=E,[C,h]}return[(o={},o[g]=ue.disabled,o),h]},Aa.prototype.colorModeForRenderPass=function(){var c=this.context.gl;return this._showOverdrawInspector?new Le([c.CONSTANT_COLOR,c.ONE],new p.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Le.unblended:Le.alphaBlended},Aa.prototype.depthModeForSublayer=function(c,o,i){if(!this.opaquePassEnabledForLayer())return Y.disabled;var h=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new Y(i||this.context.gl.LEQUAL,o,[h,h])},Aa.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Aa.prototype.render=function(c,o){var i=this;this.style=c,this.options=o,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(p.browser.now()),this.imageManager.beginFrame();var h=this.style._order,g=this.style.sourceCaches;for(var E in g){var C=g[E];C.used&&C.prepare(this.context)}var L,Z,q={},de={},ge={};for(var be in g){var Ke=g[be];q[be]=Ke.getVisibleCoordinates(),de[be]=q[be].slice().reverse(),ge[be]=Ke.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var He=0;He<h.length;He++)if(this.style._layers[h[He]].is3D()){this.opaquePassCutoff=He;break}this.renderPass="offscreen";for(var ut=0,We=h;ut<We.length;ut+=1){var et=this.style._layers[We[ut]];if(et.hasOffscreenPass()&&!et.isHidden(this.transform.zoom)){var Pt=de[et.source];(et.type==="custom"||Pt.length)&&this.renderLayer(this,g[et.source],et,Pt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?p.Color.black:p.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){var Mt=this.style._layers[h[this.currentLayer]],_r=g[Mt.source],nr=q[Mt.source];this._renderTileClippingMasks(Mt,nr),this.renderLayer(this,_r,Mt,nr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){var gr=this.style._layers[h[this.currentLayer]],Er=g[gr.source],tn=(gr.type==="symbol"?ge:de)[gr.source];this._renderTileClippingMasks(gr,q[gr.source]),this.renderLayer(this,Er,gr,tn)}this.options.showTileBoundaries&&(p.values(this.style._layers).forEach(function(Vr){Vr.source&&!Vr.isHidden(i.transform.zoom)&&(Vr.source!==(Z&&Z.id)&&(Z=i.style.sourceCaches[Vr.source]),(!L||L.getSource().maxzoom<Z.getSource().maxzoom)&&(L=Z))}),L&&Pu.debug(this,L,L.getVisibleCoordinates())),this.options.showPadding&&function(Vr){var mn=Vr.transform.padding;gc(Vr,Vr.transform.height-(mn.top||0),3,Bc),gc(Vr,mn.bottom||0,3,sf),jc(Vr,mn.left||0,3,Uc),jc(Vr,Vr.transform.width-(mn.right||0),3,Pl);var Sn=Vr.transform.centerPoint;(function(Hn,ei,Ei,Ki){nl(Hn,ei-1,Ei-10,2,20,Ki),nl(Hn,ei-10,Ei-1,20,2,Ki)})(Vr,Sn.x,Vr.transform.height-Sn.y,Mo)}(this),this.context.setDefault()},Aa.prototype.renderLayer=function(c,o,i,h){i.isHidden(this.transform.zoom)||(i.type==="background"||i.type==="custom"||h.length)&&(this.id=i.id,this.gpuTimingStart(i),Pu[i.type](c,o,i,h,this.style.placement.variableOffsets),this.gpuTimingEnd())},Aa.prototype.gpuTimingStart=function(c){if(this.options.gpuTiming){var o=this.context.extTimerQuery,i=this.gpuTimers[c.id];i||(i=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:o.createQueryEXT()}),i.calls++,o.beginQueryEXT(o.TIME_ELAPSED_EXT,i.query)}},Aa.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}},Aa.prototype.collectGpuTimers=function(){var c=this.gpuTimers;return this.gpuTimers={},c},Aa.prototype.queryGpuTimers=function(c){var o={};for(var i in c){var h=c[i],g=this.context.extTimerQuery,E=g.getQueryObjectEXT(h.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(h.query),o[i]=E}return o},Aa.prototype.translatePosMatrix=function(c,o,i,h,g){if(!i[0]&&!i[1])return c;var E=g?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(E){var C=Math.sin(E),L=Math.cos(E);i=[i[0]*L-i[1]*C,i[0]*C+i[1]*L]}var Z=[g?i[0]:ta(o,i[0],this.transform.zoom),g?i[1]:ta(o,i[1],this.transform.zoom),0],q=new Float32Array(16);return p.translate(q,c,Z),q},Aa.prototype.saveTileTexture=function(c){var o=this._tileTextures[c.size[0]];o?o.push(c):this._tileTextures[c.size[0]]=[c]},Aa.prototype.getTileTexture=function(c){var o=this._tileTextures[c];return o&&o.length>0?o.pop():null},Aa.prototype.isPatternMissing=function(c){if(!c)return!1;if(!c.from||!c.to)return!0;var o=this.imageManager.getPattern(c.from.toString()),i=this.imageManager.getPattern(c.to.toString());return!o||!i},Aa.prototype.useProgram=function(c,o){this.cache=this.cache||{};var i=""+c+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=new rh(this.context,c,zu[c],o,Kl[c],this._showOverdrawInspector)),this.cache[i]},Aa.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Aa.prototype.setBaseState=function(){var c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)},Aa.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=p.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new p.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Aa.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Jl=function(o,i){this.points=o,this.planes=i};Jl.fromInvProjectionMatrix=function(c,o,i){var h=Math.pow(2,i),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(C){return p.transformMat4([],C,c)}).map(function(C){return p.scale$1([],C,1/C[3]/o*h)}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(C){var L=p.sub([],g[C[0]],g[C[1]]),Z=p.sub([],g[C[2]],g[C[1]]),q=p.normalize([],p.cross([],L,Z)),de=-p.dot(q,g[C[1]]);return q.concat(de)});return new Jl(g,E)};var Bu=function(o,i){this.min=o,this.max=i,this.center=p.scale$2([],p.add([],this.min,this.max),.5)};Bu.prototype.quadrant=function(c){for(var o=[c%2==0,c<2],i=p.clone$2(this.min),h=p.clone$2(this.max),g=0;g<o.length;g++)i[g]=o[g]?this.min[g]:this.center[g],h[g]=o[g]?this.center[g]:this.max[g];return h[2]=this.max[2],new Bu(i,h)},Bu.prototype.distanceX=function(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]},Bu.prototype.distanceY=function(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]},Bu.prototype.intersects=function(c){for(var o=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,h=0;h<c.planes.length;h++){for(var g=c.planes[h],E=0,C=0;C<o.length;C++)E+=p.dot$1(g,o[C])>=0;if(E===0)return 0;E!==o.length&&(i=!1)}if(i)return 2;for(var L=0;L<3;L++){for(var Z=Number.MAX_VALUE,q=-Number.MAX_VALUE,de=0;de<c.points.length;de++){var ge=c.points[de][L]-this.min[L];Z=Math.min(Z,ge),q=Math.max(q,ge)}if(q<0||Z>this.max[L]-this.min[L])return 0}return 1};var il=function(o,i,h,g){if(o===void 0&&(o=0),i===void 0&&(i=0),h===void 0&&(h=0),g===void 0&&(g=0),isNaN(o)||o<0||isNaN(i)||i<0||isNaN(h)||h<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=i,this.left=h,this.right=g};il.prototype.interpolate=function(c,o,i){return o.top!=null&&c.top!=null&&(this.top=p.number(c.top,o.top,i)),o.bottom!=null&&c.bottom!=null&&(this.bottom=p.number(c.bottom,o.bottom,i)),o.left!=null&&c.left!=null&&(this.left=p.number(c.left,o.left,i)),o.right!=null&&c.right!=null&&(this.right=p.number(c.right,o.right,i)),this},il.prototype.getCenter=function(c,o){var i=p.clamp((this.left+c-this.right)/2,0,c),h=p.clamp((this.top+o-this.bottom)/2,0,o);return new p.Point(i,h)},il.prototype.equals=function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right},il.prototype.clone=function(){return new il(this.top,this.bottom,this.left,this.right)},il.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var ji=function(o,i,h,g,E){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=E===void 0||E,this._minZoom=o||0,this._maxZoom=i||22,this._minPitch=h==null?0:h,this._maxPitch=g==null?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new p.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new il,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ea={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};ji.prototype.clone=function(){var c=new ji(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c},Ea.minZoom.get=function(){return this._minZoom},Ea.minZoom.set=function(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))},Ea.maxZoom.get=function(){return this._maxZoom},Ea.maxZoom.set=function(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))},Ea.minPitch.get=function(){return this._minPitch},Ea.minPitch.set=function(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))},Ea.maxPitch.get=function(){return this._maxPitch},Ea.maxPitch.set=function(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))},Ea.renderWorldCopies.get=function(){return this._renderWorldCopies},Ea.renderWorldCopies.set=function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c},Ea.worldSize.get=function(){return this.tileSize*this.scale},Ea.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ea.size.get=function(){return new p.Point(this.width,this.height)},Ea.bearing.get=function(){return-this.angle/Math.PI*180},Ea.bearing.set=function(c){var o=-p.wrap(c,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=p.create$2(),p.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ea.pitch.get=function(){return this._pitch/Math.PI*180},Ea.pitch.set=function(c){var o=p.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())},Ea.fov.get=function(){return this._fov/Math.PI*180},Ea.fov.set=function(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())},Ea.zoom.get=function(){return this._zoom},Ea.zoom.set=function(c){var o=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom,this._constrain(),this._calcMatrices())},Ea.center.get=function(){return this._center},Ea.center.set=function(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())},Ea.padding.get=function(){return this._edgeInsets.toJSON()},Ea.padding.set=function(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())},Ea.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},ji.prototype.isPaddingEqual=function(c){return this._edgeInsets.equals(c)},ji.prototype.interpolatePadding=function(c,o,i){this._unmodified=!1,this._edgeInsets.interpolate(c,o,i),this._constrain(),this._calcMatrices()},ji.prototype.coveringZoomLevel=function(c){var o=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,o)},ji.prototype.getVisibleUnwrappedCoordinates=function(c){var o=[new p.UnwrappedTileID(0,c)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new p.Point(0,0)),h=this.pointCoordinate(new p.Point(this.width,0)),g=this.pointCoordinate(new p.Point(this.width,this.height)),E=this.pointCoordinate(new p.Point(0,this.height)),C=Math.floor(Math.min(i.x,h.x,g.x,E.x)),L=Math.floor(Math.max(i.x,h.x,g.x,E.x)),Z=C-1;Z<=L+1;Z++)Z!==0&&o.push(new p.UnwrappedTileID(Z,c));return o},ji.prototype.coveringTiles=function(c){var o=this.coveringZoomLevel(c),i=o;if(c.minzoom!==void 0&&o<c.minzoom)return[];c.maxzoom!==void 0&&o>c.maxzoom&&(o=c.maxzoom);var h=p.MercatorCoordinate.fromLngLat(this.center),g=Math.pow(2,o),E=[g*h.x,g*h.y,0],C=Jl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o),L=c.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(L=o);var Z=function(mn){return{aabb:new Bu([mn*g,0,0],[(mn+1)*g,g,0]),zoom:0,x:0,y:0,wrap:mn,fullyVisible:!1}},q=[],de=[],ge=o,be=c.reparseOverscaled?i:o;if(this._renderWorldCopies)for(var Ke=1;Ke<=3;Ke++)q.push(Z(-Ke)),q.push(Z(Ke));for(q.push(Z(0));q.length>0;){var He=q.pop(),ut=He.x,We=He.y,et=He.fullyVisible;if(!et){var Pt=He.aabb.intersects(C);if(Pt===0)continue;et=Pt===2}var Mt=He.aabb.distanceX(E),_r=He.aabb.distanceY(E),nr=Math.max(Math.abs(Mt),Math.abs(_r));if(He.zoom===ge||nr>3+(1<<ge-He.zoom)-2&&He.zoom>=L)de.push({tileID:new p.OverscaledTileID(He.zoom===ge?be:He.zoom,He.wrap,He.zoom,ut,We),distanceSq:p.sqrLen([E[0]-.5-ut,E[1]-.5-We])});else for(var gr=0;gr<4;gr++){var Er=(ut<<1)+gr%2,tn=(We<<1)+(gr>>1);q.push({aabb:He.aabb.quadrant(gr),zoom:He.zoom+1,x:Er,y:tn,wrap:He.wrap,fullyVisible:et})}}return de.sort(function(Vr,mn){return Vr.distanceSq-mn.distanceSq}).map(function(Vr){return Vr.tileID})},ji.prototype.resize=function(c,o){this.width=c,this.height=o,this.pixelsToGLUnits=[2/c,-2/o],this._constrain(),this._calcMatrices()},Ea.unmodified.get=function(){return this._unmodified},ji.prototype.zoomScale=function(c){return Math.pow(2,c)},ji.prototype.scaleZoom=function(c){return Math.log(c)/Math.LN2},ji.prototype.project=function(c){var o=p.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new p.Point(p.mercatorXfromLng(c.lng)*this.worldSize,p.mercatorYfromLat(o)*this.worldSize)},ji.prototype.unproject=function(c){return new p.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()},Ea.point.get=function(){return this.project(this.center)},ji.prototype.setLocationAtPoint=function(c,o){var i=this.pointCoordinate(o),h=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(c),E=new p.MercatorCoordinate(g.x-(i.x-h.x),g.y-(i.y-h.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())},ji.prototype.locationPoint=function(c){return this.coordinatePoint(this.locationCoordinate(c))},ji.prototype.pointLocation=function(c){return this.coordinateLocation(this.pointCoordinate(c))},ji.prototype.locationCoordinate=function(c){return p.MercatorCoordinate.fromLngLat(c)},ji.prototype.coordinateLocation=function(c){return c.toLngLat()},ji.prototype.pointCoordinate=function(c){var o=[c.x,c.y,0,1],i=[c.x,c.y,1,1];p.transformMat4(o,o,this.pixelMatrixInverse),p.transformMat4(i,i,this.pixelMatrixInverse);var h=o[3],g=i[3],E=o[1]/h,C=i[1]/g,L=o[2]/h,Z=i[2]/g,q=L===Z?0:(0-L)/(Z-L);return new p.MercatorCoordinate(p.number(o[0]/h,i[0]/g,q)/this.worldSize,p.number(E,C,q)/this.worldSize)},ji.prototype.coordinatePoint=function(c){var o=[c.x*this.worldSize,c.y*this.worldSize,0,1];return p.transformMat4(o,o,this.pixelMatrix),new p.Point(o[0]/o[3],o[1]/o[3])},ji.prototype.getBounds=function(){return new p.LngLatBounds().extend(this.pointLocation(new p.Point(0,0))).extend(this.pointLocation(new p.Point(this.width,0))).extend(this.pointLocation(new p.Point(this.width,this.height))).extend(this.pointLocation(new p.Point(0,this.height)))},ji.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new p.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},ji.prototype.setMaxBounds=function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},ji.prototype.calculatePosMatrix=function(c,o){o===void 0&&(o=!1);var i=c.key,h=o?this._alignedPosMatrixCache:this._posMatrixCache;if(h[i])return h[i];var g=c.canonical,E=this.worldSize/this.zoomScale(g.z),C=g.x+Math.pow(2,g.z)*c.wrap,L=p.identity(new Float64Array(16));return p.translate(L,L,[C*E,g.y*E,0]),p.scale(L,L,[E/p.EXTENT,E/p.EXTENT,1]),p.multiply(L,o?this.alignedProjMatrix:this.projMatrix,L),h[i]=new Float32Array(L),h[i]},ji.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},ji.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var c,o,i,h,g=-90,E=90,C=-180,L=180,Z=this.size,q=this._unmodified;if(this.latRange){var de=this.latRange;g=p.mercatorYfromLat(de[1])*this.worldSize,c=(E=p.mercatorYfromLat(de[0])*this.worldSize)-g<Z.y?Z.y/(E-g):0}if(this.lngRange){var ge=this.lngRange;C=p.mercatorXfromLng(ge[0])*this.worldSize,o=(L=p.mercatorXfromLng(ge[1])*this.worldSize)-C<Z.x?Z.x/(L-C):0}var be=this.point,Ke=Math.max(o||0,c||0);if(Ke)return this.center=this.unproject(new p.Point(o?(L+C)/2:be.x,c?(E+g)/2:be.y)),this.zoom+=this.scaleZoom(Ke),this._unmodified=q,void(this._constraining=!1);if(this.latRange){var He=be.y,ut=Z.y/2;He-ut<g&&(h=g+ut),He+ut>E&&(h=E-ut)}if(this.lngRange){var We=be.x,et=Z.x/2;We-et<C&&(i=C+et),We+et>L&&(i=L-et)}i===void 0&&h===void 0||(this.center=this.unproject(new p.Point(i!==void 0?i:be.x,h!==void 0?h:be.y))),this._unmodified=q,this._constraining=!1}},ji.prototype._calcMatrices=function(){if(this.height){var c=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var o=Math.PI/2+this._pitch,i=this._fov*(.5+c.y/this.height),h=Math.sin(i)*this.cameraToCenterDistance/Math.sin(p.clamp(Math.PI-o-i,.01,Math.PI-.01)),g=this.point,E=g.x,C=g.y,L=1.01*(Math.cos(Math.PI/2-this._pitch)*h+this.cameraToCenterDistance),Z=this.height/50,q=new Float64Array(16);p.perspective(q,this._fov,this.width/this.height,Z,L),q[8]=2*-c.x/this.width,q[9]=2*c.y/this.height,p.scale(q,q,[1,-1,1]),p.translate(q,q,[0,0,-this.cameraToCenterDistance]),p.rotateX(q,q,this._pitch),p.rotateZ(q,q,this.angle),p.translate(q,q,[-E,-C,0]),this.mercatorMatrix=p.scale([],q,[this.worldSize,this.worldSize,this.worldSize]),p.scale(q,q,[1,1,p.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=q,this.invProjMatrix=p.invert([],this.projMatrix);var de=this.width%2/2,ge=this.height%2/2,be=Math.cos(this.angle),Ke=Math.sin(this.angle),He=E-Math.round(E)+be*de+Ke*ge,ut=C-Math.round(C)+be*ge+Ke*de,We=new Float64Array(q);if(p.translate(We,We,[He>.5?He-1:He,ut>.5?ut-1:ut,0]),this.alignedProjMatrix=We,q=p.create(),p.scale(q,q,[this.width/2,-this.height/2,1]),p.translate(q,q,[1,-1,0]),this.labelPlaneMatrix=q,q=p.create(),p.scale(q,q,[1,-1,1]),p.translate(q,q,[-1,-1,0]),p.scale(q,q,[2/this.width,2/this.height,1]),this.glCoordMatrix=q,this.pixelMatrix=p.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(q=p.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=q,this._posMatrixCache={},this._alignedPosMatrixCache={}}},ji.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new p.Point(0,0)),o=[c.x*this.worldSize,c.y*this.worldSize,0,1];return p.transformMat4(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance},ji.prototype.getCameraPoint=function(){var c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new p.Point(0,c))},ji.prototype.getCameraQueryGeometry=function(c){var o=this.getCameraPoint();if(c.length===1)return[c[0],o];for(var i=o.x,h=o.y,g=o.x,E=o.y,C=0,L=c;C<L.length;C+=1){var Z=L[C];i=Math.min(i,Z.x),h=Math.min(h,Z.y),g=Math.max(g,Z.x),E=Math.max(E,Z.y)}return[new p.Point(i,h),new p.Point(g,h),new p.Point(g,E),new p.Point(i,E),new p.Point(i,h)]},Object.defineProperties(ji.prototype,Ea);var Gs=function(o){var i,h,g,E;this._hashName=o&&encodeURIComponent(o),p.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(i=this._updateHashUnthrottled.bind(this),h=!1,g=null,E=function(){g=null,h&&(i(),g=setTimeout(E,300),h=!1)},function(){return h=!0,g||E(),g})};Gs.prototype.addTo=function(c){return this._map=c,p.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Gs.prototype.remove=function(){return p.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Gs.prototype.getHashString=function(c){var o=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,h=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,h),E=Math.round(o.lng*g)/g,C=Math.round(o.lat*g)/g,L=this._map.getBearing(),Z=this._map.getPitch(),q="";if(q+=c?"/"+E+"/"+C+"/"+i:i+"/"+C+"/"+E,(L||Z)&&(q+="/"+Math.round(10*L)/10),Z&&(q+="/"+Math.round(Z)),this._hashName){var de=this._hashName,ge=!1,be=p.window.location.hash.slice(1).split("&").map(function(Ke){var He=Ke.split("=")[0];return He===de?(ge=!0,He+"="+q):Ke}).filter(function(Ke){return Ke});return ge||be.push(de+"="+q),"#"+be.join("&")}return"#"+q},Gs.prototype._getCurrentHash=function(){var c,o=this,i=p.window.location.hash.replace("#","");return this._hashName?(i.split("&").map(function(h){return h.split("=")}).forEach(function(h){h[0]===o._hashName&&(c=h)}),(c&&c[1]||"").split("/")):i.split("/")},Gs.prototype._onHashChange=function(){var c=this._getCurrentHash();if(c.length>=3&&!c.some(function(i){return isNaN(i)})){var o=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:o,pitch:+(c[4]||0)}),!0}return!1},Gs.prototype._updateHashUnthrottled=function(){var c=p.window.location.href.replace(/(#.+)?$/,this.getHashString());try{p.window.history.replaceState(p.window.history.state,null,c)}catch(o){}};var Ql={linearity:.3,easing:p.bezier(0,0,.3,1)},kl=p.extend({deceleration:2500,maxSpeed:1400},Ql),ql=p.extend({deceleration:20,maxSpeed:1400},Ql),Sf=p.extend({deceleration:1e3,maxSpeed:360},Ql),Ff=p.extend({deceleration:1e3,maxSpeed:90},Ql),ec=function(o){this._map=o,this.clear()};function al(c,o){(!c.duration||c.duration<o.duration)&&(c.duration=o.duration,c.easing=o.easing)}function ol(c,o,i){var h=i.maxSpeed,g=i.linearity,E=i.deceleration,C=p.clamp(c*g/(o/1e3),-h,h),L=Math.abs(C)/(E*g);return{easing:i.easing,duration:1e3*L,amount:C*(L/2)}}ec.prototype.clear=function(){this._inertiaBuffer=[]},ec.prototype.record=function(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:p.browser.now(),settings:c})},ec.prototype._drainInertiaBuffer=function(){for(var c=this._inertiaBuffer,o=p.browser.now();c.length>0&&o-c[0].time>160;)c.shift()},ec.prototype._onMoveEnd=function(c){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var o={zoom:0,bearing:0,pitch:0,pan:new p.Point(0,0),pinchAround:void 0,around:void 0},i=0,h=this._inertiaBuffer;i<h.length;i+=1){var g=h[i].settings;o.zoom+=g.zoomDelta||0,o.bearing+=g.bearingDelta||0,o.pitch+=g.pitchDelta||0,g.panDelta&&o.pan._add(g.panDelta),g.around&&(o.around=g.around),g.pinchAround&&(o.pinchAround=g.pinchAround)}var E=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(o.pan.mag()){var L=ol(o.pan.mag(),E,p.extend({},kl,c||{}));C.offset=o.pan.mult(L.amount/o.pan.mag()),C.center=this._map.transform.center,al(C,L)}if(o.zoom){var Z=ol(o.zoom,E,ql);C.zoom=this._map.transform.zoom+Z.amount,al(C,Z)}if(o.bearing){var q=ol(o.bearing,E,Sf);C.bearing=this._map.transform.bearing+p.clamp(q.amount,-179,179),al(C,q)}if(o.pitch){var de=ol(o.pitch,E,Ff);C.pitch=this._map.transform.pitch+de.amount,al(C,de)}if(C.zoom||C.bearing){var ge=o.pinchAround===void 0?o.around:o.pinchAround;C.around=ge?this._map.unproject(ge):this._map.getCenter()}return this.clear(),p.extend(C,{noMoveStart:!0})}};var Ka=function(c){function o(h,g,E,C){C===void 0&&(C={});var L=S.mousePos(g.getCanvasContainer(),E),Z=g.unproject(L);c.call(this,h,p.extend({point:L,lngLat:Z,originalEvent:E},C)),this._defaultPrevented=!1,this.target=g}c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(p.Event),xs=function(c){function o(h,g,E){var C=h==="touchend"?E.changedTouches:E.touches,L=S.touchPos(g.getCanvasContainer(),C),Z=L.map(function(ge){return g.unproject(ge)}),q=L.reduce(function(ge,be,Ke,He){return ge.add(be.div(He.length))},new p.Point(0,0)),de=g.unproject(q);c.call(this,h,{points:L,point:q,lngLats:Z,lngLat:de,originalEvent:E}),this._defaultPrevented=!1}c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(p.Event),Fl=function(c){function o(h,g,E){c.call(this,h,{originalEvent:E}),this._defaultPrevented=!1}c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(p.Event),io=function(o,i){this._map=o,this._clickTolerance=i.clickTolerance};io.prototype.reset=function(){delete this._mousedownPos},io.prototype.wheel=function(c){return this._firePreventable(new Fl(c.type,this._map,c))},io.prototype.mousedown=function(c,o){return this._mousedownPos=o,this._firePreventable(new Ka(c.type,this._map,c))},io.prototype.mouseup=function(c){this._map.fire(new Ka(c.type,this._map,c))},io.prototype.click=function(c,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Ka(c.type,this._map,c))},io.prototype.dblclick=function(c){return this._firePreventable(new Ka(c.type,this._map,c))},io.prototype.mouseover=function(c){this._map.fire(new Ka(c.type,this._map,c))},io.prototype.mouseout=function(c){this._map.fire(new Ka(c.type,this._map,c))},io.prototype.touchstart=function(c){return this._firePreventable(new xs(c.type,this._map,c))},io.prototype.touchmove=function(c){this._map.fire(new xs(c.type,this._map,c))},io.prototype.touchend=function(c){this._map.fire(new xs(c.type,this._map,c))},io.prototype.touchcancel=function(c){this._map.fire(new xs(c.type,this._map,c))},io.prototype._firePreventable=function(c){if(this._map.fire(c),c.defaultPrevented)return{}},io.prototype.isEnabled=function(){return!0},io.prototype.isActive=function(){return!1},io.prototype.enable=function(){},io.prototype.disable=function(){};var En=function(o){this._map=o};En.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},En.prototype.mousemove=function(c){this._map.fire(new Ka(c.type,this._map,c))},En.prototype.mousedown=function(){this._delayContextMenu=!0},En.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ka("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},En.prototype.contextmenu=function(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new Ka(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()},En.prototype.isEnabled=function(){return!0},En.prototype.isActive=function(){return!1},En.prototype.enable=function(){},En.prototype.disable=function(){};var Ps=function(o,i){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=i.clickTolerance||1};function tc(c,o){for(var i={},h=0;h<c.length;h++)i[c[h].identifier]=o[h];return i}Ps.prototype.isEnabled=function(){return!!this._enabled},Ps.prototype.isActive=function(){return!!this._active},Ps.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ps.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ps.prototype.mousedown=function(c,o){this.isEnabled()&&c.shiftKey&&c.button===0&&(S.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)},Ps.prototype.mousemoveWindow=function(c,o){if(this._active){var i=o;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var h=this._startPos;this._lastPos=i,this._box||(this._box=S.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));var g=Math.min(h.x,i.x),E=Math.max(h.x,i.x),C=Math.min(h.y,i.y),L=Math.max(h.y,i.y);S.setTransform(this._box,"translate("+g+"px,"+C+"px)"),this._box.style.width=E-g+"px",this._box.style.height=L-C+"px"}}},Ps.prototype.mouseupWindow=function(c,o){var i=this;if(this._active&&c.button===0){var h=this._startPos,g=o;if(this.reset(),S.suppressClick(),h.x!==g.x||h.y!==g.y)return this._map.fire(new p.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:function(C){return C.fitScreenCoordinates(h,g,i._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",c)}},Ps.prototype.keydown=function(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))},Ps.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(S.remove(this._box),this._box=null),S.enableDrag(),delete this._startPos,delete this._lastPos},Ps.prototype._fireEvent=function(c,o){return this._map.fire(new p.Event(c,{originalEvent:o}))};var Mu=function(o){this.reset(),this.numTouches=o.numTouches};Mu.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Mu.prototype.touchstart=function(c,o,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),i.length===this.numTouches&&(this.centroid=function(h){for(var g=new p.Point(0,0),E=0,C=h;E<C.length;E+=1)g._add(C[E]);return g.div(h.length)}(o),this.touches=tc(i,o)))},Mu.prototype.touchmove=function(c,o,i){if(!this.aborted&&this.centroid){var h=tc(i,o);for(var g in this.touches){var E=h[g];(!E||E.dist(this.touches[g])>30)&&(this.aborted=!0)}}},Mu.prototype.touchend=function(c,o,i){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),i.length===0){var h=!this.aborted&&this.centroid;if(this.reset(),h)return h}};var ru=function(o){this.singleTap=new Mu(o),this.numTaps=o.numTaps,this.reset()};ru.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ru.prototype.touchstart=function(c,o,i){this.singleTap.touchstart(c,o,i)},ru.prototype.touchmove=function(c,o,i){this.singleTap.touchmove(c,o,i)},ru.prototype.touchend=function(c,o,i){var h=this.singleTap.touchend(c,o,i);if(h){var g=c.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(h)<30;if(g&&E||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}};var Hs=function(){this._zoomIn=new ru({numTouches:1,numTaps:2}),this._zoomOut=new ru({numTouches:2,numTaps:1}),this.reset()};Hs.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Hs.prototype.touchstart=function(c,o,i){this._zoomIn.touchstart(c,o,i),this._zoomOut.touchstart(c,o,i)},Hs.prototype.touchmove=function(c,o,i){this._zoomIn.touchmove(c,o,i),this._zoomOut.touchmove(c,o,i)},Hs.prototype.touchend=function(c,o,i){var h=this,g=this._zoomIn.touchend(c,o,i),E=this._zoomOut.touchend(c,o,i);return g?(this._active=!0,c.preventDefault(),setTimeout(function(){return h.reset()},0),{cameraAnimation:function(L){return L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(g)},{originalEvent:c})}}):E?(this._active=!0,c.preventDefault(),setTimeout(function(){return h.reset()},0),{cameraAnimation:function(L){return L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(E)},{originalEvent:c})}}):void 0},Hs.prototype.touchcancel=function(){this.reset()},Hs.prototype.enable=function(){this._enabled=!0},Hs.prototype.disable=function(){this._enabled=!1,this.reset()},Hs.prototype.isEnabled=function(){return this._enabled},Hs.prototype.isActive=function(){return this._active};var sl={0:1,2:2},Qr=function(o){this.reset(),this._clickTolerance=o.clickTolerance||1};Qr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Qr.prototype._correctButton=function(c,o){return!1},Qr.prototype._move=function(c,o){return{}},Qr.prototype.mousedown=function(c,o){if(!this._lastPoint){var i=S.mouseButton(c);this._correctButton(c,i)&&(this._lastPoint=o,this._eventButton=i)}},Qr.prototype.mousemoveWindow=function(c,o){var i=this._lastPoint;if(i){if(c.preventDefault(),function(h,g){var E=sl[g];return h.buttons===void 0||(h.buttons&E)!==E}(c,this._eventButton))this.reset();else if(this._moved||!(o.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(i,o)}},Qr.prototype.mouseupWindow=function(c){this._lastPoint&&S.mouseButton(c)===this._eventButton&&(this._moved&&S.suppressClick(),this.reset())},Qr.prototype.enable=function(){this._enabled=!0},Qr.prototype.disable=function(){this._enabled=!1,this.reset()},Qr.prototype.isEnabled=function(){return this._enabled},Qr.prototype.isActive=function(){return this._active};var Ms=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.mousedown=function(i,h){c.prototype.mousedown.call(this,i,h),this._lastPoint&&(this._active=!0)},o.prototype._correctButton=function(i,h){return h===0&&!i.ctrlKey},o.prototype._move=function(i,h){return{around:h,panDelta:h.sub(i)}},o}(Qr),Iu=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype._correctButton=function(i,h){return h===0&&i.ctrlKey||h===2},o.prototype._move=function(i,h){var g=.8*(h.x-i.x);if(g)return this._active=!0,{bearingDelta:g}},o.prototype.contextmenu=function(i){i.preventDefault()},o}(Qr),Is=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype._correctButton=function(i,h){return h===0&&i.ctrlKey||h===2},o.prototype._move=function(i,h){var g=-.5*(h.y-i.y);if(g)return this._active=!0,{pitchDelta:g}},o.prototype.contextmenu=function(i){i.preventDefault()},o}(Qr),ls=function(o){this._minTouches=1,this._clickTolerance=o.clickTolerance||1,this.reset()};ls.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new p.Point(0,0)},ls.prototype.touchstart=function(c,o,i){return this._calculateTransform(c,o,i)},ls.prototype.touchmove=function(c,o,i){if(this._active&&!(i.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,o,i)},ls.prototype.touchend=function(c,o,i){this._calculateTransform(c,o,i),this._active&&i.length<this._minTouches&&this.reset()},ls.prototype.touchcancel=function(){this.reset()},ls.prototype._calculateTransform=function(c,o,i){i.length>0&&(this._active=!0);var h=tc(i,o),g=new p.Point(0,0),E=new p.Point(0,0),C=0;for(var L in h){var Z=h[L],q=this._touches[L];q&&(g._add(Z),E._add(Z.sub(q)),C++,h[L]=Z)}if(this._touches=h,!(C<this._minTouches)&&E.mag()){var de=E.div(C);if(this._sum._add(de),!(this._sum.mag()<this._clickTolerance))return{around:g.div(C),panDelta:de}}},ls.prototype.enable=function(){this._enabled=!0},ls.prototype.disable=function(){this._enabled=!1,this.reset()},ls.prototype.isEnabled=function(){return this._enabled},ls.prototype.isActive=function(){return this._active};var bs=function(){this.reset()};function yc(c,o,i){for(var h=0;h<c.length;h++)if(c[h].identifier===i)return o[h]}function _c(c,o){return Math.log(c/o)/Math.LN2}bs.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},bs.prototype._start=function(c){},bs.prototype._move=function(c,o,i){return{}},bs.prototype.touchstart=function(c,o,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([o[0],o[1]]))},bs.prototype.touchmove=function(c,o,i){if(this._firstTwoTouches){c.preventDefault();var h=this._firstTwoTouches,g=h[1],E=yc(i,o,h[0]),C=yc(i,o,g);if(E&&C){var L=this._aroundCenter?null:E.add(C).div(2);return this._move([E,C],L,c)}}},bs.prototype.touchend=function(c,o,i){if(this._firstTwoTouches){var h=this._firstTwoTouches,g=h[1],E=yc(i,o,h[0]),C=yc(i,o,g);E&&C||(this._active&&S.suppressClick(),this.reset())}},bs.prototype.touchcancel=function(){this.reset()},bs.prototype.enable=function(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"},bs.prototype.disable=function(){this._enabled=!1,this.reset()},bs.prototype.isEnabled=function(){return this._enabled},bs.prototype.isActive=function(){return this._active};var Os=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.reset=function(){c.prototype.reset.call(this),delete this._distance,delete this._startDistance},o.prototype._start=function(i){this._startDistance=this._distance=i[0].dist(i[1])},o.prototype._move=function(i,h){var g=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(_c(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_c(this._distance,g),pinchAround:h}},o}(bs);function Uu(c,o){return 180*c.angleWith(o)/Math.PI}var vu=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.reset=function(){c.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},o.prototype._start=function(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])},o.prototype._move=function(i,h){var g=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Uu(this._vector,g),pinchAround:h}},o.prototype._isBelowThreshold=function(i){this._minDiameter=Math.min(this._minDiameter,i.mag());var h=25/(Math.PI*this._minDiameter)*360,g=Uu(i,this._startVector);return Math.abs(g)<h},o}(bs);function nu(c){return Math.abs(c.y)>Math.abs(c.x)}var xc=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.reset=function(){c.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},o.prototype._start=function(i){this._lastPoints=i,nu(i[0].sub(i[1]))&&(this._valid=!1)},o.prototype._move=function(i,h,g){var E=i[0].sub(this._lastPoints[0]),C=i[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(E,C,g.timeStamp),this._valid)return this._lastPoints=i,this._active=!0,{pitchDelta:(E.y+C.y)/2*-.5}},o.prototype.gestureBeginsVertically=function(i,h,g){if(this._valid!==void 0)return this._valid;var E=i.mag()>=2,C=h.mag()>=2;if(E||C){if(!E||!C)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;var L=i.y>0==h.y>0;return nu(i)&&nu(h)&&L}},o}(bs),rc={panStep:100,bearingStep:15,pitchStep:10},iu=function(){var o=rc;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1};function Ls(c){return c*(2-c)}iu.prototype.reset=function(){this._active=!1},iu.prototype.keydown=function(c){var o=this;if(!(c.altKey||c.ctrlKey||c.metaKey)){var i=0,h=0,g=0,E=0,C=0;switch(c.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:c.shiftKey?h=-1:(c.preventDefault(),E=-1);break;case 39:c.shiftKey?h=1:(c.preventDefault(),E=1);break;case 38:c.shiftKey?g=1:(c.preventDefault(),C=-1);break;case 40:c.shiftKey?g=-1:(c.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(h=0,g=0),{cameraAnimation:function(Z){var q=Z.getZoom();Z.easeTo({duration:300,easeId:"keyboardHandler",easing:Ls,zoom:i?Math.round(q)+i*(c.shiftKey?2:1):q,bearing:Z.getBearing()+h*o._bearingStep,pitch:Z.getPitch()+g*o._pitchStep,offset:[-E*o._panStep,-C*o._panStep],center:Z.getCenter()},{originalEvent:c})}}}},iu.prototype.enable=function(){this._enabled=!0},iu.prototype.disable=function(){this._enabled=!1,this.reset()},iu.prototype.isEnabled=function(){return this._enabled},iu.prototype.isActive=function(){return this._active},iu.prototype.disableRotation=function(){this._rotationDisabled=!0},iu.prototype.enableRotation=function(){this._rotationDisabled=!1};var Di=function(o,i){this._map=o,this._el=o.getCanvasContainer(),this._handler=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,p.bindAll(["_onTimeout"],this)};Di.prototype.setZoomRate=function(c){this._defaultZoomRate=c},Di.prototype.setWheelZoomRate=function(c){this._wheelZoomRate=c},Di.prototype.isEnabled=function(){return!!this._enabled},Di.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Di.prototype.isZooming=function(){return!!this._zooming},Di.prototype.enable=function(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")},Di.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Di.prototype.wheel=function(c){if(this.isEnabled()){var o=c.deltaMode===p.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY,i=p.browser.now(),h=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,o!==0&&o%4.000244140625==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(h*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),c.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=c,this._delta-=o,this._active||this._start(c)),c.preventDefault()}},Di.prototype._onTimeout=function(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},Di.prototype._start=function(c){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var o=S.mousePos(this._el,c);this._around=p.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(o)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Di.prototype.renderFrame=function(){var c=this;if(this._frameId&&(this._frameId=null,this.isActive())){var o=this._map.transform;if(this._delta!==0){var i=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,h=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&h!==0&&(h=1/h);var g=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(g*h))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var E,C=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,L=this._startZoom,Z=this._easing,q=!1;if(this._type==="wheel"&&L&&Z){var de=Math.min((p.browser.now()-this._lastWheelEventTime)/200,1),ge=Z(de);E=p.number(L,C,ge),de<1?this._frameId||(this._frameId=!0):q=!0}else E=C,q=!0;return this._active=!0,q&&(this._active=!1,this._finishTimeout=setTimeout(function(){c._zooming=!1,c._handler._triggerRenderFrame(),delete c._targetZoom,delete c._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!q,zoomDelta:E-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Di.prototype._smoothOutEasing=function(c){var o=p.ease;if(this._prevEase){var i=this._prevEase,h=(p.browser.now()-i.start)/i.duration,g=i.easing(h+.01)-i.easing(h),E=.27/Math.sqrt(g*g+1e-4)*.01,C=Math.sqrt(.0729-E*E);o=p.bezier(E,C,.25,1)}return this._prevEase={start:p.browser.now(),duration:c,easing:o},o},Di.prototype.reset=function(){this._active=!1};var Ws=function(o,i){this._clickZoom=o,this._tapZoom=i};Ws.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ws.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ws.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ws.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Uo=function(){this.reset()};Uo.prototype.reset=function(){this._active=!1},Uo.prototype.dblclick=function(c,o){return c.preventDefault(),{cameraAnimation:function(h){h.easeTo({duration:300,zoom:h.getZoom()+(c.shiftKey?-1:1),around:h.unproject(o)},{originalEvent:c})}}},Uo.prototype.enable=function(){this._enabled=!0},Uo.prototype.disable=function(){this._enabled=!1,this.reset()},Uo.prototype.isEnabled=function(){return this._enabled},Uo.prototype.isActive=function(){return this._active};var vo=function(){this._tap=new ru({numTouches:1,numTaps:1}),this.reset()};vo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},vo.prototype.touchstart=function(c,o,i){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=o[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(c,o,i))},vo.prototype.touchmove=function(c,o,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;var h=o[0],g=h.y-this._swipePoint.y;return this._swipePoint=h,c.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(c,o,i)},vo.prototype.touchend=function(c,o,i){this._tapTime?this._swipePoint&&i.length===0&&this.reset():this._tap.touchend(c,o,i)&&(this._tapTime=c.timeStamp)},vo.prototype.touchcancel=function(){this.reset()},vo.prototype.enable=function(){this._enabled=!0},vo.prototype.disable=function(){this._enabled=!1,this.reset()},vo.prototype.isEnabled=function(){return this._enabled},vo.prototype.isActive=function(){return this._active};var ju=function(o,i,h){this._el=o,this._mousePan=i,this._touchPan=h};ju.prototype.enable=function(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ju.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ju.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ju.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ul=function(o,i,h){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=i,this._mousePitch=h};ul.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ul.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ul.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ul.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var mu=function(o,i,h,g){this._el=o,this._touchZoom=i,this._touchRotate=h,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};mu.prototype.enable=function(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},mu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},mu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},mu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},mu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},mu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var cs=function(o){return o.zoom||o.drag||o.pitch||o.rotate},zl=function(c){function o(){c.apply(this,arguments)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o}(p.Event);function Gn(c){return c.panDelta&&c.panDelta.mag()||c.zoomDelta||c.bearingDelta||c.pitchDelta}var Mn=function(o,i){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ec(o),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i),p.bindAll(["handleEvent","handleWindowEvent"],this);var h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[p.window.document,"mousemove",{capture:!0}],[p.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[p.window,"blur",void 0]];for(var g=0,E=this._listeners;g<E.length;g+=1){var C=E[g],L=C[0];S.addEventListener(L,C[1],L===p.window.document?this.handleWindowEvent:this.handleEvent,C[2])}};Mn.prototype.destroy=function(){for(var c=0,o=this._listeners;c<o.length;c+=1){var i=o[c],h=i[0];S.removeEventListener(h,i[1],h===p.window.document?this.handleWindowEvent:this.handleEvent,i[2])}},Mn.prototype._addDefaultHandlers=function(c){var o=this._map,i=o.getCanvasContainer();this._add("mapEvent",new io(o,c));var h=o.boxZoom=new Ps(o,c);this._add("boxZoom",h);var g=new Hs,E=new Uo;o.doubleClickZoom=new Ws(E,g),this._add("tapZoom",g),this._add("clickZoom",E);var C=new vo;this._add("tapDragZoom",C);var L=o.touchPitch=new xc;this._add("touchPitch",L);var Z=new Iu(c),q=new Is(c);o.dragRotate=new ul(c,Z,q),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",q,["mouseRotate"]);var de=new Ms(c),ge=new ls(c);o.dragPan=new ju(i,de,ge),this._add("mousePan",de),this._add("touchPan",ge,["touchZoom","touchRotate"]);var be=new vu,Ke=new Os;o.touchZoomRotate=new mu(i,Ke,be,C),this._add("touchRotate",be,["touchPan","touchZoom"]),this._add("touchZoom",Ke,["touchPan","touchRotate"]);var He=o.scrollZoom=new Di(o,this);this._add("scrollZoom",He,["mousePan"]);var ut=o.keyboard=new iu;this._add("keyboard",ut),this._add("blockableMapEvent",new En(o));for(var We=0,et=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];We<et.length;We+=1){var Pt=et[We];c.interactive&&c[Pt]&&o[Pt].enable(c[Pt])}},Mn.prototype._add=function(c,o,i){this._handlers.push({handlerName:c,handler:o,allowed:i}),this._handlersById[c]=o},Mn.prototype.stop=function(c){if(!this._updatingCamera){for(var o=0,i=this._handlers;o<i.length;o+=1)i[o].handler.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}},Mn.prototype.isActive=function(){for(var c=0,o=this._handlers;c<o.length;c+=1)if(o[c].handler.isActive())return!0;return!1},Mn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Mn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Mn.prototype.isMoving=function(){return Boolean(cs(this._eventsInProgress))||this.isZooming()},Mn.prototype._blockedByActive=function(c,o,i){for(var h in c)if(h!==i&&(!o||o.indexOf(h)<0))return!0;return!1},Mn.prototype.handleWindowEvent=function(c){this.handleEvent(c,c.type+"Window")},Mn.prototype._getMapTouches=function(c){for(var o=[],i=0,h=c;i<h.length;i+=1){var g=h[i];this._el.contains(g.target)&&o.push(g)}return o},Mn.prototype.handleEvent=function(c,o){if(c.type!=="blur"){this._updatingCamera=!0;for(var i=c.type==="renderFrame"?void 0:c,h={needsRenderFrame:!1},g={},E={},C=c.touches?this._getMapTouches(c.touches):void 0,L=C?S.touchPos(this._el,C):S.mousePos(this._el,c),Z=0,q=this._handlers;Z<q.length;Z+=1){var de=q[Z],ge=de.handlerName,be=de.handler,Ke=de.allowed;if(be.isEnabled()){var He=void 0;this._blockedByActive(E,Ke,ge)?be.reset():be[o||c.type]&&(He=be[o||c.type](c,L,C),this.mergeHandlerResult(h,g,He,ge,i),He&&He.needsRenderFrame&&this._triggerRenderFrame()),(He||be.isActive())&&(E[ge]=be)}}var ut={};for(var We in this._previousActiveHandlers)E[We]||(ut[We]=i);this._previousActiveHandlers=E,(Object.keys(ut).length||Gn(h))&&(this._changes.push([h,g,ut]),this._triggerRenderFrame()),(Object.keys(E).length||Gn(h))&&this._map._stop(!0),this._updatingCamera=!1;var et=h.cameraAnimation;et&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],et(this._map))}else this.stop(!0)},Mn.prototype.mergeHandlerResult=function(c,o,i,h,g){if(i){p.extend(c,i);var E={handlerName:h,originalEvent:i.originalEvent||g};i.zoomDelta!==void 0&&(o.zoom=E),i.panDelta!==void 0&&(o.drag=E),i.pitchDelta!==void 0&&(o.pitch=E),i.bearingDelta!==void 0&&(o.rotate=E)}},Mn.prototype._applyChanges=function(){for(var c={},o={},i={},h=0,g=this._changes;h<g.length;h+=1){var E=g[h],C=E[0],L=E[1],Z=E[2];C.panDelta&&(c.panDelta=(c.panDelta||new p.Point(0,0))._add(C.panDelta)),C.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+C.pitchDelta),C.around!==void 0&&(c.around=C.around),C.pinchAround!==void 0&&(c.pinchAround=C.pinchAround),C.noInertia&&(c.noInertia=C.noInertia),p.extend(o,L),p.extend(i,Z)}this._updateMapTransform(c,o,i),this._changes=[]},Mn.prototype._updateMapTransform=function(c,o,i){var h=this._map,g=h.transform;if(!Gn(c))return this._fireEvents(o,i,!0);var E=c.panDelta,C=c.zoomDelta,L=c.bearingDelta,Z=c.pitchDelta,q=c.around,de=c.pinchAround;de!==void 0&&(q=de),h._stop(!0),q=q||h.transform.centerPoint;var ge=g.pointLocation(E?q.sub(E):q);L&&(g.bearing+=L),Z&&(g.pitch+=Z),C&&(g.zoom+=C),g.setLocationAtPoint(ge,q),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(o,i,!0)},Mn.prototype._fireEvents=function(c,o,i){var h=this,g=cs(this._eventsInProgress),E=cs(c),C={};for(var L in c)this._eventsInProgress[L]||(C[L+"start"]=c[L].originalEvent),this._eventsInProgress[L]=c[L];for(var Z in!g&&E&&this._fireEvent("movestart",E.originalEvent),C)this._fireEvent(Z,C[Z]);for(var q in E&&this._fireEvent("move",E.originalEvent),c)this._fireEvent(q,c[q].originalEvent);var de,ge={};for(var be in this._eventsInProgress){var Ke=this._eventsInProgress[be],He=Ke.handlerName,ut=Ke.originalEvent;this._handlersById[He].isActive()||(delete this._eventsInProgress[be],ge[be+"end"]=de=o[He]||ut)}for(var We in ge)this._fireEvent(We,ge[We]);var et=cs(this._eventsInProgress);if(i&&(g||E)&&!et){this._updatingCamera=!0;var Pt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Mt=function(nr){return nr!==0&&-h._bearingSnap<nr&&nr<h._bearingSnap};Pt?(Mt(Pt.bearing||this._map.getBearing())&&(Pt.bearing=0),this._map.easeTo(Pt,{originalEvent:de})):(this._map.fire(new p.Event("moveend",{originalEvent:de})),Mt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Mn.prototype._fireEvent=function(c,o){this._map.fire(new p.Event(c,o?{originalEvent:o}:{}))},Mn.prototype._requestFrame=function(){var c=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(o){delete c._frameId,c.handleEvent(new zl("renderFrame",{timeStamp:o})),c._applyChanges()})},Mn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var ll=function(c){function o(i,h){c.call(this),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=h.bearingSnap,p.bindAll(["_renderFrameCallback"],this)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.getCenter=function(){return new p.LngLat(this.transform.center.lng,this.transform.center.lat)},o.prototype.setCenter=function(i,h){return this.jumpTo({center:i},h)},o.prototype.panBy=function(i,h,g){return i=p.Point.convert(i).mult(-1),this.panTo(this.transform.center,p.extend({offset:i},h),g)},o.prototype.panTo=function(i,h,g){return this.easeTo(p.extend({center:i},h),g)},o.prototype.getZoom=function(){return this.transform.zoom},o.prototype.setZoom=function(i,h){return this.jumpTo({zoom:i},h),this},o.prototype.zoomTo=function(i,h,g){return this.easeTo(p.extend({zoom:i},h),g)},o.prototype.zoomIn=function(i,h){return this.zoomTo(this.getZoom()+1,i,h),this},o.prototype.zoomOut=function(i,h){return this.zoomTo(this.getZoom()-1,i,h),this},o.prototype.getBearing=function(){return this.transform.bearing},o.prototype.setBearing=function(i,h){return this.jumpTo({bearing:i},h),this},o.prototype.getPadding=function(){return this.transform.padding},o.prototype.setPadding=function(i,h){return this.jumpTo({padding:i},h),this},o.prototype.rotateTo=function(i,h,g){return this.easeTo(p.extend({bearing:i},h),g)},o.prototype.resetNorth=function(i,h){return this.rotateTo(0,p.extend({duration:1e3},i),h),this},o.prototype.resetNorthPitch=function(i,h){return this.easeTo(p.extend({bearing:0,pitch:0,duration:1e3},i),h),this},o.prototype.snapToNorth=function(i,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,h):this},o.prototype.getPitch=function(){return this.transform.pitch},o.prototype.setPitch=function(i,h){return this.jumpTo({pitch:i},h),this},o.prototype.cameraForBounds=function(i,h){i=p.LngLatBounds.convert(i);var g=h&&h.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),g,h)},o.prototype._cameraForBoxAndBearing=function(i,h,g,E){var C={top:0,bottom:0,right:0,left:0};if(typeof(E=p.extend({padding:C,offset:[0,0],maxZoom:this.transform.maxZoom},E)).padding=="number"){var L=E.padding;E.padding={top:L,bottom:L,right:L,left:L}}E.padding=p.extend(C,E.padding);var Z=this.transform,q=Z.padding,de=Z.project(p.LngLat.convert(i)),ge=Z.project(p.LngLat.convert(h)),be=de.rotate(-g*Math.PI/180),Ke=ge.rotate(-g*Math.PI/180),He=new p.Point(Math.max(be.x,Ke.x),Math.max(be.y,Ke.y)),ut=new p.Point(Math.min(be.x,Ke.x),Math.min(be.y,Ke.y)),We=He.sub(ut),et=(Z.width-(q.left+q.right+E.padding.left+E.padding.right))/We.x,Pt=(Z.height-(q.top+q.bottom+E.padding.top+E.padding.bottom))/We.y;if(!(Pt<0||et<0)){var Mt=Math.min(Z.scaleZoom(Z.scale*Math.min(et,Pt)),E.maxZoom),_r=typeof E.offset.x=="number"?new p.Point(E.offset.x,E.offset.y):p.Point.convert(E.offset),nr=new p.Point((E.padding.left-E.padding.right)/2,(E.padding.top-E.padding.bottom)/2).rotate(g*Math.PI/180),gr=_r.add(nr).mult(Z.scale/Z.zoomScale(Mt));return{center:Z.unproject(de.add(ge).div(2).sub(gr)),zoom:Mt,bearing:g}}p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},o.prototype.fitBounds=function(i,h,g){return this._fitInternal(this.cameraForBounds(i,h),h,g)},o.prototype.fitScreenCoordinates=function(i,h,g,E,C){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(p.Point.convert(i)),this.transform.pointLocation(p.Point.convert(h)),g,E),E,C)},o.prototype._fitInternal=function(i,h,g){return i?(delete(h=p.extend(i,h)).padding,h.linear?this.easeTo(h,g):this.flyTo(h,g)):this},o.prototype.jumpTo=function(i,h){this.stop();var g=this.transform,E=!1,C=!1,L=!1;return"zoom"in i&&g.zoom!==+i.zoom&&(E=!0,g.zoom=+i.zoom),i.center!==void 0&&(g.center=p.LngLat.convert(i.center)),"bearing"in i&&g.bearing!==+i.bearing&&(C=!0,g.bearing=+i.bearing),"pitch"in i&&g.pitch!==+i.pitch&&(L=!0,g.pitch=+i.pitch),i.padding==null||g.isPaddingEqual(i.padding)||(g.padding=i.padding),this.fire(new p.Event("movestart",h)).fire(new p.Event("move",h)),E&&this.fire(new p.Event("zoomstart",h)).fire(new p.Event("zoom",h)).fire(new p.Event("zoomend",h)),C&&this.fire(new p.Event("rotatestart",h)).fire(new p.Event("rotate",h)).fire(new p.Event("rotateend",h)),L&&this.fire(new p.Event("pitchstart",h)).fire(new p.Event("pitch",h)).fire(new p.Event("pitchend",h)),this.fire(new p.Event("moveend",h))},o.prototype.easeTo=function(i,h){var g=this;this._stop(!1,i.easeId),((i=p.extend({offset:[0,0],duration:500,easing:p.ease},i)).animate===!1||!i.essential&&p.browser.prefersReducedMotion)&&(i.duration=0);var E=this.transform,C=this.getZoom(),L=this.getBearing(),Z=this.getPitch(),q=this.getPadding(),de="zoom"in i?+i.zoom:C,ge="bearing"in i?this._normalizeBearing(i.bearing,L):L,be="pitch"in i?+i.pitch:Z,Ke="padding"in i?i.padding:E.padding,He=p.Point.convert(i.offset),ut=E.centerPoint.add(He),We=E.pointLocation(ut),et=p.LngLat.convert(i.center||We);this._normalizeCenter(et);var Pt,Mt,_r=E.project(We),nr=E.project(et).sub(_r),gr=E.zoomScale(de-C);i.around&&(Pt=p.LngLat.convert(i.around),Mt=E.locationPoint(Pt));var Er={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||de!==C,this._rotating=this._rotating||L!==ge,this._pitching=this._pitching||be!==Z,this._padding=!E.isPaddingEqual(Ke),this._easeId=i.easeId,this._prepareEase(h,i.noMoveStart,Er),this._ease(function(tn){if(g._zooming&&(E.zoom=p.number(C,de,tn)),g._rotating&&(E.bearing=p.number(L,ge,tn)),g._pitching&&(E.pitch=p.number(Z,be,tn)),g._padding&&(E.interpolatePadding(q,Ke,tn),ut=E.centerPoint.add(He)),Pt)E.setLocationAtPoint(Pt,Mt);else{var Vr=E.zoomScale(E.zoom-C),mn=de>C?Math.min(2,gr):Math.max(.5,gr),Sn=Math.pow(mn,1-tn),Hn=E.unproject(_r.add(nr.mult(tn*Sn)).mult(Vr));E.setLocationAtPoint(E.renderWorldCopies?Hn.wrap():Hn,ut)}g._fireMoveEvents(h)},function(tn){g._afterEase(h,tn)},i),this},o.prototype._prepareEase=function(i,h,g){g===void 0&&(g={}),this._moving=!0,h||g.moving||this.fire(new p.Event("movestart",i)),this._zooming&&!g.zooming&&this.fire(new p.Event("zoomstart",i)),this._rotating&&!g.rotating&&this.fire(new p.Event("rotatestart",i)),this._pitching&&!g.pitching&&this.fire(new p.Event("pitchstart",i))},o.prototype._fireMoveEvents=function(i){this.fire(new p.Event("move",i)),this._zooming&&this.fire(new p.Event("zoom",i)),this._rotating&&this.fire(new p.Event("rotate",i)),this._pitching&&this.fire(new p.Event("pitch",i))},o.prototype._afterEase=function(i,h){if(!this._easeId||!h||this._easeId!==h){delete this._easeId;var g=this._zooming,E=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new p.Event("zoomend",i)),E&&this.fire(new p.Event("rotateend",i)),C&&this.fire(new p.Event("pitchend",i)),this.fire(new p.Event("moveend",i))}},o.prototype.flyTo=function(i,h){var g=this;if(!i.essential&&p.browser.prefersReducedMotion){var E=p.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(E,h)}this.stop(),i=p.extend({offset:[0,0],speed:1.2,curve:1.42,easing:p.ease},i);var C=this.transform,L=this.getZoom(),Z=this.getBearing(),q=this.getPitch(),de=this.getPadding(),ge="zoom"in i?p.clamp(+i.zoom,C.minZoom,C.maxZoom):L,be="bearing"in i?this._normalizeBearing(i.bearing,Z):Z,Ke="pitch"in i?+i.pitch:q,He="padding"in i?i.padding:C.padding,ut=C.zoomScale(ge-L),We=p.Point.convert(i.offset),et=C.centerPoint.add(We),Pt=C.pointLocation(et),Mt=p.LngLat.convert(i.center||Pt);this._normalizeCenter(Mt);var _r=C.project(Pt),nr=C.project(Mt).sub(_r),gr=i.curve,Er=Math.max(C.width,C.height),tn=Er/ut,Vr=nr.mag();if("minZoom"in i){var mn=p.clamp(Math.min(i.minZoom,L,ge),C.minZoom,C.maxZoom),Sn=Er/C.zoomScale(mn-L);gr=Math.sqrt(Sn/Vr*2)}var Hn=gr*gr;function ei(Kn){var Ci=(tn*tn-Er*Er+(Kn?-1:1)*Hn*Hn*Vr*Vr)/(2*(Kn?tn:Er)*Hn*Vr);return Math.log(Math.sqrt(Ci*Ci+1)-Ci)}function Ei(Kn){return(Math.exp(Kn)-Math.exp(-Kn))/2}function Ki(Kn){return(Math.exp(Kn)+Math.exp(-Kn))/2}var bn=ei(0),pi=function(Ci){return Ki(bn)/Ki(bn+gr*Ci)},bi=function(Ci){return Er*((Ki(bn)*(Ei(Wi=bn+gr*Ci)/Ki(Wi))-Ei(bn))/Hn)/Vr;var Wi},Nn=(ei(1)-bn)/gr;if(Math.abs(Vr)<1e-6||!isFinite(Nn)){if(Math.abs(Er-tn)<1e-6)return this.easeTo(i,h);var yi=tn<Er?-1:1;Nn=Math.abs(Math.log(tn/Er))/gr,bi=function(){return 0},pi=function(Ci){return Math.exp(yi*gr*Ci)}}return i.duration="duration"in i?+i.duration:1e3*Nn/("screenSpeed"in i?+i.screenSpeed/gr:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=Z!==be,this._pitching=Ke!==q,this._padding=!C.isPaddingEqual(He),this._prepareEase(h,!1),this._ease(function(Kn){var Ci=Kn*Nn,Wi=1/pi(Ci);C.zoom=Kn===1?ge:L+C.scaleZoom(Wi),g._rotating&&(C.bearing=p.number(Z,be,Kn)),g._pitching&&(C.pitch=p.number(q,Ke,Kn)),g._padding&&(C.interpolatePadding(de,He,Kn),et=C.centerPoint.add(We));var mo=Kn===1?Mt:C.unproject(_r.add(nr.mult(bi(Ci))).mult(Wi));C.setLocationAtPoint(C.renderWorldCopies?mo.wrap():mo,et),g._fireMoveEvents(h)},function(){return g._afterEase(h)},i),this},o.prototype.isEasing=function(){return!!this._easeFrameId},o.prototype.stop=function(){return this._stop()},o.prototype._stop=function(i,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,h)}if(!i){var E=this.handlers;E&&E.stop(!1)}return this},o.prototype._ease=function(i,h,g){g.animate===!1||g.duration===0?(i(1),h()):(this._easeStart=p.browser.now(),this._easeOptions=g,this._onEaseFrame=i,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},o.prototype._renderFrameCallback=function(){var i=Math.min((p.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},o.prototype._normalizeBearing=function(i,h){i=p.wrap(i,-180,180);var g=Math.abs(i-h);return Math.abs(i-360-h)<g&&(i-=360),Math.abs(i+360-h)<g&&(i+=360),i},o.prototype._normalizeCenter=function(i){var h=this.transform;if(h.renderWorldCopies&&!h.lngRange){var g=i.lng-h.center.lng;i.lng+=g>180?-360:g<-180?360:0}},o}(p.Evented),fs=function(o){o===void 0&&(o={}),this.options=o,p.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};fs.prototype.getDefaultPosition=function(){return"bottom-right"},fs.prototype.onAdd=function(c){var o=this.options&&this.options.compact;return this._map=c,this._container=S.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=S.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=S.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),o&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),o===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},fs.prototype.onRemove=function(){S.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},fs.prototype._setElementTitle=function(c,o){var i=this._map._getUIString("AttributionControl."+o);c.title=i,c.setAttribute("aria-label",i)},fs.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},fs.prototype._updateEditLink=function(){var c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));var o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||p.config.ACCESS_TOKEN}];if(c){var i=o.reduce(function(h,g,E){return g.value&&(h+=g.key+"="+g.value+(E<o.length-1?"&":"")),h},"?");c.href=p.config.FEEDBACK_URL+"/"+i+(this._map._hash?this._map._hash.getHashString(!0):""),c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}},fs.prototype._updateData=function(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},fs.prototype._updateAttributions=function(){if(this._map.style){var c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(function(L){return typeof L!="string"?"":L})):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){var o=this._map.style.stylesheet;this.styleOwner=o.owner,this.styleId=o.id}var i=this._map.style.sourceCaches;for(var h in i){var g=i[h];if(g.used){var E=g.getSource();E.attribution&&c.indexOf(E.attribution)<0&&c.push(E.attribution)}}c.sort(function(L,Z){return L.length-Z.length});var C=(c=c.filter(function(L,Z){for(var q=Z+1;q<c.length;q++)if(c[q].indexOf(L)>=0)return!1;return!0})).join(" | ");C!==this._attribHTML&&(this._attribHTML=C,c.length?(this._innerContainer.innerHTML=C,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},fs.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Io=function(){p.bindAll(["_updateLogo"],this),p.bindAll(["_updateCompact"],this)};Io.prototype.onAdd=function(c){this._map=c,this._container=S.create("div","mapboxgl-ctrl");var o=S.create("a","mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://www.mapbox.com/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Io.prototype.onRemove=function(){S.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Io.prototype.getDefaultPosition=function(){return"bottom-left"},Io.prototype._updateLogo=function(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Io.prototype._logoRequired=function(){if(this._map.style){var c=this._map.style.sourceCaches;for(var o in c)if(c[o].getSource().mapbox_logo)return!0;return!1}},Io.prototype._updateCompact=function(){var c=this._container.children;if(c.length){var o=c[0];this._map.getCanvasContainer().offsetWidth<250?o.classList.add("mapboxgl-compact"):o.classList.remove("mapboxgl-compact")}};var jo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};jo.prototype.add=function(c){var o=++this._id;return this._queue.push({callback:c,id:o,cancelled:!1}),o},jo.prototype.remove=function(c){for(var o=this._currentlyRunning,i=0,h=o?this._queue.concat(o):this._queue;i<h.length;i+=1){var g=h[i];if(g.id===c)return void(g.cancelled=!0)}},jo.prototype.run=function(c){c===void 0&&(c=0);var o=this._currentlyRunning=this._queue;this._queue=[];for(var i=0,h=o;i<h.length;i+=1){var g=h[i];if(!g.cancelled&&(g.callback(c),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},jo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Zu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},gu=p.window.HTMLImageElement,Nl=p.window.HTMLElement,Yi=p.window.ImageBitmap,ao={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Vc=function(c){function o(h){var g=this;if((h=p.extend({},ao,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var E=new ji(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies);if(c.call(this,E,h),this._interactive=h.interactive,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new jo,this._controls=[],this._mapId=p.uniqueId(),this._locale=p.extend({},Zu,h.locale),this._clickTolerance=h.clickTolerance,this._requestManager=new p.RequestManager(h.transformRequest,h.accessToken),typeof h.container=="string"){if(this._container=p.window.document.getElementById(h.container),!this._container)throw new Error("Container '"+h.container+"' not found.")}else{if(!(h.container instanceof Nl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),p.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return g._update(!1)}),this.on("moveend",function(){return g._update(!1)}),this.on("zoom",function(){return g._update(!0)}),p.window!==void 0&&(p.window.addEventListener("online",this._onWindowOnline,!1),p.window.addEventListener("resize",this._onWindowResize,!1),p.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Mn(this,h),this._hash=h.hash&&new Gs(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,p.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new fs({customAttribution:h.customAttribution})),this.addControl(new Io,h.logoPosition),this.on("style.load",function(){g.transform.unmodified&&g.jumpTo(g.style.stylesheet)}),this.on("data",function(C){g._update(C.dataType==="style"),g.fire(new p.Event(C.dataType+"data",C))}),this.on("dataloading",function(C){g.fire(new p.Event(C.dataType+"dataloading",C))})}c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o;var i={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return o.prototype._getMapId=function(){return this._mapId},o.prototype.addControl=function(h,g){if(g===void 0&&(g=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var E=h.onAdd(this);this._controls.push(h);var C=this._controlPositions[g];return g.indexOf("bottom")!==-1?C.insertBefore(E,C.firstChild):C.appendChild(E),this},o.prototype.removeControl=function(h){if(!h||!h.onRemove)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var g=this._controls.indexOf(h);return g>-1&&this._controls.splice(g,1),h.onRemove(this),this},o.prototype.hasControl=function(h){return this._controls.indexOf(h)>-1},o.prototype.resize=function(h){var g=this._containerDimensions(),E=g[0],C=g[1];this._resizeCanvas(E,C),this.transform.resize(E,C),this.painter.resize(E,C);var L=!this._moving;return L&&(this.stop(),this.fire(new p.Event("movestart",h)).fire(new p.Event("move",h))),this.fire(new p.Event("resize",h)),L&&this.fire(new p.Event("moveend",h)),this},o.prototype.getBounds=function(){return this.transform.getBounds()},o.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},o.prototype.setMaxBounds=function(h){return this.transform.setMaxBounds(p.LngLatBounds.convert(h)),this._update()},o.prototype.setMinZoom=function(h){if((h=h==null?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},o.prototype.getMinZoom=function(){return this.transform.minZoom},o.prototype.setMaxZoom=function(h){if((h=h==null?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")},o.prototype.getMaxZoom=function(){return this.transform.maxZoom},o.prototype.setMinPitch=function(h){if((h=h==null?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},o.prototype.getMinPitch=function(){return this.transform.minPitch},o.prototype.setMaxPitch=function(h){if((h=h==null?60:h)>60)throw new Error("maxPitch must be less than or equal to 60");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")},o.prototype.getMaxPitch=function(){return this.transform.maxPitch},o.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},o.prototype.setRenderWorldCopies=function(h){return this.transform.renderWorldCopies=h,this._update()},o.prototype.project=function(h){return this.transform.locationPoint(p.LngLat.convert(h))},o.prototype.unproject=function(h){return this.transform.pointLocation(p.Point.convert(h))},o.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},o.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},o.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},o.prototype._createDelegatedListener=function(h,g,E){var C,L=this;if(h==="mouseenter"||h==="mouseover"){var Z=!1;return{layer:g,listener:E,delegates:{mousemove:function(ge){var be=L.getLayer(g)?L.queryRenderedFeatures(ge.point,{layers:[g]}):[];be.length?Z||(Z=!0,E.call(L,new Ka(h,L,ge.originalEvent,{features:be}))):Z=!1},mouseout:function(){Z=!1}}}}if(h==="mouseleave"||h==="mouseout"){var q=!1;return{layer:g,listener:E,delegates:{mousemove:function(ge){(L.getLayer(g)?L.queryRenderedFeatures(ge.point,{layers:[g]}):[]).length?q=!0:q&&(q=!1,E.call(L,new Ka(h,L,ge.originalEvent)))},mouseout:function(ge){q&&(q=!1,E.call(L,new Ka(h,L,ge.originalEvent)))}}}}return{layer:g,listener:E,delegates:(C={},C[h]=function(de){var ge=L.getLayer(g)?L.queryRenderedFeatures(de.point,{layers:[g]}):[];ge.length&&(de.features=ge,E.call(L,de),delete de.features)},C)}},o.prototype.on=function(h,g,E){if(E===void 0)return c.prototype.on.call(this,h,g);var C=this._createDelegatedListener(h,g,E);for(var L in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(C),C.delegates)this.on(L,C.delegates[L]);return this},o.prototype.once=function(h,g,E){if(E===void 0)return c.prototype.once.call(this,h,g);var C=this._createDelegatedListener(h,g,E);for(var L in C.delegates)this.once(L,C.delegates[L]);return this},o.prototype.off=function(h,g,E){var C=this;return E===void 0?c.prototype.off.call(this,h,g):(this._delegatedListeners&&this._delegatedListeners[h]&&function(L){for(var Z=L[h],q=0;q<Z.length;q++){var de=Z[q];if(de.layer===g&&de.listener===E){for(var ge in de.delegates)C.off(ge,de.delegates[ge]);return Z.splice(q,1),C}}}(this._delegatedListeners),this)},o.prototype.queryRenderedFeatures=function(h,g){if(!this.style)return[];var E;if(g!==void 0||h===void 0||h instanceof p.Point||Array.isArray(h)||(g=h,h=void 0),g=g||{},(h=h||[[0,0],[this.transform.width,this.transform.height]])instanceof p.Point||typeof h[0]=="number")E=[p.Point.convert(h)];else{var C=p.Point.convert(h[0]),L=p.Point.convert(h[1]);E=[C,new p.Point(L.x,C.y),L,new p.Point(C.x,L.y),C]}return this.style.queryRenderedFeatures(E,g,this.transform)},o.prototype.querySourceFeatures=function(h,g){return this.style.querySourceFeatures(h,g)},o.prototype.setStyle=function(h,g){return(g=p.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},g)).diff!==!1&&g.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,g),this):(this._localIdeographFontFamily=g.localIdeographFontFamily,this._updateStyle(h,g))},o.prototype._getUIString=function(h){var g=this._locale[h];if(g==null)throw new Error("Missing UI string '"+h+"'");return g},o.prototype._updateStyle=function(h,g){return this.style&&(this.style.setEventedParent(null),this.style._remove()),h?(this.style=new Wo(this,g||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h),this):(delete this.style,this)},o.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Wo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},o.prototype._diffStyle=function(h,g){var E=this;if(typeof h=="string"){var C=this._requestManager.normalizeStyleURL(h),L=this._requestManager.transformRequest(C,p.ResourceType.Style);p.getJSON(L,function(Z,q){Z?E.fire(new p.ErrorEvent(Z)):q&&E._updateDiff(q,g)})}else typeof h=="object"&&this._updateDiff(h,g)},o.prototype._updateDiff=function(h,g){try{this.style.setState(h)&&this._update(!0)}catch(E){p.warnOnce("Unable to perform style diff: "+(E.message||E.error||E)+".  Rebuilding the style from scratch."),this._updateStyle(h,g)}},o.prototype.getStyle=function(){if(this.style)return this.style.serialize()},o.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():p.warnOnce("There is no style added to the map.")},o.prototype.addSource=function(h,g){return this._lazyInitEmptyStyle(),this.style.addSource(h,g),this._update(!0)},o.prototype.isSourceLoaded=function(h){var g=this.style&&this.style.sourceCaches[h];if(g!==void 0)return g.loaded();this.fire(new p.ErrorEvent(new Error("There is no source with ID '"+h+"'")))},o.prototype.areTilesLoaded=function(){var h=this.style&&this.style.sourceCaches;for(var g in h){var E=h[g]._tiles;for(var C in E){var L=E[C];if(L.state!=="loaded"&&L.state!=="errored")return!1}}return!0},o.prototype.addSourceType=function(h,g,E){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,g,E)},o.prototype.removeSource=function(h){return this.style.removeSource(h),this._update(!0)},o.prototype.getSource=function(h){return this.style.getSource(h)},o.prototype.addImage=function(h,g,E){E===void 0&&(E={});var C=E.pixelRatio;C===void 0&&(C=1);var L=E.sdf;L===void 0&&(L=!1);var Z=E.stretchX,q=E.stretchY,de=E.content;if(this._lazyInitEmptyStyle(),g instanceof gu||Yi&&g instanceof Yi){var ge=p.browser.getImageData(g);this.style.addImage(h,{data:new p.RGBAImage({width:ge.width,height:ge.height},ge.data),pixelRatio:C,stretchX:Z,stretchY:q,content:de,sdf:L,version:0})}else{if(g.width===void 0||g.height===void 0)return this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var be=g;this.style.addImage(h,{data:new p.RGBAImage({width:g.width,height:g.height},new Uint8Array(g.data)),pixelRatio:C,stretchX:Z,stretchY:q,content:de,sdf:L,version:0,userImage:be}),be.onAdd&&be.onAdd(this,h)}},o.prototype.updateImage=function(h,g){var E=this.style.getImage(h);if(!E)return this.fire(new p.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var C=g instanceof gu||Yi&&g instanceof Yi?p.browser.getImageData(g):g,L=C.width,Z=C.height,q=C.data;return L===void 0||Z===void 0?this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):L!==E.data.width||Z!==E.data.height?this.fire(new p.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(E.data.replace(q,!(g instanceof gu||Yi&&g instanceof Yi)),void this.style.updateImage(h,E))},o.prototype.hasImage=function(h){return h?!!this.style.getImage(h):(this.fire(new p.ErrorEvent(new Error("Missing required image id"))),!1)},o.prototype.removeImage=function(h){this.style.removeImage(h)},o.prototype.loadImage=function(h,g){p.getImage(this._requestManager.transformRequest(h,p.ResourceType.Image),g)},o.prototype.listImages=function(){return this.style.listImages()},o.prototype.addLayer=function(h,g){return this._lazyInitEmptyStyle(),this.style.addLayer(h,g),this._update(!0)},o.prototype.moveLayer=function(h,g){return this.style.moveLayer(h,g),this._update(!0)},o.prototype.removeLayer=function(h){return this.style.removeLayer(h),this._update(!0)},o.prototype.getLayer=function(h){return this.style.getLayer(h)},o.prototype.setLayerZoomRange=function(h,g,E){return this.style.setLayerZoomRange(h,g,E),this._update(!0)},o.prototype.setFilter=function(h,g,E){return E===void 0&&(E={}),this.style.setFilter(h,g,E),this._update(!0)},o.prototype.getFilter=function(h){return this.style.getFilter(h)},o.prototype.setPaintProperty=function(h,g,E,C){return C===void 0&&(C={}),this.style.setPaintProperty(h,g,E,C),this._update(!0)},o.prototype.getPaintProperty=function(h,g){return this.style.getPaintProperty(h,g)},o.prototype.setLayoutProperty=function(h,g,E,C){return C===void 0&&(C={}),this.style.setLayoutProperty(h,g,E,C),this._update(!0)},o.prototype.getLayoutProperty=function(h,g){return this.style.getLayoutProperty(h,g)},o.prototype.setLight=function(h,g){return g===void 0&&(g={}),this._lazyInitEmptyStyle(),this.style.setLight(h,g),this._update(!0)},o.prototype.getLight=function(){return this.style.getLight()},o.prototype.setFeatureState=function(h,g){return this.style.setFeatureState(h,g),this._update()},o.prototype.removeFeatureState=function(h,g){return this.style.removeFeatureState(h,g),this._update()},o.prototype.getFeatureState=function(h){return this.style.getFeatureState(h)},o.prototype.getContainer=function(){return this._container},o.prototype.getCanvasContainer=function(){return this._canvasContainer},o.prototype.getCanvas=function(){return this._canvas},o.prototype._containerDimensions=function(){var h=0,g=0;return this._container&&(h=this._container.clientWidth||400,g=this._container.clientHeight||300),[h,g]},o.prototype._detectMissingCSS=function(){p.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&p.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},o.prototype._setupContainer=function(){var h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=S.create("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();var g=this._canvasContainer=S.create("div","mapboxgl-canvas-container",h);this._interactive&&g.classList.add("mapboxgl-interactive"),this._canvas=S.create("canvas","mapboxgl-canvas",g),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var E=this._containerDimensions();this._resizeCanvas(E[0],E[1]);var C=this._controlContainer=S.create("div","mapboxgl-control-container",h),L=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Z){L[Z]=S.create("div","mapboxgl-ctrl-"+Z,C)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},o.prototype._resizeCanvas=function(h,g){var E=p.browser.devicePixelRatio||1;this._canvas.width=E*h,this._canvas.height=E*g,this._canvas.style.width=h+"px",this._canvas.style.height=g+"px"},o.prototype._setupPainter=function(){var h=p.extend({},H.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),g=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);g?(this.painter=new Aa(g,this.transform),p.webpSupported.testSupport(g)):this.fire(new p.ErrorEvent(new Error("Failed to initialize WebGL")))},o.prototype._contextLost=function(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new p.Event("webglcontextlost",{originalEvent:h}))},o.prototype._contextRestored=function(h){this._setupPainter(),this.resize(),this._update(),this.fire(new p.Event("webglcontextrestored",{originalEvent:h}))},o.prototype._onMapScroll=function(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},o.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},o.prototype._update=function(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this},o.prototype._requestRenderFrame=function(h){return this._update(),this._renderTaskQueue.add(h)},o.prototype._cancelRenderFrame=function(h){this._renderTaskQueue.remove(h)},o.prototype._render=function(h){var g,E=this,C=0,L=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(g=L.createQueryEXT(),L.beginQueryEXT(L.TIME_ELAPSED_EXT,g),C=p.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),!this._removed){var Z=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var q=this.transform.zoom,de=p.browser.now();this.style.zoomHistory.update(q,de);var ge=new p.EvaluationParameters(q,{now:de,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),be=ge.crossFadingFactor();be===1&&be===this._crossFadingFactor||(Z=!0,this._crossFadingFactor=be),this.style.update(ge)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new p.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new p.Event("load"))),this.style&&(this.style.hasTransitions()||Z)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ke=p.browser.now()-C;L.endQueryEXT(L.TIME_ELAPSED_EXT,g),setTimeout(function(){var We=L.getQueryObjectEXT(g,L.QUERY_RESULT_EXT)/1e6;L.deleteQueryEXT(g),E.fire(new p.Event("gpu-timing-frame",{cpuTime:Ke,gpuTime:We}))},50)}if(this.listens("gpu-timing-layer")){var He=this.painter.collectGpuTimers();setTimeout(function(){var We=E.painter.queryGpuTimers(He);E.fire(new p.Event("gpu-timing-layer",{layerTimes:We}))},50)}var ut=this._sourcesDirty||this._styleDirty||this._placementDirty;return ut||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new p.Event("idle")),!this._loaded||this._fullyLoaded||ut||(this._fullyLoaded=!0),this}},o.prototype.remove=function(){this._hash&&this._hash.remove();for(var h=0,g=this._controls;h<g.length;h+=1)g[h].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),p.window!==void 0&&(p.window.removeEventListener("resize",this._onWindowResize,!1),p.window.removeEventListener("orientationchange",this._onWindowResize,!1),p.window.removeEventListener("online",this._onWindowOnline,!1));var E=this.painter.context.gl.getExtension("WEBGL_lose_context");E&&E.loseContext(),cl(this._canvasContainer),cl(this._controlContainer),cl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new p.Event("remove"))},o.prototype.triggerRepaint=function(){var h=this;this.style&&!this._frame&&(this._frame=p.browser.frame(function(g){h._frame=null,h._render(g)}))},o.prototype._onWindowOnline=function(){this._update()},o.prototype._onWindowResize=function(h){this._trackResize&&this.resize({originalEvent:h})._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())},i.showPadding.get=function(){return!!this._showPadding},i.showPadding.set=function(h){this._showPadding!==h&&(this._showPadding=h,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(h){this._vertices=h,this._update()},o.prototype._setCacheLimits=function(h,g){p.setCacheLimits(h,g)},i.version.get=function(){return p.version},Object.defineProperties(o.prototype,i),o}(ll);function cl(c){c.parentNode&&c.parentNode.removeChild(c)}var bc={showCompass:!0,showZoom:!0,visualizePitch:!1},Vu=function(o){var i=this;this.options=p.extend({},bc,o),this._container=S.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(h){return h.preventDefault()}),this.options.showZoom&&(p.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(h){return i._map.zoomIn({},{originalEvent:h})}),S.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(h){return i._map.zoomOut({},{originalEvent:h})}),S.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(p.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(h){i.options.visualizePitch?i._map.resetNorthPitch({},{originalEvent:h}):i._map.resetNorth({},{originalEvent:h})}),this._compassIcon=S.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Vu.prototype._updateZoomButtons=function(){var c=this._map.getZoom(),o=c===this._map.getMaxZoom(),i=c===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())},Vu.prototype._rotateCompassArrow=function(){var c=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=c},Vu.prototype.onAdd=function(c){return this._map=c,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Rs(this._map,this._compass,this.options.visualizePitch)),this._container},Vu.prototype.onRemove=function(){S.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Vu.prototype._createButton=function(c,o){var i=S.create("button",c,this._container);return i.type="button",i.addEventListener("click",o),i},Vu.prototype._setButtonTitle=function(c,o){var i=this._map._getUIString("NavigationControl."+o);c.title=i,c.setAttribute("aria-label",i)};var Rs=function(o,i,h){h===void 0&&(h=!1),this._clickTolerance=10,this.element=i,this.mouseRotate=new Iu({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,h&&(this.mousePitch=new Is({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),p.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),S.addEventListener(i,"mousedown",this.mousedown),S.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),S.addEventListener(i,"touchmove",this.touchmove),S.addEventListener(i,"touchend",this.touchend),S.addEventListener(i,"touchcancel",this.reset)};function nc(c,o,i){if(c=new p.LngLat(c.lng,c.lat),o){var h=new p.LngLat(c.lng-360,c.lat),g=new p.LngLat(c.lng+360,c.lat),E=i.locationPoint(c).distSqr(o);i.locationPoint(h).distSqr(o)<E?c=h:i.locationPoint(g).distSqr(o)<E&&(c=g)}for(;Math.abs(c.lng-i.center.lng)>180;){var C=i.locationPoint(c);if(C.x>=0&&C.y>=0&&C.x<=i.width&&C.y<=i.height)break;c.lng>i.center.lng?c.lng-=360:c.lng+=360}return c}Rs.prototype.down=function(c,o){this.mouseRotate.mousedown(c,o),this.mousePitch&&this.mousePitch.mousedown(c,o),S.disableDrag()},Rs.prototype.move=function(c,o){var i=this.map,h=this.mouseRotate.mousemoveWindow(c,o);if(h&&h.bearingDelta&&i.setBearing(i.getBearing()+h.bearingDelta),this.mousePitch){var g=this.mousePitch.mousemoveWindow(c,o);g&&g.pitchDelta&&i.setPitch(i.getPitch()+g.pitchDelta)}},Rs.prototype.off=function(){var c=this.element;S.removeEventListener(c,"mousedown",this.mousedown),S.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),S.removeEventListener(c,"touchmove",this.touchmove),S.removeEventListener(c,"touchend",this.touchend),S.removeEventListener(c,"touchcancel",this.reset),this.offTemp()},Rs.prototype.offTemp=function(){S.enableDrag(),S.removeEventListener(p.window,"mousemove",this.mousemove),S.removeEventListener(p.window,"mouseup",this.mouseup)},Rs.prototype.mousedown=function(c){this.down(p.extend({},c,{ctrlKey:!0,preventDefault:function(){return c.preventDefault()}}),S.mousePos(this.element,c)),S.addEventListener(p.window,"mousemove",this.mousemove),S.addEventListener(p.window,"mouseup",this.mouseup)},Rs.prototype.mousemove=function(c){this.move(c,S.mousePos(this.element,c))},Rs.prototype.mouseup=function(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()},Rs.prototype.touchstart=function(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=S.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return c.preventDefault()}},this._startPos))},Rs.prototype.touchmove=function(c){c.targetTouches.length!==1?this.reset():(this._lastPos=S.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:function(){return c.preventDefault()}},this._lastPos))},Rs.prototype.touchend=function(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Rs.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var hs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Sc(c,o,i){var h=c.classList;for(var g in hs)h.remove("mapboxgl-"+i+"-anchor-"+g);h.add("mapboxgl-"+i+"-anchor-"+o)}var Bl,ic=function(c){function o(i,h){if(c.call(this),(i instanceof p.window.HTMLElement||h)&&(i=p.extend({element:i},h)),p.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=p.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=S.create("div"),this._element.setAttribute("aria-label","Map marker");var g=S.createNS("http://www.w3.org/2000/svg","svg");g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height","41px"),g.setAttributeNS(null,"width","27px"),g.setAttributeNS(null,"viewBox","0 0 27 41");var E=S.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");var C=S.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill-rule","nonzero");var L=S.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"transform","translate(3.0, 29.0)"),L.setAttributeNS(null,"fill","#000000");for(var Z=0,q=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Z<q.length;Z+=1){var de=q[Z],ge=S.createNS("http://www.w3.org/2000/svg","ellipse");ge.setAttributeNS(null,"opacity","0.04"),ge.setAttributeNS(null,"cx","10.5"),ge.setAttributeNS(null,"cy","5.80029008"),ge.setAttributeNS(null,"rx",de.rx),ge.setAttributeNS(null,"ry",de.ry),L.appendChild(ge)}var be=S.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"fill",this._color);var Ke=S.createNS("http://www.w3.org/2000/svg","path");Ke.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),be.appendChild(Ke);var He=S.createNS("http://www.w3.org/2000/svg","g");He.setAttributeNS(null,"opacity","0.25"),He.setAttributeNS(null,"fill","#000000");var ut=S.createNS("http://www.w3.org/2000/svg","path");ut.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),He.appendChild(ut);var We=S.createNS("http://www.w3.org/2000/svg","g");We.setAttributeNS(null,"transform","translate(6.0, 7.0)"),We.setAttributeNS(null,"fill","#FFFFFF");var et=S.createNS("http://www.w3.org/2000/svg","g");et.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Pt=S.createNS("http://www.w3.org/2000/svg","circle");Pt.setAttributeNS(null,"fill","#000000"),Pt.setAttributeNS(null,"opacity","0.25"),Pt.setAttributeNS(null,"cx","5.5"),Pt.setAttributeNS(null,"cy","5.5"),Pt.setAttributeNS(null,"r","5.4999962");var Mt=S.createNS("http://www.w3.org/2000/svg","circle");Mt.setAttributeNS(null,"fill","#FFFFFF"),Mt.setAttributeNS(null,"cx","5.5"),Mt.setAttributeNS(null,"cy","5.5"),Mt.setAttributeNS(null,"r","5.4999962"),et.appendChild(Pt),et.appendChild(Mt),C.appendChild(L),C.appendChild(be),C.appendChild(He),C.appendChild(We),C.appendChild(et),g.appendChild(C),g.setAttributeNS(null,"height",41*this._scale+"px"),g.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(g),this._offset=p.Point.convert(i&&i.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(_r){_r.preventDefault()}),this._element.addEventListener("mousedown",function(_r){_r.preventDefault()}),Sc(this._element,this._anchor,"marker"),this._popup=null}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.addTo=function(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},o.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),S.remove(this._element),this._popup&&this._popup.remove(),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(i){return this._lngLat=p.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},o.prototype.getElement=function(){return this._element},o.prototype.setPopup=function(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){var h=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(24.6+h)],"bottom-right":[-h,-1*(24.6+h)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},o.prototype._onKeyPress=function(i){var h=i.code,g=i.charCode||i.keyCode;h!=="Space"&&h!=="Enter"&&g!==32&&g!==13||this.togglePopup()},o.prototype._onMapClick=function(i){var h=i.originalEvent.target,g=this._element;this._popup&&(h===g||g.contains(h))&&this.togglePopup()},o.prototype.getPopup=function(){return this._popup},o.prototype.togglePopup=function(){var i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this},o.prototype._update=function(i){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=nc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var h="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?h="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(h="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g="rotateX("+this._map.getPitch()+"deg)"),i&&i.type!=="moveend"||(this._pos=this._pos.round()),S.setTransform(this._element,hs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+g+" "+h)}},o.prototype.getOffset=function(){return this._offset},o.prototype.setOffset=function(i){return this._offset=p.Point.convert(i),this._update(),this},o.prototype._onMove=function(i){if(!this._isDragging){var h=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new p.Event("dragstart"))),this.fire(new p.Event("drag")))},o.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new p.Event("dragend")),this._state="inactive"},o.prototype._addDragHandler=function(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},o.prototype.setDraggable=function(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},o.prototype.isDraggable=function(){return this._draggable},o.prototype.setRotation=function(i){return this._rotation=i||0,this._update(),this},o.prototype.getRotation=function(){return this._rotation},o.prototype.setRotationAlignment=function(i){return this._rotationAlignment=i||"auto",this._update(),this},o.prototype.getRotationAlignment=function(){return this._rotationAlignment},o.prototype.setPitchAlignment=function(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this},o.prototype.getPitchAlignment=function(){return this._pitchAlignment},o}(p.Evented),Oa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ac=0,fl=!1,Ec=function(c){function o(i){c.call(this),this.options=p.extend({},Oa,i),p.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.onAdd=function(i){var h;return this._map=i,this._container=S.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),h=this._setupUI,Bl!==void 0?h(Bl):p.window.navigator.permissions!==void 0?p.window.navigator.permissions.query({name:"geolocation"}).then(function(g){h(Bl=g.state!=="denied")}):h(Bl=!!p.window.navigator.geolocation),this._container},o.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(p.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),S.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ac=0,fl=!1},o.prototype._isOutOfMapMaxBounds=function(i){var h=this._map.getMaxBounds(),g=i.coords;return h&&(g.longitude<h.getWest()||g.longitude>h.getEast()||g.latitude<h.getSouth()||g.latitude>h.getNorth())},o.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},o.prototype._onSuccess=function(i){if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new p.Event("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("geolocate",i)),this._finish()}},o.prototype._updateCamera=function(i){var h=new p.LngLat(i.coords.longitude,i.coords.latitude),g=i.coords.accuracy,E=this._map.getBearing(),C=p.extend({bearing:E},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(g),C,{geolocateSource:!0})},o.prototype._updateMarker=function(i){if(i){var h=new p.LngLat(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},o.prototype._updateCircleRadius=function(){var i=this._map._container.clientHeight/2,h=this._map.unproject([0,i]),g=this._map.unproject([1,i]),E=h.distanceTo(g),C=Math.ceil(2*this._accuracy/E);this._circleElement.style.width=C+"px",this._circleElement.style.height=C+"px"},o.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},o.prototype._onError=function(i){if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&fl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("error",i)),this._finish()}},o.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},o.prototype._setupUI=function(i){var h=this;if(this._container.addEventListener("contextmenu",function(C){return C.preventDefault()}),this._geolocateButton=S.create("button","mapboxgl-ctrl-geolocate",this._container),S.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",i===!1){p.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}else{var E=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=S.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ic(this._dotElement),this._circleElement=S.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ic({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(C){C.geolocateSource||h._watchState!=="ACTIVE_LOCK"||C.originalEvent&&C.originalEvent.type==="resize"||(h._watchState="BACKGROUND",h._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),h._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),h.fire(new p.Event("trackuserlocationend")))})},o.prototype.trigger=function(){if(!this._setup)return p.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new p.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ac--,fl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new p.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new p.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var i;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ac>1?(i={maximumAge:6e5,timeout:0},fl=!0):(i=this.options.positionOptions,fl=!1),this._geolocationWatchID=p.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,i)}}else p.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},o.prototype._clearWatch=function(){p.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},o}(p.Evented),hl={maxWidth:100,unit:"metric"},pl=function(o){this.options=p.extend({},hl,o),p.bindAll(["_onMove","setUnit"],this)};function Ul(c,o,i){var h=i&&i.maxWidth||100,g=c._container.clientHeight/2,E=c.unproject([0,g]),C=c.unproject([h,g]),L=E.distanceTo(C);if(i&&i.unit==="imperial"){var Z=3.2808*L;Z>5280?yu(o,h,Z/5280,c._getUIString("ScaleControl.Miles")):yu(o,h,Z,c._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?yu(o,h,L/1852,c._getUIString("ScaleControl.NauticalMiles")):L>=1e3?yu(o,h,L/1e3,c._getUIString("ScaleControl.Kilometers")):yu(o,h,L,c._getUIString("ScaleControl.Meters"))}function yu(c,o,i,h){var g,E,C,L=(g=i,(E=Math.pow(10,(""+Math.floor(g)).length-1))*(C=(C=g/E)>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(Z){var q=Math.pow(10,Math.ceil(-Math.log(Z)/Math.LN10));return Math.round(Z*q)/q}(C)));c.style.width=o*(L/i)+"px",c.innerHTML=L+"&nbsp;"+h}pl.prototype.getDefaultPosition=function(){return"bottom-left"},pl.prototype._onMove=function(){Ul(this._map,this._container,this.options)},pl.prototype.onAdd=function(c){return this._map=c,this._container=S.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",c.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},pl.prototype.onRemove=function(){S.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},pl.prototype.setUnit=function(c){this.options.unit=c,Ul(this._map,this._container,this.options)};var au=function(o){this._fullscreen=!1,o&&o.container&&(o.container instanceof p.window.HTMLElement?this._container=o.container:p.warnOnce("Full screen control 'container' must be a DOM element.")),p.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in p.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in p.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in p.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in p.window.document&&(this._fullscreenchange="MSFullscreenChange")};au.prototype.onAdd=function(c){return this._map=c,this._container||(this._container=this._map.getContainer()),this._controlContainer=S.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",p.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},au.prototype.onRemove=function(){S.remove(this._controlContainer),this._map=null,p.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},au.prototype._checkFullscreenSupport=function(){return!!(p.window.document.fullscreenEnabled||p.window.document.mozFullScreenEnabled||p.window.document.msFullscreenEnabled||p.window.document.webkitFullscreenEnabled)},au.prototype._setupUI=function(){var c=this._fullscreenButton=S.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);S.create("span","mapboxgl-ctrl-icon",c).setAttribute("aria-hidden",!0),c.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),p.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},au.prototype._updateTitle=function(){var c=this._getTitle();this._fullscreenButton.setAttribute("aria-label",c),this._fullscreenButton.title=c},au.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},au.prototype._isFullscreen=function(){return this._fullscreen},au.prototype._changeIcon=function(){(p.window.document.fullscreenElement||p.window.document.mozFullScreenElement||p.window.document.webkitFullscreenElement||p.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},au.prototype._onClickFullscreen=function(){this._isFullscreen()?p.window.document.exitFullscreen?p.window.document.exitFullscreen():p.window.document.mozCancelFullScreen?p.window.document.mozCancelFullScreen():p.window.document.msExitFullscreen?p.window.document.msExitFullscreen():p.window.document.webkitCancelFullScreen&&p.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Gc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},wc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),uf=function(c){function o(i){c.call(this),this.options=p.extend(Object.create(Gc),i),p.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return c&&(o.__proto__=c),(o.prototype=Object.create(c&&c.prototype)).constructor=o,o.prototype.addTo=function(i){return this._map&&this.remove(),this._map=i,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new p.Event("open")),this},o.prototype.isOpen=function(){return!!this._map},o.prototype.remove=function(){return this._content&&S.remove(this._content),this._container&&(S.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new p.Event("close")),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(i){return this._lngLat=p.LngLat.convert(i),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},o.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},o.prototype.getElement=function(){return this._container},o.prototype.setText=function(i){return this.setDOMContent(p.window.document.createTextNode(i))},o.prototype.setHTML=function(i){var h,g=p.window.document.createDocumentFragment(),E=p.window.document.createElement("body");for(E.innerHTML=i;h=E.firstChild;)g.appendChild(h);return this.setDOMContent(g)},o.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},o.prototype.setMaxWidth=function(i){return this.options.maxWidth=i,this._update(),this},o.prototype.setDOMContent=function(i){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=S.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(i),this._createCloseButton(),this._update(),this._focusFirstElement(),this},o.prototype.addClassName=function(i){this._container&&this._container.classList.add(i)},o.prototype.removeClassName=function(i){this._container&&this._container.classList.remove(i)},o.prototype.setOffset=function(i){return this.options.offset=i,this._update(),this},o.prototype.toggleClassName=function(i){if(this._container)return this._container.classList.toggle(i)},o.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=S.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},o.prototype._onMouseUp=function(i){this._update(i.point)},o.prototype._onMouseMove=function(i){this._update(i.point)},o.prototype._onDrag=function(i){this._update(i.point)},o.prototype._update=function(i){var h=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=S.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=S.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(ge){return h._container.classList.add(ge)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=nc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||i)){var g=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat),E=this.options.anchor,C=function ge(be){if(be){if(typeof be=="number"){var Ke=Math.round(Math.sqrt(.5*Math.pow(be,2)));return{center:new p.Point(0,0),top:new p.Point(0,be),"top-left":new p.Point(Ke,Ke),"top-right":new p.Point(-Ke,Ke),bottom:new p.Point(0,-be),"bottom-left":new p.Point(Ke,-Ke),"bottom-right":new p.Point(-Ke,-Ke),left:new p.Point(be,0),right:new p.Point(-be,0)}}if(be instanceof p.Point||Array.isArray(be)){var He=p.Point.convert(be);return{center:He,top:He,"top-left":He,"top-right":He,bottom:He,"bottom-left":He,"bottom-right":He,left:He,right:He}}return{center:p.Point.convert(be.center||[0,0]),top:p.Point.convert(be.top||[0,0]),"top-left":p.Point.convert(be["top-left"]||[0,0]),"top-right":p.Point.convert(be["top-right"]||[0,0]),bottom:p.Point.convert(be.bottom||[0,0]),"bottom-left":p.Point.convert(be["bottom-left"]||[0,0]),"bottom-right":p.Point.convert(be["bottom-right"]||[0,0]),left:p.Point.convert(be.left||[0,0]),right:p.Point.convert(be.right||[0,0])}}return ge(new p.Point(0,0))}(this.options.offset);if(!E){var L,Z=this._container.offsetWidth,q=this._container.offsetHeight;L=g.y+C.bottom.y<q?["top"]:g.y>this._map.transform.height-q?["bottom"]:[],g.x<Z/2?L.push("left"):g.x>this._map.transform.width-Z/2&&L.push("right"),E=L.length===0?"bottom":L.join("-")}var de=g.add(C[E]).round();S.setTransform(this._container,hs[E]+" translate("+de.x+"px,"+de.y+"px)"),Sc(this._container,E,"popup")}},o.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var i=this._container.querySelector(wc);i&&i.focus()}},o.prototype._onClose=function(){this.remove()},o}(p.Evented),Hc={version:p.version,supported:H,setRTLTextPlugin:p.setRTLTextPlugin,getRTLTextPluginStatus:p.getRTLTextPluginStatus,Map:Vc,NavigationControl:Vu,GeolocateControl:Ec,AttributionControl:fs,ScaleControl:pl,FullscreenControl:au,Popup:uf,Marker:ic,Style:Wo,LngLat:p.LngLat,LngLatBounds:p.LngLatBounds,Point:p.Point,MercatorCoordinate:p.MercatorCoordinate,Evented:p.Evented,config:p.config,prewarm:function(){hr().acquire(Xt)},clearPrewarmedResources:function(){var o=On;o&&(o.isPreloaded()&&o.numActive()===1?(o.release(Xt),On=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return p.config.ACCESS_TOKEN},set accessToken(c){p.config.ACCESS_TOKEN=c},get baseApiUrl(){return p.config.API_URL},set baseApiUrl(c){p.config.API_URL=c},get workerCount(){return zr.workerCount},set workerCount(c){zr.workerCount=c},get maxParallelImageRequests(){return p.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(c){p.config.MAX_PARALLEL_IMAGE_REQUESTS=c},clearStorage:function(o){p.clearTileCache(o)},workerUrl:""};return Hc}),X})},27820:function(_t,O,_){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(er){return(0,b.default)((0,fe.default)(er)&&er.length>=1,"Must merge at least 1 JSON schema."),H.default.apply(void 0,[{}].concat(Ut(er),[function(Yt,lt,xt){if(!(0,F.default)(Yt)){if(xt==="required")return(0,we.default)(Yt.concat(lt));if((0,Be.default)(Yt)){if(!(0,Be.default)(lt))throw new Error('Failed to merge schemas because "'+xt+'" has different values.');return}b.default.deepEqual(Yt,lt,'Failed to merge schemas because "'+xt+'" has different values: '+JSON.stringify(Yt)+" and "+JSON.stringify(lt)+".")}}]))};var X=_(15785),b=Xe(X),p=_(55056),H=Xe(p),S=_(19550),F=Xe(S),ie=_(54898),fe=Xe(ie),Q=_(73634),we=Xe(Q),Ie=_(48882),Be=Xe(Ie);function Xe(er){return er&&er.__esModule?er:{default:er}}function Ut(er){if(Array.isArray(er)){for(var Yt=0,lt=Array(er.length);Yt<er.length;Yt++)lt[Yt]=er[Yt];return lt}else return Array.from(er)}_t.exports=O.default},15845:function(_t,O,_){var X=_(6661);/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var b;(function(p){(function(H){var S=typeof _.g=="object"?_.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),F=ie(p);typeof S.Reflect=="undefined"?S.Reflect=p:F=ie(S.Reflect,F),H(F);function ie(fe,Q){return function(we,Ie){typeof fe[we]!="function"&&Object.defineProperty(fe,we,{configurable:!0,writable:!0,value:Ie}),Q&&Q(we,Ie)}}})(function(H){var S=Object.prototype.hasOwnProperty,F=typeof Symbol=="function",ie=F&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",fe=F&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",Q=typeof Object.create=="function",we={__proto__:[]}instanceof Array,Ie=!Q&&!we,Be={create:Q?function(){return Or(Object.create(null))}:we?function(){return Or({__proto__:null})}:function(){return Or({})},has:Ie?function(qe,yt){return S.call(qe,yt)}:function(qe,yt){return yt in qe},get:Ie?function(qe,yt){return S.call(qe,yt)?qe[yt]:void 0}:function(qe,yt){return qe[yt]}},Xe=Object.getPrototypeOf(Function),Ut=typeof X=="object"&&{NODE_ENV:"production"}&&{NODE_ENV:"production"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",er=!Ut&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:dr(),Yt=!Ut&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:wr(),lt=!Ut&&typeof WeakMap=="function"?WeakMap:Tr(),xt=new lt;function ct(qe,yt,dt,lr){if(Lr(dt)){if(!A(qe))throw new TypeError;if(!ve(yt))throw new TypeError;return bt(qe,yt)}else{if(!A(qe))throw new TypeError;if(!ce(yt))throw new TypeError;if(!ce(lr)&&!Lr(lr)&&!qr(lr))throw new TypeError;return qr(lr)&&(lr=void 0),dt=Ct(dt),cr(qe,yt,dt,lr)}}H("decorate",ct);function Sr(qe,yt){function dt(lr,Kr){if(!ce(lr))throw new TypeError;if(!Lr(Kr)&&!Ce(Kr))throw new TypeError;ke(qe,yt,lr,Kr)}return dt}H("metadata",Sr);function Ft(qe,yt,dt,lr){if(!ce(dt))throw new TypeError;return Lr(lr)||(lr=Ct(lr)),ke(qe,yt,dt,lr)}H("defineMetadata",Ft);function Ht(qe,yt,dt){if(!ce(yt))throw new TypeError;return Lr(dt)||(dt=Ct(dt)),Ee(qe,yt,dt)}H("hasMetadata",Ht);function St(qe,yt,dt){if(!ce(yt))throw new TypeError;return Lr(dt)||(dt=Ct(dt)),le(qe,yt,dt)}H("hasOwnMetadata",St);function Ge(qe,yt,dt){if(!ce(yt))throw new TypeError;return Lr(dt)||(dt=Ct(dt)),re(qe,yt,dt)}H("getMetadata",Ge);function vt(qe,yt,dt){if(!ce(yt))throw new TypeError;return Lr(dt)||(dt=Ct(dt)),te(qe,yt,dt)}H("getOwnMetadata",vt);function Pe(qe,yt){if(!ce(qe))throw new TypeError;return Lr(yt)||(yt=Ct(yt)),nt(qe,yt)}H("getMetadataKeys",Pe);function Te(qe,yt){if(!ce(qe))throw new TypeError;return Lr(yt)||(yt=Ct(yt)),Kt(qe,yt)}H("getOwnMetadataKeys",Te);function ze(qe,yt,dt){if(!ce(yt))throw new TypeError;Lr(dt)||(dt=Ct(dt));var lr=ae(yt,dt,!1);if(Lr(lr)||!lr.delete(qe))return!1;if(lr.size>0)return!0;var Kr=xt.get(yt);return Kr.delete(dt),Kr.size>0||xt.delete(yt),!0}H("deleteMetadata",ze);function bt(qe,yt){for(var dt=qe.length-1;dt>=0;--dt){var lr=qe[dt],Kr=lr(yt);if(!Lr(Kr)&&!qr(Kr)){if(!ve(Kr))throw new TypeError;yt=Kr}}return yt}function cr(qe,yt,dt,lr){for(var Kr=qe.length-1;Kr>=0;--Kr){var gt=qe[Kr],Rt=gt(yt,dt,lr);if(!Lr(Rt)&&!qr(Rt)){if(!ce(Rt))throw new TypeError;lr=Rt}}return lr}function ae(qe,yt,dt){var lr=xt.get(qe);if(Lr(lr)){if(!dt)return;lr=new er,xt.set(qe,lr)}var Kr=lr.get(yt);if(Lr(Kr)){if(!dt)return;Kr=new er,lr.set(yt,Kr)}return Kr}function Ee(qe,yt,dt){var lr=le(qe,yt,dt);if(lr)return!0;var Kr=Bt(yt);return qr(Kr)?!1:Ee(qe,Kr,dt)}function le(qe,yt,dt){var lr=ae(yt,dt,!1);return Lr(lr)?!1:Qe(lr.has(qe))}function re(qe,yt,dt){var lr=le(qe,yt,dt);if(lr)return te(qe,yt,dt);var Kr=Bt(yt);if(!qr(Kr))return re(qe,Kr,dt)}function te(qe,yt,dt){var lr=ae(yt,dt,!1);if(!Lr(lr))return lr.get(qe)}function ke(qe,yt,dt,lr){var Kr=ae(dt,lr,!0);Kr.set(qe,yt)}function nt(qe,yt){var dt=Kt(qe,yt),lr=Bt(qe);if(lr===null)return dt;var Kr=nt(lr,yt);if(Kr.length<=0)return dt;if(dt.length<=0)return Kr;for(var gt=new Yt,Rt=[],sr=0,ar=dt;sr<ar.length;sr++){var _n=ar[sr],xn=gt.has(_n);xn||(gt.add(_n),Rt.push(_n))}for(var ci=0,_i=Kr;ci<_i.length;ci++){var _n=_i[ci],xn=gt.has(_n);xn||(gt.add(_n),Rt.push(_n))}return Rt}function Kt(qe,yt){var dt=[],lr=ae(qe,yt,!1);if(Lr(lr))return dt;for(var Kr=lr.keys(),gt=ot(Kr),Rt=0;;){var sr=G(gt);if(!sr)return dt.length=Rt,dt;var ar=Ot(sr);try{dt[Rt]=ar}catch(_n){try{Et(gt)}finally{throw _n}}Rt++}}function Ir(qe){if(qe===null)return 1;switch(typeof qe){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return qe===null?1:6;default:return 6}}function Lr(qe){return qe===void 0}function qr(qe){return qe===null}function tr(qe){return typeof qe=="symbol"}function ce(qe){return typeof qe=="object"?qe!==null:typeof qe=="function"}function ye(qe,yt){switch(Ir(qe)){case 0:return qe;case 1:return qe;case 2:return qe;case 3:return qe;case 4:return qe;case 5:return qe}var dt=yt===3?"string":yt===5?"number":"default",lr=$e(qe,ie);if(lr!==void 0){var Kr=lr.call(qe,dt);if(ce(Kr))throw new TypeError;return Kr}return Re(qe,dt==="default"?"number":dt)}function Re(qe,yt){if(yt==="string"){var dt=qe.toString;if(z(dt)){var lr=dt.call(qe);if(!ce(lr))return lr}var Kr=qe.valueOf;if(z(Kr)){var lr=Kr.call(qe);if(!ce(lr))return lr}}else{var Kr=qe.valueOf;if(z(Kr)){var lr=Kr.call(qe);if(!ce(lr))return lr}var gt=qe.toString;if(z(gt)){var lr=gt.call(qe);if(!ce(lr))return lr}}throw new TypeError}function Qe(qe){return!!qe}function Dt(qe){return""+qe}function Ct(qe){var yt=ye(qe,3);return tr(yt)?yt:Dt(yt)}function A(qe){return Array.isArray?Array.isArray(qe):qe instanceof Object?qe instanceof Array:Object.prototype.toString.call(qe)==="[object Array]"}function z(qe){return typeof qe=="function"}function ve(qe){return typeof qe=="function"}function Ce(qe){switch(Ir(qe)){case 3:return!0;case 4:return!0;default:return!1}}function $e(qe,yt){var dt=qe[yt];if(dt!=null){if(!z(dt))throw new TypeError;return dt}}function ot(qe){var yt=$e(qe,fe);if(!z(yt))throw new TypeError;var dt=yt.call(qe);if(!ce(dt))throw new TypeError;return dt}function Ot(qe){return qe.value}function G(qe){var yt=qe.next();return yt.done?!1:yt}function Et(qe){var yt=qe.return;yt&&yt.call(qe)}function Bt(qe){var yt=Object.getPrototypeOf(qe);if(typeof qe!="function"||qe===Xe||yt!==Xe)return yt;var dt=qe.prototype,lr=dt&&Object.getPrototypeOf(dt);if(lr==null||lr===Object.prototype)return yt;var Kr=lr.constructor;return typeof Kr!="function"||Kr===qe?yt:Kr}function dr(){var qe={},yt=[],dt=function(){function Rt(sr,ar,_n){this._index=0,this._keys=sr,this._values=ar,this._selector=_n}return Rt.prototype["@@iterator"]=function(){return this},Rt.prototype[fe]=function(){return this},Rt.prototype.next=function(){var sr=this._index;if(sr>=0&&sr<this._keys.length){var ar=this._selector(this._keys[sr],this._values[sr]);return sr+1>=this._keys.length?(this._index=-1,this._keys=yt,this._values=yt):this._index++,{value:ar,done:!1}}return{value:void 0,done:!0}},Rt.prototype.throw=function(sr){throw this._index>=0&&(this._index=-1,this._keys=yt,this._values=yt),sr},Rt.prototype.return=function(sr){return this._index>=0&&(this._index=-1,this._keys=yt,this._values=yt),{value:sr,done:!0}},Rt}();return function(){function Rt(){this._keys=[],this._values=[],this._cacheKey=qe,this._cacheIndex=-2}return Object.defineProperty(Rt.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Rt.prototype.has=function(sr){return this._find(sr,!1)>=0},Rt.prototype.get=function(sr){var ar=this._find(sr,!1);return ar>=0?this._values[ar]:void 0},Rt.prototype.set=function(sr,ar){var _n=this._find(sr,!0);return this._values[_n]=ar,this},Rt.prototype.delete=function(sr){var ar=this._find(sr,!1);if(ar>=0){for(var _n=this._keys.length,xn=ar+1;xn<_n;xn++)this._keys[xn-1]=this._keys[xn],this._values[xn-1]=this._values[xn];return this._keys.length--,this._values.length--,sr===this._cacheKey&&(this._cacheKey=qe,this._cacheIndex=-2),!0}return!1},Rt.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=qe,this._cacheIndex=-2},Rt.prototype.keys=function(){return new dt(this._keys,this._values,lr)},Rt.prototype.values=function(){return new dt(this._keys,this._values,Kr)},Rt.prototype.entries=function(){return new dt(this._keys,this._values,gt)},Rt.prototype["@@iterator"]=function(){return this.entries()},Rt.prototype[fe]=function(){return this.entries()},Rt.prototype._find=function(sr,ar){return this._cacheKey!==sr&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=sr)),this._cacheIndex<0&&ar&&(this._cacheIndex=this._keys.length,this._keys.push(sr),this._values.push(void 0)),this._cacheIndex},Rt}();function lr(Rt,sr){return Rt}function Kr(Rt,sr){return sr}function gt(Rt,sr){return[Rt,sr]}}function wr(){return function(){function qe(){this._map=new er}return Object.defineProperty(qe.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),qe.prototype.has=function(yt){return this._map.has(yt)},qe.prototype.add=function(yt){return this._map.set(yt,yt),this},qe.prototype.delete=function(yt){return this._map.delete(yt)},qe.prototype.clear=function(){this._map.clear()},qe.prototype.keys=function(){return this._map.keys()},qe.prototype.values=function(){return this._map.values()},qe.prototype.entries=function(){return this._map.entries()},qe.prototype["@@iterator"]=function(){return this.keys()},qe.prototype[fe]=function(){return this.keys()},qe}()}function Tr(){var qe=16,yt=Be.create(),dt=lr();return function(){function ar(){this._key=lr()}return ar.prototype.has=function(_n){var xn=Kr(_n,!1);return xn!==void 0?Be.has(xn,this._key):!1},ar.prototype.get=function(_n){var xn=Kr(_n,!1);return xn!==void 0?Be.get(xn,this._key):void 0},ar.prototype.set=function(_n,xn){var ci=Kr(_n,!0);return ci[this._key]=xn,this},ar.prototype.delete=function(_n){var xn=Kr(_n,!1);return xn!==void 0?delete xn[this._key]:!1},ar.prototype.clear=function(){this._key=lr()},ar}();function lr(){var ar;do ar="@@WeakMap@@"+sr();while(Be.has(yt,ar));return yt[ar]=!0,ar}function Kr(ar,_n){if(!S.call(ar,dt)){if(!_n)return;Object.defineProperty(ar,dt,{value:Be.create()})}return ar[dt]}function gt(ar,_n){for(var xn=0;xn<_n;++xn)ar[xn]=Math.random()*255|0;return ar}function Rt(ar){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(ar)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(ar)):gt(new Uint8Array(ar),ar):gt(new Array(ar),ar)}function sr(){var ar=Rt(qe);ar[6]=ar[6]&79|64,ar[8]=ar[8]&191|128;for(var _n="",xn=0;xn<qe;++xn){var ci=ar[xn];(xn===4||xn===6||xn===8)&&(_n+="-"),ci<16&&(_n+="0"),_n+=ci.toString(16).toLowerCase()}return _n}}function Or(qe){return qe.__=void 0,delete qe.__,qe}})})(b||(b={}))},20607:function(_t){(function(O,_){_t.exports=_()})(this,function(){"use strict";var O=function(he){return he instanceof Uint8Array||he instanceof Uint16Array||he instanceof Uint32Array||he instanceof Int8Array||he instanceof Int16Array||he instanceof Int32Array||he instanceof Float32Array||he instanceof Float64Array||he instanceof Uint8ClampedArray},_=function(he,Ue){for(var Vt=Object.keys(Ue),yr=0;yr<Vt.length;++yr)he[Vt[yr]]=Ue[Vt[yr]];return he},X=`
`;function b(J){return typeof atob!="undefined"?atob(J):"base64:"+J}function p(J){var he=new Error("(regl) "+J);throw console.error(he),he}function H(J,he){J||p(he)}function S(J){return J?": "+J:""}function F(J,he,Ue){J in he||p("unknown parameter ("+J+")"+S(Ue)+". possible values: "+Object.keys(he).join())}function ie(J,he){O(J)||p("invalid parameter type"+S(he)+". must be a typed array")}function fe(J,he){switch(he){case"number":return typeof J=="number";case"object":return typeof J=="object";case"string":return typeof J=="string";case"boolean":return typeof J=="boolean";case"function":return typeof J=="function";case"undefined":return typeof J=="undefined";case"symbol":return typeof J=="symbol"}}function Q(J,he,Ue){fe(J,he)||p("invalid parameter type"+S(Ue)+". expected "+he+", got "+typeof J)}function we(J,he){J>=0&&(J|0)===J||p("invalid parameter type, ("+J+")"+S(he)+". must be a nonnegative integer")}function Ie(J,he,Ue){he.indexOf(J)<0&&p("invalid value"+S(Ue)+". must be one of: "+he)}var Be=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Xe(J){Object.keys(J).forEach(function(he){Be.indexOf(he)<0&&p('invalid regl constructor argument "'+he+'". must be one of '+Be)})}function Ut(J,he){for(J=J+"";J.length<he;)J=" "+J;return J}function er(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Yt(J,he){this.number=J,this.line=he,this.errors=[]}function lt(J,he,Ue){this.file=J,this.line=he,this.message=Ue}function xt(){var J=new Error,he=(J.stack||J).toString(),Ue=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(he);if(Ue)return Ue[1];var Vt=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(he);return Vt?Vt[1]:"unknown"}function ct(){var J=new Error,he=(J.stack||J).toString(),Ue=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(he);if(Ue)return Ue[1];var Vt=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(he);return Vt?Vt[1]:"unknown"}function Sr(J,he){var Ue=J.split(`
`),Vt=1,yr=0,pr={unknown:new er,0:new er};pr.unknown.name=pr[0].name=he||xt(),pr.unknown.lines.push(new Yt(0,""));for(var rr=0;rr<Ue.length;++rr){var kr=Ue[rr],rn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(kr);if(rn)switch(rn[1]){case"line":var Wr=/(\d+)(\s+\d+)?/.exec(rn[2]);Wr&&(Vt=Wr[1]|0,Wr[2]&&(yr=Wr[2]|0,yr in pr||(pr[yr]=new er)));break;case"define":var $r=/SHADER_NAME(_B64)?\s+(.*)$/.exec(rn[2]);$r&&(pr[yr].name=$r[1]?b($r[2]):$r[2]);break}pr[yr].lines.push(new Yt(Vt++,kr))}return Object.keys(pr).forEach(function(on){var gn=pr[on];gn.lines.forEach(function(cn){gn.index[cn.number]=cn})}),pr}function Ft(J){var he=[];return J.split(`
`).forEach(function(Ue){if(!(Ue.length<5)){var Vt=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Ue);Vt?he.push(new lt(Vt[1]|0,Vt[2]|0,Vt[3].trim())):Ue.length>0&&he.push(new lt("unknown",0,Ue))}}),he}function Ht(J,he){he.forEach(function(Ue){var Vt=J[Ue.file];if(Vt){var yr=Vt.index[Ue.line];if(yr){yr.errors.push(Ue),Vt.hasErrors=!0;return}}J.unknown.hasErrors=!0,J.unknown.lines[0].errors.push(Ue)})}function St(J,he,Ue,Vt,yr){if(!J.getShaderParameter(he,J.COMPILE_STATUS)){var pr=J.getShaderInfoLog(he),rr=Vt===J.FRAGMENT_SHADER?"fragment":"vertex";cr(Ue,"string",rr+" shader source must be a string",yr);var kr=Sr(Ue,yr),rn=Ft(pr);Ht(kr,rn),Object.keys(kr).forEach(function(Wr){var $r=kr[Wr];if(!$r.hasErrors)return;var on=[""],gn=[""];function cn(en,ir){on.push(en),gn.push(ir||"")}cn("file number "+Wr+": "+$r.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),$r.lines.forEach(function(en){if(en.errors.length>0){cn(Ut(en.number,4)+"|  ","background-color:yellow; font-weight:bold"),cn(en.line+X,"color:red; background-color:yellow; font-weight:bold");var ir=0;en.errors.forEach(function(Jt){var jr=Jt.message,yn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(jr);if(yn){var br=yn[1];switch(jr=yn[2],br){case"assign":br="=";break}ir=Math.max(en.line.indexOf(br,ir),0)}else ir=0;cn(Ut("| ",6)),cn(Ut("^^^",ir+3)+X,"font-weight:bold"),cn(Ut("| ",6)),cn(jr+X,"font-weight:bold")}),cn(Ut("| ",6)+X)}else cn(Ut(en.number,4)+"|  "),cn(en.line+X,"color:red")}),typeof document!="undefined"&&!window.chrome?(gn[0]=on.join("%c"),console.log.apply(console,gn)):console.log(on.join(""))}),H.raise("Error compiling "+rr+" shader, "+kr[0].name)}}function Ge(J,he,Ue,Vt,yr){if(!J.getProgramParameter(he,J.LINK_STATUS)){var pr=J.getProgramInfoLog(he),rr=Sr(Ue,yr),kr=Sr(Vt,yr),rn='Error linking program with vertex shader, "'+kr[0].name+'", and fragment shader "'+rr[0].name+'"';typeof document!="undefined"?console.log("%c"+rn+X+"%c"+pr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(rn+X+pr),H.raise(rn)}}function vt(J){J._commandRef=xt()}function Pe(J,he,Ue,Vt){vt(J);function yr(rn){return rn?Vt.id(rn):0}J._fragId=yr(J.static.frag),J._vertId=yr(J.static.vert);function pr(rn,Wr){Object.keys(Wr).forEach(function($r){rn[Vt.id($r)]=!0})}var rr=J._uniformSet={};pr(rr,he.static),pr(rr,he.dynamic);var kr=J._attributeSet={};pr(kr,Ue.static),pr(kr,Ue.dynamic),J._hasCount="count"in J.static||"count"in J.dynamic||"elements"in J.static||"elements"in J.dynamic}function Te(J,he){var Ue=ct();p(J+" in command "+(he||xt())+(Ue==="unknown"?"":" called from "+Ue))}function ze(J,he,Ue){J||Te(he,Ue||xt())}function bt(J,he,Ue,Vt){J in he||Te("unknown parameter ("+J+")"+S(Ue)+". possible values: "+Object.keys(he).join(),Vt||xt())}function cr(J,he,Ue,Vt){fe(J,he)||Te("invalid parameter type"+S(Ue)+". expected "+he+", got "+typeof J,Vt||xt())}function ae(J){J()}function Ee(J,he,Ue){J.texture?Ie(J.texture._texture.internalformat,he,"unsupported texture format for attachment"):Ie(J.renderbuffer._renderbuffer.format,Ue,"unsupported renderbuffer format for attachment")}var le=33071,re=9728,te=9984,ke=9985,nt=9986,Kt=9987,Ir=5120,Lr=5121,qr=5122,tr=5123,ce=5124,ye=5125,Re=5126,Qe=32819,Dt=32820,Ct=33635,A=34042,z=36193,ve={};ve[Ir]=ve[Lr]=1,ve[qr]=ve[tr]=ve[z]=ve[Ct]=ve[Qe]=ve[Dt]=2,ve[ce]=ve[ye]=ve[Re]=ve[A]=4;function Ce(J,he){return J===Dt||J===Qe||J===Ct?2:J===A?4:ve[J]*he}function $e(J){return!(J&J-1)&&!!J}function ot(J,he,Ue){var Vt,yr=he.width,pr=he.height,rr=he.channels;H(yr>0&&yr<=Ue.maxTextureSize&&pr>0&&pr<=Ue.maxTextureSize,"invalid texture shape"),(J.wrapS!==le||J.wrapT!==le)&&H($e(yr)&&$e(pr),"incompatible wrap mode for texture, both width and height must be power of 2"),he.mipmask===1?yr!==1&&pr!==1&&H(J.minFilter!==te&&J.minFilter!==nt&&J.minFilter!==ke&&J.minFilter!==Kt,"min filter requires mipmap"):(H($e(yr)&&$e(pr),"texture must be a square power of 2 to support mipmapping"),H(he.mipmask===(yr<<1)-1,"missing or incomplete mipmap data")),he.type===Re&&(Ue.extensions.indexOf("oes_texture_float_linear")<0&&H(J.minFilter===re&&J.magFilter===re,"filter not supported, must enable oes_texture_float_linear"),H(!J.genMipmaps,"mipmap generation not supported with float textures"));var kr=he.images;for(Vt=0;Vt<16;++Vt)if(kr[Vt]){var rn=yr>>Vt,Wr=pr>>Vt;H(he.mipmask&1<<Vt,"missing mipmap data");var $r=kr[Vt];if(H($r.width===rn&&$r.height===Wr,"invalid shape for mip images"),H($r.format===he.format&&$r.internalformat===he.internalformat&&$r.type===he.type,"incompatible type for mip image"),!$r.compressed)if($r.data){var on=Math.ceil(Ce($r.type,rr)*rn/$r.unpackAlignment)*$r.unpackAlignment;H($r.data.byteLength===on*Wr,"invalid data for image, buffer size is inconsistent with image format")}else $r.element||$r.copy}else J.genMipmaps||H((he.mipmask&1<<Vt)==0,"extra mipmap data");he.compressed&&H(!J.genMipmaps,"mipmap generation for compressed images not supported")}function Ot(J,he,Ue,Vt){var yr=J.width,pr=J.height,rr=J.channels;H(yr>0&&yr<=Vt.maxTextureSize&&pr>0&&pr<=Vt.maxTextureSize,"invalid texture shape"),H(yr===pr,"cube map must be square"),H(he.wrapS===le&&he.wrapT===le,"wrap mode not supported by cube map");for(var kr=0;kr<Ue.length;++kr){var rn=Ue[kr];H(rn.width===yr&&rn.height===pr,"inconsistent cube map face shape"),he.genMipmaps&&(H(!rn.compressed,"can not generate mipmap for compressed textures"),H(rn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Wr=rn.images,$r=0;$r<16;++$r){var on=Wr[$r];if(on){var gn=yr>>$r,cn=pr>>$r;H(rn.mipmask&1<<$r,"missing mipmap data"),H(on.width===gn&&on.height===cn,"invalid shape for mip images"),H(on.format===J.format&&on.internalformat===J.internalformat&&on.type===J.type,"incompatible type for mip image"),on.compressed||(on.data?H(on.data.byteLength===gn*cn*Math.max(Ce(on.type,rr),on.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):on.element||on.copy)}}}}var G=_(H,{optional:ae,raise:p,commandRaise:Te,command:ze,parameter:F,commandParameter:bt,constructor:Xe,type:Q,commandType:cr,isTypedArray:ie,nni:we,oneOf:Ie,shaderError:St,linkError:Ge,callSite:ct,saveCommandRef:vt,saveDrawInfo:Pe,framebufferFormat:Ee,guessCommand:xt,texture2D:ot,textureCube:Ot}),Et=0,Bt=0,dr=5,wr=6;function Tr(J,he){this.id=Et++,this.type=J,this.data=he}function Or(J){return J.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function qe(J){if(J.length===0)return[];var he=J.charAt(0),Ue=J.charAt(J.length-1);if(J.length>1&&he===Ue&&(he==='"'||he==="'"))return['"'+Or(J.substr(1,J.length-2))+'"'];var Vt=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(J);if(Vt)return qe(J.substr(0,Vt.index)).concat(qe(Vt[1])).concat(qe(J.substr(Vt.index+Vt[0].length)));var yr=J.split(".");if(yr.length===1)return['"'+Or(J)+'"'];for(var pr=[],rr=0;rr<yr.length;++rr)pr=pr.concat(qe(yr[rr]));return pr}function yt(J){return"["+qe(J).join("][")+"]"}function dt(J,he){return new Tr(J,yt(he+""))}function lr(J){return typeof J=="function"&&!J._reglType||J instanceof Tr}function Kr(J,he){if(typeof J=="function")return new Tr(Bt,J);if(typeof J=="number"||typeof J=="boolean")return new Tr(dr,J);if(Array.isArray(J))return new Tr(wr,J.map(function(Ue,Vt){return Kr(Ue,he+"["+Vt+"]")}));if(J instanceof Tr)return J;G(!1,"invalid option type in uniform "+he)}var gt={DynamicVariable:Tr,define:dt,isDynamic:lr,unbox:Kr,accessor:yt},Rt={next:typeof requestAnimationFrame=="function"?function(J){return requestAnimationFrame(J)}:function(J){return setTimeout(J,16)},cancel:typeof cancelAnimationFrame=="function"?function(J){return cancelAnimationFrame(J)}:clearTimeout},sr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function ar(){var J={"":0},he=[""];return{id:function(Vt){var yr=J[Vt];return yr||(yr=J[Vt]=he.length,he.push(Vt),yr)},str:function(Vt){return he[Vt]}}}function _n(J,he,Ue){var Vt=document.createElement("canvas");_(Vt.style,{border:0,margin:0,padding:0,top:0,left:0}),J.appendChild(Vt),J===document.body&&(Vt.style.position="absolute",_(J.style,{margin:0,padding:0}));function yr(){var kr=window.innerWidth,rn=window.innerHeight;if(J!==document.body){var Wr=J.getBoundingClientRect();kr=Wr.right-Wr.left,rn=Wr.bottom-Wr.top}Vt.width=Ue*kr,Vt.height=Ue*rn,_(Vt.style,{width:kr+"px",height:rn+"px"})}var pr;J!==document.body&&typeof ResizeObserver=="function"?(pr=new ResizeObserver(function(){setTimeout(yr)}),pr.observe(J)):window.addEventListener("resize",yr,!1);function rr(){pr?pr.disconnect():window.removeEventListener("resize",yr),J.removeChild(Vt)}return yr(),{canvas:Vt,onDestroy:rr}}function xn(J,he){function Ue(Vt){try{return J.getContext(Vt,he)}catch(yr){return null}}return Ue("webgl")||Ue("experimental-webgl")||Ue("webgl-experimental")}function ci(J){return typeof J.nodeName=="string"&&typeof J.appendChild=="function"&&typeof J.getBoundingClientRect=="function"}function _i(J){return typeof J.drawArrays=="function"||typeof J.drawElements=="function"}function Ui(J){return typeof J=="string"?J.split():(G(Array.isArray(J),"invalid extension array"),J)}function Xi(J){return typeof J=="string"?(G(typeof document!="undefined","not supported outside of DOM"),document.querySelector(J)):J}function oi(J){var he=J||{},Ue,Vt,yr,pr,rr={},kr=[],rn=[],Wr=typeof window=="undefined"?1:window.devicePixelRatio,$r=!1,on=function(ir){ir&&G.raise(ir)},gn=function(){};if(typeof he=="string"?(G(typeof document!="undefined","selector queries only supported in DOM enviroments"),Ue=document.querySelector(he),G(Ue,"invalid query string for element")):typeof he=="object"?ci(he)?Ue=he:_i(he)?(pr=he,yr=pr.canvas):(G.constructor(he),"gl"in he?pr=he.gl:"canvas"in he?yr=Xi(he.canvas):"container"in he&&(Vt=Xi(he.container)),"attributes"in he&&(rr=he.attributes,G.type(rr,"object","invalid context attributes")),"extensions"in he&&(kr=Ui(he.extensions)),"optionalExtensions"in he&&(rn=Ui(he.optionalExtensions)),"onDone"in he&&(G.type(he.onDone,"function","invalid or missing onDone callback"),on=he.onDone),"profile"in he&&($r=!!he.profile),"pixelRatio"in he&&(Wr=+he.pixelRatio,G(Wr>0,"invalid pixel ratio"))):G.raise("invalid arguments to regl"),Ue&&(Ue.nodeName.toLowerCase()==="canvas"?yr=Ue:Vt=Ue),!pr){if(!yr){G(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var cn=_n(Vt||document.body,on,Wr);if(!cn)return null;yr=cn.canvas,gn=cn.onDestroy}rr.premultipliedAlpha===void 0&&(rr.premultipliedAlpha=!0),pr=xn(yr,rr)}return pr?{gl:pr,canvas:yr,container:Vt,extensions:kr,optionalExtensions:rn,pixelRatio:Wr,profile:$r,onDone:on,onDestroy:gn}:(gn(),on("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function K(J,he){var Ue={};function Vt(rr){G.type(rr,"string","extension name must be string");var kr=rr.toLowerCase(),rn;try{rn=Ue[kr]=J.getExtension(kr)}catch(Wr){}return!!rn}for(var yr=0;yr<he.extensions.length;++yr){var pr=he.extensions[yr];if(!Vt(pr))return he.onDestroy(),he.onDone('"'+pr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return he.optionalExtensions.forEach(Vt),{extensions:Ue,restore:function(){Object.keys(Ue).forEach(function(kr){if(Ue[kr]&&!Vt(kr))throw new Error("(regl): error restoring extension "+kr)})}}}function I(J,he){for(var Ue=Array(J),Vt=0;Vt<J;++Vt)Ue[Vt]=he(Vt);return Ue}var j=5120,Y=5121,ue=5122,Le=5123,Me=5124,se=5125,Ne=5126;function At(J){for(var he=16;he<=1<<28;he*=16)if(J<=he)return he;return 0}function Dr(J){var he,Ue;return he=(J>65535)<<4,J>>>=he,Ue=(J>255)<<3,J>>>=Ue,he|=Ue,Ue=(J>15)<<2,J>>>=Ue,he|=Ue,Ue=(J>3)<<1,J>>>=Ue,he|=Ue,he|J>>1}function Ur(){var J=I(8,function(){return[]});function he(pr){var rr=At(pr),kr=J[Dr(rr)>>2];return kr.length>0?kr.pop():new ArrayBuffer(rr)}function Ue(pr){J[Dr(pr.byteLength)>>2].push(pr)}function Vt(pr,rr){var kr=null;switch(pr){case j:kr=new Int8Array(he(rr),0,rr);break;case Y:kr=new Uint8Array(he(rr),0,rr);break;case ue:kr=new Int16Array(he(2*rr),0,rr);break;case Le:kr=new Uint16Array(he(2*rr),0,rr);break;case Me:kr=new Int32Array(he(4*rr),0,rr);break;case se:kr=new Uint32Array(he(4*rr),0,rr);break;case Ne:kr=new Float32Array(he(4*rr),0,rr);break;default:return null}return kr.length!==rr?kr.subarray(0,rr):kr}function yr(pr){Ue(pr.buffer)}return{alloc:he,free:Ue,allocType:Vt,freeType:yr}}var Xt=Ur();Xt.zero=Ur();var zr=3408,On=3410,vn=3411,hr=3412,pn=3413,un=3414,fn=3415,hi=33901,Jr=33902,vi=3379,Li=3386,Qn=34921,xi=36347,Ti=36348,bo=35661,ki=35660,si=34930,Rn=36349,Ri=34076,Zn=34024,za=7936,ys=7937,Fi=7938,ha=35724,Sl=34047,Ga=36063,mi=34852,ro=3553,Na=34067,Ba=34069,Go=33984,ta=6408,Ua=5126,xa=5121,os=36160,$o=36053,El=36064,Jo=16384,Pa=function(he,Ue){var Vt=1;Ue.ext_texture_filter_anisotropic&&(Vt=he.getParameter(Sl));var yr=1,pr=1;Ue.webgl_draw_buffers&&(yr=he.getParameter(mi),pr=he.getParameter(Ga));var rr=!!Ue.oes_texture_float;if(rr){var kr=he.createTexture();he.bindTexture(ro,kr),he.texImage2D(ro,0,ta,1,1,0,ta,Ua,null);var rn=he.createFramebuffer();if(he.bindFramebuffer(os,rn),he.framebufferTexture2D(os,El,ro,kr,0),he.bindTexture(ro,null),he.checkFramebufferStatus(os)!==$o)rr=!1;else{he.viewport(0,0,1,1),he.clearColor(1,0,0,1),he.clear(Jo);var Wr=Xt.allocType(Ua,4);he.readPixels(0,0,1,1,ta,Ua,Wr),he.getError()?rr=!1:(he.deleteFramebuffer(rn),he.deleteTexture(kr),rr=Wr[0]===1),Xt.freeType(Wr)}}var $r=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),on=!0;if(!$r){var gn=he.createTexture(),cn=Xt.allocType(xa,36);he.activeTexture(Go),he.bindTexture(Na,gn),he.texImage2D(Ba,0,ta,3,3,0,ta,xa,cn),Xt.freeType(cn),he.bindTexture(Na,null),he.deleteTexture(gn),on=!he.getError()}return{colorBits:[he.getParameter(On),he.getParameter(vn),he.getParameter(hr),he.getParameter(pn)],depthBits:he.getParameter(un),stencilBits:he.getParameter(fn),subpixelBits:he.getParameter(zr),extensions:Object.keys(Ue).filter(function(en){return!!Ue[en]}),maxAnisotropic:Vt,maxDrawbuffers:yr,maxColorAttachments:pr,pointSizeDims:he.getParameter(hi),lineWidthDims:he.getParameter(Jr),maxViewportDims:he.getParameter(Li),maxCombinedTextureUnits:he.getParameter(bo),maxCubeMapSize:he.getParameter(Ri),maxRenderbufferSize:he.getParameter(Zn),maxTextureUnits:he.getParameter(si),maxTextureSize:he.getParameter(vi),maxAttributes:he.getParameter(Qn),maxVertexUniforms:he.getParameter(xi),maxVertexTextureUnits:he.getParameter(ki),maxVaryingVectors:he.getParameter(Ti),maxFragmentUniforms:he.getParameter(Rn),glsl:he.getParameter(ha),renderer:he.getParameter(ys),vendor:he.getParameter(za),version:he.getParameter(Fi),readFloat:rr,npotTextureCube:on}};function Ha(J){return!!J&&typeof J=="object"&&Array.isArray(J.shape)&&Array.isArray(J.stride)&&typeof J.offset=="number"&&J.shape.length===J.stride.length&&(Array.isArray(J.data)||O(J.data))}var pa=function(he){return Object.keys(he).map(function(Ue){return he[Ue]})},rt={shape:Ai,flatten:nn};function pe(J,he,Ue){for(var Vt=0;Vt<he;++Vt)Ue[Vt]=J[Vt]}function Ye(J,he,Ue,Vt){for(var yr=0,pr=0;pr<he;++pr)for(var rr=J[pr],kr=0;kr<Ue;++kr)Vt[yr++]=rr[kr]}function Qt(J,he,Ue,Vt,yr,pr){for(var rr=pr,kr=0;kr<he;++kr)for(var rn=J[kr],Wr=0;Wr<Ue;++Wr)for(var $r=rn[Wr],on=0;on<Vt;++on)yr[rr++]=$r[on]}function Zr(J,he,Ue,Vt,yr){for(var pr=1,rr=Ue+1;rr<he.length;++rr)pr*=he[rr];var kr=he[Ue];if(he.length-Ue==4){var rn=he[Ue+1],Wr=he[Ue+2],$r=he[Ue+3];for(rr=0;rr<kr;++rr)Qt(J[rr],rn,Wr,$r,Vt,yr),yr+=pr}else for(rr=0;rr<kr;++rr)Zr(J[rr],he,Ue+1,Vt,yr),yr+=pr}function nn(J,he,Ue,Vt){var yr=1;if(he.length)for(var pr=0;pr<he.length;++pr)yr*=he[pr];else yr=0;var rr=Vt||Xt.allocType(Ue,yr);switch(he.length){case 0:break;case 1:pe(J,he[0],rr);break;case 2:Ye(J,he[0],he[1],rr);break;case 3:Qt(J,he[0],he[1],he[2],rr,0);break;default:Zr(J,he,0,rr,0)}return rr}function Ai(J){for(var he=[],Ue=J;Ue.length;Ue=Ue[0])he.push(Ue.length);return he}var ya={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ma=5120,va=5122,Ia=5124,Fu=5121,$u=5123,wl=5125,Po=5126,ba=5126,$n={int8:Ma,int16:va,int32:Ia,uint8:Fu,uint16:$u,uint32:wl,float:Po,float32:ba},js=35048,Ho=35040,Wa={dynamic:js,stream:Ho,static:35044},Xa=rt.flatten,Wo=rt.shape,Ya=35044,bu=35040,Il=5121,So=5126,Ze=[];Ze[5120]=1,Ze[5122]=2,Ze[5124]=4,Ze[5121]=1,Ze[5123]=2,Ze[5125]=4,Ze[5126]=4;function Nt(J){return ya[Object.prototype.toString.call(J)]|0}function mr(J,he){for(var Ue=0;Ue<he.length;++Ue)J[Ue]=he[Ue]}function zn(J,he,Ue,Vt,yr,pr,rr){for(var kr=0,rn=0;rn<Ue;++rn)for(var Wr=0;Wr<Vt;++Wr)J[kr++]=he[yr*rn+pr*Wr+rr]}function oa(J,he,Ue,Vt){var yr=0,pr={};function rr(ir){this.id=yr++,this.buffer=J.createBuffer(),this.type=ir,this.usage=Ya,this.byteLength=0,this.dimension=1,this.dtype=Il,this.persistentData=null,Ue.profile&&(this.stats={size:0})}rr.prototype.bind=function(){J.bindBuffer(this.type,this.buffer)},rr.prototype.destroy=function(){gn(this)};var kr=[];function rn(ir,Jt){var jr=kr.pop();return jr||(jr=new rr(ir)),jr.bind(),on(jr,Jt,bu,0,1,!1),jr}function Wr(ir){kr.push(ir)}function $r(ir,Jt,jr){ir.byteLength=Jt.byteLength,J.bufferData(ir.type,Jt,jr)}function on(ir,Jt,jr,yn,br,Yn){var Gr;if(ir.usage=jr,Array.isArray(Jt)){if(ir.dtype=yn||So,Jt.length>0){var Br;if(Array.isArray(Jt[0])){Gr=Wo(Jt);for(var Fr=1,Xr=1;Xr<Gr.length;++Xr)Fr*=Gr[Xr];ir.dimension=Fr,Br=Xa(Jt,Gr,ir.dtype),$r(ir,Br,jr),Yn?ir.persistentData=Br:Xt.freeType(Br)}else if(typeof Jt[0]=="number"){ir.dimension=br;var jn=Xt.allocType(ir.dtype,Jt.length);mr(jn,Jt),$r(ir,jn,jr),Yn?ir.persistentData=jn:Xt.freeType(jn)}else O(Jt[0])?(ir.dimension=Jt[0].length,ir.dtype=yn||Nt(Jt[0])||So,Br=Xa(Jt,[Jt.length,Jt[0].length],ir.dtype),$r(ir,Br,jr),Yn?ir.persistentData=Br:Xt.freeType(Br)):G.raise("invalid buffer data")}}else if(O(Jt))ir.dtype=yn||Nt(Jt),ir.dimension=br,$r(ir,Jt,jr),Yn&&(ir.persistentData=new Uint8Array(new Uint8Array(Jt.buffer)));else if(Ha(Jt)){Gr=Jt.shape;var qn=Jt.stride,ln=Jt.offset,Nr=0,Rr=0,ri=0,ni=0;Gr.length===1?(Nr=Gr[0],Rr=1,ri=qn[0],ni=0):Gr.length===2?(Nr=Gr[0],Rr=Gr[1],ri=qn[0],ni=qn[1]):G.raise("invalid shape"),ir.dtype=yn||Nt(Jt.data)||So,ir.dimension=Rr;var Ln=Xt.allocType(ir.dtype,Nr*Rr);zn(Ln,Jt.data,Nr,Rr,ri,ni,ln),$r(ir,Ln,jr),Yn?ir.persistentData=Ln:Xt.freeType(Ln)}else Jt instanceof ArrayBuffer?(ir.dtype=Il,ir.dimension=br,$r(ir,Jt,jr),Yn&&(ir.persistentData=new Uint8Array(new Uint8Array(Jt)))):G.raise("invalid buffer data")}function gn(ir){he.bufferCount--,Vt(ir);var Jt=ir.buffer;G(Jt,"buffer must not be deleted already"),J.deleteBuffer(Jt),ir.buffer=null,delete pr[ir.id]}function cn(ir,Jt,jr,yn){he.bufferCount++;var br=new rr(Jt);pr[br.id]=br;function Yn(Fr){var Xr=Ya,jn=null,qn=0,ln=0,Nr=1;return Array.isArray(Fr)||O(Fr)||Ha(Fr)||Fr instanceof ArrayBuffer?jn=Fr:typeof Fr=="number"?qn=Fr|0:Fr&&(G.type(Fr,"object","buffer arguments must be an object, a number or an array"),"data"in Fr&&(G(jn===null||Array.isArray(jn)||O(jn)||Ha(jn),"invalid data for buffer"),jn=Fr.data),"usage"in Fr&&(G.parameter(Fr.usage,Wa,"invalid buffer usage"),Xr=Wa[Fr.usage]),"type"in Fr&&(G.parameter(Fr.type,$n,"invalid buffer type"),ln=$n[Fr.type]),"dimension"in Fr&&(G.type(Fr.dimension,"number","invalid dimension"),Nr=Fr.dimension|0),"length"in Fr&&(G.nni(qn,"buffer length must be a nonnegative integer"),qn=Fr.length|0)),br.bind(),jn?on(br,jn,Xr,ln,Nr,yn):(qn&&J.bufferData(br.type,qn,Xr),br.dtype=ln||Il,br.usage=Xr,br.dimension=Nr,br.byteLength=qn),Ue.profile&&(br.stats.size=br.byteLength*Ze[br.dtype]),Yn}function Gr(Fr,Xr){G(Xr+Fr.byteLength<=br.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Fr.byteLength+" starting from offset "+Xr+" to a buffer of size "+br.byteLength),J.bufferSubData(br.type,Xr,Fr)}function Br(Fr,Xr){var jn=(Xr||0)|0,qn;if(br.bind(),O(Fr)||Fr instanceof ArrayBuffer)Gr(Fr,jn);else if(Array.isArray(Fr)){if(Fr.length>0)if(typeof Fr[0]=="number"){var ln=Xt.allocType(br.dtype,Fr.length);mr(ln,Fr),Gr(ln,jn),Xt.freeType(ln)}else if(Array.isArray(Fr[0])||O(Fr[0])){qn=Wo(Fr);var Nr=Xa(Fr,qn,br.dtype);Gr(Nr,jn),Xt.freeType(Nr)}else G.raise("invalid buffer data")}else if(Ha(Fr)){qn=Fr.shape;var Rr=Fr.stride,ri=0,ni=0,Ln=0,Vi=0;qn.length===1?(ri=qn[0],ni=1,Ln=Rr[0],Vi=0):qn.length===2?(ri=qn[0],ni=qn[1],Ln=Rr[0],Vi=Rr[1]):G.raise("invalid shape");var wi=Array.isArray(Fr.data)?br.dtype:Nt(Fr.data),Gi=Xt.allocType(wi,ri*ni);zn(Gi,Fr.data,ri,ni,Ln,Vi,Fr.offset),Gr(Gi,jn),Xt.freeType(Gi)}else G.raise("invalid data for buffer subdata");return Yn}return jr||Yn(ir),Yn._reglType="buffer",Yn._buffer=br,Yn.subdata=Br,Ue.profile&&(Yn.stats=br.stats),Yn.destroy=function(){gn(br)},Yn}function en(){pa(pr).forEach(function(ir){ir.buffer=J.createBuffer(),J.bindBuffer(ir.type,ir.buffer),J.bufferData(ir.type,ir.persistentData||ir.byteLength,ir.usage)})}return Ue.profile&&(he.getTotalBufferSize=function(){var ir=0;return Object.keys(pr).forEach(function(Jt){ir+=pr[Jt].stats.size}),ir}),{create:cn,createStream:rn,destroyStream:Wr,clear:function(){pa(pr).forEach(gn),kr.forEach(gn)},getBuffer:function(Jt){return Jt&&Jt._buffer instanceof rr?Jt._buffer:null},restore:en,_initBuffer:on}}var Sa=0,wa=0,sa=1,Ta=1,ss=4,As=4,ja={points:Sa,point:wa,lines:sa,line:Ta,triangles:ss,triangle:As,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Xl=0,Su=1,us=4,Ol=5120,_s=5121,Eu=5122,wu=5123,Tl=5124,Zs=5125,tf=34963,Lc=35040,ma=35044;function zu(J,he,Ue,Vt){var yr={},pr=0,rr={uint8:_s,uint16:wu};he.oes_element_index_uint&&(rr.uint32=Zs);function kr(en){this.id=pr++,yr[this.id]=this,this.buffer=en,this.primType=us,this.vertCount=0,this.type=0}kr.prototype.bind=function(){this.buffer.bind()};var rn=[];function Wr(en){var ir=rn.pop();return ir||(ir=new kr(Ue.create(null,tf,!0,!1)._buffer)),on(ir,en,Lc,-1,-1,0,0),ir}function $r(en){rn.push(en)}function on(en,ir,Jt,jr,yn,br,Yn){en.buffer.bind();var Gr;if(ir){var Br=Yn;!Yn&&(!O(ir)||Ha(ir)&&!O(ir.data))&&(Br=he.oes_element_index_uint?Zs:wu),Ue._initBuffer(en.buffer,ir,Jt,Br,3)}else J.bufferData(tf,br,Jt),en.buffer.dtype=Gr||_s,en.buffer.usage=Jt,en.buffer.dimension=3,en.buffer.byteLength=br;if(Gr=Yn,!Yn){switch(en.buffer.dtype){case _s:case Ol:Gr=_s;break;case wu:case Eu:Gr=wu;break;case Zs:case Tl:Gr=Zs;break;default:G.raise("unsupported type for element array")}en.buffer.dtype=Gr}en.type=Gr,G(Gr!==Zs||!!he.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Fr=yn;Fr<0&&(Fr=en.buffer.byteLength,Gr===wu?Fr>>=1:Gr===Zs&&(Fr>>=2)),en.vertCount=Fr;var Xr=jr;if(jr<0){Xr=us;var jn=en.buffer.dimension;jn===1&&(Xr=Xl),jn===2&&(Xr=Su),jn===3&&(Xr=us)}en.primType=Xr}function gn(en){Vt.elementsCount--,G(en.buffer!==null,"must not double destroy elements"),delete yr[en.id],en.buffer.destroy(),en.buffer=null}function cn(en,ir){var Jt=Ue.create(null,tf,!0),jr=new kr(Jt._buffer);Vt.elementsCount++;function yn(br){if(!br)Jt(),jr.primType=us,jr.vertCount=0,jr.type=_s;else if(typeof br=="number")Jt(br),jr.primType=us,jr.vertCount=br|0,jr.type=_s;else{var Yn=null,Gr=ma,Br=-1,Fr=-1,Xr=0,jn=0;Array.isArray(br)||O(br)||Ha(br)?Yn=br:(G.type(br,"object","invalid arguments for elements"),"data"in br&&(Yn=br.data,G(Array.isArray(Yn)||O(Yn)||Ha(Yn),"invalid data for element buffer")),"usage"in br&&(G.parameter(br.usage,Wa,"invalid element buffer usage"),Gr=Wa[br.usage]),"primitive"in br&&(G.parameter(br.primitive,ja,"invalid element buffer primitive"),Br=ja[br.primitive]),"count"in br&&(G(typeof br.count=="number"&&br.count>=0,"invalid vertex count for elements"),Fr=br.count|0),"type"in br&&(G.parameter(br.type,rr,"invalid buffer type"),jn=rr[br.type]),"length"in br?Xr=br.length|0:(Xr=Fr,jn===wu||jn===Eu?Xr*=2:(jn===Zs||jn===Tl)&&(Xr*=4))),on(jr,Yn,Gr,Br,Fr,Xr,jn)}return yn}return yn(en),yn._reglType="elements",yn._elements=jr,yn.subdata=function(br,Yn){return Jt.subdata(br,Yn),yn},yn.destroy=function(){gn(jr)},yn}return{create:cn,createStream:Wr,destroyStream:$r,getElements:function(ir){return typeof ir=="function"&&ir._elements instanceof kr?ir._elements:null},clear:function(){pa(yr).forEach(gn)}}}var rf=new Float32Array(1),bf=new Uint32Array(rf.buffer),rh=5123;function kf(J){for(var he=Xt.allocType(rh,J.length),Ue=0;Ue<J.length;++Ue)if(isNaN(J[Ue]))he[Ue]=65535;else if(J[Ue]===Infinity)he[Ue]=31744;else if(J[Ue]===-Infinity)he[Ue]=64512;else{rf[0]=J[Ue];var Vt=bf[0],yr=Vt>>>31<<15,pr=(Vt<<1>>>24)-127,rr=Vt>>13&(1<<10)-1;if(pr<-24)he[Ue]=yr;else if(pr<-14){var kr=-14-pr;he[Ue]=yr+(rr+(1<<10)>>kr)}else pr>15?he[Ue]=yr+31744:he[Ue]=yr+(pr+15<<10)+rr}return he}function no(J){return Array.isArray(J)||O(J)}var Yl=function(he){return!(he&he-1)&&!!he},hu=34467,po=3553,nf=34067,Cs=34069,Ju=6408,Qu=6406,Rc=6407,Tu=6409,Vs=6410,af=32854,Eo=32855,la=36194,Ll=32819,of=32820,pu=33635,qu=34042,Dc=6402,kc=34041,Rl=35904,Al=35906,Au=36193,Cu=33776,du=33777,el=33778,Kl=33779,eu=35986,tu=35987,Fc=34798,zc=35840,mc=35841,Nu=35842,Cl=35843,$l=36196,tl=5121,Dl=5123,Nc=5125,rl=5126,Bc=10242,sf=10243,Uc=10497,Pl=33071,Mo=33648,gc=10240,jc=10241,nl=9728,Zc=9729,Pu=9984,Aa=9985,Jl=9986,Bu=9987,il=33170,ji=4352,Ea=4353,Gs=4354,Ql=34046,kl=3317,ql=37440,Sf=37441,Ff=37443,ec=37444,al=33984,ol=[Pu,Jl,Aa,Bu],Ka=[0,Tu,Vs,Rc,Ju],xs={};xs[Tu]=xs[Qu]=xs[Dc]=1,xs[kc]=xs[Vs]=2,xs[Rc]=xs[Rl]=3,xs[Ju]=xs[Al]=4;function Fl(J){return"[object "+J+"]"}var io=Fl("HTMLCanvasElement"),En=Fl("OffscreenCanvas"),Ps=Fl("CanvasRenderingContext2D"),tc=Fl("ImageBitmap"),Mu=Fl("HTMLImageElement"),ru=Fl("HTMLVideoElement"),Hs=Object.keys(ya).concat([io,En,Ps,tc,Mu,ru]),sl=[];sl[tl]=1,sl[rl]=4,sl[Au]=2,sl[Dl]=2,sl[Nc]=4;var Qr=[];Qr[af]=2,Qr[Eo]=2,Qr[la]=2,Qr[kc]=4,Qr[Cu]=.5,Qr[du]=.5,Qr[el]=1,Qr[Kl]=1,Qr[eu]=.5,Qr[tu]=1,Qr[Fc]=1,Qr[zc]=.5,Qr[mc]=.25,Qr[Nu]=.5,Qr[Cl]=.25,Qr[$l]=.5;function Ms(J){return Array.isArray(J)&&(J.length===0||typeof J[0]=="number")}function Iu(J){if(!Array.isArray(J))return!1;var he=J.length;return!(he===0||!no(J[0]))}function Is(J){return Object.prototype.toString.call(J)}function ls(J){return Is(J)===io}function bs(J){return Is(J)===En}function yc(J){return Is(J)===Ps}function _c(J){return Is(J)===tc}function Os(J){return Is(J)===Mu}function Uu(J){return Is(J)===ru}function vu(J){if(!J)return!1;var he=Is(J);return Hs.indexOf(he)>=0?!0:Ms(J)||Iu(J)||Ha(J)}function nu(J){return ya[Object.prototype.toString.call(J)]|0}function xc(J,he){var Ue=he.length;switch(J.type){case tl:case Dl:case Nc:case rl:var Vt=Xt.allocType(J.type,Ue);Vt.set(he),J.data=Vt;break;case Au:J.data=kf(he);break;default:G.raise("unsupported texture type, must specify a typed array")}}function rc(J,he){return Xt.allocType(J.type===Au?rl:J.type,he)}function iu(J,he){J.type===Au?(J.data=kf(he),Xt.freeType(he)):J.data=he}function Ls(J,he,Ue,Vt,yr,pr){for(var rr=J.width,kr=J.height,rn=J.channels,Wr=rr*kr*rn,$r=rc(J,Wr),on=0,gn=0;gn<kr;++gn)for(var cn=0;cn<rr;++cn)for(var en=0;en<rn;++en)$r[on++]=he[Ue*cn+Vt*gn+yr*en+pr];iu(J,$r)}function Di(J,he,Ue,Vt,yr,pr){var rr;if(typeof Qr[J]!="undefined"?rr=Qr[J]:rr=xs[J]*sl[he],pr&&(rr*=6),yr){for(var kr=0,rn=Ue;rn>=1;)kr+=rr*rn*rn,rn/=2;return kr}else return rr*Ue*Vt}function Ws(J,he,Ue,Vt,yr,pr,rr){var kr={"don't care":ji,"dont care":ji,nice:Gs,fast:Ea},rn={repeat:Uc,clamp:Pl,mirror:Mo},Wr={nearest:nl,linear:Zc},$r=_({mipmap:Bu,"nearest mipmap nearest":Pu,"linear mipmap nearest":Aa,"nearest mipmap linear":Jl,"linear mipmap linear":Bu},Wr),on={none:0,browser:ec},gn={uint8:tl,rgba4:Ll,rgb565:pu,"rgb5 a1":of},cn={alpha:Qu,luminance:Tu,"luminance alpha":Vs,rgb:Rc,rgba:Ju,rgba4:af,"rgb5 a1":Eo,rgb565:la},en={};he.ext_srgb&&(cn.srgb=Rl,cn.srgba=Al),he.oes_texture_float&&(gn.float32=gn.float=rl),he.oes_texture_half_float&&(gn.float16=gn["half float"]=Au),he.webgl_depth_texture&&(_(cn,{depth:Dc,"depth stencil":kc}),_(gn,{uint16:Dl,uint32:Nc,"depth stencil":qu})),he.webgl_compressed_texture_s3tc&&_(en,{"rgb s3tc dxt1":Cu,"rgba s3tc dxt1":du,"rgba s3tc dxt3":el,"rgba s3tc dxt5":Kl}),he.webgl_compressed_texture_atc&&_(en,{"rgb atc":eu,"rgba atc explicit alpha":tu,"rgba atc interpolated alpha":Fc}),he.webgl_compressed_texture_pvrtc&&_(en,{"rgb pvrtc 4bppv1":zc,"rgb pvrtc 2bppv1":mc,"rgba pvrtc 4bppv1":Nu,"rgba pvrtc 2bppv1":Cl}),he.webgl_compressed_texture_etc1&&(en["rgb etc1"]=$l);var ir=Array.prototype.slice.call(J.getParameter(hu));Object.keys(en).forEach(function(Ve){var ur=en[Ve];ir.indexOf(ur)>=0&&(cn[Ve]=ur)});var Jt=Object.keys(cn);Ue.textureFormats=Jt;var jr=[];Object.keys(cn).forEach(function(Ve){var ur=cn[Ve];jr[ur]=Ve});var yn=[];Object.keys(gn).forEach(function(Ve){var ur=gn[Ve];yn[ur]=Ve});var br=[];Object.keys(Wr).forEach(function(Ve){var ur=Wr[Ve];br[ur]=Ve});var Yn=[];Object.keys($r).forEach(function(Ve){var ur=$r[Ve];Yn[ur]=Ve});var Gr=[];Object.keys(rn).forEach(function(Ve){var ur=rn[Ve];Gr[ur]=Ve});var Br=Jt.reduce(function(Ve,ur){var $t=cn[ur];return $t===Tu||$t===Qu||$t===Tu||$t===Vs||$t===Dc||$t===kc||he.ext_srgb&&($t===Rl||$t===Al)?Ve[$t]=$t:$t===Eo||ur.indexOf("rgba")>=0?Ve[$t]=Ju:Ve[$t]=Rc,Ve},{});function Fr(){this.internalformat=Ju,this.format=Ju,this.type=tl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=ec,this.width=0,this.height=0,this.channels=0}function Xr(Ve,ur){Ve.internalformat=ur.internalformat,Ve.format=ur.format,Ve.type=ur.type,Ve.compressed=ur.compressed,Ve.premultiplyAlpha=ur.premultiplyAlpha,Ve.flipY=ur.flipY,Ve.unpackAlignment=ur.unpackAlignment,Ve.colorSpace=ur.colorSpace,Ve.width=ur.width,Ve.height=ur.height,Ve.channels=ur.channels}function jn(Ve,ur){if(!(typeof ur!="object"||!ur)){if("premultiplyAlpha"in ur&&(G.type(ur.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ve.premultiplyAlpha=ur.premultiplyAlpha),"flipY"in ur&&(G.type(ur.flipY,"boolean","invalid texture flip"),Ve.flipY=ur.flipY),"alignment"in ur&&(G.oneOf(ur.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ve.unpackAlignment=ur.alignment),"colorSpace"in ur&&(G.parameter(ur.colorSpace,on,"invalid colorSpace"),Ve.colorSpace=on[ur.colorSpace]),"type"in ur){var $t=ur.type;G(he.oes_texture_float||!($t==="float"||$t==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),G(he.oes_texture_half_float||!($t==="half float"||$t==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),G(he.webgl_depth_texture||!($t==="uint16"||$t==="uint32"||$t==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),G.parameter($t,gn,"invalid texture type"),Ve.type=gn[$t]}var wn=Ve.width,zi=Ve.height,Oe=Ve.channels,xe=!1;"shape"in ur?(G(Array.isArray(ur.shape)&&ur.shape.length>=2,"shape must be an array"),wn=ur.shape[0],zi=ur.shape[1],ur.shape.length===3&&(Oe=ur.shape[2],G(Oe>0&&Oe<=4,"invalid number of channels"),xe=!0),G(wn>=0&&wn<=Ue.maxTextureSize,"invalid width"),G(zi>=0&&zi<=Ue.maxTextureSize,"invalid height")):("radius"in ur&&(wn=zi=ur.radius,G(wn>=0&&wn<=Ue.maxTextureSize,"invalid radius")),"width"in ur&&(wn=ur.width,G(wn>=0&&wn<=Ue.maxTextureSize,"invalid width")),"height"in ur&&(zi=ur.height,G(zi>=0&&zi<=Ue.maxTextureSize,"invalid height")),"channels"in ur&&(Oe=ur.channels,G(Oe>0&&Oe<=4,"invalid number of channels"),xe=!0)),Ve.width=wn|0,Ve.height=zi|0,Ve.channels=Oe|0;var ft=!1;if("format"in ur){var zt=ur.format;G(he.webgl_depth_texture||!(zt==="depth"||zt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),G.parameter(zt,cn,"invalid texture format");var jt=Ve.internalformat=cn[zt];Ve.format=Br[jt],zt in gn&&("type"in ur||(Ve.type=gn[zt])),zt in en&&(Ve.compressed=!0),ft=!0}!xe&&ft?Ve.channels=xs[Ve.format]:xe&&!ft?Ve.channels!==Ka[Ve.format]&&(Ve.format=Ve.internalformat=Ka[Ve.channels]):ft&&xe&&G(Ve.channels===xs[Ve.format],"number of channels inconsistent with specified format")}}function qn(Ve){J.pixelStorei(ql,Ve.flipY),J.pixelStorei(Sf,Ve.premultiplyAlpha),J.pixelStorei(Ff,Ve.colorSpace),J.pixelStorei(kl,Ve.unpackAlignment)}function ln(){Fr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Nr(Ve,ur){var $t=null;if(vu(ur)?$t=ur:ur&&(G.type(ur,"object","invalid pixel data type"),jn(Ve,ur),"x"in ur&&(Ve.xOffset=ur.x|0),"y"in ur&&(Ve.yOffset=ur.y|0),vu(ur.data)&&($t=ur.data)),G(!Ve.compressed||$t instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),ur.copy){G(!$t,"can not specify copy and data field for the same texture");var wn=yr.viewportWidth,zi=yr.viewportHeight;Ve.width=Ve.width||wn-Ve.xOffset,Ve.height=Ve.height||zi-Ve.yOffset,Ve.needsCopy=!0,G(Ve.xOffset>=0&&Ve.xOffset<wn&&Ve.yOffset>=0&&Ve.yOffset<zi&&Ve.width>0&&Ve.width<=wn&&Ve.height>0&&Ve.height<=zi,"copy texture read out of bounds")}else if(!$t)Ve.width=Ve.width||1,Ve.height=Ve.height||1,Ve.channels=Ve.channels||4;else if(O($t))Ve.channels=Ve.channels||4,Ve.data=$t,!("type"in ur)&&Ve.type===tl&&(Ve.type=nu($t));else if(Ms($t))Ve.channels=Ve.channels||4,xc(Ve,$t),Ve.alignment=1,Ve.needsFree=!0;else if(Ha($t)){var Oe=$t.data;!Array.isArray(Oe)&&Ve.type===tl&&(Ve.type=nu(Oe));var xe=$t.shape,ft=$t.stride,zt,jt,mt,ht,It,De;xe.length===3?(mt=xe[2],De=ft[2]):(G(xe.length===2,"invalid ndarray pixel data, must be 2 or 3D"),mt=1,De=1),zt=xe[0],jt=xe[1],ht=ft[0],It=ft[1],Ve.alignment=1,Ve.width=zt,Ve.height=jt,Ve.channels=mt,Ve.format=Ve.internalformat=Ka[mt],Ve.needsFree=!0,Ls(Ve,Oe,ht,It,De,$t.offset)}else if(ls($t)||bs($t)||yc($t))ls($t)||bs($t)?Ve.element=$t:Ve.element=$t.canvas,Ve.width=Ve.element.width,Ve.height=Ve.element.height,Ve.channels=4;else if(_c($t))Ve.element=$t,Ve.width=$t.width,Ve.height=$t.height,Ve.channels=4;else if(Os($t))Ve.element=$t,Ve.width=$t.naturalWidth,Ve.height=$t.naturalHeight,Ve.channels=4;else if(Uu($t))Ve.element=$t,Ve.width=$t.videoWidth,Ve.height=$t.videoHeight,Ve.channels=4;else if(Iu($t)){var st=Ve.width||$t[0].length,Ae=Ve.height||$t.length,kt=Ve.channels;no($t[0][0])?kt=kt||$t[0][0].length:kt=kt||1;for(var Gt=rt.shape($t),Ar=1,or=0;or<Gt.length;++or)Ar*=Gt[or];var xr=rc(Ve,Ar);rt.flatten($t,Gt,"",xr),iu(Ve,xr),Ve.alignment=1,Ve.width=st,Ve.height=Ae,Ve.channels=kt,Ve.format=Ve.internalformat=Ka[kt],Ve.needsFree=!0}Ve.type===rl?G(Ue.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ve.type===Au&&G(Ue.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Rr(Ve,ur,$t){var wn=Ve.element,zi=Ve.data,Oe=Ve.internalformat,xe=Ve.format,ft=Ve.type,zt=Ve.width,jt=Ve.height;qn(Ve),wn?J.texImage2D(ur,$t,xe,xe,ft,wn):Ve.compressed?J.compressedTexImage2D(ur,$t,Oe,zt,jt,0,zi):Ve.needsCopy?(Vt(),J.copyTexImage2D(ur,$t,xe,Ve.xOffset,Ve.yOffset,zt,jt,0)):J.texImage2D(ur,$t,xe,zt,jt,0,xe,ft,zi||null)}function ri(Ve,ur,$t,wn,zi){var Oe=Ve.element,xe=Ve.data,ft=Ve.internalformat,zt=Ve.format,jt=Ve.type,mt=Ve.width,ht=Ve.height;qn(Ve),Oe?J.texSubImage2D(ur,zi,$t,wn,zt,jt,Oe):Ve.compressed?J.compressedTexSubImage2D(ur,zi,$t,wn,ft,mt,ht,xe):Ve.needsCopy?(Vt(),J.copyTexSubImage2D(ur,zi,$t,wn,Ve.xOffset,Ve.yOffset,mt,ht)):J.texSubImage2D(ur,zi,$t,wn,mt,ht,zt,jt,xe)}var ni=[];function Ln(){return ni.pop()||new ln}function Vi(Ve){Ve.needsFree&&Xt.freeType(Ve.data),ln.call(Ve),ni.push(Ve)}function wi(){Fr.call(this),this.genMipmaps=!1,this.mipmapHint=ji,this.mipmask=0,this.images=Array(16)}function Gi(Ve,ur,$t){var wn=Ve.images[0]=Ln();Ve.mipmask=1,wn.width=Ve.width=ur,wn.height=Ve.height=$t,wn.channels=Ve.channels=4}function ca(Ve,ur){var $t=null;if(vu(ur))$t=Ve.images[0]=Ln(),Xr($t,Ve),Nr($t,ur),Ve.mipmask=1;else if(jn(Ve,ur),Array.isArray(ur.mipmap))for(var wn=ur.mipmap,zi=0;zi<wn.length;++zi)$t=Ve.images[zi]=Ln(),Xr($t,Ve),$t.width>>=zi,$t.height>>=zi,Nr($t,wn[zi]),Ve.mipmask|=1<<zi;else $t=Ve.images[0]=Ln(),Xr($t,Ve),Nr($t,ur),Ve.mipmask=1;Xr(Ve,Ve.images[0]),Ve.compressed&&(Ve.internalformat===Cu||Ve.internalformat===du||Ve.internalformat===el||Ve.internalformat===Kl)&&G(Ve.width%4==0&&Ve.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function zo(Ve,ur){for(var $t=Ve.images,wn=0;wn<$t.length;++wn){if(!$t[wn])return;Rr($t[wn],ur,wn)}}var zs=[];function Hi(){var Ve=zs.pop()||new wi;Fr.call(Ve),Ve.mipmask=0;for(var ur=0;ur<16;++ur)Ve.images[ur]=null;return Ve}function No(Ve){for(var ur=Ve.images,$t=0;$t<ur.length;++$t)ur[$t]&&Vi(ur[$t]),ur[$t]=null;zs.push(Ve)}function Ja(){this.minFilter=nl,this.magFilter=nl,this.wrapS=Pl,this.wrapT=Pl,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ji}function es(Ve,ur){if("min"in ur){var $t=ur.min;G.parameter($t,$r),Ve.minFilter=$r[$t],ol.indexOf(Ve.minFilter)>=0&&!("faces"in ur)&&(Ve.genMipmaps=!0)}if("mag"in ur){var wn=ur.mag;G.parameter(wn,Wr),Ve.magFilter=Wr[wn]}var zi=Ve.wrapS,Oe=Ve.wrapT;if("wrap"in ur){var xe=ur.wrap;typeof xe=="string"?(G.parameter(xe,rn),zi=Oe=rn[xe]):Array.isArray(xe)&&(G.parameter(xe[0],rn),G.parameter(xe[1],rn),zi=rn[xe[0]],Oe=rn[xe[1]])}else{if("wrapS"in ur){var ft=ur.wrapS;G.parameter(ft,rn),zi=rn[ft]}if("wrapT"in ur){var zt=ur.wrapT;G.parameter(zt,rn),Oe=rn[zt]}}if(Ve.wrapS=zi,Ve.wrapT=Oe,"anisotropic"in ur){var jt=ur.anisotropic;G(typeof jt=="number"&&jt>=1&&jt<=Ue.maxAnisotropic,"aniso samples must be between 1 and "),Ve.anisotropic=ur.anisotropic}if("mipmap"in ur){var mt=!1;switch(typeof ur.mipmap){case"string":G.parameter(ur.mipmap,kr,"invalid mipmap hint"),Ve.mipmapHint=kr[ur.mipmap],Ve.genMipmaps=!0,mt=!0;break;case"boolean":mt=Ve.genMipmaps=ur.mipmap;break;case"object":G(Array.isArray(ur.mipmap),"invalid mipmap type"),Ve.genMipmaps=!1,mt=!0;break;default:G.raise("invalid mipmap type")}mt&&!("min"in ur)&&(Ve.minFilter=Pu)}}function ts(Ve,ur){J.texParameteri(ur,jc,Ve.minFilter),J.texParameteri(ur,gc,Ve.magFilter),J.texParameteri(ur,Bc,Ve.wrapS),J.texParameteri(ur,sf,Ve.wrapT),he.ext_texture_filter_anisotropic&&J.texParameteri(ur,Ql,Ve.anisotropic),Ve.genMipmaps&&(J.hint(il,Ve.mipmapHint),J.generateMipmap(ur))}var Es=0,Ns={},$s=Ue.maxTextureUnits,Bo=Array($s).map(function(){return null});function Ii(Ve){Fr.call(this),this.mipmask=0,this.internalformat=Ju,this.id=Es++,this.refCount=1,this.target=Ve,this.texture=J.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ja,rr.profile&&(this.stats={size:0})}function Js(Ve){J.activeTexture(al),J.bindTexture(Ve.target,Ve.texture)}function da(){var Ve=Bo[0];Ve?J.bindTexture(Ve.target,Ve.texture):J.bindTexture(po,null)}function ii(Ve){var ur=Ve.texture;G(ur,"must not double destroy texture");var $t=Ve.unit,wn=Ve.target;$t>=0&&(J.activeTexture(al+$t),J.bindTexture(wn,null),Bo[$t]=null),J.deleteTexture(ur),Ve.texture=null,Ve.params=null,Ve.pixels=null,Ve.refCount=0,delete Ns[Ve.id],pr.textureCount--}_(Ii.prototype,{bind:function(){var ur=this;ur.bindCount+=1;var $t=ur.unit;if($t<0){for(var wn=0;wn<$s;++wn){var zi=Bo[wn];if(zi){if(zi.bindCount>0)continue;zi.unit=-1}Bo[wn]=ur,$t=wn;break}$t>=$s&&G.raise("insufficient number of texture units"),rr.profile&&pr.maxTextureUnits<$t+1&&(pr.maxTextureUnits=$t+1),ur.unit=$t,J.activeTexture(al+$t),J.bindTexture(ur.target,ur.texture)}return $t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&ii(this)}});function Oi(Ve,ur){var $t=new Ii(po);Ns[$t.id]=$t,pr.textureCount++;function wn(xe,ft){var zt=$t.texInfo;Ja.call(zt);var jt=Hi();return typeof xe=="number"?typeof ft=="number"?Gi(jt,xe|0,ft|0):Gi(jt,xe|0,xe|0):xe?(G.type(xe,"object","invalid arguments to regl.texture"),es(zt,xe),ca(jt,xe)):Gi(jt,1,1),zt.genMipmaps&&(jt.mipmask=(jt.width<<1)-1),$t.mipmask=jt.mipmask,Xr($t,jt),G.texture2D(zt,jt,Ue),$t.internalformat=jt.internalformat,wn.width=jt.width,wn.height=jt.height,Js($t),zo(jt,po),ts(zt,po),da(),No(jt),rr.profile&&($t.stats.size=Di($t.internalformat,$t.type,jt.width,jt.height,zt.genMipmaps,!1)),wn.format=jr[$t.internalformat],wn.type=yn[$t.type],wn.mag=br[zt.magFilter],wn.min=Yn[zt.minFilter],wn.wrapS=Gr[zt.wrapS],wn.wrapT=Gr[zt.wrapT],wn}function zi(xe,ft,zt,jt){G(!!xe,"must specify image data");var mt=ft|0,ht=zt|0,It=jt|0,De=Ln();return Xr(De,$t),De.width=0,De.height=0,Nr(De,xe),De.width=De.width||($t.width>>It)-mt,De.height=De.height||($t.height>>It)-ht,G($t.type===De.type&&$t.format===De.format&&$t.internalformat===De.internalformat,"incompatible format for texture.subimage"),G(mt>=0&&ht>=0&&mt+De.width<=$t.width&&ht+De.height<=$t.height,"texture.subimage write out of bounds"),G($t.mipmask&1<<It,"missing mipmap data"),G(De.data||De.element||De.needsCopy,"missing image data"),Js($t),ri(De,po,mt,ht,It),da(),Vi(De),wn}function Oe(xe,ft){var zt=xe|0,jt=ft|0||zt;if(zt===$t.width&&jt===$t.height)return wn;wn.width=$t.width=zt,wn.height=$t.height=jt,Js($t);for(var mt=0;$t.mipmask>>mt;++mt){var ht=zt>>mt,It=jt>>mt;if(!ht||!It)break;J.texImage2D(po,mt,$t.format,ht,It,0,$t.format,$t.type,null)}return da(),rr.profile&&($t.stats.size=Di($t.internalformat,$t.type,zt,jt,!1,!1)),wn}return wn(Ve,ur),wn.subimage=zi,wn.resize=Oe,wn._reglType="texture2d",wn._texture=$t,rr.profile&&(wn.stats=$t.stats),wn.destroy=function(){$t.decRef()},wn}function qi(Ve,ur,$t,wn,zi,Oe){var xe=new Ii(nf);Ns[xe.id]=xe,pr.cubeCount++;var ft=new Array(6);function zt(ht,It,De,st,Ae,kt){var Gt,Ar=xe.texInfo;for(Ja.call(Ar),Gt=0;Gt<6;++Gt)ft[Gt]=Hi();if(typeof ht=="number"||!ht){var or=ht|0||1;for(Gt=0;Gt<6;++Gt)Gi(ft[Gt],or,or)}else if(typeof ht=="object")if(It)ca(ft[0],ht),ca(ft[1],It),ca(ft[2],De),ca(ft[3],st),ca(ft[4],Ae),ca(ft[5],kt);else if(es(Ar,ht),jn(xe,ht),"faces"in ht){var xr=ht.faces;for(G(Array.isArray(xr)&&xr.length===6,"cube faces must be a length 6 array"),Gt=0;Gt<6;++Gt)G(typeof xr[Gt]=="object"&&!!xr[Gt],"invalid input for cube map face"),Xr(ft[Gt],xe),ca(ft[Gt],xr[Gt])}else for(Gt=0;Gt<6;++Gt)ca(ft[Gt],ht);else G.raise("invalid arguments to cube map");for(Xr(xe,ft[0]),Ue.npotTextureCube||G(Yl(xe.width)&&Yl(xe.height),"your browser does not support non power or two texture dimensions"),Ar.genMipmaps?xe.mipmask=(ft[0].width<<1)-1:xe.mipmask=ft[0].mipmask,G.textureCube(xe,Ar,ft,Ue),xe.internalformat=ft[0].internalformat,zt.width=ft[0].width,zt.height=ft[0].height,Js(xe),Gt=0;Gt<6;++Gt)zo(ft[Gt],Cs+Gt);for(ts(Ar,nf),da(),rr.profile&&(xe.stats.size=Di(xe.internalformat,xe.type,zt.width,zt.height,Ar.genMipmaps,!0)),zt.format=jr[xe.internalformat],zt.type=yn[xe.type],zt.mag=br[Ar.magFilter],zt.min=Yn[Ar.minFilter],zt.wrapS=Gr[Ar.wrapS],zt.wrapT=Gr[Ar.wrapT],Gt=0;Gt<6;++Gt)No(ft[Gt]);return zt}function jt(ht,It,De,st,Ae){G(!!It,"must specify image data"),G(typeof ht=="number"&&ht===(ht|0)&&ht>=0&&ht<6,"invalid face");var kt=De|0,Gt=st|0,Ar=Ae|0,or=Ln();return Xr(or,xe),or.width=0,or.height=0,Nr(or,It),or.width=or.width||(xe.width>>Ar)-kt,or.height=or.height||(xe.height>>Ar)-Gt,G(xe.type===or.type&&xe.format===or.format&&xe.internalformat===or.internalformat,"incompatible format for texture.subimage"),G(kt>=0&&Gt>=0&&kt+or.width<=xe.width&&Gt+or.height<=xe.height,"texture.subimage write out of bounds"),G(xe.mipmask&1<<Ar,"missing mipmap data"),G(or.data||or.element||or.needsCopy,"missing image data"),Js(xe),ri(or,Cs+ht,kt,Gt,Ar),da(),Vi(or),zt}function mt(ht){var It=ht|0;if(It!==xe.width){zt.width=xe.width=It,zt.height=xe.height=It,Js(xe);for(var De=0;De<6;++De)for(var st=0;xe.mipmask>>st;++st)J.texImage2D(Cs+De,st,xe.format,It>>st,It>>st,0,xe.format,xe.type,null);return da(),rr.profile&&(xe.stats.size=Di(xe.internalformat,xe.type,zt.width,zt.height,!1,!0)),zt}}return zt(Ve,ur,$t,wn,zi,Oe),zt.subimage=jt,zt.resize=mt,zt._reglType="textureCube",zt._texture=xe,rr.profile&&(zt.stats=xe.stats),zt.destroy=function(){xe.decRef()},zt}function ws(){for(var Ve=0;Ve<$s;++Ve)J.activeTexture(al+Ve),J.bindTexture(po,null),Bo[Ve]=null;pa(Ns).forEach(ii),pr.cubeCount=0,pr.textureCount=0}rr.profile&&(pr.getTotalTextureSize=function(){var Ve=0;return Object.keys(Ns).forEach(function(ur){Ve+=Ns[ur].stats.size}),Ve});function Qs(){for(var Ve=0;Ve<$s;++Ve){var ur=Bo[Ve];ur&&(ur.bindCount=0,ur.unit=-1,Bo[Ve]=null)}pa(Ns).forEach(function($t){$t.texture=J.createTexture(),J.bindTexture($t.target,$t.texture);for(var wn=0;wn<32;++wn)if(($t.mipmask&1<<wn)!=0)if($t.target===po)J.texImage2D(po,wn,$t.internalformat,$t.width>>wn,$t.height>>wn,0,$t.internalformat,$t.type,null);else for(var zi=0;zi<6;++zi)J.texImage2D(Cs+zi,wn,$t.internalformat,$t.width>>wn,$t.height>>wn,0,$t.internalformat,$t.type,null);ts($t.texInfo,$t.target)})}function Gl(){for(var Ve=0;Ve<$s;++Ve){var ur=Bo[Ve];ur&&(ur.bindCount=0,ur.unit=-1,Bo[Ve]=null),J.activeTexture(al+Ve),J.bindTexture(po,null),J.bindTexture(nf,null)}}return{create2D:Oi,createCube:qi,clear:ws,getTexture:function(ur){return null},restore:Qs,refresh:Gl}}var Uo=36161,vo=32854,ju=32855,ul=36194,mu=33189,cs=36168,zl=34041,Gn=35907,Mn=34836,ll=34842,fs=34843,Io=[];Io[vo]=2,Io[ju]=2,Io[ul]=2,Io[mu]=2,Io[cs]=1,Io[zl]=4,Io[Gn]=4,Io[Mn]=16,Io[ll]=8,Io[fs]=6;function jo(J,he,Ue){return Io[J]*he*Ue}var Zu=function(he,Ue,Vt,yr,pr){var rr={rgba4:vo,rgb565:ul,"rgb5 a1":ju,depth:mu,stencil:cs,"depth stencil":zl};Ue.ext_srgb&&(rr.srgba=Gn),Ue.ext_color_buffer_half_float&&(rr.rgba16f=ll,rr.rgb16f=fs),Ue.webgl_color_buffer_float&&(rr.rgba32f=Mn);var kr=[];Object.keys(rr).forEach(function(en){var ir=rr[en];kr[ir]=en});var rn=0,Wr={};function $r(en){this.id=rn++,this.refCount=1,this.renderbuffer=en,this.format=vo,this.width=0,this.height=0,pr.profile&&(this.stats={size:0})}$r.prototype.decRef=function(){--this.refCount<=0&&on(this)};function on(en){var ir=en.renderbuffer;G(ir,"must not double destroy renderbuffer"),he.bindRenderbuffer(Uo,null),he.deleteRenderbuffer(ir),en.renderbuffer=null,en.refCount=0,delete Wr[en.id],yr.renderbufferCount--}function gn(en,ir){var Jt=new $r(he.createRenderbuffer());Wr[Jt.id]=Jt,yr.renderbufferCount++;function jr(br,Yn){var Gr=0,Br=0,Fr=vo;if(typeof br=="object"&&br){var Xr=br;if("shape"in Xr){var jn=Xr.shape;G(Array.isArray(jn)&&jn.length>=2,"invalid renderbuffer shape"),Gr=jn[0]|0,Br=jn[1]|0}else"radius"in Xr&&(Gr=Br=Xr.radius|0),"width"in Xr&&(Gr=Xr.width|0),"height"in Xr&&(Br=Xr.height|0);"format"in Xr&&(G.parameter(Xr.format,rr,"invalid renderbuffer format"),Fr=rr[Xr.format])}else typeof br=="number"?(Gr=br|0,typeof Yn=="number"?Br=Yn|0:Br=Gr):br?G.raise("invalid arguments to renderbuffer constructor"):Gr=Br=1;if(G(Gr>0&&Br>0&&Gr<=Vt.maxRenderbufferSize&&Br<=Vt.maxRenderbufferSize,"invalid renderbuffer size"),!(Gr===Jt.width&&Br===Jt.height&&Fr===Jt.format))return jr.width=Jt.width=Gr,jr.height=Jt.height=Br,Jt.format=Fr,he.bindRenderbuffer(Uo,Jt.renderbuffer),he.renderbufferStorage(Uo,Fr,Gr,Br),G(he.getError()===0,"invalid render buffer format"),pr.profile&&(Jt.stats.size=jo(Jt.format,Jt.width,Jt.height)),jr.format=kr[Jt.format],jr}function yn(br,Yn){var Gr=br|0,Br=Yn|0||Gr;return Gr===Jt.width&&Br===Jt.height||(G(Gr>0&&Br>0&&Gr<=Vt.maxRenderbufferSize&&Br<=Vt.maxRenderbufferSize,"invalid renderbuffer size"),jr.width=Jt.width=Gr,jr.height=Jt.height=Br,he.bindRenderbuffer(Uo,Jt.renderbuffer),he.renderbufferStorage(Uo,Jt.format,Gr,Br),G(he.getError()===0,"invalid render buffer format"),pr.profile&&(Jt.stats.size=jo(Jt.format,Jt.width,Jt.height))),jr}return jr(en,ir),jr.resize=yn,jr._reglType="renderbuffer",jr._renderbuffer=Jt,pr.profile&&(jr.stats=Jt.stats),jr.destroy=function(){Jt.decRef()},jr}pr.profile&&(yr.getTotalRenderbufferSize=function(){var en=0;return Object.keys(Wr).forEach(function(ir){en+=Wr[ir].stats.size}),en});function cn(){pa(Wr).forEach(function(en){en.renderbuffer=he.createRenderbuffer(),he.bindRenderbuffer(Uo,en.renderbuffer),he.renderbufferStorage(Uo,en.format,en.width,en.height)}),he.bindRenderbuffer(Uo,null)}return{create:gn,clear:function(){pa(Wr).forEach(on)},restore:cn}},gu=36160,Nl=36161,Yi=3553,ao=34069,Vc=36064,cl=36096,bc=36128,Vu=33306,Rs=36053,nc=36054,hs=36055,Sc=36057,Bl=36061,ic=36193,Oa=5121,ac=5126,fl=6407,Ec=6408,hl=6402,pl=[fl,Ec],Ul=[];Ul[Ec]=4,Ul[fl]=3;var yu=[];yu[Oa]=1,yu[ac]=4,yu[ic]=2;var au=32854,Gc=32855,wc=36194,uf=33189,Hc=36168,c=34041,o=35907,i=34836,h=34842,g=34843,E=[au,Gc,wc,o,h,g,i],C={};C[Rs]="complete",C[nc]="incomplete attachment",C[Sc]="incomplete dimensions",C[hs]="incomplete, missing attachment",C[Bl]="unsupported";function L(J,he,Ue,Vt,yr,pr){var rr={cur:null,next:null,dirty:!1,setFBO:null},kr=["rgba"],rn=["rgba4","rgb565","rgb5 a1"];he.ext_srgb&&rn.push("srgba"),he.ext_color_buffer_half_float&&rn.push("rgba16f","rgb16f"),he.webgl_color_buffer_float&&rn.push("rgba32f");var Wr=["uint8"];he.oes_texture_half_float&&Wr.push("half float","float16"),he.oes_texture_float&&Wr.push("float","float32");function $r(ln,Nr,Rr){this.target=ln,this.texture=Nr,this.renderbuffer=Rr;var ri=0,ni=0;Nr?(ri=Nr.width,ni=Nr.height):Rr&&(ri=Rr.width,ni=Rr.height),this.width=ri,this.height=ni}function on(ln){ln&&(ln.texture&&ln.texture._texture.decRef(),ln.renderbuffer&&ln.renderbuffer._renderbuffer.decRef())}function gn(ln,Nr,Rr){if(!!ln)if(ln.texture){var ri=ln.texture._texture,ni=Math.max(1,ri.width),Ln=Math.max(1,ri.height);G(ni===Nr&&Ln===Rr,"inconsistent width/height for supplied texture"),ri.refCount+=1}else{var Vi=ln.renderbuffer._renderbuffer;G(Vi.width===Nr&&Vi.height===Rr,"inconsistent width/height for renderbuffer"),Vi.refCount+=1}}function cn(ln,Nr){Nr&&(Nr.texture?J.framebufferTexture2D(gu,ln,Nr.target,Nr.texture._texture.texture,0):J.framebufferRenderbuffer(gu,ln,Nl,Nr.renderbuffer._renderbuffer.renderbuffer))}function en(ln){var Nr=Yi,Rr=null,ri=null,ni=ln;typeof ln=="object"&&(ni=ln.data,"target"in ln&&(Nr=ln.target|0)),G.type(ni,"function","invalid attachment data");var Ln=ni._reglType;return Ln==="texture2d"?(Rr=ni,G(Nr===Yi)):Ln==="textureCube"?(Rr=ni,G(Nr>=ao&&Nr<ao+6,"invalid cube map target")):Ln==="renderbuffer"?(ri=ni,Nr=Nl):G.raise("invalid regl object for attachment"),new $r(Nr,Rr,ri)}function ir(ln,Nr,Rr,ri,ni){if(Rr){var Ln=Vt.create2D({width:ln,height:Nr,format:ri,type:ni});return Ln._texture.refCount=0,new $r(Yi,Ln,null)}else{var Vi=yr.create({width:ln,height:Nr,format:ri});return Vi._renderbuffer.refCount=0,new $r(Nl,null,Vi)}}function Jt(ln){return ln&&(ln.texture||ln.renderbuffer)}function jr(ln,Nr,Rr){ln&&(ln.texture?ln.texture.resize(Nr,Rr):ln.renderbuffer&&ln.renderbuffer.resize(Nr,Rr),ln.width=Nr,ln.height=Rr)}var yn=0,br={};function Yn(){this.id=yn++,br[this.id]=this,this.framebuffer=J.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Gr(ln){ln.colorAttachments.forEach(on),on(ln.depthAttachment),on(ln.stencilAttachment),on(ln.depthStencilAttachment)}function Br(ln){var Nr=ln.framebuffer;G(Nr,"must not double destroy framebuffer"),J.deleteFramebuffer(Nr),ln.framebuffer=null,pr.framebufferCount--,delete br[ln.id]}function Fr(ln){var Nr;J.bindFramebuffer(gu,ln.framebuffer);var Rr=ln.colorAttachments;for(Nr=0;Nr<Rr.length;++Nr)cn(Vc+Nr,Rr[Nr]);for(Nr=Rr.length;Nr<Ue.maxColorAttachments;++Nr)J.framebufferTexture2D(gu,Vc+Nr,Yi,null,0);J.framebufferTexture2D(gu,Vu,Yi,null,0),J.framebufferTexture2D(gu,cl,Yi,null,0),J.framebufferTexture2D(gu,bc,Yi,null,0),cn(cl,ln.depthAttachment),cn(bc,ln.stencilAttachment),cn(Vu,ln.depthStencilAttachment);var ri=J.checkFramebufferStatus(gu);!J.isContextLost()&&ri!==Rs&&G.raise("framebuffer configuration not supported, status = "+C[ri]),J.bindFramebuffer(gu,rr.next?rr.next.framebuffer:null),rr.cur=rr.next,J.getError()}function Xr(ln,Nr){var Rr=new Yn;pr.framebufferCount++;function ri(Ln,Vi){var wi;G(rr.next!==Rr,"can not update framebuffer which is currently in use");var Gi=0,ca=0,zo=!0,zs=!0,Hi=null,No=!0,Ja="rgba",es="uint8",ts=1,Es=null,Ns=null,$s=null,Bo=!1;if(typeof Ln=="number")Gi=Ln|0,ca=Vi|0||Gi;else if(!Ln)Gi=ca=1;else{G.type(Ln,"object","invalid arguments for framebuffer");var Ii=Ln;if("shape"in Ii){var Js=Ii.shape;G(Array.isArray(Js)&&Js.length>=2,"invalid shape for framebuffer"),Gi=Js[0],ca=Js[1]}else"radius"in Ii&&(Gi=ca=Ii.radius),"width"in Ii&&(Gi=Ii.width),"height"in Ii&&(ca=Ii.height);("color"in Ii||"colors"in Ii)&&(Hi=Ii.color||Ii.colors,Array.isArray(Hi)&&G(Hi.length===1||he.webgl_draw_buffers,"multiple render targets not supported")),Hi||("colorCount"in Ii&&(ts=Ii.colorCount|0,G(ts>0,"invalid color buffer count")),"colorTexture"in Ii&&(No=!!Ii.colorTexture,Ja="rgba4"),"colorType"in Ii&&(es=Ii.colorType,No?(G(he.oes_texture_float||!(es==="float"||es==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),G(he.oes_texture_half_float||!(es==="half float"||es==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):es==="half float"||es==="float16"?(G(he.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ja="rgba16f"):(es==="float"||es==="float32")&&(G(he.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ja="rgba32f"),G.oneOf(es,Wr,"invalid color type")),"colorFormat"in Ii&&(Ja=Ii.colorFormat,kr.indexOf(Ja)>=0?No=!0:rn.indexOf(Ja)>=0?No=!1:No?G.oneOf(Ii.colorFormat,kr,"invalid color format for texture"):G.oneOf(Ii.colorFormat,rn,"invalid color format for renderbuffer"))),("depthTexture"in Ii||"depthStencilTexture"in Ii)&&(Bo=!!(Ii.depthTexture||Ii.depthStencilTexture),G(!Bo||he.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Ii&&(typeof Ii.depth=="boolean"?zo=Ii.depth:(Es=Ii.depth,zs=!1)),"stencil"in Ii&&(typeof Ii.stencil=="boolean"?zs=Ii.stencil:(Ns=Ii.stencil,zo=!1)),"depthStencil"in Ii&&(typeof Ii.depthStencil=="boolean"?zo=zs=Ii.depthStencil:($s=Ii.depthStencil,zo=!1,zs=!1))}var da=null,ii=null,Oi=null,qi=null;if(Array.isArray(Hi))da=Hi.map(en);else if(Hi)da=[en(Hi)];else for(da=new Array(ts),wi=0;wi<ts;++wi)da[wi]=ir(Gi,ca,No,Ja,es);G(he.webgl_draw_buffers||da.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),G(da.length<=Ue.maxColorAttachments,"too many color attachments, not supported"),Gi=Gi||da[0].width,ca=ca||da[0].height,Es?ii=en(Es):zo&&!zs&&(ii=ir(Gi,ca,Bo,"depth","uint32")),Ns?Oi=en(Ns):zs&&!zo&&(Oi=ir(Gi,ca,!1,"stencil","uint8")),$s?qi=en($s):!Es&&!Ns&&zs&&zo&&(qi=ir(Gi,ca,Bo,"depth stencil","depth stencil")),G(!!Es+!!Ns+!!$s<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ws=null;for(wi=0;wi<da.length;++wi)if(gn(da[wi],Gi,ca),G(!da[wi]||da[wi].texture&&pl.indexOf(da[wi].texture._texture.format)>=0||da[wi].renderbuffer&&E.indexOf(da[wi].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+wi+" is invalid"),da[wi]&&da[wi].texture){var Qs=Ul[da[wi].texture._texture.format]*yu[da[wi].texture._texture.type];ws===null?ws=Qs:G(ws===Qs,"all color attachments much have the same number of bits per pixel.")}return gn(ii,Gi,ca),G(!ii||ii.texture&&ii.texture._texture.format===hl||ii.renderbuffer&&ii.renderbuffer._renderbuffer.format===uf,"invalid depth attachment for framebuffer object"),gn(Oi,Gi,ca),G(!Oi||Oi.renderbuffer&&Oi.renderbuffer._renderbuffer.format===Hc,"invalid stencil attachment for framebuffer object"),gn(qi,Gi,ca),G(!qi||qi.texture&&qi.texture._texture.format===c||qi.renderbuffer&&qi.renderbuffer._renderbuffer.format===c,"invalid depth-stencil attachment for framebuffer object"),Gr(Rr),Rr.width=Gi,Rr.height=ca,Rr.colorAttachments=da,Rr.depthAttachment=ii,Rr.stencilAttachment=Oi,Rr.depthStencilAttachment=qi,ri.color=da.map(Jt),ri.depth=Jt(ii),ri.stencil=Jt(Oi),ri.depthStencil=Jt(qi),ri.width=Rr.width,ri.height=Rr.height,Fr(Rr),ri}function ni(Ln,Vi){G(rr.next!==Rr,"can not resize a framebuffer which is currently in use");var wi=Math.max(Ln|0,1),Gi=Math.max(Vi|0||wi,1);if(wi===Rr.width&&Gi===Rr.height)return ri;for(var ca=Rr.colorAttachments,zo=0;zo<ca.length;++zo)jr(ca[zo],wi,Gi);return jr(Rr.depthAttachment,wi,Gi),jr(Rr.stencilAttachment,wi,Gi),jr(Rr.depthStencilAttachment,wi,Gi),Rr.width=ri.width=wi,Rr.height=ri.height=Gi,Fr(Rr),ri}return ri(ln,Nr),_(ri,{resize:ni,_reglType:"framebuffer",_framebuffer:Rr,destroy:function(){Br(Rr),Gr(Rr)},use:function(Vi){rr.setFBO({framebuffer:ri},Vi)}})}function jn(ln){var Nr=Array(6);function Rr(ni){var Ln;G(Nr.indexOf(rr.next)<0,"can not update framebuffer which is currently in use");var Vi={color:null},wi=0,Gi=null,ca="rgba",zo="uint8",zs=1;if(typeof ni=="number")wi=ni|0;else if(!ni)wi=1;else{G.type(ni,"object","invalid arguments for framebuffer");var Hi=ni;if("shape"in Hi){var No=Hi.shape;G(Array.isArray(No)&&No.length>=2,"invalid shape for framebuffer"),G(No[0]===No[1],"cube framebuffer must be square"),wi=No[0]}else"radius"in Hi&&(wi=Hi.radius|0),"width"in Hi?(wi=Hi.width|0,"height"in Hi&&G(Hi.height===wi,"must be square")):"height"in Hi&&(wi=Hi.height|0);("color"in Hi||"colors"in Hi)&&(Gi=Hi.color||Hi.colors,Array.isArray(Gi)&&G(Gi.length===1||he.webgl_draw_buffers,"multiple render targets not supported")),Gi||("colorCount"in Hi&&(zs=Hi.colorCount|0,G(zs>0,"invalid color buffer count")),"colorType"in Hi&&(G.oneOf(Hi.colorType,Wr,"invalid color type"),zo=Hi.colorType),"colorFormat"in Hi&&(ca=Hi.colorFormat,G.oneOf(Hi.colorFormat,kr,"invalid color format for texture"))),"depth"in Hi&&(Vi.depth=Hi.depth),"stencil"in Hi&&(Vi.stencil=Hi.stencil),"depthStencil"in Hi&&(Vi.depthStencil=Hi.depthStencil)}var Ja;if(Gi)if(Array.isArray(Gi))for(Ja=[],Ln=0;Ln<Gi.length;++Ln)Ja[Ln]=Gi[Ln];else Ja=[Gi];else{Ja=Array(zs);var es={radius:wi,format:ca,type:zo};for(Ln=0;Ln<zs;++Ln)Ja[Ln]=Vt.createCube(es)}for(Vi.color=Array(Ja.length),Ln=0;Ln<Ja.length;++Ln){var ts=Ja[Ln];G(typeof ts=="function"&&ts._reglType==="textureCube","invalid cube map"),wi=wi||ts.width,G(ts.width===wi&&ts.height===wi,"invalid cube map shape"),Vi.color[Ln]={target:ao,data:Ja[Ln]}}for(Ln=0;Ln<6;++Ln){for(var Es=0;Es<Ja.length;++Es)Vi.color[Es].target=ao+Ln;Ln>0&&(Vi.depth=Nr[0].depth,Vi.stencil=Nr[0].stencil,Vi.depthStencil=Nr[0].depthStencil),Nr[Ln]?Nr[Ln](Vi):Nr[Ln]=Xr(Vi)}return _(Rr,{width:wi,height:wi,color:Ja})}function ri(ni){var Ln,Vi=ni|0;if(G(Vi>0&&Vi<=Ue.maxCubeMapSize,"invalid radius for cube fbo"),Vi===Rr.width)return Rr;var wi=Rr.color;for(Ln=0;Ln<wi.length;++Ln)wi[Ln].resize(Vi);for(Ln=0;Ln<6;++Ln)Nr[Ln].resize(Vi);return Rr.width=Rr.height=Vi,Rr}return Rr(ln),_(Rr,{faces:Nr,resize:ri,_reglType:"framebufferCube",destroy:function(){Nr.forEach(function(Ln){Ln.destroy()})}})}function qn(){rr.cur=null,rr.next=null,rr.dirty=!0,pa(br).forEach(function(ln){ln.framebuffer=J.createFramebuffer(),Fr(ln)})}return _(rr,{getFramebuffer:function(Nr){if(typeof Nr=="function"&&Nr._reglType==="framebuffer"){var Rr=Nr._framebuffer;if(Rr instanceof Yn)return Rr}return null},create:Xr,createCube:jn,clear:function(){pa(br).forEach(Br)},restore:qn})}var Z=5126,q=34962;function de(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Z,this.offset=0,this.stride=0,this.divisor=0}function ge(J,he,Ue,Vt,yr){for(var pr=Ue.maxAttributes,rr=new Array(pr),kr=0;kr<pr;++kr)rr[kr]=new de;var rn=0,Wr={},$r={Record:de,scope:{},state:rr,currentVAO:null,targetVAO:null,restore:gn()?br:function(){},createVAO:Yn,getVAO:en,destroyBuffer:on,setVAO:gn()?ir:Jt,clear:gn()?jr:function(){}};function on(Gr){for(var Br=0;Br<rr.length;++Br){var Fr=rr[Br];Fr.buffer===Gr&&(J.disableVertexAttribArray(Br),Fr.buffer=null)}}function gn(){return he.oes_vertex_array_object}function cn(){return he.angle_instanced_arrays}function en(Gr){return typeof Gr=="function"&&Gr._vao?Gr._vao:null}function ir(Gr){if(Gr!==$r.currentVAO){var Br=gn();Gr?Br.bindVertexArrayOES(Gr.vao):Br.bindVertexArrayOES(null),$r.currentVAO=Gr}}function Jt(Gr){if(Gr!==$r.currentVAO){if(Gr)Gr.bindAttrs();else for(var Br=cn(),Fr=0;Fr<rr.length;++Fr){var Xr=rr[Fr];Xr.buffer?(J.enableVertexAttribArray(Fr),J.vertexAttribPointer(Fr,Xr.size,Xr.type,Xr.normalized,Xr.stride,Xr.offfset),Br&&Xr.divisor&&Br.vertexAttribDivisorANGLE(Fr,Xr.divisor)):(J.disableVertexAttribArray(Fr),J.vertexAttrib4f(Fr,Xr.x,Xr.y,Xr.z,Xr.w))}$r.currentVAO=Gr}}function jr(){pa(Wr).forEach(function(Gr){Gr.destroy()})}function yn(){this.id=++rn,this.attributes=[];var Gr=gn();Gr?this.vao=Gr.createVertexArrayOES():this.vao=null,Wr[this.id]=this,this.buffers=[]}yn.prototype.bindAttrs=function(){for(var Gr=cn(),Br=this.attributes,Fr=0;Fr<Br.length;++Fr){var Xr=Br[Fr];Xr.buffer?(J.enableVertexAttribArray(Fr),J.bindBuffer(q,Xr.buffer.buffer),J.vertexAttribPointer(Fr,Xr.size,Xr.type,Xr.normalized,Xr.stride,Xr.offset),Gr&&Xr.divisor&&Gr.vertexAttribDivisorANGLE(Fr,Xr.divisor)):(J.disableVertexAttribArray(Fr),J.vertexAttrib4f(Fr,Xr.x,Xr.y,Xr.z,Xr.w))}for(var jn=Br.length;jn<pr;++jn)J.disableVertexAttribArray(jn)},yn.prototype.refresh=function(){var Gr=gn();Gr&&(Gr.bindVertexArrayOES(this.vao),this.bindAttrs(),$r.currentVAO=this)},yn.prototype.destroy=function(){if(this.vao){var Gr=gn();this===$r.currentVAO&&($r.currentVAO=null,Gr.bindVertexArrayOES(null)),Gr.deleteVertexArrayOES(this.vao),this.vao=null}Wr[this.id]&&(delete Wr[this.id],Vt.vaoCount-=1)};function br(){var Gr=gn();Gr&&pa(Wr).forEach(function(Br){Br.refresh()})}function Yn(Gr){var Br=new yn;Vt.vaoCount+=1;function Fr(Xr){G(Array.isArray(Xr),"arguments to vertex array constructor must be an array"),G(Xr.length<pr,"too many attributes"),G(Xr.length>0,"must specify at least one attribute");var jn={},qn=Br.attributes;qn.length=Xr.length;for(var ln=0;ln<Xr.length;++ln){var Nr=Xr[ln],Rr=qn[ln]=new de,ri=Nr.data||Nr;if(Array.isArray(ri)||O(ri)||Ha(ri)){var ni;Br.buffers[ln]&&(ni=Br.buffers[ln],O(ri)&&ni._buffer.byteLength>=ri.byteLength?ni.subdata(ri):(ni.destroy(),Br.buffers[ln]=null)),Br.buffers[ln]||(ni=Br.buffers[ln]=yr.create(Nr,q,!1,!0)),Rr.buffer=yr.getBuffer(ni),Rr.size=Rr.buffer.dimension|0,Rr.normalized=!1,Rr.type=Rr.buffer.dtype,Rr.offset=0,Rr.stride=0,Rr.divisor=0,Rr.state=1,jn[ln]=1}else yr.getBuffer(Nr)?(Rr.buffer=yr.getBuffer(Nr),Rr.size=Rr.buffer.dimension|0,Rr.normalized=!1,Rr.type=Rr.buffer.dtype,Rr.offset=0,Rr.stride=0,Rr.divisor=0,Rr.state=1):yr.getBuffer(Nr.buffer)?(Rr.buffer=yr.getBuffer(Nr.buffer),Rr.size=(+Nr.size||Rr.buffer.dimension)|0,Rr.normalized=!!Nr.normalized||!1,"type"in Nr?(G.parameter(Nr.type,$n,"invalid buffer type"),Rr.type=$n[Nr.type]):Rr.type=Rr.buffer.dtype,Rr.offset=(Nr.offset||0)|0,Rr.stride=(Nr.stride||0)|0,Rr.divisor=(Nr.divisor||0)|0,Rr.state=1,G(Rr.size>=1&&Rr.size<=4,"size must be between 1 and 4"),G(Rr.offset>=0,"invalid offset"),G(Rr.stride>=0&&Rr.stride<=255,"stride must be between 0 and 255"),G(Rr.divisor>=0,"divisor must be positive"),G(!Rr.divisor||!!he.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Nr?(G(ln>0,"first attribute must not be a constant"),Rr.x=+Nr.x||0,Rr.y=+Nr.y||0,Rr.z=+Nr.z||0,Rr.w=+Nr.w||0,Rr.state=2):G(!1,"invalid attribute spec for location "+ln)}for(var Ln=0;Ln<Br.buffers.length;++Ln)!jn[Ln]&&Br.buffers[Ln]&&(Br.buffers[Ln].destroy(),Br.buffers[Ln]=null);return Br.refresh(),Fr}return Fr.destroy=function(){for(var Xr=0;Xr<Br.buffers.length;++Xr)Br.buffers[Xr]&&Br.buffers[Xr].destroy();Br.buffers.length=0,Br.destroy()},Fr._vao=Br,Fr._reglType="vao",Fr(Gr)}return $r}var be=35632,Ke=35633,He=35718,ut=35721;function We(J,he,Ue,Vt){var yr={},pr={};function rr(ir,Jt,jr,yn){this.name=ir,this.id=Jt,this.location=jr,this.info=yn}function kr(ir,Jt){for(var jr=0;jr<ir.length;++jr)if(ir[jr].id===Jt.id){ir[jr].location=Jt.location;return}ir.push(Jt)}function rn(ir,Jt,jr){var yn=ir===be?yr:pr,br=yn[Jt];if(!br){var Yn=he.str(Jt);br=J.createShader(ir),J.shaderSource(br,Yn),J.compileShader(br),G.shaderError(J,br,Yn,ir,jr),yn[Jt]=br}return br}var Wr={},$r=[],on=0;function gn(ir,Jt){this.id=on++,this.fragId=ir,this.vertId=Jt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Vt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function cn(ir,Jt,jr){var yn,br,Yn=rn(be,ir.fragId),Gr=rn(Ke,ir.vertId),Br=ir.program=J.createProgram();if(J.attachShader(Br,Yn),J.attachShader(Br,Gr),jr)for(yn=0;yn<jr.length;++yn){var Fr=jr[yn];J.bindAttribLocation(Br,Fr[0],Fr[1])}J.linkProgram(Br),G.linkError(J,Br,he.str(ir.fragId),he.str(ir.vertId),Jt);var Xr=J.getProgramParameter(Br,He);Vt.profile&&(ir.stats.uniformsCount=Xr);var jn=ir.uniforms;for(yn=0;yn<Xr;++yn)if(br=J.getActiveUniform(Br,yn),br)if(br.size>1)for(var qn=0;qn<br.size;++qn){var ln=br.name.replace("[0]","["+qn+"]");kr(jn,new rr(ln,he.id(ln),J.getUniformLocation(Br,ln),br))}else kr(jn,new rr(br.name,he.id(br.name),J.getUniformLocation(Br,br.name),br));var Nr=J.getProgramParameter(Br,ut);Vt.profile&&(ir.stats.attributesCount=Nr);var Rr=ir.attributes;for(yn=0;yn<Nr;++yn)br=J.getActiveAttrib(Br,yn),br&&kr(Rr,new rr(br.name,he.id(br.name),J.getAttribLocation(Br,br.name),br))}Vt.profile&&(Ue.getMaxUniformsCount=function(){var ir=0;return $r.forEach(function(Jt){Jt.stats.uniformsCount>ir&&(ir=Jt.stats.uniformsCount)}),ir},Ue.getMaxAttributesCount=function(){var ir=0;return $r.forEach(function(Jt){Jt.stats.attributesCount>ir&&(ir=Jt.stats.attributesCount)}),ir});function en(){yr={},pr={};for(var ir=0;ir<$r.length;++ir)cn($r[ir],null,$r[ir].attributes.map(function(Jt){return[Jt.location,Jt.name]}))}return{clear:function(){var Jt=J.deleteShader.bind(J);pa(yr).forEach(Jt),yr={},pa(pr).forEach(Jt),pr={},$r.forEach(function(jr){J.deleteProgram(jr.program)}),$r.length=0,Wr={},Ue.shaderCount=0},program:function(Jt,jr,yn,br){G.command(Jt>=0,"missing vertex shader",yn),G.command(jr>=0,"missing fragment shader",yn);var Yn=Wr[jr];Yn||(Yn=Wr[jr]={});var Gr=Yn[Jt];if(Gr&&(Gr.refCount++,!br))return Gr;var Br=new gn(jr,Jt);return Ue.shaderCount++,cn(Br,yn,br),Gr||(Yn[Jt]=Br),$r.push(Br),_(Br,{destroy:function(){if(Br.refCount--,Br.refCount<=0){J.deleteProgram(Br.program);var Xr=$r.indexOf(Br);$r.splice(Xr,1),Ue.shaderCount--}Yn[Br.vertId].refCount<=0&&(J.deleteShader(pr[Br.vertId]),delete pr[Br.vertId],delete Wr[Br.fragId][Br.vertId]),Object.keys(Wr[Br.fragId]).length||(J.deleteShader(yr[Br.fragId]),delete yr[Br.fragId],delete Wr[Br.fragId])}})},restore:en,shader:rn,frag:-1,vert:-1}}var et=6408,Pt=5121,Mt=3333,_r=5126;function nr(J,he,Ue,Vt,yr,pr,rr){function kr($r){var on;he.next===null?(G(yr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),on=Pt):(G(he.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),on=he.next.colorAttachments[0].texture._texture.type,pr.oes_texture_float?(G(on===Pt||on===_r,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),on===_r&&G(rr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):G(on===Pt,"Reading from a framebuffer is only allowed for the type 'uint8'"));var gn=0,cn=0,en=Vt.framebufferWidth,ir=Vt.framebufferHeight,Jt=null;O($r)?Jt=$r:$r&&(G.type($r,"object","invalid arguments to regl.read()"),gn=$r.x|0,cn=$r.y|0,G(gn>=0&&gn<Vt.framebufferWidth,"invalid x offset for regl.read"),G(cn>=0&&cn<Vt.framebufferHeight,"invalid y offset for regl.read"),en=($r.width||Vt.framebufferWidth-gn)|0,ir=($r.height||Vt.framebufferHeight-cn)|0,Jt=$r.data||null),Jt&&(on===Pt?G(Jt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):on===_r&&G(Jt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),G(en>0&&en+gn<=Vt.framebufferWidth,"invalid width for read pixels"),G(ir>0&&ir+cn<=Vt.framebufferHeight,"invalid height for read pixels"),Ue();var jr=en*ir*4;return Jt||(on===Pt?Jt=new Uint8Array(jr):on===_r&&(Jt=Jt||new Float32Array(jr))),G.isTypedArray(Jt,"data buffer for regl.read() must be a typedarray"),G(Jt.byteLength>=jr,"data buffer for regl.read() too small"),J.pixelStorei(Mt,4),J.readPixels(gn,cn,en,ir,et,on,Jt),Jt}function rn($r){var on;return he.setFBO({framebuffer:$r.framebuffer},function(){on=kr($r)}),on}function Wr($r){return!$r||!("framebuffer"in $r)?kr($r):rn($r)}return Wr}function gr(J){return Array.prototype.slice.call(J)}function Er(J){return gr(J).join("")}function tn(){var J=0,he=[],Ue=[];function Vt(on){for(var gn=0;gn<Ue.length;++gn)if(Ue[gn]===on)return he[gn];var cn="g"+J++;return he.push(cn),Ue.push(on),cn}function yr(){var on=[];function gn(){on.push.apply(on,gr(arguments))}var cn=[];function en(){var ir="v"+J++;return cn.push(ir),arguments.length>0&&(on.push(ir,"="),on.push.apply(on,gr(arguments)),on.push(";")),ir}return _(gn,{def:en,toString:function(){return Er([cn.length>0?"var "+cn.join(",")+";":"",Er(on)])}})}function pr(){var on=yr(),gn=yr(),cn=on.toString,en=gn.toString;function ir(Jt,jr){gn(Jt,jr,"=",on.def(Jt,jr),";")}return _(function(){on.apply(on,gr(arguments))},{def:on.def,entry:on,exit:gn,save:ir,set:function(jr,yn,br){ir(jr,yn),on(jr,yn,"=",br,";")},toString:function(){return cn()+en()}})}function rr(){var on=Er(arguments),gn=pr(),cn=pr(),en=gn.toString,ir=cn.toString;return _(gn,{then:function(){return gn.apply(gn,gr(arguments)),this},else:function(){return cn.apply(cn,gr(arguments)),this},toString:function(){var jr=ir();return jr&&(jr="else{"+jr+"}"),Er(["if(",on,"){",en(),"}",jr])}})}var kr=yr(),rn={};function Wr(on,gn){var cn=[];function en(){var br="a"+cn.length;return cn.push(br),br}gn=gn||0;for(var ir=0;ir<gn;++ir)en();var Jt=pr(),jr=Jt.toString,yn=rn[on]=_(Jt,{arg:en,toString:function(){return Er(["function(",cn.join(),"){",jr(),"}"])}});return yn}function $r(){var on=['"use strict";',kr,"return {"];Object.keys(rn).forEach(function(en){on.push('"',en,'":',rn[en].toString(),",")}),on.push("}");var gn=Er(on).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),cn=Function.apply(null,he.concat(gn));return cn.apply(null,Ue)}return{global:kr,link:Vt,block:yr,proc:Wr,scope:pr,cond:rr,compile:$r}}var Vr="xyzw".split(""),mn=5121,Sn=1,Hn=2,ei=0,Ei=1,Ki=2,bn=3,pi=4,bi=5,Nn=6,yi="dither",Kn="blend.enable",Ci="blend.color",Wi="blend.equation",mo="blend.func",oo="depth.enable",Oo="depth.func",La="depth.range",$a="depth.mask",Ss="colorMask",Qo="cull.enable",dl="cull.face",Ou="frontFace",qo="lineWidth",Ds="polygonOffset.enable",vl="polygonOffset.offset",oc="sample.alpha",Lu="sample.enable",ou="sample.coverage",ml="stencil.enable",Ru="stencil.mask",jl="stencil.func",su="stencil.opFront",so="stencil.opBack",Du="scissor.enable",Zl="scissor.box",ps="viewport",go="profile",Lo="framebuffer",Ro="vert",Do="frag",ko="elements",Xs="primitive",Ml="count",Vl="offset",Tc="instances",Gu="vao",Wc="Width",gl="Height",Ys=Lo+Wc,Fo=Lo+gl,lf=ps+Wc,nh=ps+gl,sc="drawingBuffer",Ef=sc+Wc,ih=sc+gl,Kh=[mo,Wi,jl,su,so,ou,ps,Zl,vl],uc=34962,ah=34963,wf=35632,zf=35633,B=3553,U=34067,M=2884,R=3042,ee=3024,_e=2960,it=2929,Tt=3089,wt=32823,fr=32926,Hr=32928,In=5126,Wn=35664,Cn=35665,fi=35666,gi=5124,Ji=35667,Mi=35668,Ra=35669,wo=35670,yo=35671,uo=35672,Za=35673,ra=35674,Da=35675,lo=35676,To=35678,co=35680,ks=4,uu=1028,Hu=1029,ds=2304,Ac=2305,Tf=32775,Ap=32776,$h=519,Cc=7680,cf=0,Jh=1,Qh=32774,Th=513,Ah=36160,Cp=36064,lc={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ff=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Af={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},cc={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Xc={frag:wf,vert:zf},Wu={cw:ds,ccw:Ac};function Nf(J){return Array.isArray(J)||O(J)||Ha(J)}function Ch(J){return J.sort(function(he,Ue){return he===ps?-1:Ue===ps?1:he<Ue?-1:1})}function _u(J,he,Ue,Vt){this.thisDep=J,this.contextDep=he,this.propDep=Ue,this.append=Vt}function yl(J){return J&&!(J.thisDep||J.contextDep||J.propDep)}function Zo(J){return new _u(!1,!1,!1,J)}function Fs(J,he){var Ue=J.type;if(Ue===ei){var Vt=J.data.length;return new _u(!0,Vt>=1,Vt>=2,he)}else if(Ue===pi){var yr=J.data;return new _u(yr.thisDep,yr.contextDep,yr.propDep,he)}else{if(Ue===bi)return new _u(!1,!1,!1,he);if(Ue===Nn){for(var pr=!1,rr=!1,kr=!1,rn=0;rn<J.data.length;++rn){var Wr=J.data[rn];if(Wr.type===Ei)kr=!0;else if(Wr.type===Ki)rr=!0;else if(Wr.type===bn)pr=!0;else if(Wr.type===ei){pr=!0;var $r=Wr.data;$r>=1&&(rr=!0),$r>=2&&(kr=!0)}else Wr.type===pi&&(pr=pr||Wr.data.thisDep,rr=rr||Wr.data.contextDep,kr=kr||Wr.data.propDep)}return new _u(pr,rr,kr,he)}else return new _u(Ue===bn,Ue===Ki,Ue===Ei,he)}}var Ph=new _u(!1,!1,!1,function(){});function qh(J,he,Ue,Vt,yr,pr,rr,kr,rn,Wr,$r,on,gn,cn,en){var ir=Wr.Record,Jt={add:32774,subtract:32778,"reverse subtract":32779};Ue.ext_blend_minmax&&(Jt.min=Tf,Jt.max=Ap);var jr=Ue.angle_instanced_arrays,yn=Ue.webgl_draw_buffers,br={dirty:!0,profile:en.profile},Yn={},Gr=[],Br={},Fr={};function Xr(Oe){return Oe.replace(".","_")}function jn(Oe,xe,ft){var zt=Xr(Oe);Gr.push(Oe),Yn[zt]=br[zt]=!!ft,Br[zt]=xe}function qn(Oe,xe,ft){var zt=Xr(Oe);Gr.push(Oe),Array.isArray(ft)?(br[zt]=ft.slice(),Yn[zt]=ft.slice()):br[zt]=Yn[zt]=ft,Fr[zt]=xe}jn(yi,ee),jn(Kn,R),qn(Ci,"blendColor",[0,0,0,0]),qn(Wi,"blendEquationSeparate",[Qh,Qh]),qn(mo,"blendFuncSeparate",[Jh,cf,Jh,cf]),jn(oo,it,!0),qn(Oo,"depthFunc",Th),qn(La,"depthRange",[0,1]),qn($a,"depthMask",!0),qn(Ss,Ss,[!0,!0,!0,!0]),jn(Qo,M),qn(dl,"cullFace",Hu),qn(Ou,Ou,Ac),qn(qo,qo,1),jn(Ds,wt),qn(vl,"polygonOffset",[0,0]),jn(oc,fr),jn(Lu,Hr),qn(ou,"sampleCoverage",[1,!1]),jn(ml,_e),qn(Ru,"stencilMask",-1),qn(jl,"stencilFunc",[$h,0,-1]),qn(su,"stencilOpSeparate",[uu,Cc,Cc,Cc]),qn(so,"stencilOpSeparate",[Hu,Cc,Cc,Cc]),jn(Du,Tt),qn(Zl,"scissor",[0,0,J.drawingBufferWidth,J.drawingBufferHeight]),qn(ps,ps,[0,0,J.drawingBufferWidth,J.drawingBufferHeight]);var ln={gl:J,context:gn,strings:he,next:Yn,current:br,draw:on,elements:pr,buffer:yr,shader:$r,attributes:Wr.state,vao:Wr,uniforms:rn,framebuffer:kr,extensions:Ue,timer:cn,isBufferArgs:Nf},Nr={primTypes:ja,compareFuncs:Af,blendFuncs:lc,blendEquations:Jt,stencilOps:cc,glTypes:$n,orientationType:Wu};G.optional(function(){ln.isArrayLike=no}),yn&&(Nr.backBuffer=[Hu],Nr.drawBuffer=I(Vt.maxDrawbuffers,function(Oe){return Oe===0?[0]:I(Oe,function(xe){return Cp+xe})}));var Rr=0;function ri(){var Oe=tn(),xe=Oe.link,ft=Oe.global;Oe.id=Rr++,Oe.batchId="0";var zt=xe(ln),jt=Oe.shared={props:"a0"};Object.keys(ln).forEach(function(st){jt[st]=ft.def(zt,".",st)}),G.optional(function(){Oe.CHECK=xe(G),Oe.commandStr=G.guessCommand(),Oe.command=xe(Oe.commandStr),Oe.assert=function(st,Ae,kt){st("if(!(",Ae,"))",this.CHECK,".commandRaise(",xe(kt),",",this.command,");")},Nr.invalidBlendCombinations=ff});var mt=Oe.next={},ht=Oe.current={};Object.keys(Fr).forEach(function(st){Array.isArray(br[st])&&(mt[st]=ft.def(jt.next,".",st),ht[st]=ft.def(jt.current,".",st))});var It=Oe.constants={};Object.keys(Nr).forEach(function(st){It[st]=ft.def(JSON.stringify(Nr[st]))}),Oe.invoke=function(st,Ae){switch(Ae.type){case ei:var kt=["this",jt.context,jt.props,Oe.batchId];return st.def(xe(Ae.data),".call(",kt.slice(0,Math.max(Ae.data.length+1,4)),")");case Ei:return st.def(jt.props,Ae.data);case Ki:return st.def(jt.context,Ae.data);case bn:return st.def("this",Ae.data);case pi:return Ae.data.append(Oe,st),Ae.data.ref;case bi:return Ae.data.toString();case Nn:return Ae.data.map(function(Gt){return Oe.invoke(st,Gt)})}},Oe.attribCache={};var De={};return Oe.scopeAttrib=function(st){var Ae=he.id(st);if(Ae in De)return De[Ae];var kt=Wr.scope[Ae];kt||(kt=Wr.scope[Ae]=new ir);var Gt=De[Ae]=xe(kt);return Gt},Oe}function ni(Oe){var xe=Oe.static,ft=Oe.dynamic,zt;if(go in xe){var jt=!!xe[go];zt=Zo(function(ht,It){return jt}),zt.enable=jt}else if(go in ft){var mt=ft[go];zt=Fs(mt,function(ht,It){return ht.invoke(It,mt)})}return zt}function Ln(Oe,xe){var ft=Oe.static,zt=Oe.dynamic;if(Lo in ft){var jt=ft[Lo];return jt?(jt=kr.getFramebuffer(jt),G.command(jt,"invalid framebuffer object"),Zo(function(ht,It){var De=ht.link(jt),st=ht.shared;It.set(st.framebuffer,".next",De);var Ae=st.context;return It.set(Ae,"."+Ys,De+".width"),It.set(Ae,"."+Fo,De+".height"),De})):Zo(function(ht,It){var De=ht.shared;It.set(De.framebuffer,".next","null");var st=De.context;return It.set(st,"."+Ys,st+"."+Ef),It.set(st,"."+Fo,st+"."+ih),"null"})}else if(Lo in zt){var mt=zt[Lo];return Fs(mt,function(ht,It){var De=ht.invoke(It,mt),st=ht.shared,Ae=st.framebuffer,kt=It.def(Ae,".getFramebuffer(",De,")");G.optional(function(){ht.assert(It,"!"+De+"||"+kt,"invalid framebuffer object")}),It.set(Ae,".next",kt);var Gt=st.context;return It.set(Gt,"."+Ys,kt+"?"+kt+".width:"+Gt+"."+Ef),It.set(Gt,"."+Fo,kt+"?"+kt+".height:"+Gt+"."+ih),kt})}else return null}function Vi(Oe,xe,ft){var zt=Oe.static,jt=Oe.dynamic;function mt(De){if(De in zt){var st=zt[De];G.commandType(st,"object","invalid "+De,ft.commandStr);var Ae=!0,kt=st.x|0,Gt=st.y|0,Ar,or;return"width"in st?(Ar=st.width|0,G.command(Ar>=0,"invalid "+De,ft.commandStr)):Ae=!1,"height"in st?(or=st.height|0,G.command(or>=0,"invalid "+De,ft.commandStr)):Ae=!1,new _u(!Ae&&xe&&xe.thisDep,!Ae&&xe&&xe.contextDep,!Ae&&xe&&xe.propDep,function(Bn,Ni){var Dn=Bn.shared.context,ai=Ar;"width"in st||(ai=Ni.def(Dn,".",Ys,"-",kt));var Pi=or;return"height"in st||(Pi=Ni.def(Dn,".",Fo,"-",Gt)),[kt,Gt,ai,Pi]})}else if(De in jt){var xr=jt[De],Yr=Fs(xr,function(Bn,Ni){var Dn=Bn.invoke(Ni,xr);G.optional(function(){Bn.assert(Ni,Dn+"&&typeof "+Dn+'==="object"',"invalid "+De)});var ai=Bn.shared.context,Pi=Ni.def(Dn,".x|0"),ea=Ni.def(Dn,".y|0"),Vo=Ni.def('"width" in ',Dn,"?",Dn,".width|0:","(",ai,".",Ys,"-",Pi,")"),ku=Ni.def('"height" in ',Dn,"?",Dn,".height|0:","(",ai,".",Fo,"-",ea,")");return G.optional(function(){Bn.assert(Ni,Vo+">=0&&"+ku+">=0","invalid "+De)}),[Pi,ea,Vo,ku]});return xe&&(Yr.thisDep=Yr.thisDep||xe.thisDep,Yr.contextDep=Yr.contextDep||xe.contextDep,Yr.propDep=Yr.propDep||xe.propDep),Yr}else return xe?new _u(xe.thisDep,xe.contextDep,xe.propDep,function(Bn,Ni){var Dn=Bn.shared.context;return[0,0,Ni.def(Dn,".",Ys),Ni.def(Dn,".",Fo)]}):null}var ht=mt(ps);if(ht){var It=ht;ht=new _u(ht.thisDep,ht.contextDep,ht.propDep,function(De,st){var Ae=It.append(De,st),kt=De.shared.context;return st.set(kt,"."+lf,Ae[2]),st.set(kt,"."+nh,Ae[3]),Ae})}return{viewport:ht,scissor_box:mt(Zl)}}function wi(Oe,xe){var ft=Oe.static,zt=typeof ft[Do]=="string"&&typeof ft[Ro]=="string";if(zt){if(Object.keys(xe.dynamic).length>0)return null;var jt=xe.static,mt=Object.keys(jt);if(mt.length>0&&typeof jt[mt[0]]=="number"){for(var ht=[],It=0;It<mt.length;++It)G(typeof jt[mt[It]]=="number","must specify all vertex attribute locations when using vaos"),ht.push([jt[mt[It]]|0,mt[It]]);return ht}}return null}function Gi(Oe,xe,ft){var zt=Oe.static,jt=Oe.dynamic;function mt(Ae){if(Ae in zt){var kt=he.id(zt[Ae]);G.optional(function(){$r.shader(Xc[Ae],kt,G.guessCommand())});var Gt=Zo(function(){return kt});return Gt.id=kt,Gt}else if(Ae in jt){var Ar=jt[Ae];return Fs(Ar,function(or,xr){var Yr=or.invoke(xr,Ar),Bn=xr.def(or.shared.strings,".id(",Yr,")");return G.optional(function(){xr(or.shared.shader,".shader(",Xc[Ae],",",Bn,",",or.command,");")}),Bn})}return null}var ht=mt(Do),It=mt(Ro),De=null,st;return yl(ht)&&yl(It)?(De=$r.program(It.id,ht.id,null,ft),st=Zo(function(Ae,kt){return Ae.link(De)})):st=new _u(ht&&ht.thisDep||It&&It.thisDep,ht&&ht.contextDep||It&&It.contextDep,ht&&ht.propDep||It&&It.propDep,function(Ae,kt){var Gt=Ae.shared.shader,Ar;ht?Ar=ht.append(Ae,kt):Ar=kt.def(Gt,".",Do);var or;It?or=It.append(Ae,kt):or=kt.def(Gt,".",Ro);var xr=Gt+".program("+or+","+Ar;return G.optional(function(){xr+=","+Ae.command}),kt.def(xr+")")}),{frag:ht,vert:It,progVar:st,program:De}}function ca(Oe,xe){var ft=Oe.static,zt=Oe.dynamic;function jt(){if(ko in ft){var Ae=ft[ko];Nf(Ae)?Ae=pr.getElements(pr.create(Ae,!0)):Ae&&(Ae=pr.getElements(Ae),G.command(Ae,"invalid elements",xe.commandStr));var kt=Zo(function(Ar,or){if(Ae){var xr=Ar.link(Ae);return Ar.ELEMENTS=xr,xr}return Ar.ELEMENTS=null,null});return kt.value=Ae,kt}else if(ko in zt){var Gt=zt[ko];return Fs(Gt,function(Ar,or){var xr=Ar.shared,Yr=xr.isBufferArgs,Bn=xr.elements,Ni=Ar.invoke(or,Gt),Dn=or.def("null"),ai=or.def(Yr,"(",Ni,")"),Pi=Ar.cond(ai).then(Dn,"=",Bn,".createStream(",Ni,");").else(Dn,"=",Bn,".getElements(",Ni,");");return G.optional(function(){Ar.assert(Pi.else,"!"+Ni+"||"+Dn,"invalid elements")}),or.entry(Pi),or.exit(Ar.cond(ai).then(Bn,".destroyStream(",Dn,");")),Ar.ELEMENTS=Dn,Dn})}return null}var mt=jt();function ht(){if(Xs in ft){var Ae=ft[Xs];return G.commandParameter(Ae,ja,"invalid primitve",xe.commandStr),Zo(function(Gt,Ar){return ja[Ae]})}else if(Xs in zt){var kt=zt[Xs];return Fs(kt,function(Gt,Ar){var or=Gt.constants.primTypes,xr=Gt.invoke(Ar,kt);return G.optional(function(){Gt.assert(Ar,xr+" in "+or,"invalid primitive, must be one of "+Object.keys(ja))}),Ar.def(or,"[",xr,"]")})}else if(mt)return yl(mt)?mt.value?Zo(function(Gt,Ar){return Ar.def(Gt.ELEMENTS,".primType")}):Zo(function(){return ks}):new _u(mt.thisDep,mt.contextDep,mt.propDep,function(Gt,Ar){var or=Gt.ELEMENTS;return Ar.def(or,"?",or,".primType:",ks)});return null}function It(Ae,kt){if(Ae in ft){var Gt=ft[Ae]|0;return G.command(!kt||Gt>=0,"invalid "+Ae,xe.commandStr),Zo(function(or,xr){return kt&&(or.OFFSET=Gt),Gt})}else if(Ae in zt){var Ar=zt[Ae];return Fs(Ar,function(or,xr){var Yr=or.invoke(xr,Ar);return kt&&(or.OFFSET=Yr,G.optional(function(){or.assert(xr,Yr+">=0","invalid "+Ae)})),Yr})}else if(kt&&mt)return Zo(function(or,xr){return or.OFFSET="0",0});return null}var De=It(Vl,!0);function st(){if(Ml in ft){var Ae=ft[Ml]|0;return G.command(typeof Ae=="number"&&Ae>=0,"invalid vertex count",xe.commandStr),Zo(function(){return Ae})}else if(Ml in zt){var kt=zt[Ml];return Fs(kt,function(or,xr){var Yr=or.invoke(xr,kt);return G.optional(function(){or.assert(xr,"typeof "+Yr+'==="number"&&'+Yr+">=0&&"+Yr+"===("+Yr+"|0)","invalid vertex count")}),Yr})}else if(mt)if(yl(mt)){if(mt)return De?new _u(De.thisDep,De.contextDep,De.propDep,function(or,xr){var Yr=xr.def(or.ELEMENTS,".vertCount-",or.OFFSET);return G.optional(function(){or.assert(xr,Yr+">=0","invalid vertex offset/element buffer too small")}),Yr}):Zo(function(or,xr){return xr.def(or.ELEMENTS,".vertCount")});var Gt=Zo(function(){return-1});return G.optional(function(){Gt.MISSING=!0}),Gt}else{var Ar=new _u(mt.thisDep||De.thisDep,mt.contextDep||De.contextDep,mt.propDep||De.propDep,function(or,xr){var Yr=or.ELEMENTS;return or.OFFSET?xr.def(Yr,"?",Yr,".vertCount-",or.OFFSET,":-1"):xr.def(Yr,"?",Yr,".vertCount:-1")});return G.optional(function(){Ar.DYNAMIC=!0}),Ar}return null}return{elements:mt,primitive:ht(),count:st(),instances:It(Tc,!1),offset:De}}function zo(Oe,xe){var ft=Oe.static,zt=Oe.dynamic,jt={};return Gr.forEach(function(mt){var ht=Xr(mt);function It(De,st){if(mt in ft){var Ae=De(ft[mt]);jt[ht]=Zo(function(){return Ae})}else if(mt in zt){var kt=zt[mt];jt[ht]=Fs(kt,function(Gt,Ar){return st(Gt,Ar,Gt.invoke(Ar,kt))})}}switch(mt){case Qo:case Kn:case yi:case ml:case oo:case Du:case Ds:case oc:case Lu:case $a:return It(function(De){return G.commandType(De,"boolean",mt,xe.commandStr),De},function(De,st,Ae){return G.optional(function(){De.assert(st,"typeof "+Ae+'==="boolean"',"invalid flag "+mt,De.commandStr)}),Ae});case Oo:return It(function(De){return G.commandParameter(De,Af,"invalid "+mt,xe.commandStr),Af[De]},function(De,st,Ae){var kt=De.constants.compareFuncs;return G.optional(function(){De.assert(st,Ae+" in "+kt,"invalid "+mt+", must be one of "+Object.keys(Af))}),st.def(kt,"[",Ae,"]")});case La:return It(function(De){return G.command(no(De)&&De.length===2&&typeof De[0]=="number"&&typeof De[1]=="number"&&De[0]<=De[1],"depth range is 2d array",xe.commandStr),De},function(De,st,Ae){G.optional(function(){De.assert(st,De.shared.isArrayLike+"("+Ae+")&&"+Ae+".length===2&&typeof "+Ae+'[0]==="number"&&typeof '+Ae+'[1]==="number"&&'+Ae+"[0]<="+Ae+"[1]","depth range must be a 2d array")});var kt=st.def("+",Ae,"[0]"),Gt=st.def("+",Ae,"[1]");return[kt,Gt]});case mo:return It(function(De){G.commandType(De,"object","blend.func",xe.commandStr);var st="srcRGB"in De?De.srcRGB:De.src,Ae="srcAlpha"in De?De.srcAlpha:De.src,kt="dstRGB"in De?De.dstRGB:De.dst,Gt="dstAlpha"in De?De.dstAlpha:De.dst;return G.commandParameter(st,lc,ht+".srcRGB",xe.commandStr),G.commandParameter(Ae,lc,ht+".srcAlpha",xe.commandStr),G.commandParameter(kt,lc,ht+".dstRGB",xe.commandStr),G.commandParameter(Gt,lc,ht+".dstAlpha",xe.commandStr),G.command(ff.indexOf(st+", "+kt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+st+", "+kt+")",xe.commandStr),[lc[st],lc[kt],lc[Ae],lc[Gt]]},function(De,st,Ae){var kt=De.constants.blendFuncs;G.optional(function(){De.assert(st,Ae+"&&typeof "+Ae+'==="object"',"invalid blend func, must be an object")});function Gt(Dn,ai){var Pi=st.def('"',Dn,ai,'" in ',Ae,"?",Ae,".",Dn,ai,":",Ae,".",Dn);return G.optional(function(){De.assert(st,Pi+" in "+kt,"invalid "+mt+"."+Dn+ai+", must be one of "+Object.keys(lc))}),Pi}var Ar=Gt("src","RGB"),or=Gt("dst","RGB");G.optional(function(){var Dn=De.constants.invalidBlendCombinations;De.assert(st,Dn+".indexOf("+Ar+'+", "+'+or+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var xr=st.def(kt,"[",Ar,"]"),Yr=st.def(kt,"[",Gt("src","Alpha"),"]"),Bn=st.def(kt,"[",or,"]"),Ni=st.def(kt,"[",Gt("dst","Alpha"),"]");return[xr,Bn,Yr,Ni]});case Wi:return It(function(De){if(typeof De=="string")return G.commandParameter(De,Jt,"invalid "+mt,xe.commandStr),[Jt[De],Jt[De]];if(typeof De=="object")return G.commandParameter(De.rgb,Jt,mt+".rgb",xe.commandStr),G.commandParameter(De.alpha,Jt,mt+".alpha",xe.commandStr),[Jt[De.rgb],Jt[De.alpha]];G.commandRaise("invalid blend.equation",xe.commandStr)},function(De,st,Ae){var kt=De.constants.blendEquations,Gt=st.def(),Ar=st.def(),or=De.cond("typeof ",Ae,'==="string"');return G.optional(function(){function xr(Yr,Bn,Ni){De.assert(Yr,Ni+" in "+kt,"invalid "+Bn+", must be one of "+Object.keys(Jt))}xr(or.then,mt,Ae),De.assert(or.else,Ae+"&&typeof "+Ae+'==="object"',"invalid "+mt),xr(or.else,mt+".rgb",Ae+".rgb"),xr(or.else,mt+".alpha",Ae+".alpha")}),or.then(Gt,"=",Ar,"=",kt,"[",Ae,"];"),or.else(Gt,"=",kt,"[",Ae,".rgb];",Ar,"=",kt,"[",Ae,".alpha];"),st(or),[Gt,Ar]});case Ci:return It(function(De){return G.command(no(De)&&De.length===4,"blend.color must be a 4d array",xe.commandStr),I(4,function(st){return+De[st]})},function(De,st,Ae){return G.optional(function(){De.assert(st,De.shared.isArrayLike+"("+Ae+")&&"+Ae+".length===4","blend.color must be a 4d array")}),I(4,function(kt){return st.def("+",Ae,"[",kt,"]")})});case Ru:return It(function(De){return G.commandType(De,"number",ht,xe.commandStr),De|0},function(De,st,Ae){return G.optional(function(){De.assert(st,"typeof "+Ae+'==="number"',"invalid stencil.mask")}),st.def(Ae,"|0")});case jl:return It(function(De){G.commandType(De,"object",ht,xe.commandStr);var st=De.cmp||"keep",Ae=De.ref||0,kt="mask"in De?De.mask:-1;return G.commandParameter(st,Af,mt+".cmp",xe.commandStr),G.commandType(Ae,"number",mt+".ref",xe.commandStr),G.commandType(kt,"number",mt+".mask",xe.commandStr),[Af[st],Ae,kt]},function(De,st,Ae){var kt=De.constants.compareFuncs;G.optional(function(){function xr(){De.assert(st,Array.prototype.join.call(arguments,""),"invalid stencil.func")}xr(Ae+"&&typeof ",Ae,'==="object"'),xr('!("cmp" in ',Ae,")||(",Ae,".cmp in ",kt,")")});var Gt=st.def('"cmp" in ',Ae,"?",kt,"[",Ae,".cmp]",":",Cc),Ar=st.def(Ae,".ref|0"),or=st.def('"mask" in ',Ae,"?",Ae,".mask|0:-1");return[Gt,Ar,or]});case su:case so:return It(function(De){G.commandType(De,"object",ht,xe.commandStr);var st=De.fail||"keep",Ae=De.zfail||"keep",kt=De.zpass||"keep";return G.commandParameter(st,cc,mt+".fail",xe.commandStr),G.commandParameter(Ae,cc,mt+".zfail",xe.commandStr),G.commandParameter(kt,cc,mt+".zpass",xe.commandStr),[mt===so?Hu:uu,cc[st],cc[Ae],cc[kt]]},function(De,st,Ae){var kt=De.constants.stencilOps;G.optional(function(){De.assert(st,Ae+"&&typeof "+Ae+'==="object"',"invalid "+mt)});function Gt(Ar){return G.optional(function(){De.assert(st,'!("'+Ar+'" in '+Ae+")||("+Ae+"."+Ar+" in "+kt+")","invalid "+mt+"."+Ar+", must be one of "+Object.keys(cc))}),st.def('"',Ar,'" in ',Ae,"?",kt,"[",Ae,".",Ar,"]:",Cc)}return[mt===so?Hu:uu,Gt("fail"),Gt("zfail"),Gt("zpass")]});case vl:return It(function(De){G.commandType(De,"object",ht,xe.commandStr);var st=De.factor|0,Ae=De.units|0;return G.commandType(st,"number",ht+".factor",xe.commandStr),G.commandType(Ae,"number",ht+".units",xe.commandStr),[st,Ae]},function(De,st,Ae){G.optional(function(){De.assert(st,Ae+"&&typeof "+Ae+'==="object"',"invalid "+mt)});var kt=st.def(Ae,".factor|0"),Gt=st.def(Ae,".units|0");return[kt,Gt]});case dl:return It(function(De){var st=0;return De==="front"?st=uu:De==="back"&&(st=Hu),G.command(!!st,ht,xe.commandStr),st},function(De,st,Ae){return G.optional(function(){De.assert(st,Ae+'==="front"||'+Ae+'==="back"',"invalid cull.face")}),st.def(Ae,'==="front"?',uu,":",Hu)});case qo:return It(function(De){return G.command(typeof De=="number"&&De>=Vt.lineWidthDims[0]&&De<=Vt.lineWidthDims[1],"invalid line width, must be a positive number between "+Vt.lineWidthDims[0]+" and "+Vt.lineWidthDims[1],xe.commandStr),De},function(De,st,Ae){return G.optional(function(){De.assert(st,"typeof "+Ae+'==="number"&&'+Ae+">="+Vt.lineWidthDims[0]+"&&"+Ae+"<="+Vt.lineWidthDims[1],"invalid line width")}),Ae});case Ou:return It(function(De){return G.commandParameter(De,Wu,ht,xe.commandStr),Wu[De]},function(De,st,Ae){return G.optional(function(){De.assert(st,Ae+'==="cw"||'+Ae+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),st.def(Ae+'==="cw"?'+ds+":"+Ac)});case Ss:return It(function(De){return G.command(no(De)&&De.length===4,"color.mask must be length 4 array",xe.commandStr),De.map(function(st){return!!st})},function(De,st,Ae){return G.optional(function(){De.assert(st,De.shared.isArrayLike+"("+Ae+")&&"+Ae+".length===4","invalid color.mask")}),I(4,function(kt){return"!!"+Ae+"["+kt+"]"})});case ou:return It(function(De){G.command(typeof De=="object"&&De,ht,xe.commandStr);var st="value"in De?De.value:1,Ae=!!De.invert;return G.command(typeof st=="number"&&st>=0&&st<=1,"sample.coverage.value must be a number between 0 and 1",xe.commandStr),[st,Ae]},function(De,st,Ae){G.optional(function(){De.assert(st,Ae+"&&typeof "+Ae+'==="object"',"invalid sample.coverage")});var kt=st.def('"value" in ',Ae,"?+",Ae,".value:1"),Gt=st.def("!!",Ae,".invert");return[kt,Gt]})}}),jt}function zs(Oe,xe){var ft=Oe.static,zt=Oe.dynamic,jt={};return Object.keys(ft).forEach(function(mt){var ht=ft[mt],It;if(typeof ht=="number"||typeof ht=="boolean")It=Zo(function(){return ht});else if(typeof ht=="function"){var De=ht._reglType;De==="texture2d"||De==="textureCube"?It=Zo(function(st){return st.link(ht)}):De==="framebuffer"||De==="framebufferCube"?(G.command(ht.color.length>0,'missing color attachment for framebuffer sent to uniform "'+mt+'"',xe.commandStr),It=Zo(function(st){return st.link(ht.color[0])})):G.commandRaise('invalid data for uniform "'+mt+'"',xe.commandStr)}else no(ht)?It=Zo(function(st){var Ae=st.global.def("[",I(ht.length,function(kt){return G.command(typeof ht[kt]=="number"||typeof ht[kt]=="boolean","invalid uniform "+mt,st.commandStr),ht[kt]}),"]");return Ae}):G.commandRaise('invalid or missing data for uniform "'+mt+'"',xe.commandStr);It.value=ht,jt[mt]=It}),Object.keys(zt).forEach(function(mt){var ht=zt[mt];jt[mt]=Fs(ht,function(It,De){return It.invoke(De,ht)})}),jt}function Hi(Oe,xe){var ft=Oe.static,zt=Oe.dynamic,jt={};return Object.keys(ft).forEach(function(mt){var ht=ft[mt],It=he.id(mt),De=new ir;if(Nf(ht))De.state=Sn,De.buffer=yr.getBuffer(yr.create(ht,uc,!1,!0)),De.type=0;else{var st=yr.getBuffer(ht);if(st)De.state=Sn,De.buffer=st,De.type=0;else if(G.command(typeof ht=="object"&&ht,"invalid data for attribute "+mt,xe.commandStr),"constant"in ht){var Ae=ht.constant;De.buffer="null",De.state=Hn,typeof Ae=="number"?De.x=Ae:(G.command(no(Ae)&&Ae.length>0&&Ae.length<=4,"invalid constant for attribute "+mt,xe.commandStr),Vr.forEach(function(Bn,Ni){Ni<Ae.length&&(De[Bn]=Ae[Ni])}))}else{Nf(ht.buffer)?st=yr.getBuffer(yr.create(ht.buffer,uc,!1,!0)):st=yr.getBuffer(ht.buffer),G.command(!!st,'missing buffer for attribute "'+mt+'"',xe.commandStr);var kt=ht.offset|0;G.command(kt>=0,'invalid offset for attribute "'+mt+'"',xe.commandStr);var Gt=ht.stride|0;G.command(Gt>=0&&Gt<256,'invalid stride for attribute "'+mt+'", must be integer betweeen [0, 255]',xe.commandStr);var Ar=ht.size|0;G.command(!("size"in ht)||Ar>0&&Ar<=4,'invalid size for attribute "'+mt+'", must be 1,2,3,4',xe.commandStr);var or=!!ht.normalized,xr=0;"type"in ht&&(G.commandParameter(ht.type,$n,"invalid type for attribute "+mt,xe.commandStr),xr=$n[ht.type]);var Yr=ht.divisor|0;"divisor"in ht&&(G.command(Yr===0||jr,'cannot specify divisor for attribute "'+mt+'", instancing not supported',xe.commandStr),G.command(Yr>=0,'invalid divisor for attribute "'+mt+'"',xe.commandStr)),G.optional(function(){var Bn=xe.commandStr,Ni=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(ht).forEach(function(Dn){G.command(Ni.indexOf(Dn)>=0,'unknown parameter "'+Dn+'" for attribute pointer "'+mt+'" (valid parameters are '+Ni+")",Bn)})}),De.buffer=st,De.state=Sn,De.size=Ar,De.normalized=or,De.type=xr||st.dtype,De.offset=kt,De.stride=Gt,De.divisor=Yr}}jt[mt]=Zo(function(Bn,Ni){var Dn=Bn.attribCache;if(It in Dn)return Dn[It];var ai={isStream:!1};return Object.keys(De).forEach(function(Pi){ai[Pi]=De[Pi]}),De.buffer&&(ai.buffer=Bn.link(De.buffer),ai.type=ai.type||ai.buffer+".dtype"),Dn[It]=ai,ai})}),Object.keys(zt).forEach(function(mt){var ht=zt[mt];function It(De,st){var Ae=De.invoke(st,ht),kt=De.shared,Gt=De.constants,Ar=kt.isBufferArgs,or=kt.buffer;G.optional(function(){De.assert(st,Ae+"&&(typeof "+Ae+'==="object"||typeof '+Ae+'==="function")&&('+Ar+"("+Ae+")||"+or+".getBuffer("+Ae+")||"+or+".getBuffer("+Ae+".buffer)||"+Ar+"("+Ae+'.buffer)||("constant" in '+Ae+"&&(typeof "+Ae+'.constant==="number"||'+kt.isArrayLike+"("+Ae+".constant))))",'invalid dynamic attribute "'+mt+'"')});var xr={isStream:st.def(!1)},Yr=new ir;Yr.state=Sn,Object.keys(Yr).forEach(function(ai){xr[ai]=st.def(""+Yr[ai])});var Bn=xr.buffer,Ni=xr.type;st("if(",Ar,"(",Ae,")){",xr.isStream,"=true;",Bn,"=",or,".createStream(",uc,",",Ae,");",Ni,"=",Bn,".dtype;","}else{",Bn,"=",or,".getBuffer(",Ae,");","if(",Bn,"){",Ni,"=",Bn,".dtype;",'}else if("constant" in ',Ae,"){",xr.state,"=",Hn,";","if(typeof "+Ae+'.constant === "number"){',xr[Vr[0]],"=",Ae,".constant;",Vr.slice(1).map(function(ai){return xr[ai]}).join("="),"=0;","}else{",Vr.map(function(ai,Pi){return xr[ai]+"="+Ae+".constant.length>"+Pi+"?"+Ae+".constant["+Pi+"]:0;"}).join(""),"}}else{","if(",Ar,"(",Ae,".buffer)){",Bn,"=",or,".createStream(",uc,",",Ae,".buffer);","}else{",Bn,"=",or,".getBuffer(",Ae,".buffer);","}",Ni,'="type" in ',Ae,"?",Gt.glTypes,"[",Ae,".type]:",Bn,".dtype;",xr.normalized,"=!!",Ae,".normalized;");function Dn(ai){st(xr[ai],"=",Ae,".",ai,"|0;")}return Dn("size"),Dn("offset"),Dn("stride"),Dn("divisor"),st("}}"),st.exit("if(",xr.isStream,"){",or,".destroyStream(",Bn,");","}"),xr}jt[mt]=Fs(ht,It)}),jt}function No(Oe,xe){var ft=Oe.static,zt=Oe.dynamic;if(Gu in ft){var jt=ft[Gu];return jt!==null&&Wr.getVAO(jt)===null&&(jt=Wr.createVAO(jt)),Zo(function(ht){return ht.link(Wr.getVAO(jt))})}else if(Gu in zt){var mt=zt[Gu];return Fs(mt,function(ht,It){var De=ht.invoke(It,mt);return It.def(ht.shared.vao+".getVAO("+De+")")})}return null}function Ja(Oe){var xe=Oe.static,ft=Oe.dynamic,zt={};return Object.keys(xe).forEach(function(jt){var mt=xe[jt];zt[jt]=Zo(function(ht,It){return typeof mt=="number"||typeof mt=="boolean"?""+mt:ht.link(mt)})}),Object.keys(ft).forEach(function(jt){var mt=ft[jt];zt[jt]=Fs(mt,function(ht,It){return ht.invoke(It,mt)})}),zt}function es(Oe,xe,ft,zt,jt){var mt=Oe.static,ht=Oe.dynamic;G.optional(function(){var Dn=[Lo,Ro,Do,ko,Xs,Vl,Ml,Tc,go,Gu].concat(Gr);function ai(Pi){Object.keys(Pi).forEach(function(ea){G.command(Dn.indexOf(ea)>=0,'unknown parameter "'+ea+'"',jt.commandStr)})}ai(mt),ai(ht)});var It=wi(Oe,xe),De=Ln(Oe,jt),st=Vi(Oe,De,jt),Ae=ca(Oe,jt),kt=zo(Oe,jt),Gt=Gi(Oe,jt,It);function Ar(Dn){var ai=st[Dn];ai&&(kt[Dn]=ai)}Ar(ps),Ar(Xr(Zl));var or=Object.keys(kt).length>0,xr={framebuffer:De,draw:Ae,shader:Gt,state:kt,dirty:or,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(xr.profile=ni(Oe,jt),xr.uniforms=zs(ft,jt),xr.drawVAO=xr.scopeVAO=No(Oe,jt),!xr.drawVAO&&Gt.program&&!It&&Ue.angle_instanced_arrays){var Yr=!0,Bn=Gt.program.attributes.map(function(Dn){var ai=xe.static[Dn];return Yr=Yr&&!!ai,ai});if(Yr&&Bn.length>0){var Ni=Wr.getVAO(Wr.createVAO(Bn));xr.drawVAO=new _u(null,null,null,function(Dn,ai){return Dn.link(Ni)}),xr.useVAO=!0}}return It?xr.useVAO=!0:xr.attributes=Hi(xe,jt),xr.context=Ja(zt,jt),xr}function ts(Oe,xe,ft){var zt=Oe.shared,jt=zt.context,mt=Oe.scope();Object.keys(ft).forEach(function(ht){xe.save(jt,"."+ht);var It=ft[ht],De=It.append(Oe,xe);Array.isArray(De)?mt(jt,".",ht,"=[",De.join(),"];"):mt(jt,".",ht,"=",De,";")}),xe(mt)}function Es(Oe,xe,ft,zt){var jt=Oe.shared,mt=jt.gl,ht=jt.framebuffer,It;yn&&(It=xe.def(jt.extensions,".webgl_draw_buffers"));var De=Oe.constants,st=De.drawBuffer,Ae=De.backBuffer,kt;ft?kt=ft.append(Oe,xe):kt=xe.def(ht,".next"),zt||xe("if(",kt,"!==",ht,".cur){"),xe("if(",kt,"){",mt,".bindFramebuffer(",Ah,",",kt,".framebuffer);"),yn&&xe(It,".drawBuffersWEBGL(",st,"[",kt,".colorAttachments.length]);"),xe("}else{",mt,".bindFramebuffer(",Ah,",null);"),yn&&xe(It,".drawBuffersWEBGL(",Ae,");"),xe("}",ht,".cur=",kt,";"),zt||xe("}")}function Ns(Oe,xe,ft){var zt=Oe.shared,jt=zt.gl,mt=Oe.current,ht=Oe.next,It=zt.current,De=zt.next,st=Oe.cond(It,".dirty");Gr.forEach(function(Ae){var kt=Xr(Ae);if(!(kt in ft.state)){var Gt,Ar;if(kt in ht){Gt=ht[kt],Ar=mt[kt];var or=I(br[kt].length,function(Yr){return st.def(Gt,"[",Yr,"]")});st(Oe.cond(or.map(function(Yr,Bn){return Yr+"!=="+Ar+"["+Bn+"]"}).join("||")).then(jt,".",Fr[kt],"(",or,");",or.map(function(Yr,Bn){return Ar+"["+Bn+"]="+Yr}).join(";"),";"))}else{Gt=st.def(De,".",kt);var xr=Oe.cond(Gt,"!==",It,".",kt);st(xr),kt in Br?xr(Oe.cond(Gt).then(jt,".enable(",Br[kt],");").else(jt,".disable(",Br[kt],");"),It,".",kt,"=",Gt,";"):xr(jt,".",Fr[kt],"(",Gt,");",It,".",kt,"=",Gt,";")}}}),Object.keys(ft.state).length===0&&st(It,".dirty=false;"),xe(st)}function $s(Oe,xe,ft,zt){var jt=Oe.shared,mt=Oe.current,ht=jt.current,It=jt.gl;Ch(Object.keys(ft)).forEach(function(De){var st=ft[De];if(!(zt&&!zt(st))){var Ae=st.append(Oe,xe);if(Br[De]){var kt=Br[De];yl(st)?Ae?xe(It,".enable(",kt,");"):xe(It,".disable(",kt,");"):xe(Oe.cond(Ae).then(It,".enable(",kt,");").else(It,".disable(",kt,");")),xe(ht,".",De,"=",Ae,";")}else if(no(Ae)){var Gt=mt[De];xe(It,".",Fr[De],"(",Ae,");",Ae.map(function(Ar,or){return Gt+"["+or+"]="+Ar}).join(";"),";")}else xe(It,".",Fr[De],"(",Ae,");",ht,".",De,"=",Ae,";")}})}function Bo(Oe,xe){jr&&(Oe.instancing=xe.def(Oe.shared.extensions,".angle_instanced_arrays"))}function Ii(Oe,xe,ft,zt,jt){var mt=Oe.shared,ht=Oe.stats,It=mt.current,De=mt.timer,st=ft.profile;function Ae(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var kt,Gt;function Ar(Dn){kt=xe.def(),Dn(kt,"=",Ae(),";"),typeof jt=="string"?Dn(ht,".count+=",jt,";"):Dn(ht,".count++;"),cn&&(zt?(Gt=xe.def(),Dn(Gt,"=",De,".getNumPendingQueries();")):Dn(De,".beginQuery(",ht,");"))}function or(Dn){Dn(ht,".cpuTime+=",Ae(),"-",kt,";"),cn&&(zt?Dn(De,".pushScopeStats(",Gt,",",De,".getNumPendingQueries(),",ht,");"):Dn(De,".endQuery();"))}function xr(Dn){var ai=xe.def(It,".profile");xe(It,".profile=",Dn,";"),xe.exit(It,".profile=",ai,";")}var Yr;if(st){if(yl(st)){st.enable?(Ar(xe),or(xe.exit),xr("true")):xr("false");return}Yr=st.append(Oe,xe),xr(Yr)}else Yr=xe.def(It,".profile");var Bn=Oe.block();Ar(Bn),xe("if(",Yr,"){",Bn,"}");var Ni=Oe.block();or(Ni),xe.exit("if(",Yr,"){",Ni,"}")}function Js(Oe,xe,ft,zt,jt){var mt=Oe.shared;function ht(De){switch(De){case Wn:case Ji:case yo:return 2;case Cn:case Mi:case uo:return 3;case fi:case Ra:case Za:return 4;default:return 1}}function It(De,st,Ae){var kt=mt.gl,Gt=xe.def(De,".location"),Ar=xe.def(mt.attributes,"[",Gt,"]"),or=Ae.state,xr=Ae.buffer,Yr=[Ae.x,Ae.y,Ae.z,Ae.w],Bn=["buffer","normalized","offset","stride"];function Ni(){xe("if(!",Ar,".buffer){",kt,".enableVertexAttribArray(",Gt,");}");var ai=Ae.type,Pi;if(Ae.size?Pi=xe.def(Ae.size,"||",st):Pi=st,xe("if(",Ar,".type!==",ai,"||",Ar,".size!==",Pi,"||",Bn.map(function(Vo){return Ar+"."+Vo+"!=="+Ae[Vo]}).join("||"),"){",kt,".bindBuffer(",uc,",",xr,".buffer);",kt,".vertexAttribPointer(",[Gt,Pi,ai,Ae.normalized,Ae.stride,Ae.offset],");",Ar,".type=",ai,";",Ar,".size=",Pi,";",Bn.map(function(Vo){return Ar+"."+Vo+"="+Ae[Vo]+";"}).join(""),"}"),jr){var ea=Ae.divisor;xe("if(",Ar,".divisor!==",ea,"){",Oe.instancing,".vertexAttribDivisorANGLE(",[Gt,ea],");",Ar,".divisor=",ea,";}")}}function Dn(){xe("if(",Ar,".buffer){",kt,".disableVertexAttribArray(",Gt,");",Ar,".buffer=null;","}if(",Vr.map(function(ai,Pi){return Ar+"."+ai+"!=="+Yr[Pi]}).join("||"),"){",kt,".vertexAttrib4f(",Gt,",",Yr,");",Vr.map(function(ai,Pi){return Ar+"."+ai+"="+Yr[Pi]+";"}).join(""),"}")}or===Sn?Ni():or===Hn?Dn():(xe("if(",or,"===",Sn,"){"),Ni(),xe("}else{"),Dn(),xe("}"))}zt.forEach(function(De){var st=De.name,Ae=ft.attributes[st],kt;if(Ae){if(!jt(Ae))return;kt=Ae.append(Oe,xe)}else{if(!jt(Ph))return;var Gt=Oe.scopeAttrib(st);G.optional(function(){Oe.assert(xe,Gt+".state","missing attribute "+st)}),kt={},Object.keys(new ir).forEach(function(Ar){kt[Ar]=xe.def(Gt,".",Ar)})}It(Oe.link(De),ht(De.info.type),kt)})}function da(Oe,xe,ft,zt,jt){for(var mt=Oe.shared,ht=mt.gl,It,De=0;De<zt.length;++De){var st=zt[De],Ae=st.name,kt=st.info.type,Gt=ft.uniforms[Ae],Ar=Oe.link(st),or=Ar+".location",xr;if(Gt){if(!jt(Gt))continue;if(yl(Gt)){var Yr=Gt.value;if(G.command(Yr!==null&&typeof Yr!="undefined",'missing uniform "'+Ae+'"',Oe.commandStr),kt===To||kt===co){G.command(typeof Yr=="function"&&(kt===To&&(Yr._reglType==="texture2d"||Yr._reglType==="framebuffer")||kt===co&&(Yr._reglType==="textureCube"||Yr._reglType==="framebufferCube")),"invalid texture for uniform "+Ae,Oe.commandStr);var Bn=Oe.link(Yr._texture||Yr.color[0]._texture);xe(ht,".uniform1i(",or,",",Bn+".bind());"),xe.exit(Bn,".unbind();")}else if(kt===ra||kt===Da||kt===lo){G.optional(function(){G.command(no(Yr),"invalid matrix for uniform "+Ae,Oe.commandStr),G.command(kt===ra&&Yr.length===4||kt===Da&&Yr.length===9||kt===lo&&Yr.length===16,"invalid length for matrix uniform "+Ae,Oe.commandStr)});var Ni=Oe.global.def("new Float32Array(["+Array.prototype.slice.call(Yr)+"])"),Dn=2;kt===Da?Dn=3:kt===lo&&(Dn=4),xe(ht,".uniformMatrix",Dn,"fv(",or,",false,",Ni,");")}else{switch(kt){case In:G.commandType(Yr,"number","uniform "+Ae,Oe.commandStr),It="1f";break;case Wn:G.command(no(Yr)&&Yr.length===2,"uniform "+Ae,Oe.commandStr),It="2f";break;case Cn:G.command(no(Yr)&&Yr.length===3,"uniform "+Ae,Oe.commandStr),It="3f";break;case fi:G.command(no(Yr)&&Yr.length===4,"uniform "+Ae,Oe.commandStr),It="4f";break;case wo:G.commandType(Yr,"boolean","uniform "+Ae,Oe.commandStr),It="1i";break;case gi:G.commandType(Yr,"number","uniform "+Ae,Oe.commandStr),It="1i";break;case yo:G.command(no(Yr)&&Yr.length===2,"uniform "+Ae,Oe.commandStr),It="2i";break;case Ji:G.command(no(Yr)&&Yr.length===2,"uniform "+Ae,Oe.commandStr),It="2i";break;case uo:G.command(no(Yr)&&Yr.length===3,"uniform "+Ae,Oe.commandStr),It="3i";break;case Mi:G.command(no(Yr)&&Yr.length===3,"uniform "+Ae,Oe.commandStr),It="3i";break;case Za:G.command(no(Yr)&&Yr.length===4,"uniform "+Ae,Oe.commandStr),It="4i";break;case Ra:G.command(no(Yr)&&Yr.length===4,"uniform "+Ae,Oe.commandStr),It="4i";break}xe(ht,".uniform",It,"(",or,",",no(Yr)?Array.prototype.slice.call(Yr):Yr,");")}continue}else xr=Gt.append(Oe,xe)}else{if(!jt(Ph))continue;xr=xe.def(mt.uniforms,"[",he.id(Ae),"]")}kt===To?(G(!Array.isArray(xr),"must specify a scalar prop for textures"),xe("if(",xr,"&&",xr,'._reglType==="framebuffer"){',xr,"=",xr,".color[0];","}")):kt===co&&(G(!Array.isArray(xr),"must specify a scalar prop for cube maps"),xe("if(",xr,"&&",xr,'._reglType==="framebufferCube"){',xr,"=",xr,".color[0];","}")),G.optional(function(){function ku(xl,Uf){Oe.assert(xe,xl,'bad data or missing for uniform "'+Ae+'".  '+Uf)}function uh(xl){G(!Array.isArray(xr),"must not specify an array type for uniform"),ku("typeof "+xr+'==="'+xl+'"',"invalid type, expected "+xl)}function _l(xl,Uf){Array.isArray(xr)?G(xr.length===xl,"must have length "+xl):ku(mt.isArrayLike+"("+xr+")&&"+xr+".length==="+xl,"invalid vector, should have length "+xl,Oe.commandStr)}function lh(xl){G(!Array.isArray(xr),"must not specify a value type"),ku("typeof "+xr+'==="function"&&'+xr+'._reglType==="texture'+(xl===B?"2d":"Cube")+'"',"invalid texture type",Oe.commandStr)}switch(kt){case gi:uh("number");break;case Ji:_l(2,"number");break;case Mi:_l(3,"number");break;case Ra:_l(4,"number");break;case In:uh("number");break;case Wn:_l(2,"number");break;case Cn:_l(3,"number");break;case fi:_l(4,"number");break;case wo:uh("boolean");break;case yo:_l(2,"boolean");break;case uo:_l(3,"boolean");break;case Za:_l(4,"boolean");break;case ra:_l(4,"number");break;case Da:_l(9,"number");break;case lo:_l(16,"number");break;case To:lh(B);break;case co:lh(U);break}});var ai=1;switch(kt){case To:case co:var Pi=xe.def(xr,"._texture");xe(ht,".uniform1i(",or,",",Pi,".bind());"),xe.exit(Pi,".unbind();");continue;case gi:case wo:It="1i";break;case Ji:case yo:It="2i",ai=2;break;case Mi:case uo:It="3i",ai=3;break;case Ra:case Za:It="4i",ai=4;break;case In:It="1f";break;case Wn:It="2f",ai=2;break;case Cn:It="3f",ai=3;break;case fi:It="4f",ai=4;break;case ra:It="Matrix2fv";break;case Da:It="Matrix3fv";break;case lo:It="Matrix4fv";break}if(xe(ht,".uniform",It,"(",or,","),It.charAt(0)==="M"){var ea=Math.pow(kt-ra+2,2),Vo=Oe.global.def("new Float32Array(",ea,")");Array.isArray(xr)?xe("false,(",I(ea,function(ku){return Vo+"["+ku+"]="+xr[ku]}),",",Vo,")"):xe("false,(Array.isArray(",xr,")||",xr," instanceof Float32Array)?",xr,":(",I(ea,function(ku){return Vo+"["+ku+"]="+xr+"["+ku+"]"}),",",Vo,")")}else ai>1?xe(I(ai,function(ku){return Array.isArray(xr)?xr[ku]:xr+"["+ku+"]"})):(G(!Array.isArray(xr),"uniform value must not be an array"),xe(xr));xe(");")}}function ii(Oe,xe,ft,zt){var jt=Oe.shared,mt=jt.gl,ht=jt.draw,It=zt.draw;function De(){var Pi=It.elements,ea,Vo=xe;return Pi?((Pi.contextDep&&zt.contextDynamic||Pi.propDep)&&(Vo=ft),ea=Pi.append(Oe,Vo)):ea=Vo.def(ht,".",ko),ea&&Vo("if("+ea+")"+mt+".bindBuffer("+ah+","+ea+".buffer.buffer);"),ea}function st(){var Pi=It.count,ea,Vo=xe;return Pi?((Pi.contextDep&&zt.contextDynamic||Pi.propDep)&&(Vo=ft),ea=Pi.append(Oe,Vo),G.optional(function(){Pi.MISSING&&Oe.assert(xe,"false","missing vertex count"),Pi.DYNAMIC&&Oe.assert(Vo,ea+">=0","missing vertex count")})):(ea=Vo.def(ht,".",Ml),G.optional(function(){Oe.assert(Vo,ea+">=0","missing vertex count")})),ea}var Ae=De();function kt(Pi){var ea=It[Pi];return ea?ea.contextDep&&zt.contextDynamic||ea.propDep?ea.append(Oe,ft):ea.append(Oe,xe):xe.def(ht,".",Pi)}var Gt=kt(Xs),Ar=kt(Vl),or=st();if(typeof or=="number"){if(or===0)return}else ft("if(",or,"){"),ft.exit("}");var xr,Yr;jr&&(xr=kt(Tc),Yr=Oe.instancing);var Bn=Ae+".type",Ni=It.elements&&yl(It.elements);function Dn(){function Pi(){ft(Yr,".drawElementsInstancedANGLE(",[Gt,or,Bn,Ar+"<<(("+Bn+"-"+mn+")>>1)",xr],");")}function ea(){ft(Yr,".drawArraysInstancedANGLE(",[Gt,Ar,or,xr],");")}Ae?Ni?Pi():(ft("if(",Ae,"){"),Pi(),ft("}else{"),ea(),ft("}")):ea()}function ai(){function Pi(){ft(mt+".drawElements("+[Gt,or,Bn,Ar+"<<(("+Bn+"-"+mn+")>>1)"]+");")}function ea(){ft(mt+".drawArrays("+[Gt,Ar,or]+");")}Ae?Ni?Pi():(ft("if(",Ae,"){"),Pi(),ft("}else{"),ea(),ft("}")):ea()}jr&&(typeof xr!="number"||xr>=0)?typeof xr=="string"?(ft("if(",xr,">0){"),Dn(),ft("}else if(",xr,"<0){"),ai(),ft("}")):Dn():ai()}function Oi(Oe,xe,ft,zt,jt){var mt=ri(),ht=mt.proc("body",jt);return G.optional(function(){mt.commandStr=xe.commandStr,mt.command=mt.link(xe.commandStr)}),jr&&(mt.instancing=ht.def(mt.shared.extensions,".angle_instanced_arrays")),Oe(mt,ht,ft,zt),mt.compile().body}function qi(Oe,xe,ft,zt){Bo(Oe,xe),ft.useVAO?ft.drawVAO?xe(Oe.shared.vao,".setVAO(",ft.drawVAO.append(Oe,xe),");"):xe(Oe.shared.vao,".setVAO(",Oe.shared.vao,".targetVAO);"):(xe(Oe.shared.vao,".setVAO(null);"),Js(Oe,xe,ft,zt.attributes,function(){return!0})),da(Oe,xe,ft,zt.uniforms,function(){return!0}),ii(Oe,xe,xe,ft)}function ws(Oe,xe){var ft=Oe.proc("draw",1);Bo(Oe,ft),ts(Oe,ft,xe.context),Es(Oe,ft,xe.framebuffer),Ns(Oe,ft,xe),$s(Oe,ft,xe.state),Ii(Oe,ft,xe,!1,!0);var zt=xe.shader.progVar.append(Oe,ft);if(ft(Oe.shared.gl,".useProgram(",zt,".program);"),xe.shader.program)qi(Oe,ft,xe,xe.shader.program);else{ft(Oe.shared.vao,".setVAO(null);");var jt=Oe.global.def("{}"),mt=ft.def(zt,".id"),ht=ft.def(jt,"[",mt,"]");ft(Oe.cond(ht).then(ht,".call(this,a0);").else(ht,"=",jt,"[",mt,"]=",Oe.link(function(It){return Oi(qi,Oe,xe,It,1)}),"(",zt,");",ht,".call(this,a0);"))}Object.keys(xe.state).length>0&&ft(Oe.shared.current,".dirty=true;")}function Qs(Oe,xe,ft,zt){Oe.batchId="a1",Bo(Oe,xe);function jt(){return!0}Js(Oe,xe,ft,zt.attributes,jt),da(Oe,xe,ft,zt.uniforms,jt),ii(Oe,xe,xe,ft)}function Gl(Oe,xe,ft,zt){Bo(Oe,xe);var jt=ft.contextDep,mt=xe.def(),ht="a0",It="a1",De=xe.def();Oe.shared.props=De,Oe.batchId=mt;var st=Oe.scope(),Ae=Oe.scope();xe(st.entry,"for(",mt,"=0;",mt,"<",It,";++",mt,"){",De,"=",ht,"[",mt,"];",Ae,"}",st.exit);function kt(Bn){return Bn.contextDep&&jt||Bn.propDep}function Gt(Bn){return!kt(Bn)}if(ft.needsContext&&ts(Oe,Ae,ft.context),ft.needsFramebuffer&&Es(Oe,Ae,ft.framebuffer),$s(Oe,Ae,ft.state,kt),ft.profile&&kt(ft.profile)&&Ii(Oe,Ae,ft,!1,!0),zt)ft.useVAO?ft.drawVAO?kt(ft.drawVAO)?Ae(Oe.shared.vao,".setVAO(",ft.drawVAO.append(Oe,Ae),");"):st(Oe.shared.vao,".setVAO(",ft.drawVAO.append(Oe,st),");"):st(Oe.shared.vao,".setVAO(",Oe.shared.vao,".targetVAO);"):(st(Oe.shared.vao,".setVAO(null);"),Js(Oe,st,ft,zt.attributes,Gt),Js(Oe,Ae,ft,zt.attributes,kt)),da(Oe,st,ft,zt.uniforms,Gt),da(Oe,Ae,ft,zt.uniforms,kt),ii(Oe,st,Ae,ft);else{var Ar=Oe.global.def("{}"),or=ft.shader.progVar.append(Oe,Ae),xr=Ae.def(or,".id"),Yr=Ae.def(Ar,"[",xr,"]");Ae(Oe.shared.gl,".useProgram(",or,".program);","if(!",Yr,"){",Yr,"=",Ar,"[",xr,"]=",Oe.link(function(Bn){return Oi(Qs,Oe,ft,Bn,2)}),"(",or,");}",Yr,".call(this,a0[",mt,"],",mt,");")}}function Ve(Oe,xe){var ft=Oe.proc("batch",2);Oe.batchId="0",Bo(Oe,ft);var zt=!1,jt=!0;Object.keys(xe.context).forEach(function(Ar){zt=zt||xe.context[Ar].propDep}),zt||(ts(Oe,ft,xe.context),jt=!1);var mt=xe.framebuffer,ht=!1;mt?(mt.propDep?zt=ht=!0:mt.contextDep&&zt&&(ht=!0),ht||Es(Oe,ft,mt)):Es(Oe,ft,null),xe.state.viewport&&xe.state.viewport.propDep&&(zt=!0);function It(Ar){return Ar.contextDep&&zt||Ar.propDep}Ns(Oe,ft,xe),$s(Oe,ft,xe.state,function(Ar){return!It(Ar)}),(!xe.profile||!It(xe.profile))&&Ii(Oe,ft,xe,!1,"a1"),xe.contextDep=zt,xe.needsContext=jt,xe.needsFramebuffer=ht;var De=xe.shader.progVar;if(De.contextDep&&zt||De.propDep)Gl(Oe,ft,xe,null);else{var st=De.append(Oe,ft);if(ft(Oe.shared.gl,".useProgram(",st,".program);"),xe.shader.program)Gl(Oe,ft,xe,xe.shader.program);else{ft(Oe.shared.vao,".setVAO(null);");var Ae=Oe.global.def("{}"),kt=ft.def(st,".id"),Gt=ft.def(Ae,"[",kt,"]");ft(Oe.cond(Gt).then(Gt,".call(this,a0,a1);").else(Gt,"=",Ae,"[",kt,"]=",Oe.link(function(Ar){return Oi(Gl,Oe,xe,Ar,2)}),"(",st,");",Gt,".call(this,a0,a1);"))}}Object.keys(xe.state).length>0&&ft(Oe.shared.current,".dirty=true;")}function ur(Oe,xe){var ft=Oe.proc("scope",3);Oe.batchId="a2";var zt=Oe.shared,jt=zt.current;ts(Oe,ft,xe.context),xe.framebuffer&&xe.framebuffer.append(Oe,ft),Ch(Object.keys(xe.state)).forEach(function(ht){var It=xe.state[ht],De=It.append(Oe,ft);no(De)?De.forEach(function(st,Ae){ft.set(Oe.next[ht],"["+Ae+"]",st)}):ft.set(zt.next,"."+ht,De)}),Ii(Oe,ft,xe,!0,!0),[ko,Vl,Ml,Tc,Xs].forEach(function(ht){var It=xe.draw[ht];!It||ft.set(zt.draw,"."+ht,""+It.append(Oe,ft))}),Object.keys(xe.uniforms).forEach(function(ht){var It=xe.uniforms[ht].append(Oe,ft);Array.isArray(It)&&(It="["+It.join()+"]"),ft.set(zt.uniforms,"["+he.id(ht)+"]",It)}),Object.keys(xe.attributes).forEach(function(ht){var It=xe.attributes[ht].append(Oe,ft),De=Oe.scopeAttrib(ht);Object.keys(new ir).forEach(function(st){ft.set(De,"."+st,It[st])})}),xe.scopeVAO&&ft.set(zt.vao,".targetVAO",xe.scopeVAO.append(Oe,ft));function mt(ht){var It=xe.shader[ht];It&&ft.set(zt.shader,"."+ht,It.append(Oe,ft))}mt(Ro),mt(Do),Object.keys(xe.state).length>0&&(ft(jt,".dirty=true;"),ft.exit(jt,".dirty=true;")),ft("a1(",Oe.shared.context,",a0,",Oe.batchId,");")}function $t(Oe){if(!(typeof Oe!="object"||no(Oe))){for(var xe=Object.keys(Oe),ft=0;ft<xe.length;++ft)if(gt.isDynamic(Oe[xe[ft]]))return!0;return!1}}function wn(Oe,xe,ft){var zt=xe.static[ft];if(!zt||!$t(zt))return;var jt=Oe.global,mt=Object.keys(zt),ht=!1,It=!1,De=!1,st=Oe.global.def("{}");mt.forEach(function(kt){var Gt=zt[kt];if(gt.isDynamic(Gt)){typeof Gt=="function"&&(Gt=zt[kt]=gt.unbox(Gt));var Ar=Fs(Gt,null);ht=ht||Ar.thisDep,De=De||Ar.propDep,It=It||Ar.contextDep}else{switch(jt(st,".",kt,"="),typeof Gt){case"number":jt(Gt);break;case"string":jt('"',Gt,'"');break;case"object":Array.isArray(Gt)&&jt("[",Gt.join(),"]");break;default:jt(Oe.link(Gt));break}jt(";")}});function Ae(kt,Gt){mt.forEach(function(Ar){var or=zt[Ar];if(!!gt.isDynamic(or)){var xr=kt.invoke(Gt,or);Gt(st,".",Ar,"=",xr,";")}})}xe.dynamic[ft]=new gt.DynamicVariable(pi,{thisDep:ht,contextDep:It,propDep:De,ref:st,append:Ae}),delete xe.static[ft]}function zi(Oe,xe,ft,zt,jt){var mt=ri();mt.stats=mt.link(jt),Object.keys(xe.static).forEach(function(It){wn(mt,xe,It)}),Kh.forEach(function(It){wn(mt,Oe,It)});var ht=es(Oe,xe,ft,zt,mt);return ws(mt,ht),ur(mt,ht),Ve(mt,ht),_(mt.compile(),{destroy:function(){ht.shader.program.destroy()}})}return{next:Yn,current:br,procs:function(){var Oe=ri(),xe=Oe.proc("poll"),ft=Oe.proc("refresh"),zt=Oe.block();xe(zt),ft(zt);var jt=Oe.shared,mt=jt.gl,ht=jt.next,It=jt.current;zt(It,".dirty=false;"),Es(Oe,xe),Es(Oe,ft,null,!0);var De;jr&&(De=Oe.link(jr)),Ue.oes_vertex_array_object&&ft(Oe.link(Ue.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var st=0;st<Vt.maxAttributes;++st){var Ae=ft.def(jt.attributes,"[",st,"]"),kt=Oe.cond(Ae,".buffer");kt.then(mt,".enableVertexAttribArray(",st,");",mt,".bindBuffer(",uc,",",Ae,".buffer.buffer);",mt,".vertexAttribPointer(",st,",",Ae,".size,",Ae,".type,",Ae,".normalized,",Ae,".stride,",Ae,".offset);").else(mt,".disableVertexAttribArray(",st,");",mt,".vertexAttrib4f(",st,",",Ae,".x,",Ae,".y,",Ae,".z,",Ae,".w);",Ae,".buffer=null;"),ft(kt),jr&&ft(De,".vertexAttribDivisorANGLE(",st,",",Ae,".divisor);")}return ft(Oe.shared.vao,".currentVAO=null;",Oe.shared.vao,".setVAO(",Oe.shared.vao,".targetVAO);"),Object.keys(Br).forEach(function(Gt){var Ar=Br[Gt],or=zt.def(ht,".",Gt),xr=Oe.block();xr("if(",or,"){",mt,".enable(",Ar,")}else{",mt,".disable(",Ar,")}",It,".",Gt,"=",or,";"),ft(xr),xe("if(",or,"!==",It,".",Gt,"){",xr,"}")}),Object.keys(Fr).forEach(function(Gt){var Ar=Fr[Gt],or=br[Gt],xr,Yr,Bn=Oe.block();if(Bn(mt,".",Ar,"("),no(or)){var Ni=or.length;xr=Oe.global.def(ht,".",Gt),Yr=Oe.global.def(It,".",Gt),Bn(I(Ni,function(Dn){return xr+"["+Dn+"]"}),");",I(Ni,function(Dn){return Yr+"["+Dn+"]="+xr+"["+Dn+"];"}).join("")),xe("if(",I(Ni,function(Dn){return xr+"["+Dn+"]!=="+Yr+"["+Dn+"]"}).join("||"),"){",Bn,"}")}else xr=zt.def(ht,".",Gt),Yr=zt.def(It,".",Gt),Bn(xr,");",It,".",Gt,"=",xr,";"),xe("if(",xr,"!==",Yr,"){",Bn,"}");ft(Bn)}),Oe.compile()}(),compile:zi}}function ep(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Mh=34918,Ks=34919,tp=35007,rp=function(he,Ue){if(!Ue.ext_disjoint_timer_query)return null;var Vt=[];function yr(){return Vt.pop()||Ue.ext_disjoint_timer_query.createQueryEXT()}function pr(yn){Vt.push(yn)}var rr=[];function kr(yn){var br=yr();Ue.ext_disjoint_timer_query.beginQueryEXT(tp,br),rr.push(br),en(rr.length-1,rr.length,yn)}function rn(){Ue.ext_disjoint_timer_query.endQueryEXT(tp)}function Wr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var $r=[];function on(){return $r.pop()||new Wr}function gn(yn){$r.push(yn)}var cn=[];function en(yn,br,Yn){var Gr=on();Gr.startQueryIndex=yn,Gr.endQueryIndex=br,Gr.sum=0,Gr.stats=Yn,cn.push(Gr)}var ir=[],Jt=[];function jr(){var yn,br,Yn=rr.length;if(Yn!==0){Jt.length=Math.max(Jt.length,Yn+1),ir.length=Math.max(ir.length,Yn+1),ir[0]=0,Jt[0]=0;var Gr=0;for(yn=0,br=0;br<rr.length;++br){var Br=rr[br];Ue.ext_disjoint_timer_query.getQueryObjectEXT(Br,Ks)?(Gr+=Ue.ext_disjoint_timer_query.getQueryObjectEXT(Br,Mh),pr(Br)):rr[yn++]=Br,ir[br+1]=Gr,Jt[br+1]=yn}for(rr.length=yn,yn=0,br=0;br<cn.length;++br){var Fr=cn[br],Xr=Fr.startQueryIndex,jn=Fr.endQueryIndex;Fr.sum+=ir[jn]-ir[Xr];var qn=Jt[Xr],ln=Jt[jn];ln===qn?(Fr.stats.gpuTime+=Fr.sum/1e6,gn(Fr)):(Fr.startQueryIndex=qn,Fr.endQueryIndex=ln,cn[yn++]=Fr)}cn.length=yn}}return{beginQuery:kr,endQuery:rn,pushScopeStats:en,update:jr,getNumPendingQueries:function(){return rr.length},clear:function(){Vt.push.apply(Vt,rr);for(var br=0;br<Vt.length;br++)Ue.ext_disjoint_timer_query.deleteQueryEXT(Vt[br]);rr.length=0,Vt.length=0},restore:function(){rr.length=0,Vt.length=0}}},Ih=16384,np=256,Oh=1024,Bf=34962,ip="webglcontextlost",hf="webglcontextrestored",oh=1,Lh=2,Rh=3;function fc(J,he){for(var Ue=0;Ue<J.length;++Ue)if(J[Ue]===he)return Ue;return-1}function sh(J){var he=oi(J);if(!he)return null;var Ue=he.gl,Vt=Ue.getContextAttributes(),yr=Ue.isContextLost(),pr=K(Ue,he);if(!pr)return null;var rr=ar(),kr=ep(),rn=pr.extensions,Wr=rp(Ue,rn),$r=sr(),on=Ue.drawingBufferWidth,gn=Ue.drawingBufferHeight,cn={tick:0,time:0,viewportWidth:on,viewportHeight:gn,framebufferWidth:on,framebufferHeight:gn,drawingBufferWidth:on,drawingBufferHeight:gn,pixelRatio:he.pixelRatio},en={},ir={elements:null,primitive:4,count:-1,offset:0,instances:-1},Jt=Pa(Ue,rn),jr=oa(Ue,kr,he,br),yn=ge(Ue,rn,Jt,kr,jr);function br(ii){return yn.destroyBuffer(ii)}var Yn=zu(Ue,rn,jr,kr),Gr=We(Ue,rr,kr,he),Br=Ws(Ue,rn,Jt,function(){jn.procs.poll()},cn,kr,he),Fr=Zu(Ue,rn,Jt,kr,he),Xr=L(Ue,rn,Jt,Br,Fr,kr),jn=qh(Ue,rr,rn,Jt,jr,Yn,Br,Xr,en,yn,Gr,ir,cn,Wr,he),qn=nr(Ue,Xr,jn.procs.poll,cn,Vt,rn,Jt),ln=jn.next,Nr=Ue.canvas,Rr=[],ri=[],ni=[],Ln=[he.onDestroy],Vi=null;function wi(){if(Rr.length===0){Wr&&Wr.update(),Vi=null;return}Vi=Rt.next(wi),$s();for(var ii=Rr.length-1;ii>=0;--ii){var Oi=Rr[ii];Oi&&Oi(cn,null,0)}Ue.flush(),Wr&&Wr.update()}function Gi(){!Vi&&Rr.length>0&&(Vi=Rt.next(wi))}function ca(){Vi&&(Rt.cancel(wi),Vi=null)}function zo(ii){ii.preventDefault(),yr=!0,ca(),ri.forEach(function(Oi){Oi()})}function zs(ii){Ue.getError(),yr=!1,pr.restore(),Gr.restore(),jr.restore(),Br.restore(),Fr.restore(),Xr.restore(),yn.restore(),Wr&&Wr.restore(),jn.procs.refresh(),Gi(),ni.forEach(function(Oi){Oi()})}Nr&&(Nr.addEventListener(ip,zo,!1),Nr.addEventListener(hf,zs,!1));function Hi(){Rr.length=0,ca(),Nr&&(Nr.removeEventListener(ip,zo),Nr.removeEventListener(hf,zs)),Gr.clear(),Xr.clear(),Fr.clear(),Br.clear(),Yn.clear(),jr.clear(),yn.clear(),Wr&&Wr.clear(),Ln.forEach(function(ii){ii()})}function No(ii){G(!!ii,"invalid args to regl({...})"),G.type(ii,"object","invalid args to regl({...})");function Oi(jt){var mt=_({},jt);delete mt.uniforms,delete mt.attributes,delete mt.context,delete mt.vao,"stencil"in mt&&mt.stencil.op&&(mt.stencil.opBack=mt.stencil.opFront=mt.stencil.op,delete mt.stencil.op);function ht(It){if(It in mt){var De=mt[It];delete mt[It],Object.keys(De).forEach(function(st){mt[It+"."+st]=De[st]})}}return ht("blend"),ht("depth"),ht("cull"),ht("stencil"),ht("polygonOffset"),ht("scissor"),ht("sample"),"vao"in jt&&(mt.vao=jt.vao),mt}function qi(jt,mt){var ht={},It={};return Object.keys(jt).forEach(function(De){var st=jt[De];if(gt.isDynamic(st)){It[De]=gt.unbox(st,De);return}else if(mt&&Array.isArray(st)){for(var Ae=0;Ae<st.length;++Ae)if(gt.isDynamic(st[Ae])){It[De]=gt.unbox(st,De);return}}ht[De]=st}),{dynamic:It,static:ht}}var ws=qi(ii.context||{},!0),Qs=qi(ii.uniforms||{},!0),Gl=qi(ii.attributes||{},!1),Ve=qi(Oi(ii),!1),ur={gpuTime:0,cpuTime:0,count:0},$t=jn.compile(Ve,Gl,Qs,ws,ur),wn=$t.draw,zi=$t.batch,Oe=$t.scope,xe=[];function ft(jt){for(;xe.length<jt;)xe.push(null);return xe}function zt(jt,mt){var ht;if(yr&&G.raise("context lost"),typeof jt=="function")return Oe.call(this,null,jt,0);if(typeof mt=="function")if(typeof jt=="number")for(ht=0;ht<jt;++ht)Oe.call(this,null,mt,ht);else if(Array.isArray(jt))for(ht=0;ht<jt.length;++ht)Oe.call(this,jt[ht],mt,ht);else return Oe.call(this,jt,mt,0);else if(typeof jt=="number"){if(jt>0)return zi.call(this,ft(jt|0),jt|0)}else if(Array.isArray(jt)){if(jt.length)return zi.call(this,jt,jt.length)}else return wn.call(this,jt)}return _(zt,{stats:ur,destroy:function(){$t.destroy()}})}var Ja=Xr.setFBO=No({framebuffer:gt.define.call(null,oh,"framebuffer")});function es(ii,Oi){var qi=0;jn.procs.poll();var ws=Oi.color;ws&&(Ue.clearColor(+ws[0]||0,+ws[1]||0,+ws[2]||0,+ws[3]||0),qi|=Ih),"depth"in Oi&&(Ue.clearDepth(+Oi.depth),qi|=np),"stencil"in Oi&&(Ue.clearStencil(Oi.stencil|0),qi|=Oh),G(!!qi,"called regl.clear with no buffer specified"),Ue.clear(qi)}function ts(ii){if(G(typeof ii=="object"&&ii,"regl.clear() takes an object as input"),"framebuffer"in ii)if(ii.framebuffer&&ii.framebuffer_reglType==="framebufferCube")for(var Oi=0;Oi<6;++Oi)Ja(_({framebuffer:ii.framebuffer.faces[Oi]},ii),es);else Ja(ii,es);else es(null,ii)}function Es(ii){G.type(ii,"function","regl.frame() callback must be a function"),Rr.push(ii);function Oi(){var qi=fc(Rr,ii);G(qi>=0,"cannot cancel a frame twice");function ws(){var Qs=fc(Rr,ws);Rr[Qs]=Rr[Rr.length-1],Rr.length-=1,Rr.length<=0&&ca()}Rr[qi]=ws}return Gi(),{cancel:Oi}}function Ns(){var ii=ln.viewport,Oi=ln.scissor_box;ii[0]=ii[1]=Oi[0]=Oi[1]=0,cn.viewportWidth=cn.framebufferWidth=cn.drawingBufferWidth=ii[2]=Oi[2]=Ue.drawingBufferWidth,cn.viewportHeight=cn.framebufferHeight=cn.drawingBufferHeight=ii[3]=Oi[3]=Ue.drawingBufferHeight}function $s(){cn.tick+=1,cn.time=Ii(),Ns(),jn.procs.poll()}function Bo(){Br.refresh(),Ns(),jn.procs.refresh(),Wr&&Wr.update()}function Ii(){return(sr()-$r)/1e3}Bo();function Js(ii,Oi){G.type(Oi,"function","listener callback must be a function");var qi;switch(ii){case"frame":return Es(Oi);case"lost":qi=ri;break;case"restore":qi=ni;break;case"destroy":qi=Ln;break;default:G.raise("invalid event, must be one of frame,lost,restore,destroy")}return qi.push(Oi),{cancel:function(){for(var Qs=0;Qs<qi.length;++Qs)if(qi[Qs]===Oi){qi[Qs]=qi[qi.length-1],qi.pop();return}}}}var da=_(No,{clear:ts,prop:gt.define.bind(null,oh),context:gt.define.bind(null,Lh),this:gt.define.bind(null,Rh),draw:No({}),buffer:function(Oi){return jr.create(Oi,Bf,!1,!1)},elements:function(Oi){return Yn.create(Oi,!1)},texture:Br.create2D,cube:Br.createCube,renderbuffer:Fr.create,framebuffer:Xr.create,framebufferCube:Xr.createCube,vao:yn.createVAO,attributes:Vt,frame:Es,on:Js,limits:Jt,hasExtension:function(Oi){return Jt.extensions.indexOf(Oi.toLowerCase())>=0},read:qn,destroy:Hi,_gl:Ue,_refresh:Bo,poll:function(){$s(),Wr&&Wr.update()},now:Ii,stats:kr});return he.onDone(null,da),da}return sh})},12476:function(_t){(function(O,_){_t.exports=_()})(this,function(){"use strict";function O(St,Ge,vt,Pe,Te,ze){if(!(Te-Pe<=vt)){var bt=Pe+Te>>1;_(St,Ge,bt,Pe,Te,ze%2),O(St,Ge,vt,Pe,bt-1,ze+1),O(St,Ge,vt,bt+1,Te,ze+1)}}function _(St,Ge,vt,Pe,Te,ze){for(;Te>Pe;){if(Te-Pe>600){var bt=Te-Pe+1,cr=vt-Pe+1,ae=Math.log(bt),Ee=.5*Math.exp(2*ae/3),le=.5*Math.sqrt(ae*Ee*(bt-Ee)/bt)*(cr-bt/2<0?-1:1),re=Math.max(Pe,Math.floor(vt-cr*Ee/bt+le)),te=Math.min(Te,Math.floor(vt+(bt-cr)*Ee/bt+le));_(St,Ge,vt,re,te,ze)}var ke=Ge[2*vt+ze],nt=Pe,Kt=Te;for(X(St,Ge,Pe,vt),Ge[2*Te+ze]>ke&&X(St,Ge,Pe,Te);nt<Kt;){for(X(St,Ge,nt,Kt),nt++,Kt--;Ge[2*nt+ze]<ke;)nt++;for(;Ge[2*Kt+ze]>ke;)Kt--}Ge[2*Pe+ze]===ke?X(St,Ge,Pe,Kt):(Kt++,X(St,Ge,Kt,Te)),Kt<=vt&&(Pe=Kt+1),vt<=Kt&&(Te=Kt-1)}}function X(St,Ge,vt,Pe){b(St,vt,Pe),b(Ge,2*vt,2*Pe),b(Ge,2*vt+1,2*Pe+1)}function b(St,Ge,vt){var Pe=St[Ge];St[Ge]=St[vt],St[vt]=Pe}function p(St,Ge,vt,Pe,Te,ze,bt){for(var cr=[0,St.length-1,0],ae=[],Ee,le;cr.length;){var re=cr.pop(),te=cr.pop(),ke=cr.pop();if(te-ke<=bt){for(var nt=ke;nt<=te;nt++)Ee=Ge[2*nt],le=Ge[2*nt+1],Ee>=vt&&Ee<=Te&&le>=Pe&&le<=ze&&ae.push(St[nt]);continue}var Kt=Math.floor((ke+te)/2);Ee=Ge[2*Kt],le=Ge[2*Kt+1],Ee>=vt&&Ee<=Te&&le>=Pe&&le<=ze&&ae.push(St[Kt]);var Ir=(re+1)%2;(re===0?vt<=Ee:Pe<=le)&&(cr.push(ke),cr.push(Kt-1),cr.push(Ir)),(re===0?Te>=Ee:ze>=le)&&(cr.push(Kt+1),cr.push(te),cr.push(Ir))}return ae}function H(St,Ge,vt,Pe,Te,ze){for(var bt=[0,St.length-1,0],cr=[],ae=Te*Te;bt.length;){var Ee=bt.pop(),le=bt.pop(),re=bt.pop();if(le-re<=ze){for(var te=re;te<=le;te++)S(Ge[2*te],Ge[2*te+1],vt,Pe)<=ae&&cr.push(St[te]);continue}var ke=Math.floor((re+le)/2),nt=Ge[2*ke],Kt=Ge[2*ke+1];S(nt,Kt,vt,Pe)<=ae&&cr.push(St[ke]);var Ir=(Ee+1)%2;(Ee===0?vt-Te<=nt:Pe-Te<=Kt)&&(bt.push(re),bt.push(ke-1),bt.push(Ir)),(Ee===0?vt+Te>=nt:Pe+Te>=Kt)&&(bt.push(ke+1),bt.push(le),bt.push(Ir))}return cr}function S(St,Ge,vt,Pe){var Te=St-vt,ze=Ge-Pe;return Te*Te+ze*ze}var F=function(Ge){return Ge[0]},ie=function(Ge){return Ge[1]},fe=function(Ge,vt,Pe,Te,ze){vt===void 0&&(vt=F),Pe===void 0&&(Pe=ie),Te===void 0&&(Te=64),ze===void 0&&(ze=Float64Array),this.nodeSize=Te,this.points=Ge;for(var bt=Ge.length<65536?Uint16Array:Uint32Array,cr=this.ids=new bt(Ge.length),ae=this.coords=new ze(Ge.length*2),Ee=0;Ee<Ge.length;Ee++)cr[Ee]=Ee,ae[2*Ee]=vt(Ge[Ee]),ae[2*Ee+1]=Pe(Ge[Ee]);O(cr,ae,Te,0,cr.length-1,0)};fe.prototype.range=function(Ge,vt,Pe,Te){return p(this.ids,this.coords,Ge,vt,Pe,Te,this.nodeSize)},fe.prototype.within=function(Ge,vt,Pe){return H(this.ids,this.coords,Ge,vt,Pe,this.nodeSize)};var Q={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ge){return Ge}},we=Math.fround||function(St){return function(Ge){return St[0]=+Ge,St[0]}}(new Float32Array(1)),Ie=function(Ge){this.options=Sr(Object.create(Q),Ge),this.trees=new Array(this.options.maxZoom+1)};Ie.prototype.load=function(Ge){var vt=this.options,Pe=vt.log,Te=vt.minZoom,ze=vt.maxZoom,bt=vt.nodeSize;Pe&&console.time("total time");var cr="prepare "+Ge.length+" points";Pe&&console.time(cr),this.points=Ge;for(var ae=[],Ee=0;Ee<Ge.length;Ee++)!Ge[Ee].geometry||ae.push(Xe(Ge[Ee],Ee));this.trees[ze+1]=new fe(ae,Ft,Ht,bt,Float32Array),Pe&&console.timeEnd(cr);for(var le=ze;le>=Te;le--){var re=+Date.now();ae=this._cluster(ae,le),this.trees[le]=new fe(ae,Ft,Ht,bt,Float32Array),Pe&&console.log("z%d: %d clusters in %dms",le,ae.length,+Date.now()-re)}return Pe&&console.timeEnd("total time"),this},Ie.prototype.getClusters=function(Ge,vt){var Pe=((Ge[0]+180)%360+360)%360-180,Te=Math.max(-90,Math.min(90,Ge[1])),ze=Ge[2]===180?180:((Ge[2]+180)%360+360)%360-180,bt=Math.max(-90,Math.min(90,Ge[3]));if(Ge[2]-Ge[0]>=360)Pe=-180,ze=180;else if(Pe>ze){var cr=this.getClusters([Pe,Te,180,bt],vt),ae=this.getClusters([-180,Te,ze,bt],vt);return cr.concat(ae)}for(var Ee=this.trees[this._limitZoom(vt)],le=Ee.range(Yt(Pe),lt(bt),Yt(ze),lt(Te)),re=[],te=0,ke=le;te<ke.length;te+=1){var nt=ke[te],Kt=Ee.points[nt];re.push(Kt.numPoints?Ut(Kt):this.points[Kt.index])}return re},Ie.prototype.getChildren=function(Ge){var vt=this._getOriginId(Ge),Pe=this._getOriginZoom(Ge),Te="No cluster with the specified id.",ze=this.trees[Pe];if(!ze)throw new Error(Te);var bt=ze.points[vt];if(!bt)throw new Error(Te);for(var cr=this.options.radius/(this.options.extent*Math.pow(2,Pe-1)),ae=ze.within(bt.x,bt.y,cr),Ee=[],le=0,re=ae;le<re.length;le+=1){var te=re[le],ke=ze.points[te];ke.parentId===Ge&&Ee.push(ke.numPoints?Ut(ke):this.points[ke.index])}if(Ee.length===0)throw new Error(Te);return Ee},Ie.prototype.getLeaves=function(Ge,vt,Pe){vt=vt||10,Pe=Pe||0;var Te=[];return this._appendLeaves(Te,Ge,vt,Pe,0),Te},Ie.prototype.getTile=function(Ge,vt,Pe){var Te=this.trees[this._limitZoom(Ge)],ze=Math.pow(2,Ge),bt=this.options,cr=bt.extent,ae=bt.radius,Ee=ae/cr,le=(Pe-Ee)/ze,re=(Pe+1+Ee)/ze,te={features:[]};return this._addTileFeatures(Te.range((vt-Ee)/ze,le,(vt+1+Ee)/ze,re),Te.points,vt,Pe,ze,te),vt===0&&this._addTileFeatures(Te.range(1-Ee/ze,le,1,re),Te.points,ze,Pe,ze,te),vt===ze-1&&this._addTileFeatures(Te.range(0,le,Ee/ze,re),Te.points,-1,Pe,ze,te),te.features.length?te:null},Ie.prototype.getClusterExpansionZoom=function(Ge){for(var vt=this._getOriginZoom(Ge)-1;vt<=this.options.maxZoom;){var Pe=this.getChildren(Ge);if(vt++,Pe.length!==1)break;Ge=Pe[0].properties.cluster_id}return vt},Ie.prototype._appendLeaves=function(Ge,vt,Pe,Te,ze){for(var bt=this.getChildren(vt),cr=0,ae=bt;cr<ae.length;cr+=1){var Ee=ae[cr],le=Ee.properties;if(le&&le.cluster?ze+le.point_count<=Te?ze+=le.point_count:ze=this._appendLeaves(Ge,le.cluster_id,Pe,Te,ze):ze<Te?ze++:Ge.push(Ee),Ge.length===Pe)break}return ze},Ie.prototype._addTileFeatures=function(Ge,vt,Pe,Te,ze,bt){for(var cr=0,ae=Ge;cr<ae.length;cr+=1){var Ee=ae[cr],le=vt[Ee],re=le.numPoints,te=void 0,ke=void 0,nt=void 0;if(re)te=er(le),ke=le.x,nt=le.y;else{var Kt=this.points[le.index];te=Kt.properties,ke=Yt(Kt.geometry.coordinates[0]),nt=lt(Kt.geometry.coordinates[1])}var Ir={type:1,geometry:[[Math.round(this.options.extent*(ke*ze-Pe)),Math.round(this.options.extent*(nt*ze-Te))]],tags:te},Lr=void 0;re?Lr=le.id:this.options.generateId?Lr=le.index:this.points[le.index].id&&(Lr=this.points[le.index].id),Lr!==void 0&&(Ir.id=Lr),bt.features.push(Ir)}},Ie.prototype._limitZoom=function(Ge){return Math.max(this.options.minZoom,Math.min(+Ge,this.options.maxZoom+1))},Ie.prototype._cluster=function(Ge,vt){for(var Pe=[],Te=this.options,ze=Te.radius,bt=Te.extent,cr=Te.reduce,ae=Te.minPoints,Ee=ze/(bt*Math.pow(2,vt)),le=0;le<Ge.length;le++){var re=Ge[le];if(!(re.zoom<=vt)){re.zoom=vt;for(var te=this.trees[vt+1],ke=te.within(re.x,re.y,Ee),nt=re.numPoints||1,Kt=nt,Ir=0,Lr=ke;Ir<Lr.length;Ir+=1){var qr=Lr[Ir],tr=te.points[qr];tr.zoom>vt&&(Kt+=tr.numPoints||1)}if(Kt>=ae){for(var ce=re.x*nt,ye=re.y*nt,Re=cr&&nt>1?this._map(re,!0):null,Qe=(le<<5)+(vt+1)+this.points.length,Dt=0,Ct=ke;Dt<Ct.length;Dt+=1){var A=Ct[Dt],z=te.points[A];if(!(z.zoom<=vt)){z.zoom=vt;var ve=z.numPoints||1;ce+=z.x*ve,ye+=z.y*ve,z.parentId=Qe,cr&&(Re||(Re=this._map(re,!0)),cr(Re,this._map(z)))}}re.parentId=Qe,Pe.push(Be(ce/Kt,ye/Kt,Qe,Kt,Re))}else if(Pe.push(re),Kt>1)for(var Ce=0,$e=ke;Ce<$e.length;Ce+=1){var ot=$e[Ce],Ot=te.points[ot];Ot.zoom<=vt||(Ot.zoom=vt,Pe.push(Ot))}}}return Pe},Ie.prototype._getOriginId=function(Ge){return Ge-this.points.length>>5},Ie.prototype._getOriginZoom=function(Ge){return(Ge-this.points.length)%32},Ie.prototype._map=function(Ge,vt){if(Ge.numPoints)return vt?Sr({},Ge.properties):Ge.properties;var Pe=this.points[Ge.index].properties,Te=this.options.map(Pe);return vt&&Te===Pe?Sr({},Te):Te};function Be(St,Ge,vt,Pe,Te){return{x:we(St),y:we(Ge),zoom:Infinity,id:vt,parentId:-1,numPoints:Pe,properties:Te}}function Xe(St,Ge){var vt=St.geometry.coordinates,Pe=vt[0],Te=vt[1];return{x:we(Yt(Pe)),y:we(lt(Te)),zoom:Infinity,index:Ge,parentId:-1}}function Ut(St){return{type:"Feature",id:St.id,properties:er(St),geometry:{type:"Point",coordinates:[xt(St.x),ct(St.y)]}}}function er(St){var Ge=St.numPoints,vt=Ge>=1e4?Math.round(Ge/1e3)+"k":Ge>=1e3?Math.round(Ge/100)/10+"k":Ge;return Sr(Sr({},St.properties),{cluster:!0,cluster_id:St.id,point_count:Ge,point_count_abbreviated:vt})}function Yt(St){return St/360+.5}function lt(St){var Ge=Math.sin(St*Math.PI/180),vt=.5-.25*Math.log((1+Ge)/(1-Ge))/Math.PI;return vt<0?0:vt>1?1:vt}function xt(St){return(St-.5)*360}function ct(St){var Ge=(180-St*360)*Math.PI/180;return 360*Math.atan(Math.exp(Ge))/Math.PI-90}function Sr(St,Ge){for(var vt in Ge)St[vt]=Ge[vt];return St}function Ft(St){return St.x}function Ht(St){return St.y}return Ie})},86940:function(_t){_t.exports.RADIUS=6378137,_t.exports.FLATTENING=1/298.257223563,_t.exports.POLAR_RADIUS=63567523142e-4},77412:function(_t){function O(_,X){for(var b=-1,p=_==null?0:_.length;++b<p&&X(_[b],b,_)!==!1;);return _}_t.exports=O},47443:function(_t,O,_){var X=_(42118);function b(p,H){var S=p==null?0:p.length;return!!S&&X(p,H,0)>-1}_t.exports=b},1196:function(_t){function O(_,X,b){for(var p=-1,H=_==null?0:_.length;++p<H;)if(b(X,_[p]))return!0;return!1}_t.exports=O},62663:function(_t){function O(_,X,b,p){var H=-1,S=_==null?0:_.length;for(p&&S&&(b=_[++H]);++H<S;)b=X(b,_[H],H,_);return b}_t.exports=O},49029:function(_t){var O=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function _(X){return X.match(O)||[]}_t.exports=_},44037:function(_t,O,_){var X=_(98363),b=_(3674);function p(H,S){return H&&X(S,b(S),H)}_t.exports=p},63886:function(_t,O,_){var X=_(98363),b=_(81704);function p(H,S){return H&&X(S,b(S),H)}_t.exports=p},89465:function(_t,O,_){var X=_(38777);function b(p,H,S){H=="__proto__"&&X?X(p,H,{configurable:!0,enumerable:!0,value:S,writable:!0}):p[H]=S}_t.exports=b},29750:function(_t){function O(_,X,b){return _===_&&(b!==void 0&&(_=_<=b?_:b),X!==void 0&&(_=_>=X?_:X)),_}_t.exports=O},85990:function(_t,O,_){var X=_(46384),b=_(77412),p=_(34865),H=_(44037),S=_(63886),F=_(64626),ie=_(278),fe=_(18805),Q=_(1911),we=_(58234),Ie=_(46904),Be=_(64160),Xe=_(43824),Ut=_(29148),er=_(38517),Yt=_(1469),lt=_(44144),xt=_(56688),ct=_(13218),Sr=_(72928),Ft=_(3674),Ht=_(81704),St=1,Ge=2,vt=4,Pe="[object Arguments]",Te="[object Array]",ze="[object Boolean]",bt="[object Date]",cr="[object Error]",ae="[object Function]",Ee="[object GeneratorFunction]",le="[object Map]",re="[object Number]",te="[object Object]",ke="[object RegExp]",nt="[object Set]",Kt="[object String]",Ir="[object Symbol]",Lr="[object WeakMap]",qr="[object ArrayBuffer]",tr="[object DataView]",ce="[object Float32Array]",ye="[object Float64Array]",Re="[object Int8Array]",Qe="[object Int16Array]",Dt="[object Int32Array]",Ct="[object Uint8Array]",A="[object Uint8ClampedArray]",z="[object Uint16Array]",ve="[object Uint32Array]",Ce={};Ce[Pe]=Ce[Te]=Ce[qr]=Ce[tr]=Ce[ze]=Ce[bt]=Ce[ce]=Ce[ye]=Ce[Re]=Ce[Qe]=Ce[Dt]=Ce[le]=Ce[re]=Ce[te]=Ce[ke]=Ce[nt]=Ce[Kt]=Ce[Ir]=Ce[Ct]=Ce[A]=Ce[z]=Ce[ve]=!0,Ce[cr]=Ce[ae]=Ce[Lr]=!1;function $e(ot,Ot,G,Et,Bt,dr){var wr,Tr=Ot&St,Or=Ot&Ge,qe=Ot&vt;if(G&&(wr=Bt?G(ot,Et,Bt,dr):G(ot)),wr!==void 0)return wr;if(!ct(ot))return ot;var yt=Yt(ot);if(yt){if(wr=Xe(ot),!Tr)return ie(ot,wr)}else{var dt=Be(ot),lr=dt==ae||dt==Ee;if(lt(ot))return F(ot,Tr);if(dt==te||dt==Pe||lr&&!Bt){if(wr=Or||lr?{}:er(ot),!Tr)return Or?Q(ot,S(wr,ot)):fe(ot,H(wr,ot))}else{if(!Ce[dt])return Bt?ot:{};wr=Ut(ot,dt,Tr)}}dr||(dr=new X);var Kr=dr.get(ot);if(Kr)return Kr;dr.set(ot,wr),Sr(ot)?ot.forEach(function(sr){wr.add($e(sr,Ot,G,sr,ot,dr))}):xt(ot)&&ot.forEach(function(sr,ar){wr.set(ar,$e(sr,Ot,G,ar,ot,dr))});var gt=qe?Or?Ie:we:Or?Ht:Ft,Rt=yt?void 0:gt(ot);return b(Rt||ot,function(sr,ar){Rt&&(ar=sr,sr=ot[ar]),p(wr,ar,$e(sr,Ot,G,ar,ot,dr))}),wr}_t.exports=$e},41848:function(_t){function O(_,X,b,p){for(var H=_.length,S=b+(p?1:-1);p?S--:++S<H;)if(X(_[S],S,_))return S;return-1}_t.exports=O},28483:function(_t,O,_){var X=_(25063),b=X();_t.exports=b},42118:function(_t,O,_){var X=_(41848),b=_(1386),p=_(42351);function H(S,F,ie){return F===F?p(S,F,ie):X(S,b,ie)}_t.exports=H},25588:function(_t,O,_){var X=_(64160),b=_(37005),p="[object Map]";function H(S){return b(S)&&X(S)==p}_t.exports=H},1386:function(_t){function O(_){return _!==_}_t.exports=O},29221:function(_t,O,_){var X=_(64160),b=_(37005),p="[object Set]";function H(S){return b(S)&&X(S)==p}_t.exports=H},18674:function(_t){function O(_){return function(X){return _==null?void 0:_[X]}}_t.exports=O},45652:function(_t,O,_){var X=_(88668),b=_(47443),p=_(1196),H=_(74757),S=_(23593),F=_(50121),ie=200;function fe(Q,we,Ie){var Be=-1,Xe=b,Ut=Q.length,er=!0,Yt=[],lt=Yt;if(Ie)er=!1,Xe=p;else if(Ut>=ie){var xt=we?null:S(Q);if(xt)return F(xt);er=!1,Xe=H,lt=new X}else lt=we?[]:Yt;e:for(;++Be<Ut;){var ct=Q[Be],Sr=we?we(ct):ct;if(ct=Ie||ct!==0?ct:0,er&&Sr===Sr){for(var Ft=lt.length;Ft--;)if(lt[Ft]===Sr)continue e;we&&lt.push(Sr),Yt.push(ct)}else Xe(lt,Sr,Ie)||(lt!==Yt&&lt.push(Sr),Yt.push(ct))}return Yt}_t.exports=fe},57157:function(_t,O,_){var X=_(74318);function b(p,H){var S=H?X(p.buffer):p.buffer;return new p.constructor(S,p.byteOffset,p.byteLength)}_t.exports=b},93147:function(_t){var O=/\w*$/;function _(X){var b=new X.constructor(X.source,O.exec(X));return b.lastIndex=X.lastIndex,b}_t.exports=_},40419:function(_t,O,_){var X=_(62705),b=X?X.prototype:void 0,p=b?b.valueOf:void 0;function H(S){return p?Object(p.call(S)):{}}_t.exports=H},18805:function(_t,O,_){var X=_(98363),b=_(99551);function p(H,S){return X(H,b(H),S)}_t.exports=p},1911:function(_t,O,_){var X=_(98363),b=_(51442);function p(H,S){return X(H,b(H),S)}_t.exports=p},25063:function(_t){function O(_){return function(X,b,p){for(var H=-1,S=Object(X),F=p(X),ie=F.length;ie--;){var fe=F[_?ie:++H];if(b(S[fe],fe,S)===!1)break}return X}}_t.exports=O},35393:function(_t,O,_){var X=_(62663),b=_(53816),p=_(58748),H="['\u2019]",S=RegExp(H,"g");function F(ie){return function(fe){return X(p(b(fe).replace(S,"")),ie,"")}}_t.exports=F},23593:function(_t,O,_){var X=_(58525),b=_(50308),p=_(50121),H=1/0,S=X&&1/p(new X([,-0]))[1]==H?function(F){return new X(F)}:b;_t.exports=S},69389:function(_t,O,_){var X=_(18674),b={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},p=X(b);_t.exports=p},38777:function(_t,O,_){var X=_(10852),b=function(){try{var p=X(Object,"defineProperty");return p({},"",{}),p}catch(H){}}();_t.exports=b},46904:function(_t,O,_){var X=_(68866),b=_(51442),p=_(81704);function H(S){return X(S,p,b)}_t.exports=H},51442:function(_t,O,_){var X=_(62488),b=_(85924),p=_(99551),H=_(70479),S=Object.getOwnPropertySymbols,F=S?function(ie){for(var fe=[];ie;)X(fe,p(ie)),ie=b(ie);return fe}:H;_t.exports=F},93157:function(_t){var O=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function _(X){return O.test(X)}_t.exports=_},43824:function(_t){var O=Object.prototype,_=O.hasOwnProperty;function X(b){var p=b.length,H=new b.constructor(p);return p&&typeof b[0]=="string"&&_.call(b,"index")&&(H.index=b.index,H.input=b.input),H}_t.exports=X},29148:function(_t,O,_){var X=_(74318),b=_(57157),p=_(93147),H=_(40419),S=_(77133),F="[object Boolean]",ie="[object Date]",fe="[object Map]",Q="[object Number]",we="[object RegExp]",Ie="[object Set]",Be="[object String]",Xe="[object Symbol]",Ut="[object ArrayBuffer]",er="[object DataView]",Yt="[object Float32Array]",lt="[object Float64Array]",xt="[object Int8Array]",ct="[object Int16Array]",Sr="[object Int32Array]",Ft="[object Uint8Array]",Ht="[object Uint8ClampedArray]",St="[object Uint16Array]",Ge="[object Uint32Array]";function vt(Pe,Te,ze){var bt=Pe.constructor;switch(Te){case Ut:return X(Pe);case F:case ie:return new bt(+Pe);case er:return b(Pe,ze);case Yt:case lt:case xt:case ct:case Sr:case Ft:case Ht:case St:case Ge:return S(Pe,ze);case fe:return new bt;case Q:case Be:return new bt(Pe);case we:return p(Pe);case Ie:return new bt;case Xe:return H(Pe)}}_t.exports=vt},42351:function(_t){function O(_,X,b){for(var p=b-1,H=_.length;++p<H;)if(_[p]===X)return p;return-1}_t.exports=O},2757:function(_t){var O="\\ud800-\\udfff",_="\\u0300-\\u036f",X="\\ufe20-\\ufe2f",b="\\u20d0-\\u20ff",p=_+X+b,H="\\u2700-\\u27bf",S="a-z\\xdf-\\xf6\\xf8-\\xff",F="\\xac\\xb1\\xd7\\xf7",ie="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fe="\\u2000-\\u206f",Q=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",we="A-Z\\xc0-\\xd6\\xd8-\\xde",Ie="\\ufe0e\\ufe0f",Be=F+ie+fe+Q,Xe="['\u2019]",Ut="["+Be+"]",er="["+p+"]",Yt="\\d+",lt="["+H+"]",xt="["+S+"]",ct="[^"+O+Be+Yt+H+S+we+"]",Sr="\\ud83c[\\udffb-\\udfff]",Ft="(?:"+er+"|"+Sr+")",Ht="[^"+O+"]",St="(?:\\ud83c[\\udde6-\\uddff]){2}",Ge="[\\ud800-\\udbff][\\udc00-\\udfff]",vt="["+we+"]",Pe="\\u200d",Te="(?:"+xt+"|"+ct+")",ze="(?:"+vt+"|"+ct+")",bt="(?:"+Xe+"(?:d|ll|m|re|s|t|ve))?",cr="(?:"+Xe+"(?:D|LL|M|RE|S|T|VE))?",ae=Ft+"?",Ee="["+Ie+"]?",le="(?:"+Pe+"(?:"+[Ht,St,Ge].join("|")+")"+Ee+ae+")*",re="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",te="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ke=Ee+ae+le,nt="(?:"+[lt,St,Ge].join("|")+")"+ke,Kt=RegExp([vt+"?"+xt+"+"+bt+"(?="+[Ut,vt,"$"].join("|")+")",ze+"+"+cr+"(?="+[Ut,vt+Te,"$"].join("|")+")",vt+"?"+Te+"+"+bt,vt+"+"+cr,te,re,Yt,nt].join("|"),"g");function Ir(Lr){return Lr.match(Kt)||[]}_t.exports=Ir},68929:function(_t,O,_){var X=_(48403),b=_(35393),p=b(function(H,S,F){return S=S.toLowerCase(),H+(F?X(S):S)});_t.exports=p},48403:function(_t,O,_){var X=_(79833),b=_(11700);function p(H){return b(X(H).toLowerCase())}_t.exports=p},74691:function(_t,O,_){var X=_(29750),b=_(14841);function p(H,S,F){return F===void 0&&(F=S,S=void 0),F!==void 0&&(F=b(F),F=F===F?F:0),S!==void 0&&(S=b(S),S=S===S?S:0),X(b(H),S,F)}_t.exports=p},50361:function(_t,O,_){var X=_(85990),b=1,p=4;function H(S){return X(S,b|p)}_t.exports=H},53816:function(_t,O,_){var X=_(69389),b=_(79833),p=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,H="\\u0300-\\u036f",S="\\ufe20-\\ufe2f",F="\\u20d0-\\u20ff",ie=H+S+F,fe="["+ie+"]",Q=RegExp(fe,"g");function we(Ie){return Ie=b(Ie),Ie&&Ie.replace(p,X).replace(Q,"")}_t.exports=we},6557:function(_t){function O(_){return _}_t.exports=O},56688:function(_t,O,_){var X=_(25588),b=_(7518),p=_(31167),H=p&&p.isMap,S=H?b(H):X;_t.exports=S},14293:function(_t){function O(_){return _==null}_t.exports=O},81763:function(_t,O,_){var X=_(44239),b=_(37005),p="[object Number]";function H(S){return typeof S=="number"||b(S)&&X(S)==p}_t.exports=H},72928:function(_t,O,_){var X=_(29221),b=_(7518),p=_(31167),H=p&&p.isSet,S=H?b(H):X;_t.exports=S},47037:function(_t,O,_){var X=_(44239),b=_(1469),p=_(37005),H="[object String]";function S(F){return typeof F=="string"||!b(F)&&p(F)&&X(F)==H}_t.exports=S},30236:function(_t,O,_){var X=_(42980),b=_(21463),p=b(function(H,S,F,ie){X(H,S,F,ie)});_t.exports=p},50308:function(_t){function O(){}_t.exports=O},44908:function(_t,O,_){var X=_(45652);function b(p){return p&&p.length?X(p):[]}_t.exports=b},58748:function(_t,O,_){var X=_(49029),b=_(93157),p=_(79833),H=_(2757);function S(F,ie,fe){return F=p(F),ie=fe?void 0:ie,ie===void 0?b(F)?H(F):X(F):F.match(ie)||[]}_t.exports=S}}]);
